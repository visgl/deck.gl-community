(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[6248],{340:(e,t,n)=>{"use strict";n.d(t,{Vi:()=>o,lP:()=>i});const o={LIGHT:"https://deck.gl/mapstyle/deck-light.json",LIGHT_LABEL:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",DARK:"https://deck.gl/mapstyle/deck-dark.json",BLANK:{version:8,sources:{},layers:[]}},i="https://github.com/visgl/deck.gl-community/tree/master"},1988:e=>{!function(e,t,n,o,i){if("customElements"in n)i();else{if(n.AWAITING_WEB_COMPONENTS_POLYFILL)return void n.AWAITING_WEB_COMPONENTS_POLYFILL.then(i);var r=n.AWAITING_WEB_COMPONENTS_POLYFILL=l();r.then(i);var s=n.WEB_COMPONENTS_POLYFILL||"//cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/2.0.2/webcomponents-bundle.js",a=n.ES6_CORE_POLYFILL||"//cdnjs.cloudflare.com/ajax/libs/core-js/2.5.3/core.min.js";"Promise"in n?d(s).then(function(){r.isDone=!0,r.exec()}):d(a).then(function(){d(s).then(function(){r.isDone=!0,r.exec()})})}function l(){var e=[];return e.isDone=!1,e.exec=function(){e.splice(0).forEach(function(e){e()})},e.then=function(t){return e.isDone?t():e.push(t),e},e}function d(e){var t=l(),n=o.createElement("script");return n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(n.onreadystatechange=null,t.isDone=!0,t.exec())}:n.onload=function(){t.isDone=!0,t.exec()},n.src=e,o.getElementsByTagName("head")[0].appendChild(n),n.then=t.then,n}}(0,0,window,document,function(){var t;window,t=function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n,o=e[1]||"",i=e[3];if(!i)return o;if(t&&"function"==typeof btoa){var r=(n=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),s=i.sources.map(function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"});return[o].concat(s).concat([r]).join("\n")}return[o].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},i=0;i<this.length;i++){var r=this[i][0];"number"==typeof r&&(o[r]=!0)}for(i=0;i<e.length;i++){var s=e[i];"number"==typeof s[0]&&o[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),t.push(s))}},t}},function(e,t,n){var o=n(3);e.exports="string"==typeof o?o:o.toString()},function(e,t,n){var o=n(4);e.exports="string"==typeof o?o:o.toString()},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@-webkit-keyframes burst{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}90%{-webkit-transform:scale(1.5);transform:scale(1.5);opacity:0}}@keyframes burst{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}90%{-webkit-transform:scale(1.5);transform:scale(1.5);opacity:0}}@-webkit-keyframes flashing{0%{opacity:1}45%{opacity:0}90%{opacity:1}}@keyframes flashing{0%{opacity:1}45%{opacity:0}90%{opacity:1}}@-webkit-keyframes fade-left{0%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}75%{-webkit-transform:translateX(-20px);transform:translateX(-20px);opacity:0}}@keyframes fade-left{0%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}75%{-webkit-transform:translateX(-20px);transform:translateX(-20px);opacity:0}}@-webkit-keyframes fade-right{0%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}75%{-webkit-transform:translateX(20px);transform:translateX(20px);opacity:0}}@keyframes fade-right{0%{-webkit-transform:translateX(0);transform:translateX(0);opacity:1}75%{-webkit-transform:translateX(20px);transform:translateX(20px);opacity:0}}@-webkit-keyframes fade-up{0%{-webkit-transform:translateY(0);transform:translateY(0);opacity:1}75%{-webkit-transform:translateY(-20px);transform:translateY(-20px);opacity:0}}@keyframes fade-up{0%{-webkit-transform:translateY(0);transform:translateY(0);opacity:1}75%{-webkit-transform:translateY(-20px);transform:translateY(-20px);opacity:0}}@-webkit-keyframes fade-down{0%{-webkit-transform:translateY(0);transform:translateY(0);opacity:1}75%{-webkit-transform:translateY(20px);transform:translateY(20px);opacity:0}}@keyframes fade-down{0%{-webkit-transform:translateY(0);transform:translateY(0);opacity:1}75%{-webkit-transform:translateY(20px);transform:translateY(20px);opacity:0}}@-webkit-keyframes tada{0%{-webkit-transform:scaleX(1);transform:scaleX(1)}10%,20%{-webkit-transform:scale3d(.95,.95,.95) rotate(-10deg);transform:scale3d(.95,.95,.95) rotate(-10deg)}30%,50%,70%,90%{-webkit-transform:scaleX(1) rotate(10deg);transform:scaleX(1) rotate(10deg)}40%,60%,80%{-webkit-transform:scaleX(1) rotate(-10deg);transform:scaleX(1) rotate(-10deg)}to{-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes tada{0%{-webkit-transform:scaleX(1);transform:scaleX(1)}10%,20%{-webkit-transform:scale3d(.95,.95,.95) rotate(-10deg);transform:scale3d(.95,.95,.95) rotate(-10deg)}30%,50%,70%,90%{-webkit-transform:scaleX(1) rotate(10deg);transform:scaleX(1) rotate(10deg)}40%,60%,80%{-webkit-transform:rotate(-10deg);transform:rotate(-10deg)}to{-webkit-transform:scaleX(1);transform:scaleX(1)}}.bx-spin,.bx-spin-hover:hover{-webkit-animation:spin 2s linear infinite;animation:spin 2s linear infinite}.bx-tada,.bx-tada-hover:hover{-webkit-animation:tada 1.5s ease infinite;animation:tada 1.5s ease infinite}.bx-flashing,.bx-flashing-hover:hover{-webkit-animation:flashing 1.5s infinite linear;animation:flashing 1.5s infinite linear}.bx-burst,.bx-burst-hover:hover{-webkit-animation:burst 1.5s infinite linear;animation:burst 1.5s infinite linear}.bx-fade-up,.bx-fade-up-hover:hover{-webkit-animation:fade-up 1.5s infinite linear;animation:fade-up 1.5s infinite linear}.bx-fade-down,.bx-fade-down-hover:hover{-webkit-animation:fade-down 1.5s infinite linear;animation:fade-down 1.5s infinite linear}.bx-fade-left,.bx-fade-left-hover:hover{-webkit-animation:fade-left 1.5s infinite linear;animation:fade-left 1.5s infinite linear}.bx-fade-right,.bx-fade-right-hover:hover{-webkit-animation:fade-right 1.5s infinite linear;animation:fade-right 1.5s infinite linear}",""])},function(e,t,n){(e.exports=n(0)(!1)).push([e.i,'.bx-rotate-90{transform:rotate(90deg);-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)"}.bx-rotate-180{transform:rotate(180deg);-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2)"}.bx-rotate-270{transform:rotate(270deg);-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)"}.bx-flip-horizontal{transform:scaleX(-1);-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)"}.bx-flip-vertical{transform:scaleY(-1);-ms-filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)"}',""])},function(e,t,n){"use strict";n.r(t),n.d(t,"BoxIconElement",function(){return x});var o,i,r,s,a=n(1),l=n.n(a),d=n(2),c=n.n(d),p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),g=(i=(o=Object).getPrototypeOf||function(e){return e.__proto__},r=o.setPrototypeOf||function(e,t){return e.__proto__=t,e},s="object"===("undefined"==typeof Reflect?"undefined":p(Reflect))?Reflect.construct:function(e,t,n){var o,i=[null];return i.push.apply(i,t),o=e.bind.apply(e,i),r(new o,n.prototype)},function(e){var t=i(e);return r(e,r(function(){return s(t,arguments,i(this).constructor)},t))}),h=window,f={},m=document.createElement("template"),y=function(){return!!h.ShadyCSS};m.innerHTML='\n<style>\n:host {\n  display: inline-block;\n  font-size: initial;\n  box-sizing: border-box;\n  width: 24px;\n  height: 24px;\n}\n:host([size=xs]) {\n    width: 0.8rem;\n    height: 0.8rem;\n}\n:host([size=sm]) {\n    width: 1.55rem;\n    height: 1.55rem;\n}\n:host([size=md]) {\n    width: 2.25rem;\n    height: 2.25rem;\n}\n:host([size=lg]) {\n    width: 3.0rem;\n    height: 3.0rem;\n}\n\n:host([size]:not([size=""]):not([size=xs]):not([size=sm]):not([size=md]):not([size=lg])) {\n    width: auto;\n    height: auto;\n}\n:host([pull=left]) #icon {\n    float: left;\n    margin-right: .3em!important;\n}\n:host([pull=right]) #icon {\n    float: right;\n    margin-left: .3em!important;\n}\n:host([border=square]) #icon {\n    padding: .25em;\n    border: .07em solid rgba(0,0,0,.1);\n    border-radius: .25em;\n}\n:host([border=circle]) #icon {\n    padding: .25em;\n    border: .07em solid rgba(0,0,0,.1);\n    border-radius: 50%;\n}\n#icon,\nsvg {\n  width: 100%;\n  height: 100%;\n}\n#icon {\n    box-sizing: border-box;\n} \n'+l.a+"\n"+c.a+'\n</style>\n<div id="icon"></div>';var x=g(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.$ui=t.attachShadow({mode:"open"}),t.$ui.appendChild(t.ownerDocument.importNode(m.content,!0)),y()&&h.ShadyCSS.styleElement(t),t._state={$iconHolder:t.$ui.getElementById("icon"),type:t.getAttribute("type")},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,HTMLElement),u(e,null,[{key:"getIconSvg",value:function(e,t){var n=this.cdnUrl+"/regular/bx-"+e+".svg";return"solid"===t?n=this.cdnUrl+"/solid/bxs-"+e+".svg":"logo"===t&&(n=this.cdnUrl+"/logos/bxl-"+e+".svg"),n&&f[n]||(f[n]=new Promise(function(e,t){var o=new XMLHttpRequest;o.addEventListener("load",function(){this.status<200||this.status>=300?t(new Error(this.status+" "+this.responseText)):e(this.responseText)}),o.onerror=t,o.onabort=t,o.open("GET",n),o.send()})),f[n]}},{key:"define",value:function(e){e=e||this.tagName,y()&&h.ShadyCSS.prepareTemplate(m,e),customElements.define(e,this)}},{key:"cdnUrl",get:function(){return"//unpkg.com/boxicons@2.1.4/svg"}},{key:"tagName",get:function(){return"box-icon"}},{key:"observedAttributes",get:function(){return["type","name","color","size","rotate","flip","animation","border","pull"]}}]),u(e,[{key:"attributeChangedCallback",value:function(e,t,n){var o=this._state.$iconHolder;switch(e){case"type":!function(e,t,n){var o=e._state;o.$iconHolder.textContent="",o.type&&(o.type=null),o.type=!n||"solid"!==n&&"logo"!==n?"regular":n,void 0!==o.currentName&&e.constructor.getIconSvg(o.currentName,o.type).then(function(e){o.type===n&&(o.$iconHolder.innerHTML=e)}).catch(function(e){console.error("Failed to load icon: "+o.currentName+"\n"+e)})}(this,0,n);break;case"name":!function(e,t,n){var o=e._state;o.currentName=n,o.$iconHolder.textContent="",n&&void 0!==o.type&&e.constructor.getIconSvg(n,o.type).then(function(e){o.currentName===n&&(o.$iconHolder.innerHTML=e)}).catch(function(e){console.error("Failed to load icon: "+n+"\n"+e)})}(this,0,n);break;case"color":o.style.fill=n||"";break;case"size":!function(e,t,n){var o=e._state;o.size&&(o.$iconHolder.style.width=o.$iconHolder.style.height="",o.size=o.sizeType=null),n&&!/^(xs|sm|md|lg)$/.test(o.size)&&(o.size=n.trim(),o.$iconHolder.style.width=o.$iconHolder.style.height=o.size)}(this,0,n);break;case"rotate":t&&o.classList.remove("bx-rotate-"+t),n&&o.classList.add("bx-rotate-"+n);break;case"flip":t&&o.classList.remove("bx-flip-"+t),n&&o.classList.add("bx-flip-"+n);break;case"animation":t&&o.classList.remove("bx-"+t),n&&o.classList.add("bx-"+n)}}},{key:"connectedCallback",value:function(){y()&&h.ShadyCSS.styleElement(this)}}]),e}());t.default=x,x.define()}])},e.exports=t()})},4451:(e,t,n)=>{"use strict";n.d(t,{Ys:()=>G,ww:()=>J,xv:()=>D});var o=n(6540),i=n(3724);const r=e=>"@media screen and (max-width: 480px)",s=i.Ay.div.withConfig({displayName:"styled__PanelContainer",componentId:"sc-oqnqzc-0"})(["font-size:14px;position:absolute;top:0;right:0;width:344px;background:var(--ifm-background-surface-color);box-shadow:var(--ifm-global-shadow-lw);margin:24px;padding:10px 24px;max-height:96%;overflow-x:hidden;overflow-y:auto;overflow-y:overlay;outline:none;z-index:1;","{width:auto;left:0;}"],r),a=i.Ay.div.withConfig({displayName:"styled__PanelExpander",componentId:"sc-oqnqzc-1"})(["display:none;width:16px;height:16px;font-family:serif;font-size:0.8em;text-align:center;line-height:16px;border-radius:50%;background:",";color:",";","{display:block;}"],e=>e.$expanded?"none":"var(--ifm-color-gray-900)",e=>e.$expanded?"var(--ifm-color-black)":"var(--ifm-color-white)",r),l=i.Ay.div.withConfig({displayName:"styled__PanelTitle",componentId:"sc-oqnqzc-2"})(["display:flex;align-items:center;justify-content:space-between;font:bold 1.25em var(--ifm-font-family-base);margin:8px 0;","{cursor:pointer;}"],r),d=i.Ay.div.withConfig({displayName:"styled__PanelContent",componentId:"sc-oqnqzc-3"})(["div > *{vertical-align:middle;white-space:nowrap;}div > label{display:inline-block;width:40%;margin-right:10%;color:var(--ifm-color-content-secondary);margin-top:2px;margin-bottom:2px;}div > input,div > a,div > button,div > select{font:normal 11px/16px var(--ifm-font-family-base);line-height:20px;text-transform:none;text-overflow:ellipsis;overflow:hidden;display:inline-block;padding:0 4px;width:50%;height:20px;text-align:left;}div > button{color:initial;}div > button:disabled{color:var(--ifm-color-gray-300);cursor:default;background:var(--ifm-color-gray-300);}div > input{border:solid 1px var(--ifm-color-gray-300);&:disabled{background:var(--ifm-color-white);}&[type='checkbox']{height:auto;}}p{margin-bottom:12px;white-space:initial;}","{display:",";}"],r,e=>e.$expanded?"block":"none"),c=i.Ay.a.withConfig({displayName:"styled__SourceLink",componentId:"sc-oqnqzc-4"})(["display:block;text-align:right;margin-top:8px;font:bold 12px/20px var(--ifm-font-family-base);color:var(--ifm-color-content-secondary);","{display:",";}"],r,e=>e.$expanded?"block":"none");var p=n(8587),u=n(4848);const g=["name","onChange","displayName","altValue","displayValue"],h=i.Ay.div.withConfig({displayName:"input__InputContainer",componentId:"sc-1myx0c6-0"})(["position:relative;width:100%;&:last-child{margin-bottom:20px;}> *{vertical-align:middle;white-space:nowrap;}label{display:inline-block;width:40%;margin-right:10%;margin-top:2px;margin-bottom:2px;}input,a,button{background:var(--ifm-background-surface-color);font-size:0.9em;text-transform:none;text-overflow:ellipsis;overflow:hidden;display:inline-block;padding:0 4px;margin:0;width:50%;height:20px;line-height:1.833;text-align:left;}button{color:initial;}button:disabled{color:var(--ifm-color-gray-500);cursor:default;background:var(--ifm-color-gray-300);}input{border:solid 1px var(--ifm-color-gray-500);&:disabled{background:var(--ifm-color-gray-300);}&[type='checkbox']{height:auto;}}.tooltip{left:50%;top:24px;opacity:0;pointer-events:none;transition:opacity 200ms;}&:hover .tooltip{opacity:1;}"]);function f(e){let{name:t,min:n,max:i,step:r,displayName:s,displayValue:a,onChange:l}=e;const d=(0,o.useCallback)(e=>{const{value:o}=e.target;let r=Number(o);void 0!==n&&(r=Math.max(n,r)),void 0!==i&&(r=Math.min(i,r)),l(t,r)},[n,i,l]);return(0,u.jsxs)(h,{children:[(0,u.jsx)("label",{children:s}),(0,u.jsxs)("div",{className:"tooltip",children:[s,": ",String(a)]}),(0,u.jsx)("input",{type:"range",min:n,max:i,value:a,step:r,onChange:d})]})}function m(e){let{name:t,value:n,displayName:i,displayValue:r,onChange:s}=e;const a=(0,o.useCallback)(e=>{const n=e.target.checked;s(t,n)},[s]);return(0,u.jsxs)(h,{children:[(0,u.jsx)("label",{children:i}),(0,u.jsxs)("div",{className:"tooltip",children:[i,": ",String(r)]}),(0,u.jsx)("input",{type:"checkbox",checked:n,onChange:a})]})}function y(e){const{name:t,onChange:n,displayName:i,altValue:r,displayValue:s}=e,a=(0,p.A)(e,g),l=(0,o.useCallback)(e=>{n(t,e.target.value)},[n]),d=(0,o.useCallback)(()=>{n(t,r)},[r,n]),c=a;switch(e.type){case"link":return(0,u.jsxs)(h,{children:[(0,u.jsx)("label",{children:i}),(0,u.jsx)("a",{href:s,target:"_new",children:s})]});case"function":case"json":const t=Boolean(r);return(0,u.jsxs)(h,{children:[(0,u.jsx)("label",{children:i}),(0,u.jsx)("button",{type:"text",disabled:!t,onClick:d,children:s})]});case"select":return(0,u.jsxs)(h,{children:[(0,u.jsx)("label",{children:i}),(0,u.jsx)("select",{onChange:l,value:s,children:e.options.map((e,t)=>(0,u.jsx)("option",{value:e,children:e},t))})]});case"checkbox":return(0,u.jsx)(m,Object.assign({},e));case"range":return(0,u.jsx)(f,Object.assign({},e));default:return(0,u.jsxs)(h,{children:[(0,u.jsx)("label",{children:i}),(0,u.jsxs)("div",{className:"tooltip",children:[i,": ",String(s)]}),(0,u.jsx)("input",Object.assign({},c,{value:s,onChange:l}))]})}}const x=i.Ay.div.withConfig({displayName:"spinner__SpinnerContainer",componentId:"sc-ok6n2c-0"})(["height:18px;line-height:18px;font-size:10px;> div{white-space:nowrap;left:0;bottom:0;position:absolute;height:18px;padding-left:20px;transition:width 0.5s;}.spinner--fill{background:$primary;color:$white;overflow:hidden;}.spinner--text{color:$black-40;}&.done{height:0 !important;line-height:0;font-size:0;transition:height 0.5s 1s;> div{height:0 !important;transition:height 0.5s 1s;}}"]);function b(e){let{meta:t}=e;if(!Number.isFinite(t.progress)&&!Number.isFinite(t.progressAlt))return null;const n=(t.progress||0)+(t.progressAlt||0),o=Math.round(1e3*n)/10,i="Loading... "+o+"%";return(0,u.jsxs)(x,{className:n>=1?"done":"",children:[(0,u.jsx)("div",{className:"spinner--text",children:i}),(0,u.jsx)("div",{className:"spinner--fill",style:{width:o+"%"},children:i})]})}const v=i.Ay.div.withConfig({displayName:"info-panel__InfoPanelContent",componentId:"sc-1qy2onu-0"})(["hr{margin:12px -24px;}a{text-decoration:none;display:inline;color:var(--ifm-color-primary);}p{margin-bottom:16px;}.legend{display:inline-block;width:12px;height:12px;}.stat{text-transform:uppercase;font-size:0.833em;b{display:block;font-size:3em;font-weight:bold;line-height:1.833;}}hr{border:none;background:var(--ifm-color-gray-400);height:1px;}.layout{display:table;width:100%;> *{display:table-cell !important;}.col-1-3{width:33.33%;}.col-1-2{width:50%;}.text-right{text-align:right;}.text-center{text-align:center;}}"]);function C(e){let{title:t,children:n,sourceLink:i}=e;const[r,p]=(0,o.useState)(!1);return(0,u.jsxs)(s,{children:[(0,u.jsxs)(l,{onClick:()=>p(!r),children:[(0,u.jsx)("div",{children:t}),(0,u.jsx)(a,{$expanded:r,children:r?"\u2715":"i"})]}),(0,u.jsx)(d,{$expanded:r,children:n}),(0,u.jsx)(c,{$expanded:r,href:i,target:"_new",children:"View Code \u2197"})]})}function P(e){let{title:t,sourceLink:n,params:o,meta:i,children:r,updateParam:s}=e;return(0,u.jsxs)(C,{title:t,sourceLink:n,children:[(0,u.jsxs)(v,{children:[r,Object.keys(o).length>0&&(0,u.jsx)("hr",{}),Object.keys(o).sort().map((e,t)=>(0,u.jsx)(y,Object.assign({name:e},o[e],{onChange:s}),t+"-"+e))]}),(0,u.jsx)(b,{meta:i})]})}var w=n(9228);const S={};function k(e,t){let n=0;S[e]&&S[e].terminate();const o=new Worker(e);S[e]=o;let i=[];o.onmessage=e=>{const{action:n,data:r,meta:s}=e.data;"end"===n?o.terminate():"add"===n&&r&&r.length&&(i=i.concat(r),t(i,s))},this.onProgress=e=>{const{responseText:t}=e.target,i=t.lastIndexOf("\n")+1;o.postMessage({event:"progress",text:t.slice(n,i)}),n=i},this.onLoad=e=>{const{responseText:t}=e;o.postMessage({event:"load",text:t.slice(n)})}}function _(e,t,n){if(t){const o=(0,w.Em)(e),i=new k(t,(e,t)=>{n(e,t)});o.on("progress",i.onProgress).on("load",i.onLoad).get()}else/\.(json|geojson)$/.test(e)?(0,w.Pq)(e,(e,t)=>{e||n(t,{})}):(0,w.Qq)(e,(e,t)=>{e||n(t,{})})}function A(e,t){return t.match(/^\w+:\/\//)?t:e.replace(/\/$/,"")+"/"+t.replace(/^\//,"")}var M=n(6420);const j=e=>{if("function"===e.type){let t=String(e.value);if(Array.isArray(e.value)&&(t="["+t+"]"),"function"==typeof e.value)return t=t.replace(/^function (\w+)?\((\w*?)\)/,"$2 =>"),t=t.replace(/^function (\w+)?(\(.*?\))/,"$2 =>"),t=t.replace(/\{\s*return\s*(.*?);?\s*\}$/,"$1"),Object.assign({},e,{displayValue:t});if(!e.altType)return Object.assign({},e,{displayValue:t});e.type=e.altType}if("json"===e.type)return Object.assign({},e,{displayValue:JSON.stringify(e.value)});if("color"===e.type){const n=function(e){if(!e)return[255,255,255,0];if(Array.isArray(e))return e.slice(0,4);const t=(0,M.Qh)(e);return[t.r,t.g,t.b,255]}(e.value);return Object.assign({},e,{value:n,displayValue:(t=n,t.slice(0,3).reduce((e,t)=>e+(t<16?"0":"")+t.toString(16),"#"))})}var t;return Object.assign({},e,{displayValue:String(e.value)})};var E=n(340),I=n(8180);const T=i.Ay.div.withConfig({displayName:"make-example__DemoContainer",componentId:"sc-is6oih-0"})([".tooltip,.deck-tooltip{position:absolute;padding:4px 12px;background:rgba(0,0,0,0.8);color:var(--ifm-color-white);max-width:300px;font-size:12px;z-index:9;pointer-events:none;white-space:nowrap;}"]),F=i.Ay.div.withConfig({displayName:"make-example__MapTip",componentId:"sc-is6oih-1"})(["position:absolute;right:12px;bottom:20px;color:var(--ifm-color-white);mix-blend-mode:difference;font-size:14px;@media screen and (max-width:480px){display:none;}"]);function D(e,t){let{isInteractive:n=!0,style:i}=void 0===t?{}:t;const{parameters:r={},mapStyle:s}=e,a=Object.keys(r).reduce((e,t)=>(e[t]=j(r[t]),e),{}),l=Array.isArray(e.data)?e.data.map(e=>null):null;return function(){const[t,r]=(0,o.useState)(l),[d,c]=(0,o.useState)(a),[p,g]=(0,o.useState)({}),h=(0,I.Ay)("/"),f=(0,o.useCallback)(e=>{const t=Object.keys(e).reduce((t,n)=>(t[n]=j(e[n]),t),{});c(e=>Object.assign({},e,t))},[]),m=(0,o.useCallback)(e=>{g(t=>Object.assign({},t,e))},[]);(0,o.useEffect)(()=>{let t=e.data;if(!t)return;const n=Array.isArray(t);n||(t=[t]);for(let e=0;e<t.length;e++){const{url:o,worker:i}=t[e];_(A(h,o),i&&A(h,i),(t,o)=>{r(n?n=>{const o=n.slice();return o[e]=t,o}:t),o&&g(e=>Object.assign({},e,o))})}},[]);return(0,u.jsxs)(T,{style:i,children:[(0,u.jsx)(e,{data:t,mapStyle:s||E.Vi.BLANK,params:d,useParam:f,onStateChange:m}),n&&(0,u.jsx)(P,{title:e.title,params:d,meta:p,updateParam:(e,t)=>{const n=d[e];n&&c(Object.assign({},d,{[e]:j(Object.assign({},n,{value:t}))}))},sourceLink:e.code,children:e.renderInfo(p)}),n&&s&&(0,u.jsx)(F,{children:"Hold down shift to rotate"})]})}}var L=n(40);const O=i.Ay.div.withConfig({displayName:"styled__ExampleHeader",componentId:"sc-1dgi8sb-0"})(["font:bold 20px/28px var(--ifm-font-family-base);color:var(--ifm-color-content-secondary);margin:0 20px;border-bottom:1px solid 20px;display:inline-block;padding:20px 20px 4px 0;"]),H=i.Ay.main.withConfig({displayName:"styled__MainExamples",componentId:"sc-1dgi8sb-1"})(["padding:16px 0;"]),R=i.Ay.main.withConfig({displayName:"styled__ExamplesGroup",componentId:"sc-1dgi8sb-2"})(["display:flex;flex-wrap:wrap;padding:16px;"]),z=i.Ay.a.withConfig({displayName:"styled__ExampleCard",componentId:"sc-1dgi8sb-3"})(["cursor:pointer;text-decoration:none;width:50%;max-width:240px;line-height:0;outline:none;padding:4px;position:relative;img{transition-property:filter;transition-duration:var(--ifm-transition-slow);transition-timing-function:var(--ifm-transition-timing-default);}&:hover{box-shadow:var(--ifm-global-shadow-md);}&:hover img{filter:contrast(0.2);}","{width:33%;min-width:200px;}@media screen and (max-width:632px){width:50%;}"],r),N=i.Ay.div.withConfig({displayName:"styled__ExampleTitle",componentId:"sc-1dgi8sb-4"})(["position:absolute;display:flex;justify-content:center;flex-direction:column;color:var(--ifm-color-white);font-size:1.5em;text-align:center;line-height:initial;width:90%;height:90%;top:5%;left:5%;border:solid 1px var(--ifm-color-white);opacity:0;transition-property:opacity;transition-duration:var(--ifm-transition-slow);transition-timing-function:var(--ifm-transition-timing-default);&:hover{opacity:1;}"]);function q(e,t){let{label:n,items:o}=e;return[(0,u.jsx)(O,{children:n},n+"-header"),(0,u.jsx)(R,{children:o.map(e=>function(e,t){const n=(0,I.Ay)(t(e)),{label:o,href:i}=e;return(0,u.jsxs)(z,{href:i,children:[(0,u.jsx)("img",{width:"100%",src:n,alt:o}),(0,u.jsx)(N,{children:(0,u.jsx)("span",{children:o})})]},o)}(e,t))},n)]}function G(e){let{getThumbnail:t}=e;const n=(0,L.t)();return(0,u.jsx)(H,{children:n.items.map(e=>"category"===e.type?q(e,t):null)})}var U=n(7639);const W=i.Ay.section.withConfig({displayName:"styled__Banner",componentId:"sc-exnbu5-0"})(["position:relative;height:30rem;background:var(--ifm-color-gray-400);color:var(--ifm-color-gray-900);z-index:0;","{height:80vh;}"],r),B=i.Ay.div.withConfig({displayName:"styled__Container",componentId:"sc-exnbu5-1"})(["position:relative;padding:2rem;max-width:80rem;width:100%;height:100%;margin:0;"]),X=(0,i.Ay)(B).withConfig({displayName:"styled__BannerContainer",componentId:"sc-exnbu5-2"})(["position:absolute;bottom:0;height:auto;padding-left:4rem;z-index:0;pointer-events:none;"]),$=i.Ay.div.withConfig({displayName:"styled__HeroExampleContainer",componentId:"sc-exnbu5-3"})(["position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;"]),Y=(i.Ay.section.withConfig({displayName:"styled__Section",componentId:"sc-exnbu5-4"})(["&:nth-child(2n + 1){background:var(--ifm-color-gray-300);}"]),i.Ay.h1.withConfig({displayName:"styled__ProjectName",componentId:"sc-exnbu5-5"})(["font-size:5em;line-height:1;text-transform:uppercase;letter-spacing:4px;font-weight:700;margin:0;margin-bottom:16px;"])),V=i.Ay.a.withConfig({displayName:"styled__GetStartedLink",componentId:"sc-exnbu5-6"})(["pointer-events:all;font-size:12px;line-height:44px;letter-spacing:2px;font-weight:bold;margin:24px 0;padding:0 4rem;pointer-events:all;display:inline-block;text-decoration:none;transition:background-color 250ms ease-in,color 250ms ease-in;border:solid 2px var(--ifm-color-primary);color:var(--ifm-color-gray-900);border-image:linear-gradient( to right,var(--ifm-color-gray-700) 0%,var(--ifm-color-gray-400) 100% );border-image-slice:2;&:visited{color:var(--ifm-color-gray-900);}&:active{color:var(--ifm-color-white);}&:hover{color:var(--ifm-color-white);background-color:var(--ifm-color-primary);}"]);function J(e){let{HeroExample:t,children:n}=e;const{siteConfig:o}=(0,U.A)();return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(W,{children:[(0,u.jsx)($,{children:t&&(0,u.jsx)(t,{})}),(0,u.jsxs)(X,{children:[(0,u.jsx)(Y,{children:o.title}),(0,u.jsx)("p",{children:o.tagline}),(0,u.jsx)(V,{href:"./docs",children:"GET STARTED"})]})]}),n]})}},4653:(e,t,n)=>{"use strict";n.d(t,{H2:()=>Ue,Jt:()=>Re,O5:()=>Te,Zy:()=>Ie,UP:()=>De,hP:()=>He,DS:()=>be,i_:()=>me,G2:()=>qe,cR:()=>ve,E6:()=>Ae,hh:()=>Se,UD:()=>Oe,OH:()=>Me,Vv:()=>_e,ls:()=>le,Tp:()=>ht,IM:()=>It,l$:()=>fe,X5:()=>Ft,fb:()=>ge,Dx:()=>zt,vX:()=>Ht,L6:()=>Lt,uq:()=>te,C$:()=>Tt,Dr:()=>ae,Sn:()=>d,GN:()=>re,cW:()=>jt,UX:()=>Ge,m0:()=>ue,_C:()=>We,O1:()=>ee,nE:()=>Y});var o=n(3279),i=n(5917),r=n(1234),s=n(6599),a=n(365),l=n(669);const d={NONE:null,RECTANGLE:"rectangle",POLYGON:"polygon"};var c=n(228);n(4526);c.EventEmitter;var p=n(6558),u=n(7604),g=n(7885),h=n(7531);var f=n(9452),m=n(8095);class y extends f.A{renderLayers(){const{id:e,getFillColor:t,getStrokeColor:n,getInnerRadius:o,updateTriggers:i}=this.props;return[new m.A(Object.assign({},this.props,{id:e+"-full",data:this.props.data,getLineColor:n,updateTriggers:Object.assign({},i,{getStrokeColor:i.getStrokeColor})})),new m.A(Object.assign({},this.props,{id:e+"-inner",data:this.props.data,getFillColor:t,getRadius:o,pickable:!1,updateTriggers:Object.assign({},i,{getFillColor:i.getFillColor,getRadius:i.getInnerRadius})}))]}}y.layerName="JunctionScatterplotLayer",y.defaultProps=Object.assign({},m.A.defaultProps,{getFillColor:e=>[0,0,0,255],getStrokeColor:e=>[255,255,255,255],getInnerRadius:e=>1});var x=n(1388);n(6467);var b=n(8894),v=n(3178),C=n(4657),P=n(5475),w=n(8364),S=n(9987),k=n(5046);function _(e,t,n){if(!Array.isArray(e[0]))return!0;for(let o=0;o<e.length;o++)if(_(e[o],[...t,o],n)){n(e,t);break}return!1}function A(e,t,n){const i={type:"LineString",coordinates:[e,t]},r=(0,o.zx)(n),s=(0,g.A)(r,i),a=(0,u.A)(e,t),l=(n[0]-e[0])*(t[1]-e[1])-(n[1]-e[1])*(t[0]-e[0])<0?a-90:a-270,d=(0,p.A)(t,s,l),c=(0,p.A)(e,s,l);return[d.geometry.coordinates,c.geometry.coordinates]}function M(e,t,n,o){const i=e-n,r=t-o;return Math.sqrt(i*i+r*r)}function j(e,t,n){const o=new h.KH(n),i=e.geometry.coordinates.map(e=>{let[t,n,i=0]=e;return o.project([t,n,i])}),[r,s]=o.project(t.geometry.coordinates);let a=1/0,l={};i.forEach((e,t)=>{let[n,o]=e;if(0===t)return;const[d,c]=i[t-1],p=c-o,u=n-d,g=d*o-n*c,h=p*p+u*u,f=Math.abs(p*r+u*s+g)/Math.sqrt(h);f<a&&(a=f,l={index:t,x0:(u*(u*r-p*s)-p*g)/h,y0:(p*(-u*r+p*s)-u*g)/h})});const{index:d,x0:c,y0:p}=l,[u,g,f=0]=i[d-1],[m,y,x=0]=i[d],b=M(u,g,m,y),v=function(e,t,n){return t*n+e*(1-n)}(f,x,M(u,g,c,p)/b);return{type:"Feature",geometry:{type:"Point",coordinates:o.unproject([c,p,v])},properties:{dist:a,index:d-1}}}function E(e){const t=F(e);return t.length?t[0]:null}function I(e){return F(e).find(e=>{let{properties:t}=e;return t.featureIndex>=0&&"existing"===t.editHandleType})}function T(e){return F(e).find(e=>{let{properties:t}=e;return t.featureIndex>=0&&"intermediate"===t.editHandleType})}function F(e){return e&&e.filter(e=>e.isGuide&&"editHandle"===e.object.properties.guideType).map(e=>e.object)||[]}function D(e,t,n){void 0===n&&(n="existing");let o=[];switch(e.type){case"Point":o=[{type:"Feature",properties:{guideType:"editHandle",editHandleType:n,positionIndexes:[],featureIndex:t},geometry:{type:"Point",coordinates:e.coordinates}}];break;case"MultiPoint":case"LineString":o=o.concat(L(e.coordinates,[],t,n));break;case"Polygon":case"MultiLineString":for(let i=0;i<e.coordinates.length;i++)o=o.concat(L(e.coordinates[i],[i],t,n)),"Polygon"===e.type&&(o=o.slice(0,-1));break;case"MultiPolygon":for(let i=0;i<e.coordinates.length;i++)for(let r=0;r<e.coordinates[i].length;r++)o=o.concat(L(e.coordinates[i][r],[i,r],t,n)),o=o.slice(0,-1);break;default:throw Error("Unhandled geometry type: "+e.type)}return o}function L(e,t,n,o){void 0===o&&(o="existing");const i=[];for(let r=0;r<e.length;r++){const s=e[r];i.push({type:"Feature",properties:{guideType:"editHandle",positionIndexes:[...t,r],featureIndex:n,editHandleType:o},geometry:{type:"Point",coordinates:s}})}return i}function O(e,t){return"number"==typeof e[0]?!isNaN(e[0])&&isFinite(e[0])?t(e):e:e.map(e=>O(e,t)).filter(Boolean)}function H(e){return e.picks.length&&e.picks.find(e=>"points"===e.featureType)}class R{constructor(e){this.featureCollection=e}getObject(){return this.featureCollection}replacePosition(e,t,n){const o=this.featureCollection.features[e].geometry,i="Polygon"===o.type||"MultiPolygon"===o.type,r=Object.assign({},o,{coordinates:N(o.coordinates,t,n,i)});return this.replaceGeometry(e,r)}removePosition(e,t){const n=this.featureCollection.features[e].geometry;if("Point"===n.type)throw Error("Can't remove a position from a Point or there'd be nothing left");if("MultiPoint"===n.type&&n.coordinates.length<2)throw Error("Can't remove the last point of a MultiPoint or there'd be nothing left");if("LineString"===n.type&&n.coordinates.length<3)throw Error("Can't remove position. LineString must have at least two positions");if("Polygon"===n.type&&n.coordinates[0].length<5&&Array.isArray(t)&&0===t[0])throw Error("Can't remove position. Polygon's outer ring must have at least four positions");if("MultiLineString"===n.type&&1===n.coordinates.length&&n.coordinates[0].length<3)throw Error("Can't remove position. MultiLineString must have at least two positions");if("MultiPolygon"===n.type&&1===n.coordinates.length&&n.coordinates[0][0].length<5&&Array.isArray(t)&&0===t[0]&&0===t[1])throw Error("Can't remove position. MultiPolygon's outer ring must have at least four positions");const o="Polygon"===n.type||"MultiPolygon"===n.type,i=Object.assign({},n,{coordinates:q(n.coordinates,t,o)});return function(e){switch(e.type){case"Polygon":!function(e){const t=e.coordinates;for(let n=1;n<t.length;n++)U(t,n)&&n--}(e);break;case"MultiLineString":!function(e){for(let t=0;t<e.coordinates.length;t++){1===e.coordinates[t].length&&(e.coordinates.splice(t,1),t--)}}(e);break;case"MultiPolygon":!function(e){for(let t=0;t<e.coordinates.length;t++){const n=e.coordinates[t];n[0].length<=3&&(e.coordinates.splice(t,1),t--);for(let e=1;e<n.length;e++)U(n,e)&&e--}}(e)}}(i),this.replaceGeometry(e,i)}addPosition(e,t,n){const o=this.featureCollection.features[e].geometry;if("Point"===o.type)throw new Error("Unable to add a position to a Point feature");const i="Polygon"===o.type||"MultiPolygon"===o.type,r=Object.assign({},o,{coordinates:G(o.coordinates,t,n,i)});return this.replaceGeometry(e,r)}replaceGeometry(e,t){const n=Object.assign({},this.featureCollection.features[e],{geometry:t}),o=Object.assign({},this.featureCollection,{features:[...this.featureCollection.features.slice(0,e),n,...this.featureCollection.features.slice(e+1)]});return new R(o)}addFeature(e){return this.addFeatures([e])}addFeatures(e){const t=Object.assign({},this.featureCollection,{features:[...this.featureCollection.features,...e]});return new R(t)}deleteFeature(e){return this.deleteFeatures([e])}deleteFeatures(e){const t=[...this.featureCollection.features];e.sort();for(let o=e.length-1;o>=0;o--){const n=e[o];n>=0&&n<t.length&&t.splice(n,1)}const n=Object.assign({},this.featureCollection,{features:t});return new R(n)}}function z(e,t){if(2===e.length&&3===t.length){const n=t[2];return[e[0],e[1],n]}return e}function N(e,t,n,o){if(!t)return e;if(0===t.length)return z(n,e);if(1===t.length){const i=[...e.slice(0,t[0]),z(n,e[t[0]]),...e.slice(t[0]+1)];return!o||0!==t[0]&&t[0]!==e.length-1||(i[0]=z(n,e[0]),i[e.length-1]=z(n,e[0])),i}return[...e.slice(0,t[0]),N(e[t[0]],t.slice(1,t.length),n,o),...e.slice(t[0]+1)]}function q(e,t,n){if(!t)return e;if(0===t.length)throw Error("Must specify the index of the position to remove");if(1===t.length){const o=[...e.slice(0,t[0]),...e.slice(t[0]+1)];return!n||0!==t[0]&&t[0]!==e.length-1||(0===t[0]?o[o.length-1]=o[0]:t[0]===e.length-1&&(o[0]=o[o.length-1])),o}return[...e.slice(0,t[0]),q(e[t[0]],t.slice(1,t.length),n),...e.slice(t[0]+1)]}function G(e,t,n,o){if(!t)return e;if(0===t.length)throw Error("Must specify the index of the position to remove");if(1===t.length){return[...e.slice(0,t[0]),n,...e.slice(t[0])]}return[...e.slice(0,t[0]),G(e[t[0]],t.slice(1,t.length),n,o),...e.slice(t[0]+1)]}function U(e,t){return e[t].length<=3&&(e.splice(t,1),!0)}const W={type:"FeatureCollection",features:[]},B=[];class X{constructor(){this._clickSequence=[]}getGuides(e){return W}getTooltips(e){return B}getSelectedFeature(e){return 1===e.selectedIndexes.length?e.data.features[e.selectedIndexes[0]]:null}getSelectedGeometry(e){const t=this.getSelectedFeature(e);return t?t.geometry:null}getSelectedFeaturesAsFeatureCollection(e){const{features:t}=e.data;return{type:"FeatureCollection",features:e.selectedIndexes.map(e=>t[e])}}getClickSequence(){return this._clickSequence}addClickSequence(e){let{mapCoords:t}=e;this._clickSequence.push(t)}resetClickSequence(){this._clickSequence=[]}getTentativeGuide(e){return this.getGuides(e).features.find(e=>e.properties&&"tentative"===e.properties.guideType)}isSelectionPicked(e,t){if(!e.length)return!1;const n=function(e){return e&&e.filter(e=>!e.isGuide)}(e).map(e=>{let{index:t}=e;return t}),o=F(e).map(e=>{let{properties:t}=e;return t.featureIndex}),i=new Set([...n,...o]);return t.selectedIndexes.some(e=>i.has(e))}rewindPolygon(e){const{geometry:t}=e;return"Polygon"===t.type||"MultiPolygon"===t.type?(0,w.A)(e):e}getAddFeatureAction(e,t,n){const o=e;n=n||{};const i="Feature"===o.type?o:{type:"Feature",properties:n,geometry:o},r=this.rewindPolygon(i),s=new R(t).addFeature(r).getObject();return{updatedData:s,editType:"addFeature",editContext:{featureIndexes:[s.features.length-1]}}}getAddManyFeaturesAction(e,t){let{features:n}=e,o=new R(t);const i=o.getObject().features.length,r=[];for(const s of n){const{properties:e,geometry:t}=s,n=t;o=o.addFeature({type:"Feature",properties:e,geometry:n}),r.push(i+r.length)}return{updatedData:o.getObject(),editType:"addFeature",editContext:{featureIndexes:r}}}getAddFeatureOrBooleanPolygonAction(e,t,n){const o=e;n=n||{};const i=this.getSelectedFeature(t),{modeConfig:r}=t;if(r&&r.booleanOperation){if(!i||"Polygon"!==i.geometry.type&&"MultiPolygon"!==i.geometry.type)return console.warn("booleanOperation only supported for single Polygon or MultiPolygon selection"),null;const e="Feature"===o.type?o:{type:"Feature",geometry:o};let n;if("union"===r.booleanOperation)n=(0,C.A)(i,e);else if("difference"===r.booleanOperation)n=(0,a.A)(i,e);else{if("intersection"!==r.booleanOperation)return console.warn("Invalid booleanOperation "+r.booleanOperation),null;n=(0,P.A)(i,e)}if(!n)return console.warn("Canceling edit. Boolean operation erased entire polygon."),null;const s=t.selectedIndexes[0];return{updatedData:new R(t.data).replaceGeometry(s,n.geometry).getObject(),editType:"unionGeometry",editContext:{featureIndexes:[s]}}}return this.getAddFeatureAction(e,t.data,n)}createTentativeFeature(e){return null}handleClick(e,t){}handlePointerMove(e,t){const n=this.createTentativeFeature(t);n&&t.onEdit({updatedData:t.data,editType:"updateTentativeFeature",editContext:{feature:n}})}handleStartDragging(e,t){}handleStopDragging(e,t){}handleDragging(e,t){}handleKeyUp(e,t){"Escape"===e.key&&(this.resetClickSequence(),t.onEdit({updatedData:t.data,editType:"cancelFeature",editContext:{}}))}}function $(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}class Y extends X{}var V=n(7083),J=n(5903),K=n(7743),Z=n(8664),Q=n(7861);class ee extends X{constructor(){super(...arguments),this._isTranslatable=void 0}handleDragging(e,t){if(this._isTranslatable){if(this._geometryBeforeTranslate){const n=this.getTranslateAction(e.pointerDownMapCoords,e.mapCoords,"translating",t);n&&t.onEdit(n)}e.cancelPan()}}handlePointerMove(e,t){this._isTranslatable=this.isSelectionPicked(e.pointerDownPicks||e.picks,t),this.updateCursor(t)}handleStartDragging(e,t){this._isTranslatable&&(e.cancelPan(),this._geometryBeforeTranslate=this.getSelectedFeaturesAsFeatureCollection(t))}handleStopDragging(e,t){if(this._geometryBeforeTranslate){const n=this.getTranslateAction(e.pointerDownMapCoords,e.mapCoords,"translated",t);n&&t.onEdit(n),this._geometryBeforeTranslate=null}}updateCursor(e){this._isTranslatable?e.onUpdateCursor("move"):e.onUpdateCursor(null)}getTranslateAction(e,t,n,i){if(!this._geometryBeforeTranslate)return null;let r=new R(i.data);const s=i.selectedIndexes,{viewport:a,screenSpace:d}=i.modeConfig||{};if(a&&d){const n=a.project?a:new h.KH(a),o=n.project(e),i=n.project(t),l=i[0]-o[0],d=i[1]-o[1];for(let e=0;e<s.length;e++){const t=s[e],o=this._geometryBeforeTranslate.features[e];let i=o.geometry.coordinates;i&&(i=O(i,e=>{const t=n.project(e);return t?(t[0]+=l,t[1]+=d,n.unproject(t)):null}),r=r.replaceGeometry(t,{type:o.geometry.type,coordinates:i}))}}else{const n=(0,o.zx)(e),i=(0,o.zx)(t),a=(0,l.A)(n,i),d=(0,u.A)(n,i),c=this._geometryBeforeTranslate.features.map(e=>function(e,t,n){const o=(0,J.A)(e),i=(0,Q.A)(o,t,n),r=O(e.geometry.coordinates,e=>{const t=(0,Z.A)(o.geometry.coordinates,e),n=(0,K.A)(o.geometry.coordinates,e);return(0,Q.A)(i.geometry.coordinates,t,n).geometry.coordinates});return e.geometry.coordinates=r,e}((0,V.A)(e),a,d));for(let e=0;e<s.length;e++){const t=s[e],n=c[e];r=r.replaceGeometry(t,n.geometry)}}return{updatedData:r.getObject(),editType:n,editContext:{featureIndexes:s}}}}class te extends X{getGuides(e){const t=[],{data:n,lastPointerMoveEvent:i}=e,{features:r}=n,s=i&&i.picks,a=i&&i.mapCoords;for(const o of e.selectedIndexes)if(o<r.length){const{geometry:e}=r[o];t.push(...D(e,o))}else console.warn("selectedFeatureIndexes out of range "+o);if(s&&s.length&&a){var l;const n=!I(s)&&s.find(e=>!e.isGuide);if(n&&!n.object.geometry.type.includes("Point")&&(null==(l=e.modeConfig)||!l.lockRectangles||"Rectangle"!==n.object.properties.shape)&&e.selectedIndexes.includes(n.index)){let i=null,r=[];const s=(0,o.zx)(a);if(_(n.object.geometry.coordinates,[],(t,n)=>{const a=(0,o.wi)(t),l=this.getNearestPoint(a,s,e.modeConfig&&e.modeConfig.viewport);(!i||l.properties.dist<i.properties.dist)&&(i=l,r=n)}),i){const{geometry:{coordinates:e},properties:{index:o}}=i;t.push({type:"Feature",properties:{guideType:"editHandle",editHandleType:"intermediate",featureIndex:n.index,positionIndexes:[...r,o+1]},geometry:{type:"Point",coordinates:e}})}}}return{type:"FeatureCollection",features:t}}getNearestPoint(e,t,n){const{coordinates:i}=e.geometry;if(i.some(e=>e.length>2)){if(n)return j(e,t,n);console.log("Editing 3D point but modeConfig.viewport not provided. Falling back to 2D logic.")}return function(e,t,n){var i,r;let s;n&&(s=new h.KH(n));let a=(0,o.zx)([1/0,1/0],{dist:1/0});return null==(i=e.geometry)||!i.coordinates.length||(null==(r=e.geometry)?void 0:r.coordinates.length)<2||(0,S.iw)(e,e=>{const n=(0,k.$R)(e),i=(0,k.$R)(t);let r,l,d,c,p,u,g;if(n.length>1&&i.length){let e,t;s?(e=n.map(e=>s.project(e)),t=s.project(i)):(e=n,t=i);for(let n=1;n<e.length;n++){if(e[n][0]!==e[n-1][0]){const o=(e[n][1]-e[n-1][1])/(e[n][0]-e[n-1][0]),i=e[n][1]-o*e[n][0];g=Math.abs(o*t[0]+i-t[1])/Math.sqrt(o*o+1)}else g=Math.abs(t[0]-e[n][0]);const o=Math.pow(e[n][1]-e[n-1][1],2)+Math.pow(e[n][0]-e[n-1][0],2),i=Math.pow(e[n][1]-t[1],2)+Math.pow(e[n][0]-t[0],2),s=Math.pow(e[n-1][1]-t[1],2)+Math.pow(e[n-1][0]-t[0],2),a=Math.pow(g,2),c=i-a+s-a;c>o&&(g=Math.sqrt(Math.min(i,s))),(null==r||r>g)&&(c>o?s<i?(l=0,d=1):(d=0,l=1):(l=Math.sqrt(s-a)/Math.sqrt(o),d=Math.sqrt(i-a)/Math.sqrt(o)),r=g,u=n)}const o=e[u-1][0]-e[u][0],a=e[u-1][1]-e[u][1];c=e[u-1][0]-o*l,p=e[u-1][1]-a*l}let h={x:c,y:p,idx:u-1,to:l,from:d};if(s){const e=s.unproject([h.x,h.y]);h={x:e[0],y:e[1],idx:u-1,to:l,from:d}}a=(0,o.zx)([h.x,h.y],{dist:Math.abs(h.from-h.to),index:h.idx})}),a}(e,t,n)}handleClick(e,t){const n=I(e.picks),o=T(e.picks);if(n){const{featureIndex:e,positionIndexes:o}=n.properties;let i;try{i=new R(t.data).removePosition(e,o).getObject()}catch(r){}i&&t.onEdit({updatedData:i,editType:"removePosition",editContext:{featureIndexes:[e],positionIndexes:o,position:n.geometry.coordinates}})}else if(o){var i;const{featureIndex:e,positionIndexes:n}=o.properties,r=t.data.features[e];if(!(null!=(i=t.modeConfig)&&i.lockRectangles&&"Rectangle"===(null==r?void 0:r.properties.shape))){const i=new R(t.data).addPosition(e,n,o.geometry.coordinates).getObject();i&&t.onEdit({updatedData:i,editType:"addPosition",editContext:{featureIndexes:[e],positionIndexes:n,position:o.geometry.coordinates}})}}}handleDragging(e,t){const n=E(e.pointerDownPicks);n&&(e.cancelPan(),this._dragEditHandle("movePosition",t,n,e))}_dragEditHandle(e,t,n,o){var i;const r=n.properties,s=t.data.features[r.featureIndex];let a;if(null!=(i=t.modeConfig)&&i.lockRectangles&&"Rectangle"===s.properties.shape){const e=function(e,t,n){const o=e.geometry.coordinates;if(!o)return null;const i=o[0].slice(0,4);i[t%4]=n;const r=i[(t+2)%4],s=i[t%4];return i[(t+1)%4]=[s[0],r[1]],i[(t+3)%4]=[r[0],s[1]],[[...i,i[0]]]}(s,r.positionIndexes[1],o.mapCoords);a=new R(t.data).replaceGeometry(r.featureIndex,{coordinates:e,type:"Polygon"}).getObject()}else a=new R(t.data).replacePosition(r.featureIndex,r.positionIndexes,o.mapCoords).getObject();t.onEdit({updatedData:a,editType:e,editContext:{featureIndexes:[r.featureIndex],positionIndexes:r.positionIndexes,position:o.mapCoords}})}handlePointerMove(e,t){const n=this.getCursor(e);t.onUpdateCursor(n)}handleStartDragging(e,t){H(e)&&e.cancelPan();const n=t.selectedIndexes,o=T(e.picks);if(n.length&&o){const n=o.properties,i=new R(t.data).addPosition(n.featureIndex,n.positionIndexes,e.mapCoords).getObject();t.onEdit({updatedData:i,editType:"addPosition",editContext:{featureIndexes:[n.featureIndex],positionIndexes:n.positionIndexes,position:e.mapCoords}})}}handleStopDragging(e,t){const n=t.selectedIndexes,o=E(e.picks);n.length&&o&&this._dragEditHandle("finishMovePosition",t,o,e)}getCursor(e){return F(e&&e.picks||[]).length?"cell":null}}var ne=n(7450),oe=n(5875),ie=n(1349);class re extends X{constructor(){super(...arguments),this._cornerGuidePoints=[],this._isScaling=!1,this._isSinglePointGeometrySelected=e=>{const{features:t}=e||{};if(Array.isArray(t)&&1===t.length){const{type:e}=(0,k.bg)(t[0]);return"Point"===e}return!1},this._getOppositeScaleHandle=e=>{const t=e&&e.properties&&Array.isArray(e.properties.positionIndexes)&&e.properties.positionIndexes[0];if("number"!=typeof t)return null;const n=this._cornerGuidePoints.length,o=(t+n/2)%n;return this._cornerGuidePoints.find(e=>!!Array.isArray(e.properties.positionIndexes)&&e.properties.positionIndexes[0]===o)||null},this._getUpdatedData=(e,t)=>{let n=new R(e.data);const o=e.selectedIndexes;for(let i=0;i<o.length;i++){const e=o[i],r=t.features[i];n=n.replaceGeometry(e,r.geometry)}return n.getObject()},this.isEditHandleSelected=()=>Boolean(this._selectedEditHandle),this.getScaleAction=(e,t,n,o)=>{if(!this._selectedEditHandle)return null;const i=this._getOppositeScaleHandle(this._selectedEditHandle),r=(0,k.uG)(i),s=function(e,t,n){const o=(0,l.A)(e,t),i=(0,l.A)(e,n);return i/o}(r,e,t),a=(0,ie.A)(this._geometryBeingScaled,s,{origin:r});return{updatedData:this._getUpdatedData(o,a),editType:n,editContext:{featureIndexes:o.selectedIndexes}}},this.updateCursor=e=>{if(this._selectedEditHandle){this._cursor&&e.onUpdateCursor(this._cursor);const t=this.getSelectedFeaturesAsFeatureCollection(e),n=(0,ne.A)(t),o=(0,u.A)(n,this._selectedEditHandle),i=o<0?o+180:o;i>=0&&i<=90||i>=180&&i<=270?(this._cursor="nesw-resize",e.onUpdateCursor("nesw-resize")):(this._cursor="nwse-resize",e.onUpdateCursor("nwse-resize"))}else e.onUpdateCursor(null),this._cursor=null}}handlePointerMove(e,t){if(!this._isScaling){const n=E(e.picks);this._selectedEditHandle=n&&"scale"===n.properties.editHandleType?n:null,this.updateCursor(t)}}handleStartDragging(e,t){this._selectedEditHandle&&(e.cancelPan(),this._isScaling=!0,this._geometryBeingScaled=this.getSelectedFeaturesAsFeatureCollection(t))}handleDragging(e,t){if(!this._isScaling)return;t.onUpdateCursor(this._cursor);const n=this.getScaleAction(e.pointerDownMapCoords,e.mapCoords,"scaling",t);n&&t.onEdit(n),e.cancelPan()}handleStopDragging(e,t){if(this._isScaling){const n=this.getScaleAction(e.pointerDownMapCoords,e.mapCoords,"scaled",t);n&&t.onEdit(n),t.onUpdateCursor(null),this._geometryBeingScaled=null,this._selectedEditHandle=null,this._cursor=null,this._isScaling=!1}}getGuides(e){this._cornerGuidePoints=[];const t=this.getSelectedFeaturesAsFeatureCollection(e);if(this._isSinglePointGeometrySelected(t))return{type:"FeatureCollection",features:[]};const n=(0,r.A)((0,i.A)(t));n.properties.mode="scale";const s=[];return(0,S.Fh)(n,(e,t)=>{if(t<4){const n=(0,o.zx)(e,{guideType:"editHandle",editHandleType:"scale",positionIndexes:[t]});s.push(n)}}),this._cornerGuidePoints=s,(0,o.Lr)([(0,oe.CN)(n),...this._cornerGuidePoints])}}var se=n(5486);class ae extends X{constructor(){super(...arguments),this._isRotating=!1,this._isSinglePointGeometrySelected=e=>{const{features:t}=e||{};if(Array.isArray(t)&&1===t.length){const{type:e}=(0,k.bg)(t[0]);return"Point"===e}return!1},this.getIsRotating=()=>this._isRotating}getGuides(e){const t=this._geometryBeingRotated||this.getSelectedFeaturesAsFeatureCollection(e);if(this._isSinglePointGeometrySelected(t))return{type:"FeatureCollection",features:[]};if(this._isRotating)return(0,o.Lr)([(0,ne.A)(t)]);const n=(0,r.A)((0,i.A)(t));let s=null,a=null,d=0;(0,S.Fh)(n,e=>{if(s){const t=$(e,s);(!a||t[1]>a[1])&&(a=t);const n=(0,l.A)(e,s);d=Math.max(d,n)}s=e});const c=a&&[a[0],a[1]+d/1e3],p=(0,o.wi)([a,c]),u=(0,o.zx)(c,{guideType:"editHandle",editHandleType:"rotate"}),g=[(0,oe.CN)(n),u,p];return(0,o.Lr)(g)}handleDragging(e,t){if(!this._isRotating)return;const n=this.getRotateAction(e.pointerDownMapCoords,e.mapCoords,"rotating",t);n&&t.onEdit(n),e.cancelPan()}handlePointerMove(e,t){if(!this._isRotating){const t=E(e.picks);this._selectedEditHandle=t&&"rotate"===t.properties.editHandleType?t:null}this.updateCursor(t)}handleStartDragging(e,t){this._selectedEditHandle&&(e.cancelPan(),this._isRotating=!0,this._geometryBeingRotated=this.getSelectedFeaturesAsFeatureCollection(t))}handleStopDragging(e,t){if(this._isRotating){const n=this.getRotateAction(e.pointerDownMapCoords,e.mapCoords,"rotated",t);n&&t.onEdit(n),this._geometryBeingRotated=null,this._selectedEditHandle=null,this._isRotating=!1}}updateCursor(e){this._selectedEditHandle?e.onUpdateCursor("crosshair"):e.onUpdateCursor(null)}getRotateAction(e,t,n,o){if(!this._geometryBeingRotated)return null;const i=(0,ne.A)(this._geometryBeingRotated),r=function(e,t,n){const o=(0,u.A)(e,t),i=(0,u.A)(e,n);return i-o}(i,e,t),s=(0,se.A)(this._geometryBeingRotated,r,{pivot:i});let a=new R(o.data);const l=o.selectedIndexes;for(let d=0;d<l.length;d++){const e=l[d],t=s.features[d];a=a.replaceGeometry(e,t.geometry)}return{updatedData:a.getObject(),editType:n,editContext:{featureIndexes:l}}}}class le extends ee{handleStartDragging(e,t){super.handleStartDragging(e,t),this._geometryBeforeTranslate&&t.onEdit(this.getAddManyFeaturesAction(this._geometryBeforeTranslate,t.data))}updateCursor(e){this._isTranslatable?e.onUpdateCursor("copy"):e.onUpdateCursor(null)}}var de=n(2608),ce=n(5085),pe=n(7028);class ue extends X{calculateMapCoords(e,t,n){const i=n.modeConfig;if(!i||!i.lock90Degree||!e.length)return t;if(1===e.length){const o=e[0],i=this.getSelectedGeometry(n),r=(0,oe.Ay)(i),s="FeatureCollection"===r.type?r.features:[r];let a=Number.MAX_SAFE_INTEGER,d=null;if(s.forEach(e=>{const t=(0,pe.A)(e,o),n=(0,l.A)(t,o);a>n&&(a=n,d=t)}),d){const e=(0,u.A)(o,d),n=(0,l.A)(o,t,{units:"meters"});return(0,p.A)(o,n,e,{units:"meters"}).geometry.coordinates}return t}const r=e[e.length-1],[s]=A(e[e.length-2],r,t);return(0,pe.A)((0,o.wi)([r,s]),t).geometry.coordinates}getGuides(e){const t=this.getClickSequence(),n={type:"FeatureCollection",features:[]};if(0===t.length||!e.lastPointerMoveEvent)return n;const{mapCoords:o}=e.lastPointerMoveEvent;return n.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[...t,this.calculateMapCoords(t,o,e)]}}),n}handleClick(e,t){const n=this.getTentativeGuide(t),o=this.getSelectedGeometry(t);if(!o)return void console.warn("A polygon must be selected for splitting");const i=this.getClickSequence();n&&"LineString"===n.geometry.type?i.push(n.geometry.coordinates[n.geometry.coordinates.length-1]):this.addClickSequence(e);const r={type:"Point",coordinates:i[i.length-1]},s=(0,de.A)(r,o);if(i.length>1&&n&&!s){this.resetClickSequence();if(0===(0,ce.A)(n,o).features.length)return;const e=this.splitPolygon(n,t);e&&t.onEdit(e)}}handlePointerMove(e,t){t.onUpdateCursor("cell")}splitPolygon(e,t){const n=this.getSelectedGeometry(t),o=t.selectedIndexes[0],i=t.modeConfig||{};let{gap:r=.1,units:l="centimeters"}=i;0===r&&(r=.1,l="centimeters");const d=(0,s.A)(e,r,{units:l}),c=(0,a.A)(n,d);if(!c)return console.warn("Canceling edit. Split Polygon erased"),null;const{type:p,coordinates:u}=c.geometry;let g=[];g="Polygon"===p?u.map(e=>[e]):u.reduce((e,t)=>(t.forEach(t=>{e.push([t])}),e),[]);return{updatedData:new R(t.data).replaceGeometry(o,{type:"MultiPolygon",coordinates:g}).getObject(),editType:"split",editContext:{featureIndexes:[o]}}}}class ge extends te{constructor(){super(...arguments),this.isPointAdded=!1}handleDragging(e,t){const n=E(e.pointerDownPicks);if(n){const{featureIndex:o}=n.properties;let{positionIndexes:i}=n.properties;const r=this.coordinatesSize(i,o,t.data);i=this.isPointAdded?this.nextPositionIndexes(i,r):i;const s=this.getPointForPositionIndexes(this.prevPositionIndexes(i,r),o,t.data),a=this.getPointForPositionIndexes(i,o,t.data);if(s&&a){const[n,l]=A(s,a,e.mapCoords),d=new R(t.data).replacePosition(o,this.prevPositionIndexes(i,r),l).replacePosition(o,i,n).getObject();t.onEdit({updatedData:d,editType:"extruding",editContext:{featureIndexes:[o],positionIndexes:this.nextPositionIndexes(i,r),position:n}}),e.cancelPan()}}}handleStartDragging(e,t){H(e)&&e.cancelPan();const n=t.selectedIndexes,o=T(e.picks);if(n.length&&o){const{positionIndexes:e,featureIndex:n}=o.properties,i=this.coordinatesSize(e,n,t.data),r=this.getPointForPositionIndexes(this.prevPositionIndexes(e,i),n,t.data),s=this.getPointForPositionIndexes(e,n,t.data);if(r&&s){let o=new R(t.data);this.isOrthogonal(e,n,i,t.data)||(o=o.addPosition(n,e,s)),this.isOrthogonal(this.prevPositionIndexes(e,i),n,i,t.data)||(o=o.addPosition(n,e,r),this.isPointAdded=!0),t.onEdit({updatedData:o.getObject(),editType:"startExtruding",editContext:{featureIndexes:[n],positionIndexes:e,position:r}})}}}handleStopDragging(e,t){const n=t.selectedIndexes,o=E(e.pointerDownPicks);if(n.length&&o){const{featureIndex:n}=o.properties;let{positionIndexes:i}=o.properties;const r=this.coordinatesSize(i,n,t.data);i=this.isPointAdded?this.nextPositionIndexes(i,r):i;const s=this.getPointForPositionIndexes(this.prevPositionIndexes(i,r),n,t.data),a=this.getPointForPositionIndexes(i,n,t.data);if(s&&a){const[o,l]=A(s,a,e.mapCoords),d=new R(t.data).replacePosition(n,this.prevPositionIndexes(i,r),l).replacePosition(n,i,o).getObject();t.onEdit({updatedData:d,editType:"extruded",editContext:{featureIndexes:[n],positionIndexes:i,position:o}})}}this.isPointAdded=!1}coordinatesSize(e,t,n){let{features:o}=n,i=0;if(Array.isArray(e)){const n=o[t].geometry.coordinates;if(3===e.length){const[t,o]=e;n.length&&n[t].length&&(i=n[t][o].length)}else{const[t]=e;n.length&&n[t].length&&(i=n[t].length)}}return i}getBearing(e,t){const n=(0,u.A)(e,t);return n<0?Math.floor(360+n):Math.floor(n)}isOrthogonal(e,t,n,o){if(!Array.isArray(e))return!1;e[e.length-1]===n-1&&(e[e.length-1]=0);const i=this.getPointForPositionIndexes(this.prevPositionIndexes(e,n),t,o),r=this.getPointForPositionIndexes(this.nextPositionIndexes(e,n),t,o),s=this.getPointForPositionIndexes(e,t,o),a=this.getBearing(s,i),l=this.getBearing(s,r);return[89,90,91,269,270,271].includes(Math.abs(a-l))}nextPositionIndexes(e,t){if(!Array.isArray(e))return[];const n=[...e];return n.length&&(n[n.length-1]=n[n.length-1]===t-1?0:n[n.length-1]+1),n}prevPositionIndexes(e,t){if(!Array.isArray(e))return[];const n=[...e];return n.length&&(n[n.length-1]=0===n[n.length-1]?t-2:n[n.length-1]-1),n}getPointForPositionIndexes(e,t,n){let o,{features:i}=n;if(Array.isArray(e)){const n=i[t].geometry.coordinates;if(3===e.length){const[t,i,r]=e;n.length&&n[t].length&&(o=n[t][i][r])}else{const[t,i]=e;n.length&&n[t].length&&(o=n[t][i])}}return o}}function he(e){let{pointerDownScreenCoords:t,screenCoords:n}=e;return 10*(t[1]-n[1])}class fe extends te{makeElevatedEvent(e,t,n){const{minElevation:o=0,maxElevation:i=2e4,calculateElevationChange:r=he}=n.modeConfig||{};if(!e.pointerDownScreenCoords)return e;let s=3===t.length?t[2]:0;return s+=r({pointerDownScreenCoords:e.pointerDownScreenCoords,screenCoords:e.screenCoords}),s=Math.min(s,i),s=Math.max(s,o),Object.assign({},e,{mapCoords:[t[0],t[1],s]})}handlePointerMove(e,t){const n=E(e.pointerDownPicks),o=n?n.geometry.coordinates:e.mapCoords;super.handlePointerMove(this.makeElevatedEvent(e,o,t),t)}handleStopDragging(e,t){const n=E(e.picks),o=n?n.geometry.coordinates:e.mapCoords;super.handleStopDragging(this.makeElevatedEvent(e,o,t),t)}getCursor(e){let t=super.getCursor(e);return"cell"===t&&(t="ns-resize"),t}static calculateElevationChangeWithViewport(e,t){let{pointerDownScreenCoords:n,screenCoords:o}=t;return 156543.03392*Math.cos(e.latitude*Math.PI/180)/Math.pow(2,e.zoom)*(n[1]-o[1])/2}}class me extends X{createTentativeFeature(e){const{lastPointerMoveEvent:t}=e;return{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Point",coordinates:(t?[t.mapCoords]:[])[0]}}}handleClick(e,t){let{mapCoords:n}=e;const o={type:"Point",coordinates:n};t.onEdit(this.getAddFeatureAction(o,t.data))}handlePointerMove(e,t){t.onUpdateCursor("cell"),super.handlePointerMove(e,t)}}function ye(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let o=0;o<n;o++)if(e[o]!==t[o])return!1;return!0}return!1}function xe(e){let t,n={};return o=>{for(const i in o)if(!ye(o[i],n[i])){t=e(o),n=o;break}return t}}class be extends X{constructor(){super(...arguments),this.dist=0,this.position=null,this.elems=[],this._getTooltips=xe(e=>{let{modeConfig:t,dist:n}=e,o=[];const{formatTooltip:i}=t||{};let r;return n&&(r=i?i(n):"Distance: "+parseFloat(n).toFixed(2)+" kilometers",o=[{position:this.position,text:r}]),o})}handleClick(e,t){const{picks:n}=e,o=E(n);let i=!1;o||(this.addClickSequence(e),i=!0);const r=this.getClickSequence();if(o||this.calculateInfoDraw(r),r.length>1&&o&&Array.isArray(o.properties.positionIndexes)&&o.properties.positionIndexes[0]===r.length-1){this.dist=0;const e={type:"LineString",coordinates:[...r]};this.resetClickSequence();const n=this.getAddFeatureAction(e,t.data);n&&t.onEdit(n)}else i&&t.onEdit({updatedData:t.data,editType:"addTentativePosition",editContext:{position:e.mapCoords}})}handleKeyUp(e,t){const{key:n}=e;if("Enter"===n){const e=this.getClickSequence();if(e.length>1){const n={type:"LineString",coordinates:[...e]};this.resetClickSequence();const o=this.getAddFeatureAction(n,t.data);o&&t.onEdit(o)}}else"Escape"===n&&(this.resetClickSequence(),t.onEdit({updatedData:t.data,editType:"cancelFeature",editContext:{}}))}getGuides(e){const{lastPointerMoveEvent:t}=e,n=this.getClickSequence(),o=t?[t.mapCoords]:[],i={type:"FeatureCollection",features:[]};let r;n.length>0&&(r={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[...n,...o]}}),r&&i.features.push(r);const s=n.map((e,t)=>({type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[t]},geometry:{type:"Point",coordinates:e}}));return i.features.push(...s),i}handlePointerMove(e,t){t.onUpdateCursor("cell")}getTooltips(e){return this._getTooltips({modeConfig:e.modeConfig,dist:this.dist})}calculateInfoDraw(e){e.length>1&&(this.position=e[e.length-1],this.dist+=(0,l.A)(e[e.length-2],e[e.length-1]))}}class ve extends X{createTentativeFeature(e){const{lastPointerMoveEvent:t}=e,n=this.getClickSequence(),o=t?[t.mapCoords]:[];let i;return 1===n.length||2===n.length?i={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[...n,...o]}}:n.length>2&&(i={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Polygon",coordinates:[[...n,...o,n[0]]]}}),i}getGuides(e){const t=this.getClickSequence(),n={type:"FeatureCollection",features:[]},o=this.createTentativeFeature(e);o&&n.features.push(o);const i=t.map((e,t)=>({type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[t]},geometry:{type:"Point",coordinates:e}}));return n.features.push(...i),n}handleClick(e,t){const{picks:n}=e,i=E(n),r=this.getClickSequence();let s=!1;if(r.length>2&&t.modeConfig&&t.modeConfig.preventOverlappingLines){const t=(0,o.wi)([r[r.length-1],e.mapCoords]),n=(0,o.wi)([...r.slice(0,r.length-1)]);(0,ce.A)(t,n).features.length>0&&(s=!0)}let a=!1;if(i||s||(this.addClickSequence(e),a=!0),r.length>2&&i&&Array.isArray(i.properties.positionIndexes)&&(0===i.properties.positionIndexes[0]||i.properties.positionIndexes[0]===r.length-1)){const e={type:"Polygon",coordinates:[[...r,r[0]]]};this.resetClickSequence();const n=this.getAddFeatureOrBooleanPolygonAction(e,t);n&&t.onEdit(n)}else a&&t.onEdit({updatedData:t.data,editType:"addTentativePosition",editContext:{position:e.mapCoords}})}handleKeyUp(e,t){if("Enter"===e.key){const e=this.getClickSequence();if(e.length>2){const n={type:"Polygon",coordinates:[[...e,e[0]]]};this.resetClickSequence();const o=this.getAddFeatureOrBooleanPolygonAction(n,t);o&&t.onEdit(o)}}else"Escape"===e.key&&(this.resetClickSequence(),t.onEdit({updatedData:t.data,editType:"cancelFeature",editContext:{}}))}handlePointerMove(e,t){t.onUpdateCursor("cell"),super.handlePointerMove(e,t)}}var Ce=n(7563),Pe=n.n(Ce);class we extends X{handleClick(e,t){t.modeConfig&&t.modeConfig.dragToDraw||(this.addClickSequence(e),this.checkAndFinishPolygon(t))}handleStartDragging(e,t){t.modeConfig&&t.modeConfig.dragToDraw&&(this.addClickSequence(e),e.cancelPan())}handleStopDragging(e,t){t.modeConfig&&t.modeConfig.dragToDraw&&(this.addClickSequence(e),this.checkAndFinishPolygon(t))}checkAndFinishPolygon(e){const t=this.getClickSequence(),n=this.getTentativeGuide(e);if(t.length>1&&n&&"Polygon"===n.geometry.type){const t={type:"Feature",properties:Pe()(n.properties,"guideType"),geometry:{type:"Polygon",coordinates:n.geometry.coordinates}},o=this.getAddFeatureOrBooleanPolygonAction(t,e);this.resetClickSequence(),o&&e.onEdit(o)}}getGuides(e){const{lastPointerMoveEvent:t,modeConfig:n}=e,o=this.getClickSequence(),i={type:"FeatureCollection",features:[]};if(0===o.length||!t)return i;const r=o[0],s=t.mapCoords,a=this.getTwoClickPolygon(r,s,n);return a&&i.features.push({type:"Feature",properties:Object.assign({},a.properties,{guideType:"tentative"}),geometry:a.geometry}),i}getTwoClickPolygon(e,t,n){return null}handlePointerMove(e,t){t.onUpdateCursor("cell"),super.handlePointerMove(e,t)}createTentativeFeature(e){const{lastPointerMoveEvent:t}=e,n=this.getClickSequence(),o=t?[t.mapCoords]:[];let i;return 1===n.length&&(i=this.getTwoClickPolygon(n[0],o[0],e.modeConfig)),i}}class Se extends we{getTwoClickPolygon(e,t,n){const o=(0,r.A)([e[0],e[1],t[0],t[1]]);return o.properties=o.properties||{},o.properties.shape="Rectangle",o}}var ke=n(491);class _e extends we{getTwoClickPolygon(e,t,n){const i=[t[0],e[1]],s=[e[0],t[1]],a=(0,l.A)((0,o.zx)(i),(0,o.zx)(e)),d=(0,l.A)((0,o.zx)(s),(0,o.zx)(e)),c=a<=d?a:d,p=a<=d?i:s,u=(0,o.wi)([p,t]),g=(0,ke.A)(u,c).geometry.coordinates,h=(0,r.A)([e[0],e[1],g[0],g[1]]);return h.properties=h.properties||{},h.properties.shape="Square",h}}class Ae extends we{getTwoClickPolygon(e,t,n){const o=e[0]>t[0]?e[0]+Math.abs(e[0]-t[0]):e[0]-Math.abs(e[0]-t[0]),i=e[1]>t[1]?e[1]+Math.abs(e[1]-t[1]):e[1]-Math.abs(e[1]-t[1]),s=(0,r.A)([o,i,t[0],t[1]]);return s.properties=s.properties||{},s.properties.shape="Rectangle",s}}class Me extends we{getTwoClickPolygon(e,t,n){const i=[t[0],e[1]],s=[e[0],t[1]],a=(0,l.A)((0,o.zx)(i),(0,o.zx)(e)),d=(0,l.A)((0,o.zx)(s),(0,o.zx)(e)),c=a<=d?a:d,p=a<=d?i:s,u=(0,o.wi)([p,t]),g=(0,ke.A)(u,c).geometry.coordinates,h=e[0]>g[0]?e[0]+Math.abs(e[0]-g[0]):e[0]-Math.abs(e[0]-g[0]),f=e[1]>g[1]?e[1]+Math.abs(e[1]-g[1]):e[1]-Math.abs(e[1]-g[1]),m=(0,r.A)([h,f,g[0],g[1]]);return m.properties=m.properties||{},m.properties.shape="Square",m}}var je=n(6338),Ee=n(999);class Ie extends we{constructor(){super(...arguments),this.radius=null,this.position=null,this.areaCircle=null,this._getTooltips=xe(e=>{let{modeConfig:t,radius:n,areaCircle:o}=e,i=[];const{formatTooltip:r}=t||{};let s;return n&&o&&(s=r?r(n):"Radius: "+parseFloat(n).toFixed(2)+" kilometers\n      \n Area: "+parseFloat(o).toFixed(2),i=[{position:this.position,text:s}]),i})}getTwoClickPolygon(e,t,n){const{steps:o=64}=n||{},i={steps:o};this.position=t,o<4&&(console.warn("Minimum steps to draw a circle is 4 "),i.steps=4),this.radius=Math.max((0,l.A)(e,t),.001);const r=(0,je.A)(e,this.radius,i);return r.properties=r.properties||{},r.properties.shape="Circle",r.properties.editProperties=r.properties.editProperties||{},r.properties.editProperties.shape="Circle",r.properties.editProperties.radius={value:this.radius,unit:"kilometers"},r.properties.editProperties.center=e,this.areaCircle=(0,Ee.A)(r),r}getTooltips(e){return this._getTooltips({modeConfig:null==e?void 0:e.modeConfig,radius:this.radius,areaCircle:this.areaCircle})}}class Te extends we{constructor(){super(...arguments),this.radius=null,this.position=null,this.areaCircle=null,this.diameter=null,this._getTooltips=xe(e=>{let{modeConfig:t,radius:n,areaCircle:o,diameter:i}=e,r=[];const{formatTooltip:s}=t||{};let a;return n&&o&&(a=s?s(n):"Radius: "+parseFloat(n).toFixed(2)+" kilometers\n      \n Area: "+parseFloat(o).toFixed(2)+"\n      \n Diameter: "+parseFloat(i).toFixed(2)+" kilometers",r=[{position:this.position,text:a}]),r})}getTwoClickPolygon(e,t,n){const{steps:o=64}=n||{},i={steps:o};o<4&&(console.warn("Minimum steps to draw a circle is 4 "),i.steps=4);const r=$(e,t);this.radius=Math.max((0,l.A)(e,r),.001),this.diameter=Math.max((0,l.A)(e,t),.001),this.position=r;const s=(0,je.A)(r,this.radius,i);return s.properties=s.properties||{},s.properties.shape="Circle",s.properties.editProperties=s.properties.editProperties||{},s.properties.editProperties.shape="Circle",s.properties.editProperties.radius={value:this.radius,unit:"kilometers"},s.properties.editProperties.center=r,this.areaCircle=(0,Ee.A)(s),s}getTooltips(e){return this._getTooltips({modeConfig:e.modeConfig,radius:this.radius,areaCircle:this.areaCircle,diameter:this.diameter})}}var Fe=n(3416);class De extends we{getTwoClickPolygon(e,t,n){const i=Math.min(e[0],t[0]),s=Math.min(e[1],t[1]),a=Math.max(e[0],t[0]),d=Math.max(e[1],t[1]),c=(0,r.A)([i,s,a,d]).geometry.coordinates[0],p=$(e,t),u=Math.max((0,l.A)((0,o.zx)(c[0]),(0,o.zx)(c[1])),.001),g=Math.max((0,l.A)((0,o.zx)(c[0]),(0,o.zx)(c[3])),.001),h=(0,Fe.A)(p,u,g);return h.properties=h.properties||{},h.properties.editProperties=h.properties.editProperties||{},h.properties.editProperties.shape="Ellipse",h.properties.editProperties.xSemiAxis={value:u,unit:"kilometers"},h.properties.editProperties.ySemiAxis={value:g,unit:"kilometers"},h.properties.editProperties.angle=0,h.properties.editProperties.center=p,h}}class Le extends X{handleClick(e,t){this.addClickSequence(e);const n=this.getClickSequence(),o=this.getTentativeGuide(t);if(n.length>2&&o&&"Polygon"===o.geometry.type){const e=this.getAddFeatureOrBooleanPolygonAction(o.geometry,t,Pe()(o.properties,"guideType"));this.resetClickSequence(),e&&t.onEdit(e)}}getGuides(e){const{lastPointerMoveEvent:t,modeConfig:n}=e,o=this.getClickSequence(),i={type:"FeatureCollection",features:[]};if(0===o.length)return i;const r=t.mapCoords;if(1===o.length)i.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[o[0],r]}});else{const e=this.getThreeClickPolygon(o[0],o[1],r,n);e&&i.features.push({type:"Feature",properties:Object.assign({},e.properties,{guideType:"tentative"}),geometry:e.geometry})}return i}getThreeClickPolygon(e,t,n,o){return null}handlePointerMove(e,t){t.onUpdateCursor("cell"),super.handlePointerMove(e,t)}createTentativeFeature(e){const{lastPointerMoveEvent:t}=e,n=this.getClickSequence(),o=t?[t.mapCoords]:[];let i;return 2===n.length&&(i=this.getThreeClickPolygon(n[0],n[1],o[0],e.modeConfig)),i}}class Oe extends Le{getThreeClickPolygon(e,t,n,o){const[i,r]=A(e,t,n);return{type:"Feature",properties:{shape:"Rectangle"},geometry:{type:"Polygon",coordinates:[[e,t,i,r,e]]}}}}class He extends Le{getThreeClickPolygon(e,t,n,i){const r=$(e,t),s=Math.max((0,l.A)(r,(0,o.zx)(n)),.001),a=Math.max((0,l.A)(e,t),.001)/2,d={angle:(0,u.A)(e,t)},c=(0,Fe.A)(r,s,a,d);return c.properties=c.properties||{},c.properties.editProperties=c.properties.editProperties||{},c.properties.editProperties.shape="Ellipse",c.properties.editProperties.xSemiAxis={value:s,unit:"kilometers"},c.properties.editProperties.ySemiAxis={value:a,unit:"kilometers"},c.properties.editProperties.angle=d.angle,c.properties.editProperties.center=r,c}}class Re extends X{createTentativeFeature(e){const t=this.getClickSequence(),{mapCoords:n}=e.lastPointerMoveEvent;let o,i;if(t.length<=1)o=n;else{const e=t[t.length-2],i=t[t.length-1];[o]=A(e,i,n)}return i=t.length<3?{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[...t,o]}}:{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Polygon",coordinates:[[...t,o,t[0]]]}},i}getGuides(e){const t={type:"FeatureCollection",features:[]};if(0===this.getClickSequence().length||!e.lastPointerMoveEvent)return t;const n=this.createTentativeFeature(e);return t.features.push(n),t.features=t.features.concat(D(n.geometry,-1)),t.features=t.features.slice(0,-1),t}handlePointerMove(e,t){t.onUpdateCursor("cell"),super.handlePointerMove(e,t)}handleClick(e,t){const{picks:n}=e,o=this.getTentativeGuide(t);this.addClickSequence(e);const i=this.getClickSequence();if(o)if(3===i.length&&"LineString"===o.geometry.type){const e=o.geometry;i[i.length-1]=e.coordinates[e.coordinates.length-1]}else if(i.length>3&&"Polygon"===o.geometry.type){const e=o.geometry;i[i.length-1]=e.coordinates[0][e.coordinates[0].length-2];const r=E(n);if(r&&Array.isArray(r.properties.positionIndexes)&&(0===r.properties.positionIndexes[1]||r.properties.positionIndexes[1]===e.coordinates[0].length-3)){const n={type:"Polygon",coordinates:this.finalizedCoordinates([...e.coordinates[0]])};this.resetClickSequence();const o=this.getAddFeatureOrBooleanPolygonAction(n,t);o&&t.onEdit(o)}}else{const n={screenCoords:[-1,-1],mapCoords:e.mapCoords,picks:[],pointerDownPicks:null,pointerDownScreenCoords:null,pointerDownMapCoords:null,cancelPan:()=>{},sourceEvent:null};this.handlePointerMove(n,t)}}finalizedCoordinates(e){let t=[[...e.slice(0,-2),e[0]]],n=this.getIntermediatePoint([...e]);if(n)t=[[...e.slice(0,-2),n,e[0]]];else{const o=[...e];o.splice(-3,1),n=this.getIntermediatePoint([...o]),n&&(t=[[...e.slice(0,-3),n,e[0]]])}return t}getIntermediatePoint(e){let t=null;if(e.length>4){const[n,i]=[...e],r=(0,u.A)(n,i),s=e[e.length-3],a=e[e.length-4],d=(0,u.A)(s,a),c={first:[],second:[]};[1,2,3].forEach(e=>{const t=r+90*e;c.first.push(t>180?t-360:t);const n=d+90*e;c.second.push(n>180?n-360:n)});const g=(0,l.A)((0,o.zx)(n),(0,o.zx)(s));[0,1,2].forEach(e=>{const i=(0,o.wi)([n,(0,p.A)(n,g,c.first[e]).geometry.coordinates]);[0,1,2].forEach(e=>{const n=(0,o.wi)([s,(0,p.A)(s,g,c.second[e]).geometry.coordinates]),r=(0,ce.A)(i,n);r&&r.features.length&&(t=r.features[0].geometry.coordinates)})})}return t}}var ze=n(8550),Ne=n.n(ze);class qe extends ve{constructor(){super(...arguments),this.handleDraggingThrottled=null}handleClick(e,t){}handleStartDragging(e,t){e.cancelPan(),t.modeConfig&&t.modeConfig.throttleMs?this.handleDraggingThrottled=Ne()(this.handleDraggingAux,t.modeConfig.throttleMs):this.handleDraggingThrottled=this.handleDraggingAux}handleStopDragging(e,t){this.addClickSequence(e);const n=this.getClickSequence();if(this.handleDraggingThrottled&&this.handleDraggingThrottled.cancel&&this.handleDraggingThrottled.cancel(),n.length>2){const e={type:"Polygon",coordinates:[[...n,n[0]]]},o=this.getAddFeatureOrBooleanPolygonAction(e,t);o&&t.onEdit(o)}this.resetClickSequence()}handleDraggingAux(e,t){const{picks:n}=e;E(n)||(this.addClickSequence(e),t.onEdit({updatedData:t.data,editType:"addTentativePosition",editContext:{position:e.mapCoords}}))}handleDragging(e,t){this.handleDraggingThrottled&&this.handleDraggingThrottled(e,t)}handleKeyUp(e,t){if("Enter"===e.key){const e=this.getClickSequence();if(e.length>2){const n={type:"Polygon",coordinates:[[...e,e[0]]]};this.resetClickSequence();const o=this.getAddFeatureOrBooleanPolygonAction(n,t);o&&t.onEdit(o)}}else"Escape"===e.key&&(this.resetClickSequence(),this.handleDraggingThrottled&&(this.handleDraggingThrottled=null),t.onEdit({updatedData:t.data,editType:"cancelFeature",editContext:{}}))}}class Ge extends X{constructor(e){super(),this._handler=e}_getSnappedMouseEvent(e,t,n){return Object.assign(e,{mapCoords:n.geometry.coordinates,pointerDownMapCoords:t&&t.geometry.coordinates})}_getPickedSnapTarget(e){return F(e).find(e=>"snap-target"===e.properties.editHandleType)}_getPickedSnapSource(e){return F(e).find(e=>"snap-source"===e.properties.editHandleType)}_getUpdatedSnapSourceHandle(e,t){const{featureIndex:n,positionIndexes:o}=e.properties;if(!Array.isArray(o))return e;const i=t.features[n],r=o.reduce((e,t)=>e[t],i.geometry.coordinates);return Object.assign({},e,{geometry:{type:"Point",coordinates:r}})}_getSnapTargets(e){let{additionalSnapTargets:t}=e.modeConfig||{};t=t||[];return[...e.data.features,...t]}_getSnapTargetHandles(e){const t=[],n=this._getSnapTargets(e);for(let o=0;o<n.length;o++){if(!e.selectedIndexes.includes(o)){const{geometry:e}=n[o];t.push(...D(e,o,"snap-target"))}}return t}getGuides(e){const{modeConfig:t,lastPointerMoveEvent:n}=e,{enableSnapping:o}=t||{},i={type:"FeatureCollection",features:[...this._handler.getGuides(e).features]};if(!o)return i;const r=n&&this._getPickedSnapSource(n.pointerDownPicks);if(r)return i.features.push(...this._getSnapTargetHandles(e),this._getUpdatedSnapSourceHandle(r,e.data)),i;const{features:s}=e.data;for(const a of e.selectedIndexes)if(a<s.length){const{geometry:e}=s[a];i.features.push(...D(e,a,"snap-source"))}return i}_getSnapAwareEvent(e,t){const n=this._getPickedSnapSource(t.lastPointerMoveEvent.pointerDownPicks),o=this._getPickedSnapTarget(e.picks);return n&&o?this._getSnappedMouseEvent(e,n,o):e}handleStartDragging(e,t){this._handler.handleStartDragging(e,t)}handleStopDragging(e,t){this._handler.handleStopDragging(this._getSnapAwareEvent(e,t),t)}handleDragging(e,t){this._handler.handleDragging(this._getSnapAwareEvent(e,t),t)}handlePointerMove(e,t){this._handler.handlePointerMove(this._getSnapAwareEvent(e,t),t)}}class Ue extends X{constructor(e){super(),this._modes=e}_coalesce(e,t){void 0===t&&(t=null);let n=null;for(let o=0;o<this._modes.length&&(n=e(this._modes[o]),!(t?t(n):n));o++);return n}handleClick(e,t){this._coalesce(n=>n.handleClick(e,t))}handlePointerMove(e,t){return this._coalesce(n=>n.handlePointerMove(e,t))}handleStartDragging(e,t){return this._coalesce(n=>n.handleStartDragging(e,t))}handleStopDragging(e,t){return this._coalesce(n=>n.handleStopDragging(e,t))}handleDragging(e,t){return this._coalesce(n=>n.handleDragging(e,t))}getGuides(e){const t=[];for(const n of this._modes)t.push(...n.getGuides(e).features);return{type:"FeatureCollection",features:t}}}class We extends Ue{constructor(){super([new ee,new re,new ae])}handlePointerMove(e,t){let n=null;super.handlePointerMove(e,Object.assign({},t,{onUpdateCursor:e=>{n=e||n}})),t.onUpdateCursor(n)}handleStartDragging(e,t){let n=null,o=null;const i=[];e.picks.length&&e.cancelPan(),this._modes.forEach(e=>{e instanceof ee?o=e:(e instanceof re&&(n=e),i.push(e))}),n instanceof re&&!n.isEditHandleSelected()&&i.push(o),i.filter(Boolean).forEach(n=>n.handleStartDragging(e,t))}getGuides(e){let t=super.getGuides(e);const n=(this._modes||[]).find(e=>e instanceof ae);if(n instanceof ae){const e=t.features.filter(e=>{const{editHandleType:t,mode:o}=e.properties||{},i=[o];return n.getIsRotating()&&i.push(t),!i.includes("scale")});t=(0,o.Lr)(e)}return t}}const Be=2/3,Xe=["click","pointermove","panstart","panmove","panend","keyup"];class $e extends f.A{constructor(){super(...arguments),this.state=void 0}onLayerClick(e){}onStartDragging(e){}onStopDragging(e){}onDragging(e){}onPointerMove(e){}onLayerKeyUp(e){}initializeState(){this.setState({_editableLayerState:{pointerDownPicks:null,pointerDownScreenCoords:null,pointerDownMapCoords:null,eventHandler:this._forwardEventToCurrentLayer.bind(this)}}),this._addEventHandlers()}finalizeState(){this._removeEventHandlers()}_addEventHandlers(){const{eventManager:e}=this.context.deck,{eventHandler:t}=this.state._editableLayerState;for(const n of Xe)e.on(n,t,{priority:100})}_removeEventHandlers(){const{eventManager:e}=this.context.deck,{eventHandler:t}=this.state._editableLayerState;for(const n of Xe)e.off(n,t)}_forwardEventToCurrentLayer(e){const t=this.getCurrentLayer(),n=t["_on"+e.type].bind(t);n?n(e):console.warn("no handler for mjolnir.js event "+e.type)}_onclick(e){let{srcEvent:t}=e;const n=this.getScreenCoords(t),o=this.getMapCoords(n),i=this.getPicks(n);this.onLayerClick({mapCoords:o,screenCoords:n,picks:i,sourceEvent:t})}_onkeyup(e){let{srcEvent:t}=e;this.onLayerKeyUp(t)}_onpanstart(e){const t=this.getScreenCoords(e.srcEvent),n=this.getMapCoords(t),o=this.getPicks(t);this.setState({_editableLayerState:Object.assign({},this.state._editableLayerState,{pointerDownScreenCoords:t,pointerDownMapCoords:n,pointerDownPicks:o})}),this.onStartDragging({picks:o,screenCoords:t,mapCoords:n,pointerDownScreenCoords:t,pointerDownMapCoords:n,cancelPan:()=>{this.props.onCancelPan&&this.props.onCancelPan(),e.stopImmediatePropagation()},sourceEvent:e.srcEvent})}_onpanmove(e){const{srcEvent:t}=e,n=this.getScreenCoords(t),o=this.getMapCoords(n),{pointerDownPicks:i,pointerDownScreenCoords:r,pointerDownMapCoords:s}=this.state._editableLayerState,a=this.getPicks(n);this.onDragging({screenCoords:n,mapCoords:o,picks:a,pointerDownPicks:i,pointerDownScreenCoords:r,pointerDownMapCoords:s,sourceEvent:t,cancelPan:e.stopImmediatePropagation})}_onpanend(e){let{srcEvent:t}=e;const n=this.getScreenCoords(t),o=this.getMapCoords(n),{pointerDownPicks:i,pointerDownScreenCoords:r,pointerDownMapCoords:s}=this.state._editableLayerState,a=this.getPicks(n);this.onStopDragging({picks:a,screenCoords:n,mapCoords:o,pointerDownPicks:i,pointerDownScreenCoords:r,pointerDownMapCoords:s,sourceEvent:t}),this.setState({_editableLayerState:Object.assign({},this.state._editableLayerState,{pointerDownScreenCoords:null,pointerDownMapCoords:null,pointerDownPicks:null})})}_onpointermove(e){const{srcEvent:t}=e,n=this.getScreenCoords(t),o=this.getMapCoords(n),{pointerDownPicks:i,pointerDownScreenCoords:r,pointerDownMapCoords:s}=this.state._editableLayerState,a=this.getPicks(n);this.onPointerMove({screenCoords:n,mapCoords:o,picks:a,pointerDownPicks:i,pointerDownScreenCoords:r,pointerDownMapCoords:s,sourceEvent:t,cancelPan:e.stopImmediatePropagation})}getPicks(e){return this.context.deck.pickMultipleObjects({x:e[0],y:e[1],layerIds:[this.props.id],radius:this.props.pickingRadius,depth:this.props.pickingDepth})}getScreenCoords(e){return[e.clientX-this.context.gl.canvas.getBoundingClientRect().left,e.clientY-this.context.gl.canvas.getBoundingClientRect().top]}getMapCoords(e){return this.context.viewport.unproject([e[0],e[1]])}}$e.layerName="EditableLayer";var Ye=n(4968);const Ve="uniform pickingLineWidthUniforms {\n  float extraPixels;\n} pickingLineWidth;\n",Je={name:"pickingLineWidth",vs:Ve,fs:Ve,uniformTypes:{extraPixels:"f32"}},Ke=Object.assign({},Ye.A.defaultProps,{pickingLineWidthExtraPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER}});class Ze extends Ye.A{getShaders(){const e=super.getShaders();return e.vs=function(e,t,n){const o=e.indexOf(t);return o<0?e:e.slice(0,o)+n+e.slice(o)}(e.vs,"vec3 width;","\n       if(bool(picking.isActive)){\n        widthPixels.xy += pickingLineWidth.extraPixels;\n       }\n      "),Object.assign({},e,{modules:[...e.modules,Je]})}draw(e){const{pickingLineWidthExtraPixels:t}=this.props,n={extraPixels:t};this.state.model.shaderInputs.setProps({pickingLineWidth:n}),super.draw(e)}}Ze.defaultProps=Ke,Ze.layerName="EditablePathLayer";const Qe=[0,0,0,153],et=[0,0,0,144],tt=[0,0,0,255],nt=[0,0,144,144],ot=[144,144,144,255],it=[144,144,144,144],rt=[192,0,0,255],st=[0,0,0,128],at=[124,0,192,255],lt=[255,255,255,255],dt=ve;function ct(e){return e&&"function"==typeof e?t=>e(function(e){if(e.__source)return e.__source.object;if(e.sourceFeature)return e.sourceFeature.feature;return e}(t)):e}function pt(e){switch(e.properties.editHandleType){case"existing":return rt;case"snap-source":return at;default:return st}}const ut={mode:dt,onEdit:()=>{},pickable:!0,pickingRadius:10,pickingDepth:5,fp64:!1,filled:!0,stroked:!0,lineWidthScale:Be,lineWidthMinPixels:1,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,pickingLineWidthExtraPixels:0,lineWidthUnits:"pixels",lineJointRounded:!1,lineCapRounded:!1,lineMiterLimit:4,pointRadiusScale:1,pointRadiusMinPixels:2,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,getLineColor:(e,t,n)=>t?tt:Qe,getFillColor:(e,t,n)=>t?nt:et,getRadius:e=>e&&e.properties&&e.properties.radius||e&&e.properties&&e.properties.size||1,getLineWidth:e=>e&&e.properties&&e.properties.lineWidth||3,getTentativeLineColor:e=>ot,getTentativeFillColor:e=>it,getTentativeLineWidth:e=>e&&e.properties&&e.properties.lineWidth||3,editHandleType:"point",editHandlePointRadiusScale:1,editHandlePointOutline:!0,editHandlePointStrokeWidth:2,editHandlePointRadiusUnits:"pixels",editHandlePointRadiusMinPixels:4,editHandlePointRadiusMaxPixels:8,getEditHandlePointColor:pt,getEditHandlePointOutlineColor:function(e){return lt},getEditHandlePointRadius:function(e){switch(e.properties.editHandleType){case"existing":return 5;case"snap":return 7;default:return 3}},editHandleIconAtlas:null,editHandleIconMapping:null,editHandleIconSizeScale:1,editHandleIconSizeUnits:"pixels",getEditHandleIcon:e=>e.properties.editHandleType,getEditHandleIconSize:10,getEditHandleIconColor:pt,getEditHandleIconAngle:0,billboard:!0},gt={view:Y,modify:te,translate:new Ge(new ee),transform:new Ge(new We),scale:re,rotate:ae,duplicate:le,split:ue,extrude:ge,elevation:fe,delete:class extends X{handleClick(e,t){const n=t.lastPointerMoveEvent.picks.map(e=>e.index);if(n.length>0){const e=n[0],o=t.data.features.filter((t,n)=>n!==e),i={updatedData:Object.assign({},t.data,{features:o}),editType:"deleteFeature",editContext:{featureIndexes:n}};t.onEdit(i)}}},drawPoint:me,drawLineString:be,drawPolygon:ve,drawRectangle:Se,drawSquare:_e,drawRectangleFromCenter:Ae,drawSquareFromCenter:Me,drawCircleFromCenter:Ie,drawCircleByBoundingBox:Te,drawEllipseByBoundingBox:De,drawRectangleUsing3Points:Oe,drawEllipseUsing3Points:He,draw90DegreePolygon:Re,drawPolygonByDragging:qe};class ht extends $e{constructor(){super(...arguments),this.state=void 0}renderLayers(){const e=this.getSubLayerProps({id:"geojson",data:this.props.data,fp64:this.props.fp64,filled:this.props.filled,stroked:this.props.stroked,lineWidthScale:this.props.lineWidthScale,lineWidthMinPixels:this.props.lineWidthMinPixels,lineWidthMaxPixels:this.props.lineWidthMaxPixels,lineWidthUnits:this.props.lineWidthUnits,lineJointRounded:this.props.lineJointRounded,lineCapRounded:this.props.lineCapRounded,lineMiterLimit:this.props.lineMiterLimit,pointRadiusScale:this.props.pointRadiusScale,pointRadiusMinPixels:this.props.pointRadiusMinPixels,pointRadiusMaxPixels:this.props.pointRadiusMaxPixels,getLineColor:this.selectionAwareAccessor(this.props.getLineColor),getFillColor:this.selectionAwareAccessor(this.props.getFillColor),getPointRadius:this.selectionAwareAccessor(this.props.getRadius),getLineWidth:this.selectionAwareAccessor(this.props.getLineWidth),_subLayerProps:{linestrings:{billboard:this.props.billboard,updateTriggers:{all:[this.props.selectedFeatureIndexes,this.props.mode]}},"polygons-stroke":{billboard:this.props.billboard,pickingLineWidthExtraPixels:this.props.pickingLineWidthExtraPixels,type:Ze,updateTriggers:{all:[this.props.selectedFeatureIndexes,this.props.mode]}}},updateTriggers:{getLineColor:[this.props.selectedFeatureIndexes,this.props.mode],getFillColor:[this.props.selectedFeatureIndexes,this.props.mode],getPointRadius:[this.props.selectedFeatureIndexes,this.props.mode],getLineWidth:[this.props.selectedFeatureIndexes,this.props.mode]}});let t=[new b.A(e)];return t=t.concat(this.createGuidesLayers(),this.createTooltipsLayers()),t}initializeState(){super.initializeState(),this.setState({selectedFeatures:[],editHandles:[]})}shouldUpdateState(e){return super.shouldUpdateState(e)||e.changeFlags.stateChanged}updateState(e){let{props:t,oldProps:n,changeFlags:o,context:i}=e;if(super.updateState({oldProps:n,props:t,changeFlags:o,context:i}),o.propsOrDataChanged){if(0===Object.keys(n).length||t.mode!==n.mode){let e;if("function"==typeof t.mode){e=new(0,t.mode)}else"string"==typeof t.mode?(e=gt[t.mode],console.warn("Deprecated use of passing `mode` as a string. Pass the mode's class constructor instead.")):e=t.mode;e||(console.warn("No mode configured for "+String(t.mode)),e=new dt),e!==this.state.mode&&this.setState({mode:e,cursor:null})}}let r=[];if(Array.isArray(t.selectedFeatureIndexes)&&"object"==typeof t.data&&"features"in t.data){const e=t.data;r=t.selectedFeatureIndexes.map(t=>e.features[t])}this.setState({selectedFeatures:r})}getModeProps(e){return{modeConfig:e.modeConfig,data:e.data,selectedIndexes:e.selectedFeatureIndexes,lastPointerMoveEvent:this.state.lastPointerMoveEvent,cursor:this.state.cursor,onEdit:t=>{this.setNeedsUpdate(),e.onEdit(t)},onUpdateCursor:e=>{this.setState({cursor:e})}}}selectionAwareAccessor(e){return"function"!=typeof e?e:t=>e(t,this.isFeatureSelected(t),this.props.mode)}isFeatureSelected(e){return!(!this.props.data||!this.props.selectedFeatureIndexes)&&(!!this.props.selectedFeatureIndexes.length&&this.state.selectedFeatures.includes(e))}getPickingInfo(e){let{info:t,sourceLayer:n}=e;return n.id.endsWith("guides")&&(t.isGuide=!0),t}_updateAutoHighlight(e){if(null!=e&&e.sourceLayer)if(e.isGuide)for(const t of e.sourceLayer.getSubLayers())t.updateAutoHighlight(e);else e.sourceLayer.updateAutoHighlight(e)}createGuidesLayers(){const e=this.getActiveMode().getGuides(this.getModeProps(this.props));if(!e||!e.features.length)return[];const t={linestrings:{billboard:this.props.billboard,autoHighlight:!1},"polygons-fill":{autoHighlight:!1},"polygons-stroke":{billboard:this.props.billboard}};"icon"===this.props.editHandleType?t["points-icon"]={type:v.A,iconAtlas:this.props.editHandleIconAtlas,iconMapping:this.props.editHandleIconMapping,sizeUnits:this.props.editHandleIconSizeUnits,sizeScale:this.props.editHandleIconSizeScale,getIcon:ct(this.props.getEditHandleIcon),getSize:ct(this.props.getEditHandleIconSize),getColor:ct(this.props.getEditHandleIconColor),getAngle:ct(this.props.getEditHandleIconAngle),billboard:this.props.billboard}:t["points-circle"]={type:m.A,radiusScale:this.props.editHandlePointRadiusScale,stroked:this.props.editHandlePointOutline,getLineWidth:this.props.editHandlePointStrokeWidth,radiusUnits:this.props.editHandlePointRadiusUnits,radiusMinPixels:this.props.editHandlePointRadiusMinPixels,radiusMaxPixels:this.props.editHandlePointRadiusMaxPixels,getRadius:ct(this.props.getEditHandlePointRadius),getFillColor:ct(this.props.getEditHandlePointColor),getLineColor:ct(this.props.getEditHandlePointOutlineColor),billboard:this.props.billboard};return[new b.A(this.getSubLayerProps({id:"guides",data:e,fp64:this.props.fp64,_subLayerProps:t,lineWidthScale:this.props.lineWidthScale,lineWidthMinPixels:this.props.lineWidthMinPixels,lineWidthMaxPixels:this.props.lineWidthMaxPixels,lineWidthUnits:this.props.lineWidthUnits,lineJointRounded:this.props.lineJointRounded,lineCapRounded:this.props.lineCapRounded,lineMiterLimit:this.props.lineMiterLimit,getLineColor:ct(this.props.getTentativeLineColor),getLineWidth:ct(this.props.getTentativeLineWidth),getFillColor:ct(this.props.getTentativeFillColor),pointType:"icon"===this.props.editHandleType?"icon":"circle",iconAtlas:this.props.editHandleIconAtlas}))]}createTooltipsLayers(){const e=this.getActiveMode().getTooltips(this.getModeProps(this.props));return[new x.A(Object.assign({getSize:21.333333333333332},this.getSubLayerProps({id:"tooltips",data:e})))]}onLayerClick(e){this.getActiveMode().handleClick(e,this.getModeProps(this.props))}onLayerKeyUp(e){this.getActiveMode().handleKeyUp(e,this.getModeProps(this.props))}onStartDragging(e){this.getActiveMode().handleStartDragging(e,this.getModeProps(this.props))}onDragging(e){this.getActiveMode().handleDragging(e,this.getModeProps(this.props))}onStopDragging(e){this.getActiveMode().handleStopDragging(e,this.getModeProps(this.props))}onPointerMove(e){this.setState({lastPointerMoveEvent:e}),this.getActiveMode().handlePointerMove(e,this.getModeProps(this.props))}getCursor(e){let{isDragging:t}=e;if(null===this.state||void 0===this.state)return null;let{cursor:n}=this.state;return n||(n=t?"grabbing":"grab"),n}getActiveMode(){return this.state.mode}}ht.layerName="EditableGeoJsonLayer",ht.defaultProps=ut;var ft=n(4326);const mt=Y,yt={type:"FeatureCollection",features:[]},xt=Object.assign({mode:mt},ht.defaultProps,{data:[],selectedIndexes:[],filled:!1,stroked:!0,lineWidthScale:Be,lineWidthMinPixels:1,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineWidthUnits:"pixels",getHexagons:e=>e.hexIds,getEditedCluster:(e,t)=>t?Object.assign({},t,{hexIds:e}):{hexIds:e},resolution:9});class bt extends $e{constructor(){super(...arguments),this.state=void 0}initializeState(){super.initializeState(),this.setState({tentativeHexagonIDs:[]})}getDerivedHexagonIDs(e){throw new Error("not implemented")}getDerivedHexagonID(e){throw new Error("not implemented")}renderLayers(){return[new ht(this.getSubLayerProps({id:"editable-geojson",mode:this.props.mode,data:yt,selectedFeatureIndexes:[],onEdit:e=>{const{editType:t,editContext:n}=e;switch(t){case"updateTentativeFeature":if("Polygon"===n.feature.geometry.type){const e=n.feature.geometry.coordinates,t=this.getDerivedHexagonIDs(e);this.setState({tentativeHexagonIDs:t})}else if("Point"===n.feature.geometry.type){const e=n.feature.geometry.coordinates,t=this.getDerivedHexagonID(e);this.setState({tentativeHexagonIDs:[t]})}break;case"addFeature":const e=[...this.props.data],{modeConfig:t}=this.props;if(t&&t.booleanOperation)if(1!==this.props.selectedIndexes.length)console.warn("booleanOperation only supported for single cluster selection");else{let n;const o=new Set(this.getSelectedHexIDs()),i=new Set(this.state.tentativeHexagonIDs);switch(t.booleanOperation){case"union":default:n=[...new Set([...o,...i])];break;case"intersection":n=[...o].filter(e=>i.has(e));break;case"difference":n=[...o].filter(e=>!i.has(e))}const r=this.props.selectedIndexes[0],s=this.props.data[r];e[r]=this.props.getEditedCluster(n,s)}else e.push(this.props.getEditedCluster(this.state.tentativeHexagonIDs,null));this.setState({tentativeHexagonIDs:[]}),this.props.onEdit({updatedData:e})}}})),new ft.A(this.getSubLayerProps({id:"hexagons",data:this.props.data,getHexagons:this.props.getHexagons})),new ft.A(this.getSubLayerProps({id:"tentative-hexagons",data:[{hexIds:this.state.tentativeHexagonIDs}],getHexagons:e=>e.hexIds}))]}getSelectedHexIDs(){let e=[];return this.props.selectedIndexes.forEach(t=>{const n=this.props.data[t],o=this.props.getHexagons(n);e=e.concat(o)}),e}getCursor(e){let{isDragging:t}=e,{cursor:n}=this.state||{};return n||(n=t?"grabbing":"grab"),n}}bt.layerName="EditableH3ClusterLayer",bt.defaultProps=xt;var vt=n(9751);const Ct="rectangle",Pt="polygon",wt={[Ct]:Se,[Pt]:ve},St={[Ct]:{dragToDraw:!0}},kt={selectionType:Ct,layerIds:[],onSelect:()=>{}},_t={type:"FeatureCollection",features:[]},At="selection-blocker",Mt=["lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","lineWidthUnits","lineJointRounded","lineCapRounded","lineMiterLimit","pointRadiusScale","pointRadiusMinPixels","pointRadiusMaxPixels","lineDashJustified","getLineColor","getFillColor","getRadius","getLineWidth","getLineDashArray","getTentativeLineDashArray","getTentativeLineColor","getTentativeFillColor","getTentativeLineWidth"];class jt extends f.A{constructor(){super(...arguments),this.state=void 0}_selectRectangleObjects(e){const{layerIds:t,onSelect:n}=this.props,[o,i]=this.context.viewport.project(e[0][0]),[r,s]=this.context.viewport.project(e[0][2]);n({pickingInfos:this.context.deck.pickObjects({x:Math.min(o,r),y:Math.min(i,s),width:Math.abs(r-o),height:Math.abs(s-i),layerIds:t})})}_selectPolygonObjects(e){const{layerIds:t,onSelect:n}=this.props,i=e[0].map(e=>this.context.viewport.project(e)),r=i.map(e=>e[0]),l=i.map(e=>e[1]),d=Math.min(...r),c=Math.min(...l),p=Math.max(...r),u=Math.max(...l),g=(0,o.n1)(e),h=(0,s.A)(g,50);let f;try{f=(0,a.A)(h,g)}catch(y){return void console.log("turfDifference() error",y)}this.setState({pendingPolygonSelection:{bigPolygon:f}});const m=this.props.id+"-"+At;setTimeout(()=>{const e=this.context.deck.pickObjects({x:d,y:c,width:p-d,height:u-c,layerIds:[m,...t]});n({pickingInfos:e.filter(e=>e.layer.id!==this.props.id)})},250)}renderLayers(){const{pendingPolygonSelection:e}=this.state,t=wt[this.props.selectionType]||Y,n=St[this.props.selectionType],o={};Mt.forEach(e=>{void 0!==this.props[e]&&(o[e]=this.props[e])});const i=[new ht(this.getSubLayerProps(Object.assign({id:"selection-geojson",pickable:!0,mode:t,modeConfig:n,selectedFeatureIndexes:[],data:_t,onEdit:e=>{let{updatedData:t,editType:n}=e;if("addFeature"===n){const{coordinates:e}=t.features[0].geometry;this.props.selectionType===Ct?this._selectRectangleObjects(e):this.props.selectionType===Pt&&this._selectPolygonObjects(e)}}},o)))];if(e){const{bigPolygon:t}=e;i.push(new vt.A(this.getSubLayerProps({id:At,pickable:!0,stroked:!1,opacity:1,data:[t],getLineColor:e=>[0,0,0,1],getFillColor:e=>[0,0,0,1],getPolygon:e=>e.geometry.coordinates})))}return i}shouldUpdateState(e){let{changeFlags:{stateChanged:t,propsOrDataChanged:n}}=e;return t||n}}jt.layerName="SelectionLayer",jt.defaultProps=kt;var Et=n(9105);class It extends f.A{renderLayers(){return[new m.A(Object.assign({},this.props,{id:this.props.id+"-ScatterplotLayer",data:this.props.data})),new Et.A(Object.assign({},this.props,{id:this.props.id+"-LineLayer",data:this.props.data,pickable:!1,getSourcePosition:e=>{let{position:t}=e;return[t[0],t[1],0]},getTargetPosition:e=>{let{position:t}=e;return[t[0],t[1],t[2]||0]},getColor:[150,150,150,200],getStrokeWidth:3}))]}}It.layerName="ElevatedEditHandleLayer",It.defaultProps={};class Tt extends X{constructor(){super(...arguments),this._isResizing=!1}getGuides(e){const t=[],n=e.selectedIndexes,{lastPointerMoveEvent:i}=e,r=i&&i.picks,s=i&&i.mapCoords;if(r&&r.length&&s&&1===n.length&&!this._isResizing){const n=r.find(e=>!e.isGuide);if(n&&n.object.properties.shape&&n.object.properties.shape.includes("Circle")&&e.selectedIndexes.includes(n.index)){let i=null,r=[];const a=(0,o.zx)(s);if(_(n.object.geometry.coordinates,[],(t,n)=>{const s=(0,o.wi)(t),l=this.getNearestPoint(s,a,e.modeConfig&&e.modeConfig.viewport);(!i||l.properties.dist<i.properties.dist)&&(i=l,r=n)}),i){const{geometry:{coordinates:e},properties:{index:o}}=i;t.push({type:"Feature",properties:{guideType:"editHandle",editHandleType:"intermediate",featureIndex:n.index,positionIndexes:[...r,o+1]},geometry:{type:"Point",coordinates:e}})}}}return{type:"FeatureCollection",features:t}}getNearestPoint(e,t,n){const{coordinates:o}=e.geometry;if(o.some(e=>e.length>2)){if(n)return j(e,t,n);console.log("Editing 3D point but modeConfig.viewport not provided. Falling back to 2D logic.")}return(0,pe.A)(e,t)}handleDragging(e,t){const n=E(e.pointerDownPicks);if(n){e.cancelPan();const o=n.properties,i=this.getSelectedFeature(t),r=(0,J.A)(i).geometry.coordinates,s=Object.entries(i.geometry.coordinates[0]).length-1,a=Math.max((0,l.A)(r,e.mapCoords),.001),{steps:d=s}={},c={steps:d},p=(0,je.A)(r,a,c).geometry,u=new R(t.data).replaceGeometry(o.featureIndex,p).getObject();t.onEdit({updatedData:u,editType:"unionGeometry",editContext:{featureIndexes:[o.featureIndex]}})}}handlePointerMove(e,t){if(!this._isResizing){const t=E(e.picks);this._selectedEditHandle=t&&"intermediate"===t.properties.editHandleType?t:null}const n=this.getCursor(e);t.onUpdateCursor(n)}handleStartDragging(e,t){this._selectedEditHandle&&(e.cancelPan(),this._isResizing=!0)}handleStopDragging(e,t){this._isResizing&&(this._selectedEditHandle=null,this._isResizing=!1)}getCursor(e){return F(e&&e.picks||[]).length?"cell":null}}class Ft extends X{getSingleSelectedLineString(e){const t=this.getSelectedGeometry(e);return t&&"LineString"===t.type?t:null}handleClick(e,t){const{selectedIndexes:n}=t,o=this.getSingleSelectedLineString(t);if(!o)return void console.warn("ExtendLineStringMode only supported for single LineString selection");let i=[o.coordinates.length];const r=t.modeConfig;r&&r.drawAtFront&&(i=[0]);const s=n[0],a=new R(t.data).addPosition(s,i,e.mapCoords).getObject();t.onEdit({updatedData:a,editType:"addPosition",editContext:{featureIndexes:[s],positionIndexes:i,position:e.mapCoords}})}getGuides(e){const t={type:"FeatureCollection",features:[]},n=this.getSingleSelectedLineString(e);if(!n)return t;const o=e.lastPointerMoveEvent&&e.lastPointerMoveEvent.mapCoords;if(!o)return t;let i=null;const{modeConfig:r}=e;return i=r&&r.drawAtFront?n.coordinates[0]:n.coordinates[n.coordinates.length-1],t.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[i,o]}}),t}handlePointerMove(e,t){t.onUpdateCursor("cell")}}var Dt=n(3922);class Lt extends X{constructor(){super(...arguments),this._isMeasuringSessionFinished=!1,this._currentTooltips=[],this._currentDistance=0,this._calculateDistanceForTooltip=e=>{let{positionA:t,positionB:n,modeConfig:o}=e;const{turfOptions:i,measurementCallback:r}=o||{},s=(0,l.A)(t,n,i);return r&&r(s),s}}_formatTooltip(e,t){const{formatTooltip:n,turfOptions:o}=t||{},i=o&&o.units||"kilometers";let r;return r=n?n(e):parseFloat(e).toFixed(2)+" "+i,r}handleClick(e,t){const{modeConfig:n,data:o,onEdit:i}=t,{centerTooltipsOnLine:r=!1}=n||{};this._isMeasuringSessionFinished&&(this._isMeasuringSessionFinished=!1,this.resetClickSequence(),this._currentTooltips=[],this._currentDistance=0);const{picks:s}=e,a=E(s);let l=!1;a||(this.addClickSequence(e),l=!0);const d=this.getClickSequence();if(d.length>1&&a&&Array.isArray(a.properties.positionIndexes)&&a.properties.positionIndexes[0]===d.length-1)this._isMeasuringSessionFinished=!0;else if(l){if(d.length>1){this._currentDistance+=this._calculateDistanceForTooltip({positionA:d[d.length-2],positionB:d[d.length-1],modeConfig:n});const t=r?(0,Dt.A)(d[d.length-2],d[d.length-1]).geometry.coordinates:e.mapCoords;this._currentTooltips.push({position:t,text:this._formatTooltip(this._currentDistance,n)})}i({updatedData:o,editType:"addTentativePosition",editContext:{position:e.mapCoords}})}}handleKeyUp(e,t){if(this._isMeasuringSessionFinished)return;e.stopPropagation();const{key:n}=e,o=this.getClickSequence().length;switch(n){case"Escape":this._isMeasuringSessionFinished=!0,1===o&&(this.resetClickSequence(),this._currentTooltips=[]),t.onUpdateCursor("cell");break;case"Enter":this.handleClick(t.lastPointerMoveEvent,t),this._isMeasuringSessionFinished=!0}}getGuides(e){const{lastPointerMoveEvent:t}=e,n=this.getClickSequence(),o=t&&!this._isMeasuringSessionFinished?[t.mapCoords]:[],i={type:"FeatureCollection",features:[]};n.length>0&&i.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[...n,...o]}});const r=n.map((e,t)=>({type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[t]},geometry:{type:"Point",coordinates:e}}));return i.features.push(...r),i}handlePointerMove(e,t){t.onUpdateCursor("cell")}getTooltips(e){const{lastPointerMoveEvent:t,modeConfig:n}=e,{centerTooltipsOnLine:o=!1}=n||{},i=this.getClickSequence();if(i.length>0&&t&&!this._isMeasuringSessionFinished){const r=this._calculateDistanceForTooltip({positionA:i[i.length-1],positionB:t.mapCoords,modeConfig:e.modeConfig}),s=o?(0,Dt.A)(i[i.length-1],t.mapCoords).geometry.coordinates:t.mapCoords;return[...this._currentTooltips,{position:s,text:this._formatTooltip(this._currentDistance+r,n)}]}return this._currentTooltips}}const Ot=[];class Ht extends ve{handleClick(e,t){const n=Object.assign({},t,{onEdit:()=>{}});super.handleClick(e,n)}handleKeyUp(e,t){const n=Object.assign({},t,{onEdit:()=>{}});super.handleKeyUp(e,n)}getTooltips(e){const t=this.getTentativeGuide(e);if(t&&"Polygon"===t.geometry.type){const{modeConfig:n}=e,{formatTooltip:o,measurementCallback:i}=n||{},r="sq. m",s=(0,ne.A)(t),a=(0,Ee.A)(t);let l;return l=o?o(a):parseFloat(a).toFixed(2)+" "+r,i&&i(a),[{position:s.geometry.coordinates,text:l}]}return Ot}}const Rt=[];class zt extends X{constructor(){super(...arguments),this._getTooltips=xe(e=>{let{modeConfig:t,vertex:n,point1:o,point2:i}=e,r=Rt;if(n&&o&&i){const{formatTooltip:e,measurementCallback:s}=t||{},a="deg",l=(0,u.A)(n,o),d=(0,u.A)(n,i);let c,p=Math.abs(l-d);p>180&&(p=360-p),c=e?e(p):parseFloat(p).toFixed(2)+" "+a,s&&s(p);r=[{position:(0,J.A)({type:"FeatureCollection",features:[o,i].map(e=>({type:"Feature",geometry:{type:"Point",coordinates:e},properties:{}}))}).geometry.coordinates,text:c}]}return r})}handleClick(e,t){this.getClickSequence().length>=3&&this.resetClickSequence(),this.addClickSequence(e)}handlePointerMove(e,t){t.onUpdateCursor("cell")}getPoints(e){const t=this.getClickSequence(),n=[...t];return t.length<3&&e.lastPointerMoveEvent&&n.push(e.lastPointerMoveEvent.mapCoords),n}getGuides(e){const t={type:"FeatureCollection",features:[]},{features:n}=t,o=this.getPoints(e);return o.length>2?n.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[o[1],o[0],o[2]]}}):o.length>1&&n.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[o[1],o[0]]}}),t}getTooltips(e){const t=this.getPoints(e);return this._getTooltips({modeConfig:e.modeConfig,vertex:t[0],point1:t[1],point2:t[2]})}}},5169:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assets:()=>f,contentTitle:()=>h,default:()=>x,frontMatter:()=>g,metadata:()=>o,toc:()=>m});const o=JSON.parse('{"id":"editable-layers/editor","title":"Editor","description":"","source":"@site/src/examples/editable-layers/editor.mdx","sourceDirName":"editable-layers","slug":"/editable-layers/editor","permalink":"/deck.gl-community/examples/editable-layers/editor","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"examplesSidebar","previous":{"title":"HorizonGraphLayer","permalink":"/deck.gl-community/examples/infovis-layers/horizon-graph-layer"},"next":{"title":"Advanced","permalink":"/deck.gl-community/examples/editable-layers/advanced"}}');var i=n(4848),r=n(8453),s=n(454),a=n(6540),l=n(9813),d=n(340),c=n(4451);class p extends a.Component{static renderInfo(e){return(0,i.jsx)(i.Fragment,{})}render(){const e=this.props,t=Object.assign({},((0,s.A)(e),e));return(0,i.jsx)(l.A,{children:()=>{const e=n(7244);return(0,i.jsx)(e.Example,Object.assign({},t))}})}}p.title="Editor",p.code=d.lP+"/examples/editable-layers/editor";const u=(0,c.xv)(p),g={},h="Editor",f={},m=[];function y(e){const t={h1:"h1",header:"header",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"editor",children:"Editor"})}),"\n","\n",(0,i.jsx)(u,{})]})}function x(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(y,{...e})}):y(e)}},6467:(e,t,n)=>{"use strict";n.d(t,{P:()=>A});var o=n(9452),i=n(9350),r=n(8095),s=n(8643),a=n(4968);const l={outlineEnabled:!1,outlineRenderShadowmap:!1,outlineShadowmap:null};const d={name:"outline",vs:"#version 300 es\nin float instanceZLevel;\nout float outline_vzLevel;\nout vec4 outline_vPosition;\n\n// Set the z level for the outline shadowmap rendering\nvoid outline_setZLevel(float zLevel) {\n  outline_vzLevel = zLevel;\n}\n\n// Store an adjusted position for texture2DProj\nvoid outline_setUV(vec4 position) {\n  // mat4(\n  //   0.5, 0.0, 0.0, 0.0,\n  //   0.0, 0.5, 0.0, 0.0,\n  //   0.0, 0.0, 0.5, 0.0,\n  //   0.5, 0.5, 0.5, 1.0\n  // ) * position;\n  outline_vPosition = vec4(position.xyz * 0.5 + position.w * 0.5, position.w);\n}\n",fs:"uniform bool outline_uEnabled;\nuniform bool outline_uRenderOutlines;\nuniform sampler2D outline_uShadowmap;\n\nin float outline_vzLevel;\n// in vec2 outline_vUV;\nin vec4 outline_vPosition;\n\nout vec4 fragColor;\n\nconst float OUTLINE_Z_LEVEL_ERROR = 0.01;\n\n// Return a darker color in shadowmap\nvec4 outline_filterShadowColor(vec4 color) {\n  return vec4(outline_vzLevel / 255., outline_vzLevel / 255., outline_vzLevel / 255., 1.);\n}\n\n// Return a darker color if in shadowmap\nvec4 outline_filterDarkenColor(vec4 color) {\n  if (outline_uEnabled) {\n    float maxZLevel;\n    if (outline_vPosition.q > 0.0) {\n      maxZLevel = texture2DProj(outline_uShadowmap, outline_vPosition).r * 255.;\n    } else {\n      discard;\n    }\n    if (maxZLevel < outline_vzLevel + OUTLINE_Z_LEVEL_ERROR) {\n      vec4(color.rgb * 0.5, color.a);\n    } else {\n      discard;\n    }\n  }\n  return color;\n}\n\n// if enabled and rendering outlines - Render depth to shadowmap\n// if enabled and rendering colors - Return a darker color if in shadowmap\n// if disabled, just return color\nvec4 outline_filterColor(vec4 color) {\n  if (outline_uEnabled) {\n    return outline_uRenderOutlines ?\n      outline_filterShadowColor(color) :\n      outline_filterDarkenColor(color);\n  }\n  return color;\n}\n",getUniforms:function(e){let{outlineEnabled:t,outlineRenderShadowmap:n,outlineShadowmap:o}=void 0===e?l:e;const i={};return void 0!==t&&(i.outline_uEnabled=t),void 0!==n&&(i.outline_uRenderOutlines=n),void 0!==o&&(i.outline_uShadowmap=o),i}},c={common:0,meters:1,pixels:2};function p(e){let{source:t,code:n=""}=e;return t.replace(/}[^{}]*$/,n.concat("\n}\n"))}class u extends a.A{constructor(){super(...arguments),this.state=void 0}getShaders(){const e=super.getShaders();return Object.assign({},e,{modules:e.modules.concat([d]),vs:p({source:e.vs,code:"  outline_setUV(gl_Position);\n  outline_setZLevel(instanceZLevel);\n"}),fs:p({source:e.fs,code:"  fragColor = outline_filterColor(fragColor);\n"})})}initializeState(e){super.initializeState(),this.setState({outlineFramebuffer:e.device.createFramebuffer({}),dummyTexture:e.device.createTexture({width:1,height:1})}),this.state.attributeManager.addInstanced({instanceZLevel:{size:1,type:5121,accessor:"getZLevel"}})}draw(e){let{moduleParameters:t={},parameters:n,uniforms:o,context:i}=e;const{jointRounded:r,capRounded:s,billboard:a,miterLimit:l,widthUnits:d,widthScale:p,widthMinPixels:u,widthMaxPixels:g}=this.props;o=Object.assign({},o,{jointType:Number(r),capType:Number(s),billboard:a,widthUnits:c[d],widthScale:p,miterLimit:l,widthMinPixels:u,widthMaxPixels:g});const{outlineFramebuffer:h,dummyTexture:f}=this.state;this.state.model.updateModuleSettings({outlineEnabled:!0,outlineRenderShadowmap:!0,outlineShadowmap:f}),this.state.model.draw({uniforms:Object.assign({},o,{jointType:0,widthScale:1.3*this.props.widthScale}),parameters:{depthTest:!1,blendEquation:32776},framebuffer:h}),this.state.model.updateModuleSettings({outlineEnabled:!0,outlineRenderShadowmap:!1,outlineShadowmap:h}),this.state.model.draw({uniforms:Object.assign({},o,{jointType:Number(r),capType:Number(s),widthScale:this.props.widthScale}),parameters:{depthTest:!1}})}}u.layerName="PathOutlineLayer",u.defaultProps={getZLevel:()=>0};var g=n(5337);class h extends g.V{constructor(e){void 0===e&&(e={}),super(Object.assign({},e,{attributes:f(e),topology:"triangle-list"}))}}function f(e){let{length:t=1,headSize:n=.2,tailWidth:o=.05,tailStart:i=.05}=e;const r=[.5,1,0,.5-n/2,1-n,0,.5+n/2,1-n,0,.5-o/2,i,0,.5+o/2,1-n,0,.5+o/2,i,0,.5-o/2,i,0,.5-o/2,1-n,0,.5+o/2,1-n,0],s=new Array(r.length);for(let a=0;a<r.length/3;a++){const e=3*a;s[e+0]=(r[e+0]-.5)*t,s[e+1]=(r[e+1]-.5)*t,s[e+2]=0}return{positions:{size:3,value:new Float32Array(s)},normals:{size:3,value:new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1])},texCoords:{size:2,value:new Float32Array(r)}}}var m=n(7422);function y(e){let t=0;for(let n=0;n<e.length-1;n++)t+=e[n].distance(e[n+1]);return t}const x=[0,0,0,255],b={forward:!0,backward:!1};function v(e){let{path:t,percentage:n,lineLength:o,color:i,object:r,projectFlat:s}=e;const a=o*n;let l=0,d=0,c=0;for(c=0;c<t.length-1&&(l+=t[c].distance(t[c+1]),!(l>a));c++)d=l;c===t.length-1&&(c-=1);const p=a-d,u=t[c+1].clone().subtract(t[c]).normalize().clone().multiply(new m.I(p,p)).add(t[c]),g=180*new m.I(s(t[c+1])).subtract(s(t[c])).verticalAngle()/Math.PI;return{position:[u.x,u.y,0],angle:g,color:i,object:r}}var C=n(7597),P=n(4901);function w(e){let{p:t,p1:n,p2:o,clampToLine:i=!0}=e;const r=new C.P(o).subtract(n),s=new C.P(t).subtract(n);let a=r.dot(s);return i&&(a=(0,P.qE)(a,0,1)),r.lerp(n,o,a)}const S=s.A,k={mesh:new h({headSize:.2,tailWidth:.05})},_=Object.assign({},u.defaultProps,{MarkerLayer:S,markerLayerProps:k,sizeScale:100,fp64:!1,highlightIndex:-1,highlightPoint:null,getPath:e=>e.path,getColor:e=>e.color,getMarkerColor:e=>[0,0,0,255],getDirection:e=>e.direction,getMarkerPercentages:(e,t)=>{let{lineLength:n}=t;return n>.1?[.25,.5,.75]:[.5]}});class A extends o.A{constructor(){super(...arguments),this.state=void 0}initializeState(){this.state={markers:[],mesh:new h({headSize:.2,tailWidth:.05}),closestPoint:null,closestPoints:[]}}projectFlat(e,t,n,o){if(n===i.rf.METER_OFFSETS){const[n,i]=t.metersToLngLatDelta(e),[r,s]=o;return t.projectFlat([r+n,i+s])}if(n===i.rf.LNGLAT_OFFSETS){const[n,i]=e,[r,s]=o;return t.projectFlat([r+n,i+s])}return t.projectFlat(e)}updateState(e){let{props:t,oldProps:n,changeFlags:o}=e;if(o.dataChanged||o.updateTriggersChanged){const{data:e,getPath:t,getDirection:n,getMarkerColor:o,getMarkerPercentages:i,coordinateSystem:r,coordinateOrigin:s}=this.props,{viewport:a}=this.context,l=e=>this.projectFlat(e,a,r,s);this.state.markers=function(e){let{data:t,getPath:n=(e,t)=>e.path,getDirection:o=e=>e.direction,getColor:i=e=>x,getMarkerPercentages:r=(e,t)=>[.5],projectFlat:s}=e;const a=[];for(const l of t){const e=n(l,null),t=o(l)||b,d=i(l),c=e.map(e=>new m.I(e)),p=c.slice(0).reverse(),u=y(c),g=r(l,{lineLength:u});for(const n of g){if(t.forward){const e=v({path:c,percentage:n,lineLength:u,color:d,object:l,projectFlat:s});a.push(e)}if(t.backward){const e=v({path:p,percentage:n,lineLength:u,color:d,object:l,projectFlat:s});a.push(e)}}}return a}({data:e,getPath:t,getDirection:n,getColor:o,getMarkerPercentages:i,projectFlat:l}),this._recalculateClosestPoint()}o.propsChanged&&t.point!==n.point&&this._recalculateClosestPoint()}_recalculateClosestPoint(){const{highlightPoint:e,highlightIndex:t}=this.props;if(e&&t>=0){const n=this.props.data[t],o=this.props.getPath(n,null),{point:i}=function(e){let{p:t,points:n}=e;t=new C.P(t);let o=null,i=1/0,r=-1;for(let s=0;s<n.length-1;++s){const e=w({p:t,p1:n[s],p2:n[s+1]}),a=t.distanceSquared(e);a<i&&(i=a,o=e,r=s)}return{point:o,index:r,p1:n[r],p2:n[r+1],distanceSquared:i,distance:Math.sqrt(i)}}({points:o,p:e});this.state.closestPoints=[{position:i}]}else this.state.closestPoints=[]}getPickingInfo(e){let{info:t}=e;return Object.assign(t,{object:t.object&&t.object.path||t.object})}renderLayers(){return[new u(this.props,this.getSubLayerProps({id:"paths",data:this.props.data})),new this.props.MarkerLayer(this.getSubLayerProps(Object.assign({},this.props.markerLayerProps,{id:"markers",data:this.state.markers,getOrientation:e=>[0,-e.angle,0],getColor:e=>e.color,sizeScale:this.props.sizeScale,fp64:this.props.fp64,pickable:!1,parameters:{blend:!1,depthTest:!1}}))),this.state.closestPoints&&new r.A({id:this.props.id+"-highlight",data:this.state.closestPoints,fp64:this.props.fp64})]}}A.layerName="PathMarkerLayer",A.defaultProps=_},7244:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Example:()=>v,getDefaultGeoJSON:()=>x});var o=n(6540),i=n(840),r=n(4653),s=n(3724),a=(n(1988),n(4848));function l(e){return(0,a.jsx)("box-icon",Object.assign({color:"currentColor"},e))}const d=s.Ay.div.withConfig({displayName:"toolbox__Tools",componentId:"sc-1q3b1ev-0"})(["position:absolute;display:flex;flex-direction:column;top:10px;",":10px;"],e=>e.left?"left":"right"),c=s.Ay.button.withConfig({displayName:"toolbox__Button",componentId:"sc-1q3b1ev-1"})(["color:#fff;background:",";font-size:1em;font-weight:400;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';border:1px solid transparent;border-radius:0.25em;margin:0.05em;padding:0.1em 0.2em;:hover{background:rgb(128,137,133);}"],e=>{let{kind:t,active:n}=e;return"danger"===t?"rgb(180, 40, 40)":n?"rgb(0, 105, 217)":"rgb(90, 98, 94)"}),p=s.Ay.div.withConfig({displayName:"toolbox__SubToolsContainer",componentId:"sc-1q3b1ev-2"})(["position:relative;"]),u=s.Ay.div.withConfig({displayName:"toolbox__SubTools",componentId:"sc-1q3b1ev-3"})(["display:flex;flex-direction:row-reverse;position:absolute;top:0;",":0;"],e=>e.left?"left":"right"),g=[{modes:[{mode:r.nE,content:(0,a.jsx)(l,{name:"pointer"})}]},{modes:[{mode:r.i_,content:(0,a.jsx)(l,{name:"map-pin"})}]},{modes:[{mode:r.DS,content:(0,a.jsx)(l,{name:"stats"})}]},{modes:[{mode:r.cR,content:(0,a.jsx)(l,{name:"shape-polygon"})},{mode:r.hh,content:(0,a.jsx)(l,{name:"rectangle"})},{mode:r.Zy,content:(0,a.jsx)(l,{name:"circle"})}]},{modes:[{mode:r.L6,content:(0,a.jsx)(l,{name:"ruler"})},{mode:r.Dx,content:(0,a.jsx)(l,{name:"shape-triangle"})},{mode:r.vX,content:(0,a.jsx)(l,{name:"shape-square"})}]}];function h(e){let{buttonConfig:t,mode:n,onClick:o}=e;return(0,a.jsx)(c,{active:t.mode===n,onClick:o,children:t.content})}function f(e){let{left:t,modeGroup:n,mode:i,onSetMode:r}=e;const[s,l]=o.useState(!1),{modes:d}=n;let c=null;s&&(c=(0,a.jsx)(u,{left:t,children:d.map((e,t)=>(0,a.jsx)(h,{buttonConfig:e,mode:i,onClick:()=>{r(()=>e.mode),l(!1)}},t))}));const g=d.find(e=>e.mode===i)||d[0];return(0,a.jsxs)(p,{children:[c,(0,a.jsx)(h,{buttonConfig:g,mode:i,onClick:()=>{r(()=>g.mode),l(!0)}})]})}function m(e){let{left:t=!1,mode:n,modeConfig:i,geoJson:r,onSetMode:s,onSetModeConfig:h,onSetGeoJson:m,onImport:y}=e;const[x,b]=o.useState(!1),[v,C]=o.useState(!1),[P,w]=o.useState(!1),[S,k]=o.useState(!1);return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(d,{left:t,children:[g.map((e,o)=>(0,a.jsx)(f,{left:t,modeGroup:e,mode:n,onSetMode:s},o)),(0,a.jsx)(c,{onClick:()=>w(!0),title:"Export",children:(0,a.jsx)(l,{name:"export"})}),(0,a.jsx)(c,{onClick:()=>C(!0),title:"Import",children:(0,a.jsx)(l,{name:"import"})}),(0,a.jsxs)(p,{children:[x&&(0,a.jsxs)(u,{left:t,children:[(0,a.jsx)(c,{onClick:()=>b(!1),children:(0,a.jsx)(l,{name:"chevron-right"})}),(0,a.jsx)(c,{onClick:()=>h({booleanOperation:"difference"}),active:i&&"difference"===i.booleanOperation,children:(0,a.jsx)(l,{name:"minus-front"})}),(0,a.jsx)(c,{onClick:()=>h({booleanOperation:"union"}),active:i&&"union"===i.booleanOperation,children:(0,a.jsx)(l,{name:"unite"})}),(0,a.jsx)(c,{onClick:()=>h({booleanOperation:"intersection"}),active:i&&"intersection"===i.booleanOperation,children:(0,a.jsx)(l,{name:"intersect"})})]}),(0,a.jsx)(c,{onClick:()=>b(!0),children:(0,a.jsx)(l,{name:"cog"})})]}),(0,a.jsxs)(p,{children:[S&&(0,a.jsxs)(u,{left:t,children:[(0,a.jsxs)(c,{onClick:()=>{m({type:"FeatureCollection",features:[]}),k(!1)},kind:"danger",title:"Clear all features",children:["Clear all features ",(0,a.jsx)(l,{name:"trash"})]}),(0,a.jsx)(c,{onClick:()=>k(!1),children:"Cancel"})]}),(0,a.jsx)(c,{onClick:()=>k(!0),title:"Clear",children:(0,a.jsx)(l,{name:"trash"})})]})]})})}var y=n(5605);function x(){return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[-122.46212548792364,37.79026033616934],[-122.48435831844807,37.77160302698496],[-122.45884849905971,37.74414218845571],[-122.42863676726826,37.76266965836386],[-122.46212548792364,37.79026033616934]]]}},{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[-122.4136573004723,37.78826678755718],[-122.44875601708893,37.782670574261324],[-122.43793598592286,37.74322062447909],[-122.40836932539945,37.75125290412125],[-122.4136573004723,37.78826678755718]]]}}]}}const b={longitude:-122.43,latitude:37.775,zoom:12};function v(){const[e,t]=(0,o.useState)({type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[-122.46212548792364,37.79026033616934],[-122.48435831844807,37.77160302698496],[-122.45884849905971,37.74414218845571],[-122.42863676726826,37.76266965836386],[-122.46212548792364,37.79026033616934]]]}},{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[-122.4136573004723,37.78826678755718],[-122.44875601708893,37.782670574261324],[-122.43793598592286,37.74322062447909],[-122.40836932539945,37.75125290412125],[-122.4136573004723,37.78826678755718]]]}}]}),[n,s]=(0,o.useState)([0]),[l,d]=(0,o.useState)(()=>r.nE),[c,p]=(0,o.useState)({}),u=new r.Tp({data:e,mode:l,modeConfig:c,selectedFeatureIndexes:n,onEdit:e=>{let{updatedData:n}=e;t(n)}});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.A,{initialViewState:b,controller:{doubleClickZoom:!1},layers:[u],getCursor:u.getCursor.bind(u),onClick:e=>{l===r.nE&&s(e?[e.index]:[])},children:(0,a.jsx)(y.Ay,{mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json"})}),(0,a.jsx)(m,{left:!0,geoJson:e,mode:l,modeConfig:c,onSetMode:d,onSetModeConfig:p,onImport:n=>t(Object.assign({},e,{features:[...e.features,...n.features]})),onSetGeoJson:t})]})}}}]);