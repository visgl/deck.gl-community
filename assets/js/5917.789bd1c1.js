"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[5917],{185:(e,t,n)=>{n.d(t,{WebGLDevice:()=>C});var r=n(83909),s=n(29651),i=n(62088),o=n(20966),a=n(58587),c=n(93948),l=n(47095),u=n(99273),h=n(25299),d=n(67483),f=n(21719),p=n(30983),g=n(2919),_=n(62372),m=n(62477),v=n(85450),b=n(7638),y=n(99616),E=n(15477),w=n(38591),x=n(95561),T=n(28176),A=n(34782),S=n(83593),R=n(90539),I=n(68643);class C extends r.pF{type="webgl";handle;features;limits;info;canvasContext;preferredColorFormat="rgba8unorm";preferredDepthFormat="depth24plus";commandEncoder;lost;_resolveContextLost;gl;_constants;_extensions={};_polyfilled=!1;spectorJS;get[Symbol.toStringTag](){return"WebGLDevice"}toString(){return`${this[Symbol.toStringTag]}(${this.id})`}isVertexFormatSupported(e){return"unorm8x4-bgra"!==e}constructor(e){super({...e,id:e.id||(0,p.L)("webgl-device")});const t=r.pF._getCanvasContextProps(e);if(!t)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let n=t.canvas?.gl?.device;if(n)throw new Error(`WebGL context already attached to device ${n.id}`);this.canvasContext=new u.X(this,t),this.lost=new Promise(e=>{this._resolveContextLost=e});const f={...e.webgl};"premultiplied"===t.alphaMode&&(f.premultipliedAlpha=!0),void 0!==e.powerPreference&&(f.powerPreference=e.powerPreference);const g=this.props._handle||(0,o.e)(this.canvasContext.canvas,{onContextLost:e=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:e=>console.log("WebGL context restored")},f);if(!g)throw new Error("WebGL context creation failed");if(n=g.device,n){if(e._reuseDevices)return s.R.log(1,`Not creating a new Device, instead returning a reference to Device ${n.id} already attached to WebGL context`,n)(),n._reused=!0,n;throw new Error(`WebGL context already attached to device ${n.id}`)}this.handle=g,this.gl=g,this.spectorJS=(0,h.k2)({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=(0,a.N)(this.gl,this._extensions),this.limits=new l.K(this.gl),this.features=new c.l(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures();new i.J(this.gl,{log:(...e)=>s.R.log(1,...e)()}).trackState(this.gl,{copyState:!1});const _=e.debugWebGL||e.debug,m=e.debugWebGL;_&&(this.gl=(0,d.l)(this.gl,{debugWebGL:_,traceWebGL:m}),s.R.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(s.R.level=Math.max(s.R.level,1))),this.commandEncoder=new E.v(this,{id:`${this}-command-encoder`})}destroy(){this.props._reuseDevices||this._reused||delete this.gl.device}get isLost(){return this.gl.isContextLost()}getTextureByteAlignment(){return 4}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const t=this._normalizeBufferProps(e);return new g.K(this,t)}createTexture(e){return new v.d_(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new m.e(this,e)}createShader(e){return new _.l(this,e)}createFramebuffer(e){return new b.h(this,e)}createVertexArray(e){return new w.d(this,e)}createTransformFeedback(e){return new x.R(this,e)}createQuerySet(e){return new T.U(this,e)}createRenderPipeline(e){return new y.G(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}createCommandEncoder(e={}){return new E.v(this,e)}submit(e){e||(e=this.commandEncoder.finish(),this.commandEncoder.destroy(),this.commandEncoder=this.createCommandEncoder({id:`${this.id}-default-encoder`})),e._executeCommands()}readPixelsToArrayWebGL(e,t){return(0,A.sy)(e,t)}readPixelsToBufferWebGL(e,t){return(0,A.fY)(e,t)}setParametersWebGL(e){(0,S.wb)(this.gl,e)}getParametersWebGL(e){return(0,S.OO)(this.gl,e)}withParametersWebGL(e,t){return(0,R.O)(this.gl,e,t)}resetWebGL(){s.R.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),(0,S.Fh)(this.gl)}_getDeviceSpecificTextureFormatCapabilities(e){return(0,f.o5)(this.gl,e,this._extensions)}loseDevice(){let e=!1;const t=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return t&&(e=!0,t.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){i.J.get(this.gl).push()}popState(){i.J.get(this.gl).pop()}getGLKey(e,t){const n=Number(e);for(const r in this.gl)if(this.gl[r]===n)return`GL.${r}`;return t?.emptyIfUnknown?"":String(e)}getGLKeys(e){const t={emptyIfUnknown:!0};return Object.entries(e).reduce((e,[n,r])=>(e[`${n}:${this.getGLKey(n,t)}`]=`${r}:${this.getGLKey(r,t)}`,e),{})}setConstantAttributeWebGL(e,t){const n=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(n).fill(null);const r=this._constants[e];switch(r&&function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(r,t)&&s.R.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=t,t.constructor){case Float32Array:!function(e,t,n){switch(n.length){case 1:e.gl.vertexAttrib1fv(t,n);break;case 2:e.gl.vertexAttrib2fv(t,n);break;case 3:e.gl.vertexAttrib3fv(t,n);break;case 4:e.gl.vertexAttrib4fv(t,n)}}(this,e,t);break;case Int32Array:!function(e,t,n){e.gl.vertexAttribI4iv(t,n)}(this,e,t);break;case Uint32Array:!function(e,t,n){e.gl.vertexAttribI4uiv(t,n)}(this,e,t);break;default:throw new Error("constant")}}getExtension(e){return(0,I.T)(this.gl,e,this._extensions),this._extensions}_setWebGLDebugMetadata(e,t,n){e.luma=t;const r={props:n.spector,id:n.spector.id};e.__SPECTOR_Metadata=r}}},327:(e,t,n)=>{n.d(t,{H:()=>a});var r=n(8521),s=n(90405),i=n(73968),o=n(89664);async function a(e,t,n,a){let c,l;Array.isArray(t)||(0,s.l)(t)?(c=t,l=n):(c=[],l=t);const u=(0,i.z)(l);let h=e;return"string"==typeof e&&(h=await u(e)),(0,r.qf)(e)&&(h=await u(e)),Array.isArray(c),await(0,o.q)(h,c,l)}},1035:(e,t,n)=>{n.d(t,{O1:()=>c});var r=n(69833),s=n(8521),i=n(5755),o=n(46555);const a="Cannot convert supplied data type";async function c(e,t,n){const c=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"==typeof e||c)return function(e,t){if(t.text&&"string"==typeof e)return e;if((0,s.Pe)(e)&&(e=e.buffer),e instanceof ArrayBuffer){const n=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let n=e.buffer;const r=e.byteLength||e.length;return 0===e.byteOffset&&r===n.byteLength||(n=n.slice(e.byteOffset,e.byteOffset+r)),n}throw new Error(a)}(e,t);if((0,s.qf)(e)&&(e=await(0,o.wv)(e)),(0,s.Sv)(e)){const n=e;return await(0,o.Mz)(n),t.binary?await n.arrayBuffer():await n.text()}if((0,s.H1)(e)&&(e=(0,i.l)(e,n)),(0,s.xZ)(e)||(0,s.Td)(e))return(0,r.cy)(e);throw new Error(a)}},1069:(e,t,n)=>{n.d(t,{Lk:()=>c,Y5:()=>i,bj:()=>o,m$:()=>a,ol:()=>s});var r=n(72246);function s(e){switch(e){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return(0,r.Ak)(e)}}const i=r.h1;function o(e,t,n){const r="webgpu"===n&&"uint8"===t.type?"unorm8":t.type;return{attribute:e,format:t.size>1?`${r}x${t.size}`:t.type,byteOffset:t.offset||0}}function a(e){return e.stride||e.size*e.bytesPerElement}function c(e,t){return e.type===t.type&&e.size===t.size&&a(e)===a(t)&&(e.offset||0)===(t.offset||0)}},1351:(e,t,n)=>{n.d(t,{M:()=>f});var r=n(52027),s=n(10048),i=n(49987),o=n(90405),a=n(72548),c=n(42221),l=n(5223),u=n(8521),h=n(28071);const d=/\.([^.]+)$/;async function f(e,t=[],n,r){if(!g(e))return null;let s=p(e,t,{...n,nothrow:!0},r);if(s)return s;if((0,u.qf)(e)&&(s=p(e=await e.slice(0,10).arrayBuffer(),t,n,r)),!s&&!n?.nothrow)throw new Error(_(e));return s}function p(e,t=[],n,s){if(!g(e))return null;if(t&&!Array.isArray(t))return(0,o.D)(t);let i=[];t&&(i=i.concat(t)),n?.ignoreRegisteredLoaders||i.push(...(0,l.Ph)()),function(e){for(const t of e)(0,o.D)(t)}(i);const c=function(e,t,n,s){const i=(0,a.Al)(e),o=(0,a.z4)(e),c=(0,h.S3)(i)||s?.url;let l=null,u="";n?.mimeType&&(l=m(t,n?.mimeType),u=`match forced by supplied MIME type ${n?.mimeType}`);l=l||function(e,t){const n=t&&d.exec(t),r=n&&n[1];return r?function(e,t){t=t.toLowerCase();for(const n of e)for(const e of n.extensions)if(e.toLowerCase()===t)return n;return null}(e,r):null}(t,c),u=u||(l?`matched url ${c}`:""),l=l||m(t,o),u=u||(l?`matched MIME type ${o}`:""),l=l||function(e,t){if(!t)return null;for(const n of e)if("string"==typeof t){if(v(t,n))return n}else if(ArrayBuffer.isView(t)){if(b(t.buffer,t.byteOffset,n))return n}else if(t instanceof ArrayBuffer){if(b(t,0,n))return n}return null}(t,e),u=u||(l?`matched initial data ${y(e)}`:""),n?.fallbackMimeType&&(l=l||m(t,n?.fallbackMimeType),u=u||(l?`matched fallback MIME type ${o}`:""));u&&r.R.log(1,`selectLoader selected ${l?.name}: ${u}.`);return l}(e,i,n,s);if(!c&&!n?.nothrow)throw new Error(_(e));return c}function g(e){return!(e instanceof Response&&204===e.status)}function _(e){const t=(0,a.Al)(e),n=(0,a.z4)(e);let r="No valid loader found (";r+=t?`${i.iW(t)}, `:"no url provided, ",r+=`MIME type: ${n?`"${n}"`:"not provided"}, `;const s=e?y(e):"";return r+=s?` first bytes: "${s}"`:"first bytes: not available",r+=")",r}function m(e,t){for(const n of e){if(n.mimeTypes?.some(e=>(0,c.JQ)(t,e)))return n;if((0,c.JQ)(t,`application/x.${n.id}`))return n}return null}function v(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some(t=>e.startsWith(t))}function b(e,t,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(n=>function(e,t,n,r){if(r instanceof ArrayBuffer)return(0,s.YV)(r,e,r.byteLength);switch(typeof r){case"function":return r(e);case"string":return r===E(e,t,r.length);default:return!1}}(e,t,0,n))}function y(e,t=5){if("string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return E(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return E(e,0,t)}return""}function E(e,t,n){if(e.byteLength<t+n)return"";const r=new DataView(e);let s="";for(let i=0;i<n;i++)s+=String.fromCharCode(r.getUint8(t+i));return s}},1635:(e,t,n)=>{n.d(t,{$:()=>s});const r={number:{type:"number",validate:(e,t)=>Number.isFinite(e)&&"object"==typeof t&&(void 0===t.max||e<=t.max)&&(void 0===t.min||e>=t.min)},array:{type:"array",validate:(e,t)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function s(e){const t={};for(const[n,r]of Object.entries(e))t[n]=i(r);return t}function i(e){let t=o(e);if("object"!==t)return{value:e,...r[t],type:t};if("object"==typeof e)return e?void 0!==e.type?{...e,...r[e.type],type:e.type}:void 0===e.value?{type:"object",value:e}:(t=o(e.value),{...e,...r[t],type:t}):{type:"object",value:null};throw new Error("props")}function o(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}},2021:(e,t,n)=>{n.d(t,{M:()=>a,P:()=>o});var r=n(29651),s=n(86231),i=n(77933);function o(e,t){const n={};for(const r of e.attributes){const s=c(e,t,r.name);s&&(n[r.name]=s)}return n}function a(e,t,n=16){const r=o(e,t),s=new Array(n).fill(null);for(const i of Object.values(r))s[i.location]=i;return s}function c(e,t,n){const o=function(e,t){const n=e.attributes.find(e=>e.name===t);n||r.R.warn(`shader layout attribute "${t}" not present in shader`);return n||null}(e,n),a=function(e,t){l(e);let n=function(e,t){for(const n of e)if(n.format&&n.name===t)return{attributeName:n.name,bufferName:t,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}(e,t);if(n)return n;if(n=function(e,t){for(const n of e){let e=n.byteStride;if("number"!=typeof n.byteStride)for(const t of n.attributes||[]){e+=(0,i.yx)(t.format).byteLength}const r=n.attributes?.find(e=>e.attribute===t);if(r)return{attributeName:r.attribute,bufferName:n.name,stepMode:n.stepMode,vertexFormat:r.format,byteOffset:r.byteOffset,byteStride:e}}return null}(e,t),n)return n;return r.R.warn(`layout for attribute "${t}" not present in buffer layout`),null}(t,n);if(!o)return null;const c=(0,s.wH)(o.type),u=(0,i.Mz)(c),h=a?.vertexFormat||u,d=(0,i.yx)(h);return{attributeName:a?.attributeName||o.name,bufferName:a?.bufferName||o.name,location:o.location,shaderType:o.type,primitiveType:c.primitiveType,shaderComponents:c.components,vertexFormat:h,bufferDataType:d.type,bufferComponents:d.components,normalized:d.normalized,integer:c.integer,stepMode:a?.stepMode||o.stepMode||"vertex",byteOffset:a?.byteOffset||0,byteStride:a?.byteStride||0}}function l(e){for(const t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&r.R.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}},2047:(e,t,n)=>{n.d(t,{l:()=>s});var r=n(77264);function s(e){return e&r.g.Cancelled?"cancel":e&r.g.Ended?"end":e&r.g.Changed?"move":e&r.g.Began?"start":""}},2357:(e,t,n)=>{n.d(t,{A:()=>r});class r{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}},2776:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(68475),s=n(88679),i=n(15896);class o extends i.${constructor({device:e,attribute:t,timeline:n}){super({device:e,attribute:t,timeline:n}),this.type="spring",this.texture=function(e){return e.createTexture({data:new Uint8Array(4),format:"rgba8unorm",width:1,height:1})}(e),this.framebuffer=function(e,t){return e.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[t]})}(e,this.texture),this.transform=function(e,t){const n=(0,s.A3)(t.size),i=(0,s.ro)(t.size);return new r.p(e,{vs:c,fs:l,bufferLayout:[{name:"aPrev",format:i},{name:"aCur",format:i},{name:"aTo",format:t.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[a],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}(e,t)}start(e,t){const n=this.currentLength,r=this.currentStartIndices;super.start(e,t);const{buffers:i,attribute:o}=this;for(let c=0;c<2;c++)i[c]=(0,s.aI)({device:this.device,buffer:i[c],attribute:o,fromLength:n,toLength:this.currentLength,fromStartIndices:r,getData:e.enter});i[2]=(0,s.Sg)({device:this.device,source:i[0],target:i[2]}),this.setBuffer(i[1]);const{model:a}=this.transform;a.setVertexCount(Math.floor(this.currentLength/o.size)),o.isConstant?a.setConstantAttributes({aTo:o.value}):a.setAttributes({aTo:o.getBuffer()})}onUpdate(){const{buffers:e,transform:t,framebuffer:n,transition:r}=this,i=this.settings;t.model.setAttributes({aPrev:e[0],aCur:e[1]}),t.transformFeedback.setBuffers({vNext:e[2]});const o={stiffness:i.stiffness,damping:i.damping};t.model.shaderInputs.setProps({spring:o}),t.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),(0,s.yY)(e),this.setBuffer(e[1]);this.device.readPixelsToArrayWebGL(n)[0]>0||r.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const a={name:"spring",vs:"uniform springUniforms {\n  float damping;\n  float stiffness;\n} spring;\n",uniformTypes:{damping:"f32",stiffness:"f32"}},c="#version 300 es\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nin ATTRIBUTE_TYPE aPrev;\nin ATTRIBUTE_TYPE aCur;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vNext;\nout float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE force = delta * spring.stiffness;\n  ATTRIBUTE_TYPE resistance = velocity * spring.damping;\n  return force - resistance + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",l="#version 300 es\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nin float vIsTransitioningFlag;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  fragColor = vec4(1.0);\n}"},2919:(e,t,n)=>{n.d(t,{K:()=>s});var r=n(26839);class s extends r.h{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength=0;bytesUsed=0;constructor(e,t={}){super(e,t),this.device=e,this.gl=this.device.gl;const n="object"==typeof t?t.handle:void 0;this.handle=n||this.gl.createBuffer(),e._setWebGLDebugMetadata(this.handle,this,{spector:{...this.props,data:typeof this.props.data}}),this.glTarget=function(e){if(e&r.h.INDEX)return 34963;if(e&r.h.VERTEX)return 34962;if(e&r.h.UNIFORM)return 35345;return 34962}(this.props.usage),this.glUsage=function(e){if(e&r.h.INDEX)return 35044;if(e&r.h.VERTEX)return 35044;if(e&r.h.UNIFORM)return 35048;return 35044}(this.props.usage),this.glIndexType="uint32"===this.props.indexType?5125:5123,t.data?this._initWithData(t.data,t.byteOffset,t.byteLength):this._initWithByteLength(t.byteLength||0)}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}_initWithData(e,t=0,n=e.byteLength+t){const r=this.glTarget;this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.glUsage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(e,t,n),this.trackAllocatedMemory(n)}_initWithByteLength(e){let t=e;0===e&&(t=new Float32Array(0));const n=this.glTarget;return this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,t,this.glUsage),this.gl.bindBuffer(n,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}write(e,t=0){const n=ArrayBuffer.isView(e)?e:new Uint8Array(e),r=36663;this.gl.bindBuffer(r,this.handle),this.gl.bufferSubData(r,t,n),this.gl.bindBuffer(r,null),this._setDebugData(e,t,e.byteLength)}async mapAndWriteAsync(e,t=0,n=this.byteLength-t){const r=new ArrayBuffer(n);await e(r,"copied"),this.write(r,t)}async readAsync(e=0,t){return this.readSyncWebGL(e,t)}async mapAndReadAsync(e,t=0,n){const r=await this.readAsync(t,n);return await e(r.buffer,"copied")}readSyncWebGL(e=0,t){t=t??this.byteLength-e;const n=new Uint8Array(t);return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,n,0,t),this.gl.bindBuffer(36662,null),this._setDebugData(n,e,t),n}}},3065:(e,t,n)=>{n.d(t,{A:()=>s});const r="#define SMOOTH_EDGE_RADIUS 0.5",s={name:"geometry",source:"const SMOOTH_EDGE_RADIUS: f32 = 0.5;\n\nstruct VertexGeometry {\n  position: vec4<f32>,\n  worldPosition: vec3<f32>,\n  worldPositionAlt: vec3<f32>,\n  normal: vec3<f32>,\n  uv: vec2<f32>,\n  pickingColor: vec3<f32>,\n};\n\nvar<private> geometry_: VertexGeometry = VertexGeometry(\n  vec4<f32>(0.0, 0.0, 1.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0),\n  vec2<f32>(0.0, 0.0),\n  vec3<f32>(0.0, 0.0, 0.0)\n);\n\nstruct FragmentGeometry {\n  uv: vec2<f32>,\n};\n\nvar<private> fragmentGeometry: FragmentGeometry;\n\nfn smoothedge(edge: f32, x: f32) -> f32 {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n",vs:`${r}\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n`,fs:`${r}\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n`}},3459:(e,t,n)=>{n.d(t,{A:()=>r});const r=new(n(39965).t)({id:"deck"})},3481:(e,t,n)=>{n.d(t,{K2:()=>o,a5:()=>c,pp:()=>a});var r=n(8521),s=n(10875),i=n(10388);function o(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function a(){const e=o();return e.globalOptions=e.globalOptions||{...i.f},e.globalOptions}function c(e,t,n,r){return n=n||[],function(e,t){l(e,null,i.f,i.W,t);for(const n of t){const r=e&&e[n.id]||{},s=n.options&&n.options[n.id]||{},i=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};l(r,n.id,s,i,t)}}(e,n=Array.isArray(n)?n:[n]),h(t,e,r)}function l(e,t,n,i,o){const a=t||"Top level",c=t?`${t}.`:"";for(const l in e){const h=!t&&(0,r.Gv)(e[l]);if(!(l in n)&&!("baseUri"===l&&!t)&&!("workerUrl"===l&&t))if(l in i)s.vB.warn(`${a} loader option '${c}${l}' no longer supported, use '${i[l]}'`)();else if(!h){const e=u(l,o);s.vB.warn(`${a} loader option '${c}${l}' not recognized. ${e}`)()}}}function u(e,t){const n=e.toLowerCase();let r="";for(const s of t)for(const t in s.options){if(e===t)return`Did you mean '${s.id}.${t}'?`;const i=t.toLowerCase();(n.startsWith(i)||i.startsWith(n))&&(r=r||`Did you mean '${s.id}.${t}'?`)}return r}function h(e,t,n){const r={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(r,n),null===r.log&&(r.log=new s.sq),d(r,a()),d(r,t),r}function d(e,t){for(const n in t)if(n in t){const s=t[n];(0,r.aC)(s)&&(0,r.aC)(e[n])?e[n]={...e[n],...t[n]}:e[n]=t[n]}}},3593:(e,t,n)=>{function r(e,t){if(e===t)return!0;if(s(e)&&s(t)&&e.length===t.length){for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}return!1}function s(e){return Array.isArray(e)||ArrayBuffer.isView(e)}n.d(t,{Q:()=>r})},3726:(e,t,n)=>{n.d(t,{K:()=>i});let r=1,s=1;class i{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){const{delay:t=0,duration:n=Number.POSITIVE_INFINITY,rate:s=1,repeat:i=1}=e,o=r++,a={time:0,delay:t,duration:n,rate:s,repeat:i};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,n]of this.animations)n.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const n=this.animations.values();for(const r of n){const{animation:e,channel:t}=r;e.setTime(this.getTime(t))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const n=s++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const n=t-e.delay;n>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}},4360:(e,t,n)=>{n.d(t,{xv:()=>r});const r="4.1.0"},4500:(e,t,n)=>{n.d(t,{L:()=>s});const r={};function s(e="id"){r[e]=r[e]||1;return`${e}-${r[e]++}`}},4990:(e,t,n)=>{function r(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}n.d(t,{v:()=>r})},5139:(e,t,n)=>{n.d(t,{qG:()=>g});const r="texture-compression-bc",s="texture-compression-astc",i="texture-compression-etc2",o="texture-compression-pvrtc-webgl",a="texture-compression-atc-webgl",c="float32-renderable-webgl",l="float16-renderable-webgl",u="snorm8-renderable-webgl",h="norm16-renderable-webgl",d="snorm16-renderable-webgl",f="float32-filterable",p="float16-filterable-webgl";function g(e){const t=_[e];if(!t)throw new Error(`Unsupported texture format ${e}`);return t}const _={...{r8unorm:{},rg8unorm:{},"rgb8unorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},r8snorm:{render:u},rg8snorm:{render:u},"rgb8snorm-webgl":{},rgba8snorm:{render:u},r8uint:{},rg8uint:{},rgba8uint:{},r8sint:{},rg8sint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},r16unorm:{f:h},rg16unorm:{render:h},"rgb16unorm-webgl":{f:h},rgba16unorm:{render:h},r16snorm:{f:d},rg16snorm:{render:d},"rgb16snorm-webgl":{f:h},rgba16snorm:{render:d},r16uint:{},rg16uint:{},rgba16uint:{},r16sint:{},rg16sint:{},rgba16sint:{},r16float:{render:l,filter:"float16-filterable-webgl"},rg16float:{render:l,filter:p},rgba16float:{render:l,filter:p},r32uint:{},rg32uint:{},rgba32uint:{},r32sint:{},rg32sint:{},rgba32sint:{},r32float:{render:c,filter:f},rg32float:{render:!1,filter:f},"rgb32float-webgl":{render:c,filter:f},rgba32float:{render:c,filter:f},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},rgb9e5ufloat:{channels:"rgb",packed:!0,render:"rgb9e5ufloat-renderable-webgl"},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:c},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},rgb10a2uint:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0}},...{"bc1-rgb-unorm-webgl":{f:r},"bc1-rgb-unorm-srgb-webgl":{f:r},"bc1-rgba-unorm":{f:r},"bc1-rgba-unorm-srgb":{f:r},"bc2-rgba-unorm":{f:r},"bc2-rgba-unorm-srgb":{f:r},"bc3-rgba-unorm":{f:r},"bc3-rgba-unorm-srgb":{f:r},"bc4-r-unorm":{f:r},"bc4-r-snorm":{f:r},"bc5-rg-unorm":{f:r},"bc5-rg-snorm":{f:r},"bc6h-rgb-ufloat":{f:r},"bc6h-rgb-float":{f:r},"bc7-rgba-unorm":{f:r},"bc7-rgba-unorm-srgb":{f:r},"etc2-rgb8unorm":{f:i},"etc2-rgb8unorm-srgb":{f:i},"etc2-rgb8a1unorm":{f:i},"etc2-rgb8a1unorm-srgb":{f:i},"etc2-rgba8unorm":{f:i},"etc2-rgba8unorm-srgb":{f:i},"eac-r11unorm":{f:i},"eac-r11snorm":{f:i},"eac-rg11unorm":{f:i},"eac-rg11snorm":{f:i},"astc-4x4-unorm":{f:s},"astc-4x4-unorm-srgb":{f:s},"astc-5x4-unorm":{f:s},"astc-5x4-unorm-srgb":{f:s},"astc-5x5-unorm":{f:s},"astc-5x5-unorm-srgb":{f:s},"astc-6x5-unorm":{f:s},"astc-6x5-unorm-srgb":{f:s},"astc-6x6-unorm":{f:s},"astc-6x6-unorm-srgb":{f:s},"astc-8x5-unorm":{f:s},"astc-8x5-unorm-srgb":{f:s},"astc-8x6-unorm":{f:s},"astc-8x6-unorm-srgb":{f:s},"astc-8x8-unorm":{f:s},"astc-8x8-unorm-srgb":{f:s},"astc-10x5-unorm":{f:s},"astc-10x5-unorm-srgb":{f:s},"astc-10x6-unorm":{f:s},"astc-10x6-unorm-srgb":{f:s},"astc-10x8-unorm":{f:s},"astc-10x8-unorm-srgb":{f:s},"astc-10x10-unorm":{f:s},"astc-10x10-unorm-srgb":{f:s},"astc-12x10-unorm":{f:s},"astc-12x10-unorm-srgb":{f:s},"astc-12x12-unorm":{f:s},"astc-12x12-unorm-srgb":{f:s},"pvrtc-rgb4unorm-webgl":{f:o},"pvrtc-rgba4unorm-webgl":{f:o},"pvrtc-rbg2unorm-webgl":{f:o},"pvrtc-rgba2unorm-webgl":{f:o},"etc1-rbg-unorm-webgl":{f:"texture-compression-etc1-webgl"},"atc-rgb-unorm-webgl":{f:a},"atc-rgba-unorm-webgl":{f:a},"atc-rgbai-unorm-webgl":{f:a}}}},5147:(e,t,n)=>{function r(e){return(e.ownerDocument||e).defaultView}n.d(t,{S:()=>r})},5153:(e,t,n)=>{n.d(t,{F:()=>s});var r=n(74683);class s{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,t,n){if(!e)throw new Error("no device");this._device=e,this.props=function(e,t){const n={...t};for(const r in e)void 0!==e[r]&&(n[r]=e[r]);return n}(t,n);const s="undefined"!==this.props.id?this.props.id:(0,r.L)(this[Symbol.toStringTag]);this.props.id=s,this.id=s,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get(`${t}s Active`).decrementCount()}trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(e),n.get(`${t} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}}},5223:(e,t,n)=>{n.d(t,{Ph:()=>a,mk:()=>o});var r=n(90405),s=n(3481);const i=()=>{const e=(0,s.K2)();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function o(e){const t=i();e=Array.isArray(e)?e:[e];for(const n of e){const e=(0,r.D)(n);t.find(t=>e===t)||t.unshift(e)}}function a(){return i()}},5689:(e,t,n)=>{n.d(t,{F:()=>s});var r=n(88171);function s(e,t){const n=t.center;let s=e.offsetDelta,i=e.prevDelta;const o=e.prevInput;return t.eventType!==r.TL.Start&&o?.eventType!==r.TL.End||(i=e.prevDelta={x:o?.deltaX||0,y:o?.deltaY||0},s=e.offsetDelta={x:n.x,y:n.y}),{deltaX:i.x+(n.x-s.x),deltaY:i.y+(n.y-s.y)}}},5755:(e,t,n)=>{n.d(t,{l:()=>c});var r=n(49243),s=n(87022),i=n(83701),o=n(33808),a=n(8521);function c(e,t){if("string"==typeof e)return(0,r.Y)(e,t);if(e instanceof ArrayBuffer)return(0,s.A)(e,t);if((0,a.qf)(e))return(0,i.u)(e,t);if((0,a.H1)(e))return(0,o.r)(e,t);if((0,a.Sv)(e)){const n=e;return(0,o.r)(n.body,t)}throw new Error("makeIterator")}},5993:(e,t,n)=>{function r(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}n.d(t,{v:()=>r})},6895:(e,t,n)=>{n.d(t,{M:()=>s});var r=n(5153);class s extends r.F{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,s.defaultProps)}static defaultProps={...r.F.defaultProps}}},7480:(e,t,n)=>{n.d(t,{N:()=>s});let r=1;function s(){return r++}},7638:(e,t,n)=>{n.d(t,{h:()=>i});var r=n(74918),s=n(21719);class i extends r.G{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,t){super(e,t);const n=null===t.handle;this.device=e,this.gl=e.gl,this.handle=this.props.handle||n?this.props.handle:this.gl.createFramebuffer(),n||(e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),this.destroyed||null===this.handle||this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let t=0;t<this.colorAttachments.length;++t){const e=this.colorAttachments[t];if(e){const n=36064+t;this._attachTextureView(n,e)}}if(this.depthStencilAttachment){const e=(0,s.ql)(this.depthStencilAttachment.props.format);this._attachTextureView(e,this.depthStencilAttachment)}if(this.device.props.debug){const e=this.gl.checkFramebufferStatus(36160);if(36053!==e)throw new Error(`Framebuffer ${function(e){switch(e){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${e}`}}(e)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,t){const{gl:n}=this.device,{texture:r}=t,s=t.props.baseMipLevel,i=t.props.baseArrayLayer;switch(n.bindTexture(r.glTarget,r.handle),r.glTarget){case 35866:case 32879:n.framebufferTextureLayer(36160,e,r.handle,s,i);break;case 34067:const t=function(e){return e<34069?e+34069:e}(i);n.framebufferTexture2D(36160,e,t,r.handle,s);break;case 3553:n.framebufferTexture2D(36160,e,3553,r.handle,s);break;default:throw new Error("Illegal texture type")}n.bindTexture(r.glTarget,null)}}},7914:(e,t,n)=>{function r(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let s=0;s<e.length;s++)if(!r(e[s],t[s],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"==typeof e&&"object"==typeof t){const s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(const o of s){if(!t.hasOwnProperty(o))return!1;if(!r(e[o],t[o],n-1))return!1}return!0}return!1}n.d(t,{b:()=>r})},8036:(e,t,n)=>{n.d(t,{A:()=>r});class r{constructor(e,t={id:"pass"}){const{id:n}=t;this.id=n,this.device=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}},8199:(e,t,n)=>{n.d(t,{K:()=>s});const r={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function s(e,t){if(!e)return null;Number.isFinite(e)&&(e={type:"interpolation",duration:e});const n=e.type||"interpolation";return{...r[n],...t,...e,type:n}}},8521:(e,t,n)=>{n.d(t,{Gv:()=>i,H1:()=>d,Pe:()=>h,Sv:()=>l,Td:()=>c,aC:()=>o,qf:()=>u,xZ:()=>a});const r=e=>"boolean"==typeof e,s=e=>"function"==typeof e,i=e=>null!==e&&"object"==typeof e,o=e=>i(e)&&e.constructor==={}.constructor,a=e=>Boolean(e)&&"function"==typeof e[Symbol.iterator],c=e=>e&&"function"==typeof e[Symbol.asyncIterator],l=e=>"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,u=e=>"undefined"!=typeof Blob&&e instanceof Blob,h=e=>e&&"object"==typeof e&&e.isBuffer,d=e=>(e=>"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||i(e)&&s(e.tee)&&s(e.cancel)&&s(e.getReader))(e)||(e=>i(e)&&s(e.read)&&s(e.pipe)&&r(e.readable))(e)},8965:(e,t,n)=>{function r(e){switch(e?.gpu.toLowerCase()){case"apple":return"#define APPLE_GPU\n// Apple optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Headless Chrome's software shader 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// If the GPU doesn't have full 32 bits precision, will causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}n.d(t,{B:()=>r})},9241:(e,t,n)=>{n.d(t,{Cx:()=>i.o,e8:()=>r.e8,h1:()=>a.l,mS:()=>s.m,uq:()=>o.o});var r=n(88171),s=(n(77264),n(86482)),i=(n(69258),n(76280),n(44860),n(36157),n(19380)),o=n(57662),a=(n(98763),n(39769));n(32126),n(86798)},9350:(e,t,n)=>{n.d(t,{Kx:()=>o,We:()=>l,p5:()=>a,rf:()=>i,tg:()=>c});var r=n(3459),s=n(18511);const i={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(i,"IDENTITY",{get:()=>(r.A.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const o={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},a={common:0,meters:1,pixels:2},c={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},l={multipan:[s.uq,{threshold:10,direction:s.e8.Vertical,pointers:2}],pinch:[s.h1,{},null,["multipan"]],pan:[s.uq,{threshold:1},["pinch"],["multipan"]],dblclick:[s.Cx,{event:"dblclick",taps:2}],click:[s.Cx,{event:"click"},null,["dblclick"]]}},10048:(e,t,n)=>{function r(e,t,n){if(n=n||e.byteLength,e.byteLength<n||t.byteLength<n)return!1;const r=new Uint8Array(e),s=new Uint8Array(t);for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}function s(...e){return function(e){const t=e.map(e=>e instanceof ArrayBuffer?new Uint8Array(e):e),n=t.reduce((e,t)=>e+t.byteLength,0),r=new Uint8Array(n);let s=0;for(const i of t)r.set(i,s),s+=i.byteLength;return r.buffer}(e)}n.d(t,{AQ:()=>s,YV:()=>r})},10062:(e,t,n)=>{n.d(t,{U:()=>i});const r="count(): argument not an object",s="count(): argument not a container";function i(e){if(null===(t=e)||"object"!=typeof t)throw new Error(r);var t;if("function"==typeof e.count)return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(function(e){return null!==e&&"object"==typeof e&&e.constructor===Object}(e))return Object.keys(e).length;throw new Error(s)}},10388:(e,t,n)=>{n.d(t,{W:()=>i,f:()=>s});var r=n(47612);const s={fetch:null,mimeType:void 0,nothrow:!1,log:new(n(10875).wN),useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:r.Bd,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},i={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"}},10511:(e,t,n)=>{n.d(t,{E:()=>o});var r=n(11778),s=n(7914);const i={boolean:{validate:(e,t)=>!0,equal:(e,t,n)=>Boolean(e)===Boolean(t)},number:{validate:(e,t)=>Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)},color:{validate:(e,t)=>t.optional&&!e||l(e)&&(3===e.length||4===e.length),equal:(e,t,n)=>(0,s.b)(e,t,1)},accessor:{validate(e,t){const n=u(e);return"function"===n||n===u(t.value)},equal:(e,t,n)=>"function"==typeof t||(0,s.b)(e,t,1)},array:{validate:(e,t)=>t.optional&&!e||l(e),equal(e,t,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?(0,s.b)(e,t,i):e===t}},object:{equal(e,t,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?(0,s.b)(e,t,i):e===t}},function:{validate:(e,t)=>t.optional&&!e||"function"==typeof e,equal:(e,t,n)=>!n.compare&&!1!==n.ignore||e===t},data:{transform:(e,t,n)=>{if(!e)return e;const{dataTransform:r}=n.props;return r?r(e):"string"==typeof e.shape&&e.shape.endsWith("-table")&&Array.isArray(e.data)?e.data:e}},image:{transform:(e,t,n)=>{const s=n.context;return s&&s.device?(0,r.s)(n.id,s.device,e,{...t.parameters,...n.props.textureParameters}):null},release:(e,t,n)=>{(0,r.G)(n.id,e)}}};function o(e){const t={},n={},r={};for(const[s,i]of Object.entries(e)){const e=i?.deprecatedFor;if(e)r[s]=Array.isArray(e)?e:[e];else{const e=a(s,i);t[s]=e,n[s]=e.value}}return{propTypes:t,defaultProps:n,deprecatedProps:r}}function a(e,t){switch(u(t)){case"object":return c(e,t);case"array":return c(e,{type:"array",value:t,compare:!1});case"boolean":return c(e,{type:"boolean",value:t});case"number":return c(e,{type:"number",value:t});case"function":return c(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function c(e,t){return"type"in t?{name:e,...i[t.type],...t}:"value"in t?{name:e,type:u(t.value),...t}:{name:e,type:"object",value:t}}function l(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function u(e){return l(e)?"array":null===e?"null":typeof e}},10875:(e,t,n)=>{n.d(t,{sq:()=>s,vB:()=>r,wN:()=>i});const r=new(n(39965).t)({id:"loaders.gl"});class s{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class i{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}},11346:(e,t,n)=>{n.d(t,{g:()=>a,s:()=>o});var r=n(38503),s=n(66008),i=n(77146);function o(e,t){return!!s.A.isSupported()&&(!(!r.Bd&&!t?._nodeWorkers)&&(e.worker&&t?.worker))}async function a(e,t,n,r,o){const a=e.id,l=(0,i.q)(e,n),u=s.A.getWorkerFarm(n).getWorkerPool({name:a,url:l});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const h=await u.startJob("process-on-worker",c.bind(null,o));h.postMessage("process",{input:t,options:n,context:r});const d=await h.result;return await d.result}async function c(e,t,n,r){switch(n){case"done":t.done(r);break;case"error":t.error(new Error(r.error));break;case"process":const{id:i,input:o,options:a}=r;try{const n=await e(o,a);t.postMessage("done",{id:i,result:n})}catch(s){const e=s instanceof Error?s.message:"unknown error";t.postMessage("error",{id:i,error:e})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}},11548:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(71845);class s{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=(0,r.A)(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime((0,r.A)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}},11778:(e,t,n)=>{n.d(t,{G:()=>a,s:()=>o});var r=n(80698);const s={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},i={};function o(e,t,n,o){if(n instanceof r.g)return n;n.constructor&&"Object"!==n.constructor.name&&(n={data:n});let a=null;n.compressed&&(a={minFilter:"linear",mipmapFilter:n.data.length>1?"nearest":"linear"});const{width:c,height:l}=n.data,u=t.createTexture({...n,sampler:{...s,...a,...o},mipLevels:t.getMipLevelCount(c,l)});return u.generateMipmapsWebGL(),i[u.id]=e,u}function a(e,t){t&&t instanceof r.g&&i[t.id]===e&&(t.delete(),delete i[t.id])}},12294:(e,t,n)=>{n.d(t,{mg:()=>i,zo:()=>s});var r=n(12897);function s(e){const t=e[r.fW];for(const n in t){const r=t[n],{validate:s}=r;if(s&&!s(e[n],r))throw new Error(`Invalid prop ${n}: ${e[n]}`)}}function i(e,t){const n=a({newProps:e,oldProps:t,propTypes:e[r.fW],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),s=function(e,t){if(null===t)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:s}=e;r?r(e.data,t.data)||(n="Data comparator detected a change"):e.data!==t.data&&(n="A new data container was supplied");n&&s&&(n=s(e.data,t.data)||n);return n}(e,t);let i=!1;return s||(i=function(e,t){if(null===t)return{all:!0};if("all"in e.updateTriggers){if(u(e,t,"all"))return{all:!0}}const n={};let r=!1;for(const s in e.updateTriggers)if("all"!==s){u(e,t,s)&&(n[s]=!0,r=!0)}return!!r&&n}(e,t)),{dataChanged:s,propsChanged:n,updateTriggersChanged:i,extensionsChanged:l(e,t),transitionsChanged:o(e,t)}}function o(e,t){if(!e.transitions)return!1;const n={},s=e[r.fW];let i=!1;for(const r in e.transitions){const o=s[r],a=o&&o.type;("number"===a||"color"===a||"array"===a)&&c(e[r],t[r],o)&&(n[r]=!0,i=!0)}return!!i&&n}function a({newProps:e,oldProps:t,ignoreProps:n={},propTypes:r={},triggerName:s="props"}){if(t===e)return!1;if("object"!=typeof e||null===e)return`${s} changed shallowly`;if("object"!=typeof t||null===t)return`${s} changed shallowly`;for(const i of Object.keys(e))if(!(i in n)){if(!(i in t))return`${s}.${i} added`;const n=c(e[i],t[i],r[i]);if(n)return`${s}.${i} ${n}`}for(const i of Object.keys(t))if(!(i in n)){if(!(i in e))return`${s}.${i} dropped`;if(!Object.hasOwnProperty.call(e,i)){const n=c(e[i],t[i],r[i]);if(n)return`${s}.${i} ${n}`}}return!1}function c(e,t,n){let r=n&&n.equal;return r&&!r(e,t,n)?"changed deeply":r||(r=e&&t&&e.equals,!r||r.call(e,t))?r||t===e?null:"changed shallowly":"changed deeply"}function l(e,t){if(null===t)return!0;const n=t.extensions,{extensions:r}=e;if(r===n)return!1;if(!n||!r)return!0;if(r.length!==n.length)return!0;for(let s=0;s<r.length;s++)if(!r[s].equals(n[s]))return!0;return!1}function u(e,t,n){let r=e.updateTriggers[n];r=null==r?{}:r;let s=t.updateTriggers[n];s=null==s?{}:s;return a({oldProps:s,newProps:r,triggerName:n})}},12345:(e,t,n)=>{n.d(t,{D:()=>i});let r=null,s=null;function i(e,{id:t,minimap:n,opaque:i,top:o="0",left:a="0",rgbaScale:c=1}){r||(r=document.createElement("canvas"),r.id=t,r.title=t,r.style.zIndex="100",r.style.position="absolute",r.style.top=o,r.style.left=a,r.style.border="blue 5px solid",r.style.transform="scaleY(-1)",document.body.appendChild(r),s=r.getContext("2d")),r.width===e.width&&r.height===e.height||(r.width=e.width/2,r.height=e.height/2,r.style.width="400px",r.style.height="400px");const l=e.device.readPixelsToArrayWebGL(e),u=s?.createImageData(e.width,e.height);if(u){const e=0;for(let t=0;t<l.length;t+=4)u.data[e+t+0]=l[t+0]*c,u.data[e+t+1]=l[t+1]*c,u.data[e+t+2]=l[t+2]*c,u.data[e+t+3]=i?255:l[t+3]*c;s?.putImageData(u,0,0)}}},12489:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(68475),s=n(85036),i=n(88679),o=n(15896);class a extends o.${constructor({device:e,attribute:t,timeline:n}){super({device:e,attribute:t,timeline:n}),this.type="interpolation",this.transform=function(e,t){const n=t.size,o=(0,i.A3)(n),a=(0,i.ro)(n),d=t.getBufferLayout();if(h(t))return new r.p(e,{vs:u,bufferLayout:[{name:"aFrom",byteStride:8*n,attributes:[{attribute:"aFrom",format:a,byteOffset:0},{attribute:"aFrom64Low",format:a,byteOffset:4*n}]},{name:"aTo",byteStride:8*n,attributes:[{attribute:"aTo",format:a,byteOffset:0},{attribute:"aTo64Low",format:a,byteOffset:4*n}]}],modules:[s.dI,c],defines:{ATTRIBUTE_TYPE:o,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0});return new r.p(e,{vs:l,bufferLayout:[{name:"aFrom",format:a},{name:"aTo",format:d.attributes[0].format}],modules:[c],defines:{ATTRIBUTE_TYPE:o},varyings:["vCurrent"],disableWarnings:!0})}(e,t)}start(e,t){const n=this.currentLength,r=this.currentStartIndices;if(super.start(e,t,e.duration),e.duration<=0)return void this.transition.cancel();const{buffers:s,attribute:o}=this;(0,i.yY)(s),s[0]=(0,i.aI)({device:this.device,buffer:s[0],attribute:o,fromLength:n,toLength:this.currentLength,fromStartIndices:r,getData:e.enter}),s[1]=(0,i.Sg)({device:this.device,source:s[0],target:s[1]}),this.setBuffer(s[1]);const{transform:a}=this,c=a.model;let l=Math.floor(this.currentLength/o.size);h(o)&&(l/=2),c.setVertexCount(l),o.isConstant?(c.setAttributes({aFrom:s[0]}),c.setConstantAttributes({aTo:o.value})):c.setAttributes({aFrom:s[0],aTo:o.getBuffer()}),a.transformFeedback.setBuffers({vCurrent:s[1]})}onUpdate(){const{duration:e,easing:t}=this.settings,{time:n}=this.transition;let r=n/e;t&&(r=t(r));const{model:s}=this.transform,i={time:r};s.shaderInputs.setProps({interpolation:i}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const c={name:"interpolation",vs:"uniform interpolationUniforms {\n  float time;\n} interpolation;\n",uniformTypes:{time:"f32"}},l="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aTo;\nout ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, interpolation.time);\n  gl_Position = vec4(0.0);\n}\n",u="#version 300 es\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nin ATTRIBUTE_TYPE aFrom;\nin ATTRIBUTE_TYPE aFrom64Low;\nin ATTRIBUTE_TYPE aTo;\nin ATTRIBUTE_TYPE aTo64Low;\nout ATTRIBUTE_TYPE vCurrent;\nout ATTRIBUTE_TYPE vCurrent64Low;\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid main(void) {\n  for (int i=0; i<ATTRIBUTE_SIZE; i++) {\n    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);\n    vCurrent[i] = value.x;\n    vCurrent64Low[i] = value.y;\n  }\n  gl_Position = vec4(0.0);\n}\n";function h(e){return e.doublePrecision&&e.value instanceof Float64Array}},12716:(e,t,n)=>{n.d(t,{N:()=>a});var r=n(22512),s=n(69499),i=n(29651),o=n(4500);class a{static defaultProps={...r.r.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new a(e),e._lumaData.defaultPipelineFactory}device;cachingEnabled;destroyPolicy;debug;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};get[Symbol.toStringTag](){return"PipelineFactory"}toString(){return`PipelineFactory(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cachePipelines,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=e.props.debugFactories}createRenderPipeline(e){if(!this.cachingEnabled)return this.device.createRenderPipeline(e);const t={...r.r.defaultProps,...e},n=this._renderPipelineCache,s=this._hashRenderPipeline(t);let a=n[s]?.pipeline;return a?(n[s].useCount++,this.debug&&i.R.warn(`${this}: ${n[s].pipeline} reused, count=${n[s].useCount}, (id=${e.id})`)()):(a=this.device.createRenderPipeline({...t,id:t.id?`${t.id}-cached`:(0,o.L)("unnamed-cached")}),a.hash=s,n[s]={pipeline:a,useCount:1},this.debug&&i.R.warn(`${this}: ${a} created, count=${n[s].useCount}`)()),a}createComputePipeline(e){if(!this.cachingEnabled)return this.device.createComputePipeline(e);const t={...s.C.defaultProps,...e},n=this._computePipelineCache,r=this._hashComputePipeline(t);let o=n[r]?.pipeline;return o?(n[r].useCount++,this.debug&&i.R.warn(`${this}: ${n[r].pipeline} reused, count=${n[r].useCount}, (id=${e.id})`)()):(o=this.device.createComputePipeline({...t,id:t.id?`${t.id}-cached`:void 0}),o.hash=r,n[r]={pipeline:o,useCount:1},this.debug&&i.R.warn(`${this}: ${o} created, count=${n[r].useCount}`)()),o}release(e){if(!this.cachingEnabled)return void e.destroy();const t=this._getCache(e),n=e.hash;t[n].useCount--,0===t[n].useCount?(this._destroyPipeline(e),this.debug&&i.R.warn(`${this}: ${e} released and destroyed`)()):t[n].useCount<0?(i.R.error(`${this}: ${e} released, useCount < 0, resetting`)(),t[n].useCount=0):this.debug&&i.R.warn(`${this}: ${e} released, count=${t[n].useCount}`)()}_destroyPipeline(e){const t=this._getCache(e);switch(this.destroyPolicy){case"never":return!1;case"unused":return delete t[e.hash],e.destroy(),!0}}_getCache(e){let t;if(e instanceof s.C&&(t=this._computePipelineCache),e instanceof r.r&&(t=this._renderPipelineCache),!t)throw new Error(`${this}`);if(!t[e.hash])throw new Error(`${this}: ${e} matched incorrect entry`);return t}_hashComputePipeline(e){const{type:t}=this.device;return`${t}/C/${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const t=e.vs?this._getHash(e.vs.source):0,n=e.fs?this._getHash(e.fs.source):0,r=this._getHash(JSON.stringify(e.bufferLayout)),{type:s}=this.device;if("webgl"===s)return`${s}/R/${t}/${n}V-BL${r}`;{const i=this._getHash(JSON.stringify(e.parameters));return`${s}/R/${t}/${n}V-T${e.topology}P${i}BL${r}`}}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}},12897:(e,t,n)=>{n.d(t,{VD:()=>r,YN:()=>c,fW:()=>i,jA:()=>a,r3:()=>s,uH:()=>o,vf:()=>l});const r={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},s=Symbol.for("component"),i=Symbol.for("propTypes"),o=Symbol.for("deprecatedProps"),a=Symbol.for("asyncPropDefaults"),c=Symbol.for("asyncPropOriginal"),l=Symbol.for("asyncPropResolved")},13004:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(89351),s=n(38503),i=n(5993),o=n(53034),a=n(14797);const c=()=>{};class l{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return"undefined"!=typeof Worker&&s.Bd||void 0!==r.j&&!s.Bd}constructor(e){const{name:t,source:n,url:r}=e;(0,i.v)(n||r),this.name=t,this.source=n,this.url=r,this.onMessage=c,this.onError=e=>console.log(e),this.worker=s.Bd?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=c,this.onError=c,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||(0,a.Y)(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name} from ${this.url}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=(0,o.A)({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new r.j(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new r.j(this.source,{eval:!0})}return e.on("message",e=>{this.onMessage(e)}),e.on("error",e=>{this.onError(e)}),e.on("exit",e=>{}),e}}},13364:(e,t,n)=>{n.d(t,{M:()=>o});var r=n(5153),s=n(74683),i=n(72963);class o extends r.F{get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,t){super(e,{id:a(t={...t,debugShaders:t.debugShaders||e.props.debugShaders||"errors"}),...t},o.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if("success"===this.compilationStatus)return}const t=await this.getCompilationInfo();"warnings"===e&&0===t?.length||this._displayShaderLog(t,this.id)}_displayShaderLog(e,t){if("undefined"==typeof document||!document?.createElement)return;const n=t,r=`${this.stage} shader "${n}"`;let s=(0,i.B)(e,this.source,{showSourceCode:"all",html:!0});const o=this.getTranslatedSource();o&&(s+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${o}</pre></code>`);const a=document.createElement("Button");a.innerHTML=`\n<h1>Compilation error in ${r}</h1><br /><br />\n<code style="user-select:text;"><pre>\n${s}\n</pre></code>`,a.style.top="10px",a.style.left="10px",a.style.position="absolute",a.style.zIndex="9999",a.style.width="100%",a.style.textAlign="left",document.body.appendChild(a);const c=document.getElementsByClassName("luma-compiler-log-error");c[0]?.scrollIntoView(),a.onclick=()=>{const e=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(e)}}static defaultProps={...r.F.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0}}function a(e){return function(e,t="unnamed"){const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return n?n[1]:t}(e.source)||e.id||(0,s.L)(`unnamed ${e.stage}-shader`)}},13461:(e,t,n)=>{n.d(t,{l:()=>o});var r=n(29651),s=n(35185),i=n(61313);class o{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,t){Object.assign(this.options,t);const n=(0,s.$Q)(Object.values(e).filter(e=>e.dependencies));for(const r of n)e[r.name]=r;r.R.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[s,i]of Object.entries(e))this._addModule(i),i.name&&s!==i.name&&!this.options.disableWarnings&&r.R.warn(`Module name: ${s} vs ${i.name}`)()}destroy(){}setProps(e){for(const t of Object.keys(e)){const n=t,s=e[n]||{},o=this.modules[n];if(!o){this.options.disableWarnings||r.R.warn(`Module ${t} not found`)();continue}const a=this.moduleUniforms[n],c=this.moduleBindings[n],l=o.getUniforms?.(s,a)||s,{uniforms:u,bindings:h}=(0,i.l)(l);this.moduleUniforms[n]={...a,...u},this.moduleBindings[n]={...c,...h}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){const e={};for(const[t,n]of Object.entries(this.moduleUniforms))for(const[r,s]of Object.entries(n))e[`${t}.${r}`]={type:this.modules[t].uniformTypes?.[r],value:String(s)};return e}_addModule(e){const t=e.name;this.moduleUniforms[t]=e.defaultUniforms||{},this.moduleBindings[t]={}}}},13995:(e,t,n)=>{n.d(t,{$g:()=>i,ZG:()=>a});var r=n(1635),s=n(33429);function i(e){e.map(e=>o(e))}function o(e){if(e.instance)return;i(e.dependencies||[]);const{propTypes:t={},deprecations:n=[],inject:o={}}=e,a={normalizedInjections:(0,s.Uu)(o),parsedDeprecations:c(n)};t&&(a.propValidators=(0,r.$)(t)),e.instance=a;let l={};t&&(l=Object.entries(t).reduce((e,[t,n])=>{const r=n?.value;return r&&(e[t]=r),e},{})),e.defaultUniforms={...e.defaultUniforms,...l}}function a(e,t,n){e.deprecations?.forEach(e=>{e.regex?.test(t)&&(e.deprecated?n.deprecated(e.old,e.new)():n.removed(e.old,e.new)())})}function c(e){return e.forEach(e=>{if("function"===e.type)e.regex=new RegExp(`\\b${e.old}\\(`);else e.regex=new RegExp(`${e.type} ${e.old};`)}),e}},14221:(e,t,n)=>{n.d(t,{$:()=>d,H:()=>h});const r=2,s={pointerdown:1,pointermove:r,pointerup:4,mousedown:1,mousemove:r,mouseup:4},i=0,o=1,a=2,c=1,l=2,u=4;function h(e){const t=s[e.srcEvent.type];if(!t)return null;const{buttons:n,button:h}=e.srcEvent;let d=!1,f=!1,p=!1;return t===r?(d=Boolean(n&c),f=Boolean(n&u),p=Boolean(n&l)):(d=h===i,f=h===o,p=h===a),{leftButton:d,middleButton:f,rightButton:p}}function d(e,t){const n=e.center;if(!n)return null;const r=t.getBoundingClientRect(),s=r.width/t.offsetWidth||1,i=r.height/t.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-r.left-t.clientLeft)/s,y:(n.y-r.top-t.clientTop)/i}}}},14797:(e,t,n)=>{function r(e,t=!0,n){const i=n||new Set;if(e){if(s(e))i.add(e);else if(s(e.buffer))i.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"==typeof e)for(const s in e)r(e[s],t,i)}else;return void 0===n?Array.from(i):[]}function s(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&e instanceof MessagePort||("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}n.d(t,{Y:()=>r})},15477:(e,t,n)=>{n.d(t,{v:()=>o});var r=n(47173),s=n(72959),i=n(95631);class o extends r.i{device;handle=null;commandBuffer;constructor(e,t){super(e,t),this.device=e,this.commandBuffer=new s.Rm(e)}destroy(){}finish(){return this.commandBuffer}beginRenderPass(e){return new i.X(this.device,e)}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,t,n){}}},15896:(e,t,n)=>{n.d(t,{$:()=>i});var r=n(2357),s=n(88679);class i{constructor({device:e,attribute:t,timeline:n}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new r.A(n),this.attribute=t,this.attributeInTransition=(0,s.Ol)(t),this.currentStartIndices=t.startIndices}get inProgress(){return this.transition.inProgress}start(e,t,n=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=(0,s.Pu)(this.attribute,t),this.transition.start({...e,duration:n})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}},15992:(e,t,n)=>{n.d(t,{WQ:()=>i,eW:()=>s,wg:()=>r});const r=[],s=[[0,1/0]];function i(e,t){if(e===s)return e;if(t[0]<0&&(t[0]=0),t[0]>=t[1])return e;const n=[],r=e.length;let i=0;for(let s=0;s<r;s++){const r=e[s];r[1]<t[0]?(n.push(r),i=s+1):r[0]>t[1]?n.push(r):t=[Math.min(r[0],t[0]),Math.max(r[1],t[1])]}return n.splice(i,0,t),n}},16534:(e,t,n)=>{function r(e,t){if(300!==Number(e.match(/^#version[ \t]+(\d+)/m)?.[1]||100))throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(t){case"vertex":return e=a(e,i);case"fragment":return e=a(e,o);default:throw new Error(t)}}n.d(t,{o:()=>r});const s=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],i=[...s,[c("attribute"),"in $1"],[c("varying"),"out $1"]],o=[...s,[c("varying"),"in $1"]];function a(e,t){for(const[n,r]of t)e=e.replace(n,r);return e}function c(e){return new RegExp(`\\b${e}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}},17043:(e,t,n)=>{n.d(t,{z:()=>l});var r=n(94976),s=n(44133),i=n(53905),o=n(67637),a=n(99209),c=n(95862);async function l(e,t,n){const l=((t=t||{}).image||{}).type||"auto",{url:u}=n||{};let h;switch(function(e){switch(e){case"auto":case"data":return(0,s.f)();default:return(0,s.O)(e),e}}(l)){case"imagebitmap":h=await(0,a.r)(e,t,u);break;case"image":h=await(0,o.a)(e,t,u);break;case"data":h=await(0,c.q)(e,t);break;default:(0,r.v)(!1)}return"data"===l&&(h=(0,i.M5)(h)),h}},17393:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(33945),s=n(7914);class i{constructor(e){const{id:t,x:n=0,y:s=0,width:i="100%",height:o="100%",padding:a=null}=e;this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=(0,r.r)(n),this._y=(0,r.r)(s),this._width=(0,r.r)(i),this._height=(0,r.r)(o),this._padding=a&&{left:(0,r.r)(a.left||0),right:(0,r.r)(a.right||0),top:(0,r.r)(a.top||0),bottom:(0,r.r)(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||this.constructor===e.constructor&&(0,s.b)(this.props,e.props,2)}clone(e){return new(0,this.constructor)({...this.props,...e})}makeViewport({width:e,height:t,viewState:n}){n=this.filterViewState(n);const r=this.getDimensions({width:e,height:t});if(!r.height||!r.width)return null;return new(this.getViewportType(n))({...n,...this.props,...r})}getViewStateId(){const{viewState:e}=this.props;return"string"==typeof e?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const e in this.props.viewState)"id"!==e&&(t[e]=this.props.viewState[e]);return t}return e}getDimensions({width:e,height:t}){const n={x:(0,r.E)(this._x,e),y:(0,r.E)(this._y,t),width:(0,r.E)(this._width,e),height:(0,r.E)(this._height,t)};return this._padding&&(n.padding={left:(0,r.E)(this._padding.left,e),top:(0,r.E)(this._padding.top,t),right:(0,r.E)(this._padding.right,e),bottom:(0,r.E)(this._padding.bottom,t)}),n}get controller(){const e=this.props.controller;return e?!0===e?{type:this.ControllerType}:"function"==typeof e?{type:e}:{type:this.ControllerType,...e}:null}}},18160:(e,t,n)=>{function r(e,t,n){return{x:t/e||0,y:n/e||0}}n.d(t,{O:()=>r})},18511:(e,t,n)=>{n.d(t,{Cx:()=>s.Cx,EU:()=>r.E,e8:()=>s.e8,h1:()=>s.h1,uq:()=>s.uq});var r=n(44333),s=n(9241)},19023:(e,t,n)=>{n.d(t,{o:()=>i});var r=n(2021),s=n(5153);class i extends s.F{static defaultProps={...s.F.defaultProps,shaderLayout:void 0,bufferLayout:[]};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,t){super(e,t,i.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=(0,r.M)(t.shaderLayout,t.bufferLayout,this.maxVertexAttributes)}setConstantWebGL(e,t){this.device.reportError(new Error("constant attributes not supported"),this)()}}},19380:(e,t,n)=>{n.d(t,{o:()=>c});var r=n(44860),s=n(93871),i=n(88171),o=n(77264),a=n(20736);class c extends r.f{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[s.ZO]}process(e){const{options:t}=this,n=e.pointers.length===t.pointers,r=e.distance<t.threshold,s=e.deltaTime<t.time;if(this.reset(),e.eventType&i.TL.Start&&0===this.count)return this.failTimeout();if(r&&s&&n){if(e.eventType!==i.TL.End)return this.failTimeout();const n=!this.pTime||e.timeStamp-this.pTime<t.interval,r=!this.pCenter||(0,a.C)(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,r&&n?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=o.g.Recognized,this.tryEmit(this._input)},t.interval),o.g.Began):o.g.Recognized}return o.g.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=o.g.Failed},this.options.interval),o.g.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===o.g.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}},19871:(e,t,n)=>{n.d(t,{F:()=>a});var r=n(95850),s=n(30440),i=n(88755);let o=0;class a{static defaultAnimationLoopProps={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:r.a.stats.get("animation-loop-"+o++),autoResizeViewport:!1};device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...a.defaultAnimationLoopProps,...e},!(e=this.props).device)throw new Error("No device provided");this.stats=e.stats||new i.A({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}reportError(e){this.props.onError(e),this._error=e}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(!1!==e&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error||(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers()),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=(0,s.U)(this._animationFrame.bind(this)))}_cancelAnimationFrame(){null!==this._animationFrameId&&((0,s.$)(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){this.display?this.display._renderFrame(e):(this.props.onRender(this._getAnimationProps()),this.device?.submit())}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.getDefaultCanvasContext();if(!this.device||!e)throw new Error("loop");const t=e?.canvas,n=e.props.useDevicePixels;this.animationProps={animationLoop:this,device:this.device,canvasContext:e,canvas:t,useDevicePixels:n,timeline:this.timeline,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:n}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.getDefaultCanvasContext().canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,t]=this.device?.getDefaultCanvasContext().getDevicePixelSize()||[1,1];let n=1;const r=this.device?.getDefaultCanvasContext().canvas;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:e>0&&t>0&&(n=e/t),{width:e,height:t,aspect:n}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}},20471:(e,t,n)=>{n.d(t,{a:()=>o});var r=n(56769);const s=-1!==n(33213).N1.indexOf("firefox"),i=4.000244140625;class o extends r.p{constructor(e,t,n){super(e,t,{enable:!0,...n}),this.handleEvent=e=>{if(!this.options.enable)return;let t=e.deltaY;globalThis.WheelEvent&&(s&&e.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(t/=globalThis.devicePixelRatio),e.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(t*=40)),0!==t&&t%i===0&&(t=Math.floor(t/i)),e.shiftKey&&t&&(t*=.25),this.callback({type:"wheel",center:{x:e.clientX,y:e.clientY},delta:-t,srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}}},20522:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(93871);function s(e){if(e.includes(r.uR))return r.uR;const t=e.includes(r.Sw),n=e.includes(r.LU);return t&&n?r.uR:t||n?t?r.Sw:r.LU:e.includes(r.ZO)?r.ZO:r.fO}},20736:(e,t,n)=>{function r(e,t){const n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)}function s(e,t){const n=t.clientX-e.clientX,r=t.clientY-e.clientY;return Math.sqrt(n*n+r*r)}n.d(t,{C:()=>r,m:()=>s})},20966:(e,t,n)=>{function r(e,t,n){let r="";const s={preserveDrawingBuffer:!0,...n};let i=null;if(i||=e.getContext("webgl2",s),s.failIfMajorPerformanceCaveat&&(r||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),i||n.failIfMajorPerformanceCaveat||(s.failIfMajorPerformanceCaveat=!1,i=e.getContext("webgl2",s),i.luma||={},i.luma.softwareRenderer=!0),i||(i=e.getContext("webgl",{}),i&&(i=null,r||="Your browser only supports WebGL1")),!i)throw r||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${r}`);const{onContextLost:o,onContextRestored:a}=t;return e.addEventListener("webglcontextlost",e=>o(e),!1),e.addEventListener("webglcontextrestored",e=>a(e),!1),i.luma||={},i}n.d(t,{e:()=>r})},21658:(e,t,n)=>{n.d(t,{XA:()=>s});var r=n(83749);function s(e){if((t=e)&&"object"==typeof t&&t.isBuffer)return r.X(e);var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"==typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"==typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}},21719:(e,t,n)=>{n.d(t,{M8:()=>m,My:()=>f,aK:()=>p,cu:()=>d,o5:()=>_,ql:()=>v});var r=n(25543),s=n(68643),i=n(60742);const o="WEBGL_compressed_texture_s3tc",a="WEBGL_compressed_texture_s3tc_srgb",c="EXT_texture_compression_rgtc",l="EXT_texture_compression_bptc",u="EXT_texture_norm16",h="EXT_render_snorm",d={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[h],"norm16-renderable-webgl":[u],"snorm16-renderable-webgl":[u,h],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[o,a,c,l],"texture-compression-bc5-webgl":[c],"texture-compression-bc7-webgl":[l],"texture-compression-etc2":["WEBGL_compressed_texture_etc"],"texture-compression-astc":["WEBGL_compressed_texture_astc"],"texture-compression-etc1-webgl":["WEBGL_compressed_texture_etc1"],"texture-compression-pvrtc-webgl":["WEBGL_compressed_texture_pvrtc"],"texture-compression-atc-webgl":["WEBGL_compressed_texture_atc"]};function f(e){return e in d}function p(e,t,n){return(d[t]||[]).every(t=>(0,s.T)(e,t,n))}const g={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},r16unorm:{gl:33322,rb:!0},r16snorm:{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},rg16unorm:{gl:33324},rg16snorm:{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},rgb10a2uint:{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},rgba16unorm:{gl:32859,rb:!0},rgba16snorm:{gl:36763},"rgb32float-webgl":{gl:34837,x:"EXT_color_buffer_float",dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:o},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:a},"bc1-rgba-unorm":{gl:33777,x:o},"bc1-rgba-unorm-srgb":{gl:35916,x:a},"bc2-rgba-unorm":{gl:33778,x:o},"bc2-rgba-unorm-srgb":{gl:35918,x:a},"bc3-rgba-unorm":{gl:33779,x:o},"bc3-rgba-unorm-srgb":{gl:35919,x:a},"bc4-r-unorm":{gl:36283,x:c},"bc4-r-snorm":{gl:36284,x:c},"bc5-rg-unorm":{gl:36285,x:c},"bc5-rg-snorm":{gl:36286,x:c},"bc6h-rgb-ufloat":{gl:36495,x:l},"bc6h-rgb-float":{gl:36494,x:l},"bc7-rgba-unorm":{gl:36492,x:l},"bc7-rgba-unorm-srgb":{gl:36493,x:l},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function _(e,t,n){let r=t.create;const i=g[t.format];return void 0===i?.gl&&(r=!1),i?.x&&(r=r&&Boolean((0,s.T)(e,i.x,n))),{format:t.format,create:r&&t.create,render:r&&t.render,filter:r&&t.filter,blend:r&&t.blend,store:r&&t.store}}function m(e){const t=g[e],n=function(e){const t=g[e],n=t?.gl;if(void 0===n)throw new Error(`Unsupported texture format ${e}`);return n}(e),s=r.v.getInfo(e);return s.compressed&&(t.dataFormat=n),{internalFormat:n,format:t?.dataFormat||b(s.channels,s.integer,s.normalized,n),type:s.dataType?(0,i.q1)(s.dataType):t?.types?.[0]||5121,compressed:s.compressed||!1}}function v(e){switch(r.v.getInfo(e).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${e}`)}}function b(e,t,n,r){if(6408===r||6407===r)return r;switch(e){case"r":return t&&!n?36244:6403;case"rg":return t&&!n?33320:33319;case"rgb":return t&&!n?36248:6407;case"rgba":return t&&!n?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}},22512:(e,t,n)=>{n.d(t,{r:()=>s});var r=n(5153);class s extends r.F{get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,t){super(e,t,s.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}static defaultProps={...r.F.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",colorAttachmentFormats:void 0,depthStencilAttachmentFormat:void 0,parameters:{},bindings:{},uniforms:{}}}},22535:(e,t,n)=>{function r(e,t){let n="";for(const r in e){const s=e[r];if(n+=`void ${s.signature} {\n`,s.header&&(n+=`  ${s.header}`),t[r]){const e=t[r];e.sort((e,t)=>e.order-t.order);for(const t of e)n+=`  ${t.injection}\n`}s.footer&&(n+=`  ${s.footer}`),n+="}\n"}return n}function s(e){const t={vertex:{},fragment:{}};for(const n of e){let e,r;"string"!=typeof n?(e=n,r=e.hook):(e={},r=n),r=r.trim();const[s,i]=r.split(":"),o=r.replace(/\(.+/,""),a=Object.assign(e,{signature:i});switch(s){case"vs":t.vertex[o]=a;break;case"fs":t.fragment[o]=a;break;default:throw new Error(s)}}return t}n.d(t,{R:()=>s,m:()=>r})},22549:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(26839),s=n(1069),i=n(23459),o=n(25667),a=n(3459);function c(e,t){t.offset&&a.A.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=(0,s.m$)(e),r=(void 0!==t.vertexOffset?t.vertexOffset:e.vertexOffset||0)*n+(t.elementOffset||0)*e.bytesPerElement+(e.offset||0);return{...t,offset:r,stride:n}}class l{constructor(e,t,n){this._buffer=null,this.device=e,this.id=t.id||"",this.size=t.size||1;const r=t.logicalType||t.type,i="float64"===r;let o,{defaultValue:a}=t;a=Number.isFinite(a)?[a]:a||new Array(this.size).fill(0),o=i?"float32":!r&&t.isIndexed?"uint32":r||"float32";let c=(0,s.ol)(r||o);this.doublePrecision=i,i&&!1===t.fp64&&(c=Float32Array),this.value=null,this.settings={...t,defaultType:c,defaultValue:a,logicalType:r,type:o,normalized:o.includes("norm"),size:this.size,bytesPerElement:c.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*(0,s.m$)(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),i.A.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,t=null){const n={};if(this.state.constant){const r=this.value;if(t){const s=c(this.getAccessor(),t),i=s.offset/r.BYTES_PER_ELEMENT,o=s.size||this.size;n[e]=r.subarray(i,i+o)}else n[e]=r}else n[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n[`${e}64Low`]=n[e]:n[`${e}64Low`]=new Float32Array(this.size)),n}_getBufferLayout(e=this.id,t=null){const n=this.getAccessor(),r=[],i={name:this.id,byteStride:(0,s.m$)(n),attributes:r};if(this.doublePrecision){const i=function(e,t){const n=c(e,t);return{high:n,low:{...n,offset:n.offset+4*e.size}}}(n,t||{});r.push((0,s.bj)(e,{...n,...i.high},this.device.type),(0,s.bj)(`${e}64Low`,{...n,...i.low},this.device.type))}else if(t){const i=c(n,t);r.push((0,s.bj)(e,{...n,...i},this.device.type))}else r.push((0,s.bj)(e,n,this.device.type));return i}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:n,size:r}=this,s=n*r;if(t&&s&&t.length>=s){const n=new Array(r).fill(1/0),i=new Array(r).fill(-1/0);for(let e=0;e<s;)for(let s=0;s<r;s++){const r=t[e++];r<n[s]&&(n[s]=r),r>i[s]&&(i[s]=r)}e=[n,i]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let n;n=ArrayBuffer.isView(e)?{value:e}:e instanceof r.h?{buffer:e}:e;const i={...this.settings,...n};if(ArrayBuffer.isView(n.value)){if(!n.type){if(this.doublePrecision&&n.value instanceof Float64Array)i.type="float32";else{const e=(0,s.Y5)(n.value);i.type=i.normalized?e.replace("int","norm"):e}}i.bytesPerElement=n.value.BYTES_PER_ELEMENT,i.stride=(0,s.m$)(i)}if(t.bounds=null,n.constant){let e=n.value;e=this._normalizeValue(e,[],0),this.settings.normalized&&(e=this.normalizeConstant(e));if(!(!t.constant||!this._areValuesEqual(e,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=ArrayBuffer.isView(e)?e:new Float32Array(e)}else if(n.buffer){const e=n.buffer;t.externalBuffer=e,t.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let e=n.value;t.externalBuffer=null,t.constant=!1,this.value=e;let{buffer:r}=this;const a=(0,s.m$)(i),c=(i.vertexOffset||0)*a;if(this.doublePrecision&&e instanceof Float64Array&&(e=(0,o.cT)(e,i)),this.settings.isIndexed){const t=this.settings.defaultType;e.constructor!==t&&(e=new t(e))}const l=e.byteLength+c+2*a;(!r||r.byteLength<l)&&(r=this._createBuffer(l)),r.write(e,c)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const t=this.value,{startOffset:n=0,endOffset:r}=e;this.buffer.write(this.doublePrecision&&t instanceof Float64Array?(0,o.cT)(t,{size:this.size,startIndex:n,endIndex:r}):t.subarray(n,r),n*t.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,t=!1){const{state:n}=this,r=n.allocatedValue,s=i.A.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=s;const{byteOffset:a}=this;let{buffer:c}=this;return(!c||c.byteLength<s.byteLength+a)&&(c=this._createBuffer(s.byteLength+a),t&&r&&c.write(r instanceof Float64Array?(0,o.cT)(r,this):r,a)),n.allocatedValue=s,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error(`Attribute ${this.id} value is not TypedArray`);const n=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error(`Attribute ${this.id} does not support ${t.constructor.name}`);t instanceof n||!this.settings.normalized||"normalized"in e||a.A.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(e=>(e+128)/255*2-1);case"snorm16":return new Float32Array(e).map(e=>(e+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(e=>e/255);case"unorm16":return new Float32Array(e).map(e=>e/65535);default:return e}}_normalizeValue(e,t,n){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[n]=e,t;if(!e){let e=s;for(;--e>=0;)t[n+e]=r[e];return t}switch(s){case 4:t[n+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[n+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[n+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[n+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let i=s;for(;--i>=0;)t[n+i]=Number.isFinite(e[i])?e[i]:r[i]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();const{isIndexed:t,type:n}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(t?r.h.INDEX:r.h.VERTEX)|r.h.COPY_DST,indexType:t?n:void 0,byteLength:e}),this._buffer}}},22749:(e,t,n)=>{function r(e){const t=e.split(/\r?\n/),n=[];for(const r of t){if(r.length<=1)continue;const e=r.split(":");if(2===e.length){const[t,r]=e;n.push({message:r.trim(),type:s(t),lineNum:0,linePos:0});continue}const[t,i,o,...a]=e;let c=parseInt(o,10);isNaN(c)&&(c=0);let l=parseInt(i,10);isNaN(l)&&(l=0),n.push({message:a.join(":").trim(),type:s(t),lineNum:c,linePos:l})}return n}function s(e){const t=e.toLowerCase();return["warning","error","info"].includes(t)?t:"info"}n.d(t,{E:()=>r})},23459:(e,t,n)=>{n.d(t,{A:()=>r});const r=new class{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,{size:n=1,type:r,padding:s=0,copy:i=!1,initialize:o=!1,maxCount:a}){const c=r||e&&e.constructor||Float32Array,l=t*n+s;if(ArrayBuffer.isView(e)){if(l<=e.length)return e;if(l*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,l)}let u=1/0;a&&(u=a*n+s);const h=this._allocate(c,l,o,u);return e&&i?h.set(e):o||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,t,n,r){let s=Math.max(Math.ceil(t*this.opts.overAlloc),1);s>r&&(s=r);const i=this._pool,o=e.BYTES_PER_ELEMENT*s,a=i.findIndex(e=>e.byteLength>=o);if(a>=0){const t=new e(i.splice(a,1)[0],0,s);return n&&t.fill(0),t}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:n}=e,{byteLength:r}=n,s=t.findIndex(e=>e.byteLength>=r);s<0?t.push(n):(s>0||t.length<this.opts.poolSize)&&t.splice(s,0,n),t.length>this.opts.poolSize&&t.shift()}}},23793:(e,t,n)=>{n.d(t,{m:()=>o});var r=n(81813);const s=!1,i=!0;function o(e){const t=a(e);return function(e){const t=a(e),n=t.byteLength>=24&&2303741511===t.getUint32(0,s);if(!n)return null;return{mimeType:"image/png",width:t.getUint32(16,s),height:t.getUint32(20,s)}}(t)||function(e){const t=a(e),n=t.byteLength>=3&&65496===t.getUint16(0,s)&&255===t.getUint8(2);if(!n)return null;const{tableMarkers:r,sofMarkers:i}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)e.add(n);const t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}();let o=2;for(;o+9<t.byteLength;){const e=t.getUint16(o,s);if(i.has(e))return{mimeType:"image/jpeg",height:t.getUint16(o+5,s),width:t.getUint16(o+7,s)};if(!r.has(e))return null;o+=2,o+=t.getUint16(o,s)}return null}(t)||function(e){const t=a(e),n=t.byteLength>=10&&1195984440===t.getUint32(0,s);if(!n)return null;return{mimeType:"image/gif",width:t.getUint16(6,i),height:t.getUint16(8,i)}}(t)||function(e){const t=a(e),n=t.byteLength>=14&&16973===t.getUint16(0,s)&&t.getUint32(2,i)===t.byteLength;if(!n)return null;return{mimeType:"image/bmp",width:t.getUint32(18,i),height:t.getUint32(22,i)}}(t)||function(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),n=(0,r.Z)(t);if(!n)return null;return{mimeType:n.mimeType,width:0,height:0}}(t)}function a(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}},24067:(e,t,n)=>{function r(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}n.d(t,{A:()=>r})},24145:(e,t,n)=>{n.d(t,{s:()=>s});var r=n(9350);const s=`${Object.keys(r.rf).map(e=>`const int COORDINATE_SYSTEM_${e} = ${r.rf[e]};`).join("")}\n${Object.keys(r.Kx).map(e=>`const int PROJECTION_MODE_${e} = ${r.Kx[e]};`).join("")}\n${Object.keys(r.p5).map(e=>`const int UNIT_${e.toUpperCase()} = ${r.p5[e]};`).join("")}\nuniform projectUniforms {\nbool wrapLongitude;\nint coordinateSystem;\nvec3 commonUnitsPerMeter;\nint projectionMode;\nfloat scale;\nvec3 commonUnitsPerWorldUnit;\nvec3 commonUnitsPerWorldUnit2;\nvec4 center;\nmat4 modelMatrix;\nmat4 viewProjectionMatrix;\nvec2 viewportSize;\nfloat devicePixelRatio;\nfloat focalDistance;\nvec3 cameraPosition;\nvec3 coordinateOrigin;\nvec3 commonOrigin;\nbool pseudoMeters;\n} project;\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\nfloat y = clamp(lat, -89.9, 89.9);\nreturn 1.0 / cos(radians(y));\n}\nfloat project_size() {\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&\nproject.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\nproject.pseudoMeters == false) {\nif (geometry.position.w == 0.0) {\nreturn project_size_at_latitude(geometry.worldPosition.y);\n}\nfloat y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\nfloat y2 = y * y;\nfloat y4 = y2 * y2;\nfloat y6 = y4 * y2;\nreturn 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n}\nreturn 1.0;\n}\nfloat project_size_at_latitude(float meters, float lat) {\nreturn meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\nreturn meters * project.commonUnitsPerMeter.z * project_size();\n}\nvec2 project_size(vec2 meters) {\nreturn meters * project.commonUnitsPerMeter.xy * project_size();\n}\nvec3 project_size(vec3 meters) {\nreturn meters * project.commonUnitsPerMeter * project_size();\n}\nvec4 project_size(vec4 meters) {\nreturn vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\nvec3 uz = normalize(up);\nvec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\nvec3 uy = cross(uz, ux);\nreturn mat3(ux, uy, uz);\n}\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\nif (project.projectionMode == PROJECTION_MODE_GLOBE) {\ntransform = project_get_orientation_matrix(commonPosition);\nreturn true;\n}\nreturn false;\n}\nvec3 project_normal(vec3 vector) {\nvec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);\nvec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);\nmat3 rotation;\nif (project_needs_rotation(geometry.position.xyz, rotation)) {\nn = rotation * n;\n}\nreturn n;\n}\nvec4 project_offset_(vec4 offset) {\nfloat dy = offset.y;\nvec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;\nreturn vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\nfloat x = lnglat.x;\nif (project.wrapLongitude) {\nx = mod(x + 180., 360.0) - 180.;\n}\nfloat y = clamp(lnglat.y, -89.9, 89.9);\nreturn vec2(\nradians(x) + PI,\nPI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n) * WORLD_SCALE;\n}\nvec3 project_globe_(vec3 lnglatz) {\nfloat lambda = radians(lnglatz.x);\nfloat phi = radians(lnglatz.y);\nfloat cosPhi = cos(phi);\nfloat D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\nreturn vec3(\nsin(lambda) * cosPhi,\n-cos(lambda) * cosPhi,\nsin(phi)\n) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\nvec4 position_world = project.modelMatrix * position;\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_mercator_(position_world.xy),\nproject_size_at_latitude(position_world.z, position_world.y),\nposition_world.w\n);\n}\nif (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\nposition_world.xyz += project.coordinateOrigin;\n}\n}\nif (project.projectionMode == PROJECTION_MODE_GLOBE) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nreturn vec4(\nproject_globe_(position_world.xyz),\nposition_world.w\n);\n}\n}\nif (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\nif (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\nif (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {\nreturn vec4(\nproject_mercator_(position_world.xy) - project.commonOrigin.xy,\nproject_size(position_world.z),\nposition_world.w\n);\n}\n}\n}\nif (project.projectionMode == PROJECTION_MODE_IDENTITY ||\n(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\nproject.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\nposition_world.xyz -= project.coordinateOrigin;\n}\nreturn project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));\n}\nvec4 project_position(vec4 position) {\nreturn project_position(position, ZERO_64_LOW);\n}\nvec3 project_position(vec3 position, vec3 position64Low) {\nvec4 projected_position = project_position(vec4(position, 1.0), position64Low);\nreturn projected_position.xyz;\n}\nvec3 project_position(vec3 position) {\nvec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\nreturn projected_position.xyz;\n}\nvec2 project_position(vec2 position) {\nvec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\nreturn projected_position.xy;\n}\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\nreturn viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\nreturn project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\nvec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;\nreturn offset * project.focalDistance;\n}\nfloat project_size_to_pixel(float meters) {\nreturn project_size(meters) * project.scale;\n}\nfloat project_size_to_pixel(float size, int unit) {\nif (unit == UNIT_METERS) return project_size_to_pixel(size);\nif (unit == UNIT_COMMON) return size * project.scale;\nreturn size;\n}\nfloat project_pixel_size(float pixels) {\nreturn pixels / project.scale;\n}\nvec2 project_pixel_size(vec2 pixels) {\nreturn pixels / project.scale;\n}\n`},24744:(e,t,n)=>{function r(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(e)}}function s(e){switch(e){case"point-list":return 0;case"line-list":case"line-strip":return 1;case"triangle-list":case"triangle-strip":return 4;default:throw new Error(e)}}n.d(t,{PD:()=>s,nV:()=>r})},25285:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(8036);class s extends r.A{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[t,n]=this.device.canvasContext.getDrawingBufferSize(),r=e.clearCanvas??!0,s=e.clearColor??(!!r&&[0,0,0,0]),i=!!r&&1,o=!!r&&0,a=e.colorMask??15,c={viewport:[0,0,t,n]};e.colorMask&&(c.colorMask=a),e.scissorRect&&(c.scissorRect=e.scissorRect);const l=this.device.beginRenderPass({framebuffer:e.target,parameters:c,clearColor:s,clearDepth:i,clearStencil:o});try{return this._drawLayers(l,e)}finally{l.end(),this.device.submit()}}_drawLayers(e,t){const{target:n,shaderModuleProps:r,viewports:s,views:i,onViewportActive:o,clearStack:a=!0}=t;t.pass=t.pass||"unknown",a&&(this._lastRenderIndex=-1);const c=[];for(const l of s){const s=i&&i[l.id];o?.(l);const a=this._getDrawLayerParams(l,t),u=l.subViewports||[l];for(const i of u){const o=this._drawLayersInViewport(e,{target:n,shaderModuleProps:r,viewport:i,view:s,pass:t.pass,layers:t.layers},a);c.push(o)}}return c}_getDrawLayerParams(e,{layers:t,pass:n,isPicking:r=!1,layerFilter:s,cullRect:o,effects:a,shaderModuleProps:c},l=!1){const u=[],h=i(this._lastRenderIndex+1),d={layer:t[0],viewport:e,isPicking:r,renderPass:n,cullRect:o},f={};for(let i=0;i<t.length;i++){const r=t[i],o=this._shouldDrawLayer(r,d,s,f),p={shouldDrawLayer:o};o&&!l&&(p.shouldDrawLayer=!0,p.layerRenderIndex=h(r,o),p.shaderModuleProps=this._getShaderModuleProps(r,a,n,c),p.layerParameters={...r.context.deck?.props.parameters,...this.getLayerParameters(r,i,e)}),u[i]=p}return u}_drawLayersInViewport(e,{layers:t,shaderModuleProps:n,pass:r,target:s,viewport:i,view:o},a){const c=function(e,{shaderModuleProps:t,target:n,viewport:r}){const s=t?.project?.devicePixelRatio??e.canvasContext.cssToDeviceRatio(),[,i]=e.canvasContext.getDrawingBufferSize(),o=n?n.height:i,a=r;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}(this.device,{shaderModuleProps:n,target:s,viewport:i});if(o){const{clear:e,clearColor:t,clearDepth:n,clearStencil:r}=o.props;if(e){let e=[0,0,0,0],i=1,o=0;Array.isArray(t)?e=[...t.slice(0,3),t[3]||255].map(e=>e/255):!1===t&&(e=!1),void 0!==n&&(i=n),void 0!==r&&(o=r);this.device.beginRenderPass({framebuffer:s,parameters:{viewport:c,scissorRect:c},clearColor:e,clearDepth:i,clearStencil:o}).end()}}const l={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:c});for(let h=0;h<t.length;h++){const n=t[h],s=a[h],{shouldDrawLayer:o}=s;if(o&&n.props.pickable&&l.pickableCount++,n.isComposite&&l.compositeCount++,n.isDrawable&&s.shouldDrawLayer){const{layerRenderIndex:t,shaderModuleProps:o,layerParameters:a}=s;l.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,t),o.project&&(o.project.viewport=i),n.context.renderPass=e;try{n._drawLayer({renderPass:e,shaderModuleProps:o,uniforms:{layerIndex:t},parameters:a})}catch(u){n.raiseError(u,`drawing ${n} to ${r}`)}}}return l}shouldDrawLayer(e){return!0}getShaderModuleProps(e,t,n){return null}getLayerParameters(e,t,n){return e.props.parameters}_shouldDrawLayer(e,t,n,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let s=e.parent;for(;s;){if(!s.props.visible||!s.filterSubLayer(t))return!1;t.layer=s,s=s.parent}if(n){const e=t.layer.id;if(e in r||(r[e]=n(t)),!r[e])return!1}return e.activateViewport(t.viewport),!0}_getShaderModuleProps(e,t,n,r){const s=this.device.canvasContext.cssToDeviceRatio(),i=e.internalState?.propsInTransition||e.props,a={layer:i,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:s,modelMatrix:i.modelMatrix,coordinateSystem:i.coordinateSystem,coordinateOrigin:i.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(t)for(const c of t)o(a,c.getShaderModuleProps?.(e,a));return o(a,this.getShaderModuleProps(e,t,a),r)}}function i(e=0,t={}){const n={},r=(s,o)=>{const a=s.props._offset,c=s.id,l=s.parent&&s.parent.id;let u;if(l&&!(l in t)&&r(s.parent,!1),l in n){const e=n[l]=n[l]||i(t[l],t);u=e(s,o),n[c]=e}else Number.isFinite(a)?(u=a+(t[l]||0),n[c]=null):u=e;return o&&u>=e&&(e=u+1),t[c]=u,u};return r}function o(e,...t){for(const n of t)if(n)for(const t in n)e[t]?Object.assign(e[t],n[t]):e[t]=n[t];return e}},25299:(e,t,n)=>{n.d(t,{_G:()=>l,ic:()=>c,k2:()=>u});var r=n(29651),s=n(32077);const i=1;let o=null,a=!1;const c={debugSpectorJS:r.R.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function l(e){if(!globalThis.SPECTOR)try{await(0,s.k)(e.debugSpectorJSUrl||c.debugSpectorJSUrl)}catch(t){r.R.warn(String(t))}}function u(e){if(!(e={...c,...e}).debugSpectorJS)return null;if(!o&&globalThis.SPECTOR&&!globalThis.luma?.spector){r.R.probe(i,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;o=new e,globalThis.luma&&(globalThis.luma.spector=o)}if(!o)return null;if(a||(a=!0,o.spyCanvases(),o?.onCaptureStarted.add(e=>r.R.info("Spector capture started:",e)()),o?.onCapture.add(e=>{r.R.info("Spector capture complete:",e)(),o?.getResultUI(),o?.resultView.display(),o?.resultView.addCapture(e)})),e.gl){const t=e.gl,n=t.device;o?.startCapture(e.gl,500),t.device=n,new Promise(e=>setTimeout(e,2e3)).then(e=>{r.R.info("Spector capture stopped after 2 seconds")(),o?.stopCapture()})}return o}},25337:(e,t,n)=>{n.d(t,{V:()=>s});var r=n(4500);class s{id;topology;vertexCount;indices;attributes;userData={};constructor(e){const{attributes:t={},indices:n=null,vertexCount:s=null}=e;this.id=e.id||(0,r.L)("geometry"),this.topology=e.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(const[r,i]of Object.entries(t)){const e=ArrayBuffer.isView(i)?{value:i}:i;if(!ArrayBuffer.isView(e.value))throw new Error(`${this._print(r)}: must be typed array or object with value as typed array`);if("POSITION"!==r&&"positions"!==r||e.size||(e.size=3),"indices"===r){if(this.indices)throw new Error("Multiple indices detected");this.indices=e}else this.attributes[r]=e}this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=s||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){return this}_calculateVertexCount(e,t){if(t)return t.value.length;let n=1/0;for(const r of Object.values(e)){const{value:e,size:t,constant:s}=r;!s&&e&&void 0!==t&&t>=1&&(n=Math.min(n,e.length/t))}return n}}},25543:(e,t,n)=>{n.d(t,{v:()=>a});var r=n(72246),s=n(5139);const i=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],o=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;const a=new class{getInfo(e){return c(e)}isColor(e){return e.startsWith("rgba")||e.startsWith("bgra")||e.startsWith("rgb")}isDepthStencil(e){return e.startsWith("depth")||e.startsWith("stencil")}isCompressed(e){return i.some(t=>e.startsWith(t))}getCapabilities(e){const t=(0,s.qG)(e),n={format:e,create:t.f??!0,render:t.render??!0,filter:t.filter??!0,blend:t.blend??!0,store:t.store??!0},r=c(e),i=e.startsWith("depth")||e.startsWith("stencil"),o=r?.signed,a=r?.integer,l=r?.webgl;return n.render&&=!o,n.filter&&=!(i||o||a||l),n}};function c(e){let t=function(e){const t=(0,s.qG)(e),n=t.bytesPerPixel||1,r=t.bitsPerChannel||[8,8,8,8];delete t.bitsPerChannel,delete t.bytesPerPixel,delete t.f,delete t.render,delete t.filter,delete t.blend,delete t.store;const i={...t,format:e,attachment:t.attachment||"color",channels:t.channels||"r",components:t.components||t.channels?.length||1,bytesPerPixel:n,bitsPerChannel:r,dataType:t.dataType||"uint8",srgb:t.srgb??!1,packed:t.packed??!1,webgl:t.webgl??!1,integer:t.integer??!1,signed:t.signed??!1,normalized:t.normalized??!1,compressed:t.compressed??!1};return i}(e);if(a.isCompressed(e)){t.channels="rgb",t.components=3,t.bytesPerPixel=1,t.srgb=!1,t.compressed=!0;const n=function(e){const t=/.*-(\d+)x(\d+)-.*/.exec(e);if(t){const[,e,n]=t;return{blockWidth:Number(e),blockHeight:Number(n)}}return null}(e);n&&(t.blockWidth=n.blockWidth,t.blockHeight=n.blockHeight)}const n=o.exec(e);if(n){const[,s,i,o,a,c]=n,l=`${o}${i}`,u=(0,r.vE)(l),h=8*u.byteLength,d=s.length,f=[h,d>=2?h:0,d>=3?h:0,d>=4?h:0];t={format:e,attachment:t.attachment,dataType:u.signedType,components:d,channels:s,integer:u.integer,signed:u.signed,normalized:u.normalized,bitsPerChannel:f,bytesPerPixel:u.byteLength*s.length,packed:t.packed,srgb:t.srgb},"-webgl"===c&&(t.webgl=!0),"-srgb"===a&&(t.srgb=!0)}return e.endsWith("-webgl")&&(t.webgl=!0),e.endsWith("-srgb")&&(t.srgb=!0),t}},25593:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(92189),s=n(99551),i=n(79431);class o{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new r.A(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObjectAsync(e){return this._pickClosestObjectAsync(e)}pickObjectsAsync(e){return this._pickVisibleObjectsAsync(e)}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:n,viewports:r},s=this.lastPickedInfo.info){const i=s&&s.layer&&s.layer.id,o=s&&s.viewport&&s.viewport.id,a=i?n.find(e=>e.id===i):null,c=o&&r.find(e=>e.id===o)||r[0],l=c&&c.unproject([e-c.x,t-c.y]),u={x:e,y:t,viewport:c,coordinate:l,layer:a};return{...s,...u}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const e=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=e}const{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(e=>this.pickLayersPass.shouldDrawLayer(e)&&!e.isComposite);return t.length?t:null}async _pickClosestObjectAsync({layers:e,views:t,viewports:n,x:r,y:o,radius:a=0,depth:c=1,mode:l="query",unproject3D:u,onViewportActive:h,effects:d}){const f=this.device.canvasContext.cssToDeviceRatio(),p=this._getPickable(e);if(!p||0===n.length)return{result:[],emptyInfo:(0,i.nK)({viewports:n,x:r,y:o,pixelRatio:f})};this._resizeBuffer();const g=this.device.canvasContext.cssToDevicePixels([r,o],!0),_=[g.x+Math.floor(g.width/2),g.y+Math.floor(g.height/2)],m=Math.round(a*f),{width:v,height:b}=this.pickingFBO,y=this._getPickingRect({deviceX:_[0],deviceY:_[1],deviceRadius:m,deviceWidth:v,deviceHeight:b}),E={x:r-a,y:o-a,width:2*a+1,height:2*a+1};let w;const x=[],T=new Set;for(let A=0;A<c;A++){let e,a;if(y){const r=this._drawAndSample({layers:p,views:t,viewports:n,onViewportActive:h,deviceRect:y,cullRect:E,effects:d,pass:`picking:${l}`});e=(0,s.F)({...r,deviceX:_[0],deviceY:_[1],deviceRadius:m,deviceRect:y})}else e={pickedColor:null,pickedObjectIndex:-1};if(e.pickedLayer&&u&&this.depthFBO){const{pickedColors:r}=this._drawAndSample({layers:[e.pickedLayer],views:t,viewports:n,onViewportActive:h,deviceRect:{x:e.pickedX,y:e.pickedY,width:1,height:1},cullRect:E,effects:d,pass:`picking:${l}:z`},!0);r[3]&&(a=r[0])}e.pickedLayer&&A+1<c&&(T.add(e.pickedLayer),e.pickedLayer.disablePickingIndex(e.pickedObjectIndex)),w=(0,i.r6)({pickInfo:e,lastPickedInfo:this.lastPickedInfo,mode:l,layers:p,viewports:n,x:r,y:o,z:a,pixelRatio:f});for(const t of w.values())t.layer&&x.push(t);if(!e.pickedColor)break}for(const s of T)s.restorePickingColors();return{result:x,emptyInfo:w.get(null)}}_pickClosestObject({layers:e,views:t,viewports:n,x:r,y:o,radius:a=0,depth:c=1,mode:l="query",unproject3D:u,onViewportActive:h,effects:d}){const f=this.device.canvasContext.cssToDeviceRatio(),p=this._getPickable(e);if(!p||0===n.length)return{result:[],emptyInfo:(0,i.nK)({viewports:n,x:r,y:o,pixelRatio:f})};this._resizeBuffer();const g=this.device.canvasContext.cssToDevicePixels([r,o],!0),_=[g.x+Math.floor(g.width/2),g.y+Math.floor(g.height/2)],m=Math.round(a*f),{width:v,height:b}=this.pickingFBO,y=this._getPickingRect({deviceX:_[0],deviceY:_[1],deviceRadius:m,deviceWidth:v,deviceHeight:b}),E={x:r-a,y:o-a,width:2*a+1,height:2*a+1};let w;const x=[],T=new Set;for(let A=0;A<c;A++){let e,a;if(y){const r=this._drawAndSample({layers:p,views:t,viewports:n,onViewportActive:h,deviceRect:y,cullRect:E,effects:d,pass:`picking:${l}`});e=(0,s.F)({...r,deviceX:_[0],deviceY:_[1],deviceRadius:m,deviceRect:y})}else e={pickedColor:null,pickedObjectIndex:-1};if(e.pickedLayer&&u&&this.depthFBO){const{pickedColors:r}=this._drawAndSample({layers:[e.pickedLayer],views:t,viewports:n,onViewportActive:h,deviceRect:{x:e.pickedX,y:e.pickedY,width:1,height:1},cullRect:E,effects:d,pass:`picking:${l}:z`},!0);r[3]&&(a=r[0])}e.pickedLayer&&A+1<c&&(T.add(e.pickedLayer),e.pickedLayer.disablePickingIndex(e.pickedObjectIndex)),w=(0,i.r6)({pickInfo:e,lastPickedInfo:this.lastPickedInfo,mode:l,layers:p,viewports:n,x:r,y:o,z:a,pixelRatio:f});for(const t of w.values())t.layer&&x.push(t);if(!e.pickedColor)break}for(const s of T)s.restorePickingColors();return{result:x,emptyInfo:w.get(null)}}async _pickVisibleObjectsAsync({layers:e,views:t,viewports:n,x:r,y:o,width:a=1,height:c=1,mode:l="query",maxObjects:u=null,onViewportActive:h,effects:d}){const f=this._getPickable(e);if(!f||0===n.length)return[];this._resizeBuffer();const p=this.device.canvasContext.cssToDeviceRatio(),g=this.device.canvasContext.cssToDevicePixels([r,o],!0),_=g.x,m=g.y+g.height,v=this.device.canvasContext.cssToDevicePixels([r+a,o+c],!0),b=v.x+v.width,y=v.y,E={x:_,y:y,width:b-_,height:m-y},w=this._drawAndSample({layers:f,views:t,viewports:n,onViewportActive:h,deviceRect:E,cullRect:{x:r,y:o,width:a,height:c},effects:d,pass:`picking:${l}`}),x=(0,s.q)(w),T=new Map,A=[],S=Number.isFinite(u);for(let s=0;s<x.length&&!(S&&A.length>=u);s++){const e=x[s];let t={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:r,y:o,pixelRatio:p};t=(0,i.Rz)({layer:e.pickedLayer,info:t,mode:l});const n=t.layer.id;T.has(n)||T.set(n,new Set);const a=T.get(n),c=t.object??t.index;a.has(c)||(a.add(c),A.push(t))}return A}_pickVisibleObjects({layers:e,views:t,viewports:n,x:r,y:o,width:a=1,height:c=1,mode:l="query",maxObjects:u=null,onViewportActive:h,effects:d}){const f=this._getPickable(e);if(!f||0===n.length)return[];this._resizeBuffer();const p=this.device.canvasContext.cssToDeviceRatio(),g=this.device.canvasContext.cssToDevicePixels([r,o],!0),_=g.x,m=g.y+g.height,v=this.device.canvasContext.cssToDevicePixels([r+a,o+c],!0),b=v.x+v.width,y=v.y,E={x:_,y:y,width:b-_,height:m-y},w=this._drawAndSample({layers:f,views:t,viewports:n,onViewportActive:h,deviceRect:E,cullRect:{x:r,y:o,width:a,height:c},effects:d,pass:`picking:${l}`}),x=(0,s.q)(w),T=new Map,A=[],S=Number.isFinite(u);for(let s=0;s<x.length&&!(S&&A.length>=u);s++){const e=x[s];let t={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:r,y:o,pixelRatio:p};t=(0,i.Rz)({layer:e.pickedLayer,info:t,mode:l});const n=t.layer.id;T.has(n)||T.set(n,new Set);const a=T.get(n),c=t.object??t.index;a.has(c)||(a.add(c),A.push(t))}return A}async _drawAndSampleAsync({layers:e,views:t,viewports:n,onViewportActive:r,deviceRect:s,cullRect:i,effects:o,pass:a},c=!1){const l=c?this.depthFBO:this.pickingFBO,u={layers:e,layerFilter:this.layerFilter,views:t,viewports:n,onViewportActive:r,pickingFBO:l,deviceRect:s,cullRect:i,effects:o,pass:a,pickZ:c,preRenderStats:{},isPicking:!0};for(const m of o)m.useInPicking&&(u.preRenderStats[m.id]=m.preRender(u));const{decodePickingColor:h}=this.pickLayersPass.render(u),{x:d,y:f,width:p,height:g}=s,_=new(c?Float32Array:Uint8Array)(p*g*4);return this.device.readPixelsToArrayWebGL(l,{sourceX:d,sourceY:f,sourceWidth:p,sourceHeight:g,target:_}),{pickedColors:_,decodePickingColor:h}}_drawAndSample({layers:e,views:t,viewports:n,onViewportActive:r,deviceRect:s,cullRect:i,effects:o,pass:a},c=!1){const l=c?this.depthFBO:this.pickingFBO,u={layers:e,layerFilter:this.layerFilter,views:t,viewports:n,onViewportActive:r,pickingFBO:l,deviceRect:s,cullRect:i,effects:o,pass:a,pickZ:c,preRenderStats:{},isPicking:!0};for(const m of o)m.useInPicking&&(u.preRenderStats[m.id]=m.preRender(u));const{decodePickingColor:h}=this.pickLayersPass.render(u),{x:d,y:f,width:p,height:g}=s,_=new(c?Float32Array:Uint8Array)(p*g*4);return this.device.readPixelsToArrayWebGL(l,{sourceX:d,sourceY:f,sourceWidth:p,sourceHeight:g,target:_}),{pickedColors:_,decodePickingColor:h}}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:n,deviceWidth:r,deviceHeight:s}){const i=Math.max(0,e-n),o=Math.max(0,t-n),a=Math.min(r,e+n+1)-i,c=Math.min(s,t+n+1)-o;return a<=0||c<=0?null:{x:i,y:o,width:a,height:c}}}},25667:(e,t,n)=>{n.d(t,{$M:()=>i,Vl:()=>a,_Z:()=>p,cT:()=>f,on:()=>c,zi:()=>o});var r=n(23459),s=n(87597);function i(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function o(e,t){const n=e%t;return n<0?t+n:n}function a(e){return[e[12],e[13],e[14]]}function c(e){return{left:u(e[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),right:u(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),bottom:u(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),top:u(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),near:u(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),far:u(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14])}}const l=new s.P;function u(e,t,n,r){l.set(e,t,n);const i=l.len();return{distance:r/i,normal:new s.P(-e/i,-t/i,-n/i)}}function h(e){return e-Math.fround(e)}let d;function f(e,t){const{size:n=1,startIndex:s=0}=t,i=void 0!==t.endIndex?t.endIndex:e.length,o=(i-s)/n;d=r.A.allocate(d,o,{type:Float32Array,size:2*n});let a=s,c=0;for(;a<i;){for(let t=0;t<n;t++){const r=e[a++];d[c+t]=r,d[c+t+n]=h(r)}c+=2*n}return d.subarray(0,o*n*2)}function p(e){let t=null,n=!1;for(const r of e)r&&(t?(n||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],n=!0),t[0][0]=Math.min(t[0][0],r[0][0]),t[0][1]=Math.min(t[0][1],r[0][1]),t[1][0]=Math.max(t[1][0],r[1][0]),t[1][1]=Math.max(t[1][1],r[1][1])):t=r);return t}},26369:(e,t,n)=>{function r(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}n.d(t,{v:()=>r})},26397:(e,t,n)=>{n.d(t,{_:()=>i});var r=n(56769);const s=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class i extends r.p{constructor(e,t,n){super(e,t,{enable:!0,...n}),this.handleEvent=e=>{this.handleOverEvent(e),this.handleOutEvent(e),this.handleEnterEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,s.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){s.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){switch(e){case"pointermove":this.enableMoveEvent=t;break;case"pointerover":this.enableOverEvent=t;break;case"pointerout":this.enableOutEvent=t;break;case"pointerenter":this.enableEnterEvent=t;break;case"pointerleave":this.enableLeaveEvent=t}}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.buttons&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}},26839:(e,t,n)=>{n.d(t,{h:()=>s});var r=n(5153);class s extends r.F{static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,t){const n={...t};(t.usage||0)&s.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?n.indexType="uint32":t.data instanceof Uint16Array&&(n.indexType="uint16")),delete n.data,super(e,n,s.defaultProps),this.usage=n.usage||0,this.indexType=n.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,t,n){const r=ArrayBuffer.isView(e)?e.buffer:e,i=Math.min(e?e.byteLength:n,s.DEBUG_DATA_MAX_LENGTH);null===r?this.debugData=new ArrayBuffer(i):0===t&&n===r.byteLength?this.debugData=r.slice(0,i):this.debugData=r.slice(t,t+i)}static defaultProps={...r.F.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",onMapped:void 0}}},28071:(e,t,n)=>{n.d(t,{E1:()=>o,S3:()=>i,by:()=>s});const r=/\?.*/;function s(e){const t=e.match(r);return t&&t[0]}function i(e){return e.replace(r,"")}function o(e){if(e.length<50)return e;const t=e.slice(e.length-15);return`${e.substr(0,32)}...${t}`}},28176:(e,t,n)=>{n.d(t,{U:()=>s});var r=n(57856);class s extends r.d{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,t){if(super(e,t),this.device=e,t.count>1)throw new Error("WebGL QuerySet can only have one value");const n=this.device.gl.createQuery();if(!n)throw new Error("WebGL query not supported");this.handle=n,Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((n,r)=>{const s=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}}},29651:(e,t,n)=>{n.d(t,{R:()=>r});const r=new(n(39965).t)({id:"luma.gl"})},30416:(e,t,n)=>{n.d(t,{l:()=>u});var r=n(74588),s=n(83909),i=n(29651),o=n(62053),a=n(25299),c=n(67483);class l extends r.Y{type="webgl";constructor(){super(),s.pF.defaultProps={...s.pF.defaultProps,...a.ic}}enforceWebGL2(e){(0,o.c)(e)}isSupported(){return"undefined"!=typeof WebGL2RenderingContext}isDeviceHandle(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||("undefined"!=typeof WebGLRenderingContext&&e instanceof WebGLRenderingContext&&i.R.warn("WebGL1 is not supported",e)(),!1)}async attach(e,t={}){const{WebGLDevice:r}=await Promise.resolve().then(n.bind(n,185));if(e instanceof r)return e;if(e?.device instanceof r)return e.device;if(!function(e){if("undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)return!0;return Boolean(e&&Number.isFinite(e._version))}(e))throw new Error("Invalid WebGL2RenderingContext");const s=!0===t.createCanvasContext?{}:t.createCanvasContext;return new r({...t,_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1,...s}})}async create(e={}){const{WebGLDevice:t}=await Promise.resolve().then(n.bind(n,185));i.R.groupCollapsed(1,"WebGLDevice created")();try{const n=[];(e.debugWebGL||e.debug)&&n.push((0,c.$)()),e.debugSpectorJS&&n.push((0,a._G)(e));const r=await Promise.allSettled(n);for(const e of r)"rejected"===e.status&&i.R.error(`Failed to initialize debug libraries ${e.reason}`)();const s=new t(e),o=`${s._reused?"Reusing":"Created"} device with WebGL2 ${s.props.debug?"debug ":""}context: ${s.info.vendor}, ${s.info.renderer} for canvas: ${s.canvasContext.id}`;return i.R.probe(1,o)(),i.R.table(1,s.info)(),s}finally{i.R.groupEnd(1)()}}}const u=new l},30440:(e,t,n)=>{function r(e){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)}function s(e){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e)}n.d(t,{$:()=>s,U:()=>r})},30853:(e,t,n)=>{n.d(t,{a:()=>s,r:()=>i});var r=n(91097);function s(e,t,n=16){if(e!==t)return!1;const s=e,i=t;if(!(0,r.p)(s))return!1;if((0,r.p)(i)&&s.length===i.length)for(let r=0;r<s.length;++r)if(i[r]!==s[r])return!1;return!0}function i(e){return(0,r.p)(e)?e.slice():e}},30983:(e,t,n)=>{n.d(t,{L:()=>s});const r={};function s(e="id"){r[e]=r[e]||1;return`${e}-${r[e]++}`}},31327:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(34938),s=n(3065),i=n(74334),o=n(48244),a=n(24145);const c={};const l={name:"project",dependencies:[r.i,s.A],source:o.B,vs:a.s,getUniforms:function(e=c){return"viewport"in e?(0,i.a)(e):{}},uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}}},31661:(e,t,n)=>{n.d(t,{Kd:()=>_,Mg:()=>f,V_:()=>r,hE:()=>u,pK:()=>g,xI:()=>d});const r={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},s=(e,t,n)=>t?e.enable(n):e.disable(n),i=(e,t,n)=>e.hint(n,t),o=(e,t,n)=>e.pixelStorei(n,t),a=(e,t,n)=>{const r=36006===n?36009:36008;return e.bindFramebuffer(r,t)},c=(e,t,n)=>{const r={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];e.bindBuffer(r,t)};function l(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}const u={3042:s,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:s,2885:(e,t)=>e.cullFace(t),2929:s,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:s,35723:i,35725:(e,t)=>e.useProgram(t),36007:(e,t)=>e.bindRenderbuffer(36161,t),36389:(e,t)=>e.bindTransformFeedback?.(36386,t),34229:(e,t)=>e.bindVertexArray(t),36006:a,36010:a,34964:c,36662:c,36663:c,35053:c,35055:c,2886:(e,t)=>e.frontFace(t),33170:i,2849:(e,t)=>e.lineWidth(t),32823:s,32824:"polygonOffset",10752:"polygonOffset",35977:s,32926:s,32928:s,32938:"sampleCoverage",32939:"sampleCoverage",3089:s,3088:(e,t)=>e.scissor(...t),2960:s,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),34383:s,10754:s,12288:s,12289:s,12290:s,12291:s,12292:s,12293:s,12294:s,12295:s,3333:o,3317:o,37440:o,37441:o,37443:o,3330:o,3332:o,3331:o,3314:o,32878:o,3316:o,3315:o,32877:o,framebuffer:(e,t)=>{const n=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,n)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{const n="number"==typeof t?[t,t]:t;e.blendEquationSeparate(...n)},blendFunc:(e,t)=>{const n=2===t?.length?[...t,...t]:t;e.blendFuncSeparate(...n)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(t[0],t[1]||!1),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=l(t)?t:[t,t];const[n,r]=t;e.stencilMaskSeparate(1028,n),e.stencilMaskSeparate(1029,r)},stencilFunc:(e,t)=>{t=l(t)&&3===t.length?[...t,...t]:t;const[n,r,s,i,o,a]=t;e.stencilFuncSeparate(1028,n,r,s),e.stencilFuncSeparate(1029,i,o,a)},stencilOp:(e,t)=>{t=l(t)&&3===t.length?[...t,...t]:t;const[n,r,s,i,o,a]=t;e.stencilOpSeparate(1028,n,r,s),e.stencilOpSeparate(1029,i,o,a)},viewport:(e,t)=>e.viewport(...t)};function h(e,t,n){return void 0!==t[e]?t[e]:n[e]}const d={blendEquation:(e,t,n)=>e.blendEquationSeparate(h(32777,t,n),h(34877,t,n)),blendFunc:(e,t,n)=>e.blendFuncSeparate(h(32969,t,n),h(32968,t,n),h(32971,t,n),h(32970,t,n)),polygonOffset:(e,t,n)=>e.polygonOffset(h(32824,t,n),h(10752,t,n)),sampleCoverage:(e,t,n)=>e.sampleCoverage(h(32938,t,n),h(32939,t,n)),stencilFuncFront:(e,t,n)=>e.stencilFuncSeparate(1028,h(2962,t,n),h(2967,t,n),h(2963,t,n)),stencilFuncBack:(e,t,n)=>e.stencilFuncSeparate(1029,h(34816,t,n),h(36003,t,n),h(36004,t,n)),stencilOpFront:(e,t,n)=>e.stencilOpSeparate(1028,h(2964,t,n),h(2965,t,n),h(2966,t,n)),stencilOpBack:(e,t,n)=>e.stencilOpSeparate(1029,h(34817,t,n),h(34818,t,n),h(34819,t,n))},f={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,n)=>e({[t]:n}),hint:(e,t,n)=>e({[t]:n}),useProgram:(e,t)=>e({35725:t}),bindRenderbuffer:(e,t,n)=>e({36007:n}),bindTransformFeedback:(e,t,n)=>e({36389:n}),bindVertexArray:(e,t)=>e({34229:t}),bindFramebuffer:(e,t,n)=>{switch(t){case 36160:return e({36006:n,36010:n});case 36009:return e({36006:n});case 36008:return e({36010:n});default:return null}},bindBuffer:(e,t,n)=>{const r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[t];return r?e({[r]:n}):{valueChanged:!0}},blendColor:(e,t,n,r,s)=>e({32773:new Float32Array([t,n,r,s])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,n)=>e({32777:t,34877:n}),blendFunc:(e,t,n)=>e({32969:t,32968:n,32971:t,32970:n}),blendFuncSeparate:(e,t,n,r,s)=>e({32969:t,32968:n,32971:r,32970:s}),clearColor:(e,t,n,r,s)=>e({3106:new Float32Array([t,n,r,s])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,n,r,s)=>e({3107:[t,n,r,s]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,n)=>e({2928:new Float32Array([t,n])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,n)=>e({32824:t,10752:n}),sampleCoverage:(e,t,n)=>e({32938:t,32939:n}),scissor:(e,t,n,r,s)=>e({3088:new Int32Array([t,n,r,s])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,n)=>e({[1028===t?2968:36005]:n}),stencilFunc:(e,t,n,r)=>e({2962:t,2967:n,2963:r,34816:t,36003:n,36004:r}),stencilFuncSeparate:(e,t,n,r,s)=>e({[1028===t?2962:34816]:n,[1028===t?2967:36003]:r,[1028===t?2963:36004]:s}),stencilOp:(e,t,n,r)=>e({2964:t,2965:n,2966:r,34817:t,34818:n,34819:r}),stencilOpSeparate:(e,t,n,r,s)=>e({[1028===t?2964:34817]:n,[1028===t?2965:34818]:r,[1028===t?2966:34819]:s}),viewport:(e,t,n,r,s)=>e({2978:[t,n,r,s]})},p=(e,t)=>e.isEnabled(t),g={3042:p,2884:p,2929:p,3024:p,32823:p,32926:p,32928:p,3089:p,2960:p,35977:p},_=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068])},31886:(e,t,n)=>{n.d(t,{k:()=>_});var r,s=n(46022),i=n(73731),o=n(68225),a=n(90218),c=n(83588),l=n(82859),u=n(39426);!function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"}(r||(r={}));const h=45*Math.PI/180,d=1,f=.1,p=500,g=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class _ extends s.u{static get IDENTITY(){return function(){v||(v=new _,Object.freeze(v));return v}()}static get ZERO(){return function(){m||(m=new _([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(m));return m}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return r}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,n,r,s,i,o,a,c,l,u,h,d,f,p,g){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=s,this[5]=i,this[6]=o,this[7]=a,this[8]=c,this[9]=l,this[10]=u,this[11]=h,this[12]=d,this[13]=f,this[14]=p,this[15]=g,this.check()}setRowMajor(e,t,n,r,s,i,o,a,c,l,u,h,d,f,p,g){return this[0]=e,this[1]=s,this[2]=c,this[3]=d,this[4]=t,this[5]=i,this[6]=l,this[7]=f,this[8]=n,this[9]=o,this[10]=u,this[11]=p,this[12]=r,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(g)}fromObject(e){return this.check()}fromQuaternion(e){return(0,a.I0)(this,e),this.check()}frustum(e){const{left:t,right:n,bottom:r,top:s,near:i=f,far:o=p}=e;return o===1/0?function(e,t,n,r,s,i){const o=2*i/(n-t),a=2*i/(s-r),c=(n+t)/(n-t),l=(s+r)/(s-r),u=-1,h=-1,d=-2*i;e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=c,e[9]=l,e[10]=u,e[11]=h,e[12]=0,e[13]=0,e[14]=d,e[15]=0}(this,t,n,r,s,i):(0,a.$h)(this,t,n,r,s,i,o),this.check()}lookAt(e){const{eye:t,center:n=[0,0,0],up:r=[0,1,0]}=e;return(0,a.t5)(this,t,n,r),this.check()}ortho(e){const{left:t,right:n,bottom:r,top:s,near:i=f,far:o=p}=e;return(0,a.v3)(this,t,n,r,s,i,o),this.check()}orthographic(e){const{fovy:t=h,aspect:n=d,focalDistance:r=1,near:s=f,far:i=p}=e;b(t);const o=t/2,a=r*Math.tan(o),c=a*n;return this.ortho({left:-c,right:c,bottom:-a,top:a,near:s,far:i})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:n=1,near:r=.1,far:s=500}=e;return b(t),(0,a.fN)(this,t,n,r,s),this.check()}determinant(){return(0,a.a4)(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),r=1/n[0],s=1/n[1],i=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*i,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*i,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),r=1/n[0],s=1/n[1],i=1/n[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*i,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*i,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*i,e}transpose(){return(0,a.mg)(this,this),this.check()}invert(){return(0,a.B8)(this,this),this.check()}multiplyLeft(e){return(0,a.lw)(this,e,this),this.check()}multiplyRight(e){return(0,a.lw)(this,this,e),this.check()}rotateX(e){return(0,a.eL)(this,this,e),this.check()}rotateY(e){return(0,a.Z8)(this,this,e),this.check()}rotateZ(e){return(0,a.Qr)(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return(0,a.e$)(this,this,e,t),this.check()}scale(e){return(0,a.hs)(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return(0,a.Tl)(this,this,e),this.check()}transform(e,t){return 4===e.length?(t=(0,u.Z0)(t||[-0,-0,-0,-0],e,this),(0,i.qk)(t,4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:n}=e;let r;switch(n){case 2:r=(0,c.Z0)(t||[-0,-0],e,this);break;case 3:r=(0,l.Z0)(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return(0,i.qk)(r,e.length),r}transformAsVector(e,t){let n;switch(e.length){case 2:n=(0,o.B$)(t||[-0,-0],e,this);break;case 3:n=(0,o.cL)(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return(0,i.qk)(n,e.length),n}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,n){return this.identity().translate([e,t,n])}}let m,v;function b(e){if(e>2*Math.PI)throw Error("expected radians")}},32077:(e,t,n)=>{async function r(e,t){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",e),t&&(r.id=t),new Promise((t,s)=>{r.onload=t,r.onerror=t=>s(new Error(`Unable to load script '${e}': ${t}`)),n.appendChild(r)})}n.d(t,{k:()=>r})},32126:(e,t,n)=>{var r=n(36157);n(93871),n(77264);r.o},32264:(e,t,n)=>{n.d(t,{C:()=>o});var r=n(88967),s=n(70177);const i=512;function o(e){const{width:t,height:n,pitch:o=0}=e;let{longitude:a,latitude:c,zoom:l,bearing:u=0}=e;(a<-180||a>180)&&(a=(0,s.zi)(a+180,360)-180),(u<-180||u>180)&&(u=(0,s.zi)(u+180,360)-180);const h=(0,s.p6)(n/i);if(l<=h)l=h,c=0;else{const e=n/2/Math.pow(2,l),t=(0,r.iV)([0,e])[1];if(c<t)c=t;else{const t=(0,r.iV)([0,i-e])[1];c>t&&(c=t)}}return{width:t,height:n,longitude:a,latitude:c,zoom:l,pitch:o,bearing:u}}},32367:(e,t,n)=>{n.d(t,{q:()=>s});var r=n(30853);class s{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const t=e?.shaderLayout.bindings?.find(t=>"uniform"===t.type&&t.name===e?.name);if(!t)throw new Error(e?.name);const n=t;for(const e of n.uniforms||[])this.bindingLayout[e.name]=e}}setUniforms(e){for(const[t,n]of Object.entries(e))this._setUniform(t,n),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${t}=${n}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){(0,r.a)(this.uniforms[e],t)||(this.uniforms[e]=(0,r.r)(t),this.modifiedUniforms[e]=!0,this.modified=!0)}}},32429:(e,t,n)=>{n.d(t,{i:()=>a,l:()=>o});var r=n(73968),s=n(28071),i=n(49987);function o(e,t,n){if(n)return n;const o={fetch:(0,r.z)(t,e),...e};if(o.url){const e=(0,s.S3)(o.url);o.baseUrl=e,o.queryString=(0,s.by)(o.url),o.filename=i.iW(e),o.baseUrl=i.pD(e)}return Array.isArray(o.loaders)||(o.loaders=null),o}function a(e,t){if(e&&!Array.isArray(e))return e;let n;if(e&&(n=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];n=n?[...n,...e]:e}return n&&n.length?n:void 0}},33027:(e,t,n)=>{n.d(t,{K:()=>A});var r=n(26839),s=n(80698),i=n(75638),o=n(89277),a=n(22512),c=n(85007),l=n(72246),u=n(29651),h=n(2021),d=n(33952),f=n(74805),p=n(96100),g=n(12716),_=n(82027),m=n(44684),v=n(12345),b=n(74559),y=n(61166),E=n(74092),w=n(4500),x=n(13461),T=n(86143);class A{static defaultProps={...a.r.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:d._.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,t){this.props={...A.defaultProps,...t},t=this.props,this.id=t.id||(0,w.L)("model"),this.device=e,Object.assign(this.userData,t.userData);const n=Object.fromEntries(this.props.modules?.map(e=>[e.name,e])||[]),r=t.shaderInputs||new x.l(n,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(r);const s=function(e){return{type:e.type,shaderLanguage:e.info.shadingLanguage,shaderLanguageVersion:e.info.shadingLanguageVersion,gpu:e.info.gpu,features:e.features}}(e),i=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if("webgpu"===this.device.type&&this.props.source){const{source:e,getUniforms:t}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:s,...this.props,modules:i});this.source=e,this._getModuleUniforms=t,this.props.shaderLayout||=(0,f.$)(this.source)}else{const{vs:e,fs:t,getUniforms:n}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:s,...this.props,modules:i});this.vs=e,this.fs=t,this._getModuleUniforms=n}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,t.geometry&&this.setGeometry(t.geometry),this.pipelineFactory=t.pipelineFactory||g.N.getDefaultPipelineFactory(this.device),this.shaderFactory=t.shaderFactory||_.g.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in t&&(this.isInstanced=t.isInstanced),t.instanceCount&&this.setInstanceCount(t.instanceCount),t.vertexCount&&this.setVertexCount(t.vertexCount),t.indexBuffer&&this.setIndexBuffer(t.indexBuffer),t.attributes&&this.setAttributes(t.attributes),t.constantAttributes&&this.setConstantAttributes(t.constantAttributes),t.bindings&&this.setBindings(t.bindings),t.transformFeedback&&(this.transformFeedback=t.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const t=this._areBindingsLoading();if(t)return u.R.info(2,`>>> DRAWING ABORTED ${this.id}: ${t} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let n;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const t=this._getBindings();this.pipeline.setBindings(t,{disableWarnings:this.props.disableWarnings});const{indexBuffer:r}=this.vertexArray,s=r?r.byteLength/("uint32"===r.indexType?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){this._gpuGeometry?.destroy();const t=e&&(0,p.d3)(this.device,e);if(t){this.setTopology(t.topology||"triangle-list");const e=new y.F(this.bufferLayout);this.bufferLayout=e.mergeBufferLayouts(t.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(t)}this._gpuGeometry=t}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const t=new y.F(this.bufferLayout);this.bufferLayout=this._gpuGeometry?t.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){(0,b.b)(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,void 0===this.isInstanced&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new c.K(this.shaderInputs.modules);for(const[t,n]of Object.entries(this.shaderInputs.modules))if(S(n)){const e=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings[`${t}Uniforms`]=e}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){const n=t?.disableWarnings??this.props.disableWarnings;e.indices&&u.R.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=(0,E.F)(this.pipeline.shaderLayout,this.bufferLayout);const r=new y.F(this.bufferLayout);for(const[s,i]of Object.entries(e)){const e=r.getBufferLayout(s);if(!e){n||u.R.warn(`Model(${this.id}): Missing layout for buffer "${s}".`)();continue}const t=r.getAttributeNamesForBuffer(e);let o=!1;for(const n of t){const e=this._attributeInfos[n];if(e){const t="webgpu"===this.device.type?r.getBufferIndex(e.bufferName):e.location;this.vertexArray.setBuffer(t,i),o=!0}}o||n||u.R.warn(`Model(${this.id}): Ignoring buffer "${i.id}" for unknown attribute "${s}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[n,r]of Object.entries(e)){const e=this._attributeInfos[n];e?this.vertexArray.setConstantWebGL(e.location,r):(t?.disableWarnings??this.props.disableWarnings)||u.R.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${n}"`)()}this.setNeedsRedraw("constants")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof T.iR&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[t,n]of Object.entries(this.bindings))n instanceof T.iR?n.isReady&&(e[t]=n.texture):e[t]=n;return e}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof i.X?e=Math.max(e,t.texture.updateTimestamp):t instanceof r.h||t instanceof s.g?e=Math.max(e,t.updateTimestamp):t instanceof T.iR?e=t.texture?Math.max(e,t.texture.updateTimestamp):1/0:t instanceof o.L||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t={...e.attributes};for(const[n]of Object.entries(t))this.pipeline.shaderLayout.attributes.find(e=>e.name===n)||"positions"===n||delete t[n];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(u.R.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let r=null;this.source?r=n:this.fs&&(r=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:n,fs:r}),this._attributeInfos=(0,h.P)(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const e=u.R.level>3?0:1e4;u.R.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,u.R.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:u.R.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=(0,m.m)(this.pipeline.shaderLayout,this.id);u.R.table(2,e)();const t=this.shaderInputs.getDebugTable();u.R.table(2,t)();const n=this._getAttributeDebugTable();u.R.table(2,this._attributeInfos)(),u.R.table(2,n)(),u.R.groupEnd(2)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){const t=this.device.props.debugFramebuffers;if(this._drawCount++,!t)return;const n=e.props.framebuffer;n&&(0,v.D)(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,n]of Object.entries(this._attributeInfos)){const r=this.vertexArray.attributes[n.location];e[n.location]={name:t,type:n.shaderType,values:r?this._getBufferOrConstantValues(r,n.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,n="uint32"===t.indexType?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:n.toString()}}return e}_getBufferOrConstantValues(e,t){const n=(0,l.Ak)(t);return(e instanceof r.h?new n(e.debugData):e).toString()}}function S(e){return Boolean(e.uniformTypes&&!function(e){for(const t in e)return!1;return!0}(e.uniformTypes))}},33213:(e,t,n)=>{n.d(t,{N1:()=>r});const r="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"";"undefined"!=typeof window?window:global,"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document},33429:(e,t,n)=>{n.d(t,{O_:()=>c,Uu:()=>l,bv:()=>h});var r=n(55026);const s={vertex:r.T,fragment:r.b},i=/void\s+main\s*\([^)]*\)\s*\{\n?/,o=/}\n?[^{}]*$/,a=[],c="__LUMA_INJECT_DECLARATIONS__";function l(e){const t={vertex:{},fragment:{}};for(const n in e){let r=e[n];"string"==typeof r&&(r={order:0,injection:r}),t[u(n)][n]=r}return t}function u(e){const t=e.slice(0,2);switch(t){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(t)}}function h(e,t,n,r=!1){const l="vertex"===t;for(const s in n){const t=n[s];t.sort((e,t)=>e.order-t.order),a.length=t.length;for(let e=0,n=t.length;e<n;++e)a[e]=t[e].injection;const r=`${a.join("\n")}\n`;switch(s){case"vs:#decl":l&&(e=e.replace(c,r));break;case"vs:#main-start":l&&(e=e.replace(i,e=>e+r));break;case"vs:#main-end":l&&(e=e.replace(o,e=>r+e));break;case"fs:#decl":l||(e=e.replace(c,r));break;case"fs:#main-start":l||(e=e.replace(i,e=>e+r));break;case"fs:#main-end":l||(e=e.replace(o,e=>r+e));break;default:e=e.replace(s,e=>e+r)}}return e=e.replace(c,""),r&&(e=e.replace(/\}\s*$/,e=>e+s[t])),e}},33808:(e,t,n)=>{n.d(t,{r:()=>i});var r=n(47612),s=n(21658);function i(e,t){return r.Bd?async function*(e,t){const n=e.getReader();let r;try{for(;;){const e=r||n.read();t?._streamReadAhead&&(r=n.read());const{done:i,value:o}=await e;if(i)return;yield(0,s.XA)(o)}}catch(i){n.releaseLock()}}(e,t):async function*(e){for await(const t of e)yield(0,s.XA)(t)}(e)}},33814:(e,t,n)=>{n.d(t,{XJ:()=>i,qW:()=>a,s6:()=>o});const r=/^data:image\/svg\+xml/,s=/\.svg((\?|#).*)?$/;function i(e){return e&&(r.test(e)||s.test(e))}function o(e,t){if(i(t)){let t=(new TextDecoder).decode(e);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(n){throw new Error(n.message)}return`data:image/svg+xml;base64,${btoa(t)}`}return a(e,t)}function a(e,t){if(i(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}},33945:(e,t,n)=>{n.d(t,{E:()=>i,r:()=>s});const r=/([0-9]+\.?[0-9]*)(%|px)/;function s(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":const t=r.exec(e);if(t&&t.length>=3){const e="%"===t[2],n=parseFloat(t[1]);return{position:e?n/100:n,relative:e}}default:throw new Error(`Could not parse position string ${e}`)}}function i(e,t){return e.relative?Math.round(e.position*t):e.position}},33952:(e,t,n)=>{n.d(t,{_:()=>o});var r=n(13995),s=n(69616),i=n(78623);class o{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return o.defaultShaderAssembler=o.defaultShaderAssembler||new o,o.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(t=>t.name===("string"==typeof e?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(e=>e.name!==t)}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const t=this._getModuleList(e.modules),n=this._hookFunctions,{source:r,getUniforms:o}=(0,s.l4)({...e,source:e.source,modules:t,hookFunctions:n});return{source:"wgsl"===e.platformInfo.shaderLanguage?(0,i.v)(r):r,getUniforms:o,modules:t}}assembleGLSLShaderPair(e){const t=this._getModuleList(e.modules),n=this._hookFunctions;return{...(0,s.uO)({...e,vs:e.vs,fs:e.fs,modules:t,hookFunctions:n}),modules:t}}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),n={};let s=0;for(let r=0,i=this._defaultModules.length;r<i;++r){const e=this._defaultModules[r],i=e.name;t[s++]=e,n[i]=!0}for(let r=0,i=e.length;r<i;++r){const i=e[r],o=i.name;n[o]||(t[s++]=i,n[o]=!0)}return t.length=s,(0,r.$g)(t),t}}},34113:(e,t,n)=>{n.d(t,{j:()=>c});var r=n(72246),s=n(86231),i=n(73390),o=n(91097),a=n(29651);class c{layout={};byteLength;constructor(e,t={}){let n=0;for(const[o,a]of Object.entries(e)){const e=(0,s.k0)(a),{type:i,components:c}=e,l=c*(t?.[o]??1);n=(0,r.JP)(n,l);const u=n;n+=l,this.layout[o]={type:i,size:l,offset:u}}n+=(4-n%4)%4;const i=4*n;this.byteLength=Math.max(i,1024)}getData(e){const t=(0,i.o)(this.byteLength),n={i32:new Int32Array(t),u32:new Uint32Array(t),f32:new Float32Array(t),f16:new Uint16Array(t)};for(const[r,s]of Object.entries(e)){const e=this.layout[r];if(!e){a.R.warn(`Supplied uniform value ${r} not present in uniform block layout`)();continue}const{type:t,size:i,offset:c}=e,l=n[t];if(1===i){if("number"!=typeof s&&"boolean"!=typeof s){a.R.warn(`Supplied value for single component uniform ${r} is not a number: ${s}`)();continue}l[c]=Number(s)}else{if(!(0,o.p)(s)){a.R.warn(`Supplied value for multi component / array uniform ${r} is not a numeric array: ${s}`)();continue}l.set(s,c)}}return new Uint8Array(t,0,this.byteLength)}has(e){return Boolean(this.layout[e])}get(e){return this.layout[e]}}},34336:(e,t,n)=>{n.d(t,{F:()=>o});var r=n(26369),s=n(70177),i=n(88967);function o(e){const{width:t,height:n,bounds:o,minExtent:a=0,maxZoom:c=24,offset:l=[0,0]}=e,[[u,h],[d,f]]=o,p=function(e=0){if("number"==typeof e)return{top:e,bottom:e,left:e,right:e};return(0,r.v)(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e}(e.padding),g=(0,i.Gw)([u,(0,s.qE)(f,-i.aH,i.aH)]),_=(0,i.Gw)([d,(0,s.qE)(h,-i.aH,i.aH)]),m=[Math.max(Math.abs(_[0]-g[0]),a),Math.max(Math.abs(_[1]-g[1]),a)],v=[t-p.left-p.right-2*Math.abs(l[0]),n-p.top-p.bottom-2*Math.abs(l[1])];(0,r.v)(v[0]>0&&v[1]>0);const b=v[0]/m[0],y=v[1]/m[1],E=(p.right-p.left)/2/b,w=(p.top-p.bottom)/2/y,x=[(_[0]+g[0])/2+E,(_[1]+g[1])/2+w],T=(0,i.iV)(x),A=Math.min(c,(0,s.p6)(Math.abs(Math.min(b,y))));return(0,r.v)(Number.isFinite(A)),{longitude:T[0],latitude:T[1],zoom:A}}},34617:(e,t,n)=>{n(70177),n(88967)},34782:(e,t,n)=>{n.d(t,{fY:()=>l,sy:()=>c});var r=n(74918),s=n(72246),i=n(49187),o=n(99254),a=n(94937);function c(e,t){const{sourceX:n=0,sourceY:r=0,sourceAttachment:c=0}=t||{};let{target:l=null,sourceWidth:h,sourceHeight:d,sourceDepth:f,sourceFormat:p,sourceType:g}=t||{};const{framebuffer:_,deleteFramebuffer:m}=u(e),{gl:v,handle:b}=_;h||=_.width,d||=_.height;const y=_.colorAttachments[c]?.texture;if(!y)throw new Error(`Invalid framebuffer attachment ${c}`);f=y?.depth||1,p||=y?.glFormat||6408,g||=y?.glType||5121,l=function(e,t,n,r,i){if(e)return e;t||=5121;const c=(0,a.q)(t),l=(0,s.Ak)(c),u=(0,o.c)(n);return new l(r*i*u)}(l,g,p,h,d);const E=(0,s.h1)(l);g=g||(0,i.k2)(E);const w=v.bindFramebuffer(36160,b);return v.readBuffer(36064+c),v.readPixels(n,r,h,d,p,g,l),v.readBuffer(36064),v.bindFramebuffer(36160,w||null),m&&_.destroy(),l}function l(e,t){const{target:n,sourceX:r=0,sourceY:s=0,sourceFormat:i=6408,targetByteOffset:a=0}=t||{};let{sourceWidth:c,sourceHeight:l,sourceType:h}=t||{};const{framebuffer:d,deleteFramebuffer:f}=u(e);c=c||d.width,l=l||d.height;const p=d;h=h||5121;let g=n;if(!g){const e=a+c*l*(0,o.c)(i)*(0,o.E)(h);g=p.device.createBuffer({byteLength:e})}const _=e.device.createCommandEncoder();return _.copyTextureToBuffer({sourceTexture:e,width:c,height:l,origin:[r,s],destinationBuffer:g,byteOffset:a}),_.destroy(),f&&d.destroy(),g}function u(e){return e instanceof r.G?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:h(e),deleteFramebuffer:!0}}function h(e,t){const{device:n,width:r,height:s,id:i}=e;return n.createFramebuffer({...t,id:`framebuffer-for-${i}`,width:r,height:s,colorAttachments:[e]})}},34938:(e,t,n)=>{n.d(t,{i:()=>r});const r={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n\n// All these functions are for substituting tan() function from Intel GPU only\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n\n    // 2pi range reduction\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n"}},35185:(e,t,n)=>{n.d(t,{$Q:()=>s});var r=n(13995);function s(e){(0,r.$g)(e);const t={},n={};i({modules:e,level:0,moduleMap:t,moduleDepth:n});const s=Object.keys(n).sort((e,t)=>n[t]-n[e]).map(e=>t[e]);return(0,r.$g)(s),s}function i(e){const{modules:t,level:n,moduleMap:r,moduleDepth:s}=e;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const i of t)r[i.name]=i,(void 0===s[i.name]||s[i.name]<n)&&(s[i.name]=n);for(const o of t)o.dependencies&&i({modules:o.dependencies,level:n+1,moduleMap:r,moduleDepth:s})}},35356:(e,t,n)=>{n.d(t,{g:()=>s});var r=n(50258);function s(e){const t=[];let n=0;for(;n<e.pointers.length;)t[n]={clientX:Math.round(e.pointers[n].clientX),clientY:Math.round(e.pointers[n].clientY)},n++;return{timeStamp:Date.now(),pointers:t,center:(0,r.q)(t),deltaX:e.deltaX,deltaY:e.deltaY}}},35560:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(2357);const s=()=>{},i=2,o=3,a=e=>e,c=1;class l{constructor(e){this._onTransitionUpdate=e=>{const{time:t,settings:{interpolator:n,startProps:r,endProps:s,duration:i,easing:o}}=e,a=o(t/i),c=n.interpolateProps(r,s,a);this.propsInTransition=this.getControllerState({...this.props,...c}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new r.A(e.timeline),this.onViewStateChange=e.onViewStateChange||s,this.onStateChange=e.onStateChange||s}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let r=n;if(this.transition.inProgress){const{interruption:e,endProps:t}=this.transition.settings;r={...n,...e===i?t:this.propsInTransition||n}}this._triggerTransition(r,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:n}=e;return(t>0||"auto"===t)&&Boolean(n)}_isUpdateDueToCurrentTransition(e){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){if(this.transition.inProgress){return this.transition.settings.interruption===o||this._isUpdateDueToCurrentTransition(t)}return!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const n=this.getControllerState(e),r=this.getControllerState(t).shortestPathFrom(n),s=t.transitionInterpolator,i=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===i)return;const o=s.initializeProps(e,r);this.propsInTransition={};const l={duration:i,easing:t.transitionEasing||a,interpolator:s,interruption:t.transitionInterruption||c,startProps:o.start,endProps:o.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(t)}}}},36157:(e,t,n)=>{n.d(t,{o:()=>o});var r=n(44860),s=n(77264),i=n(88171);class o extends r.f{attrTest(e){const t=this.options.pointers;return 0===t||e.pointers.length===t}process(e){const{state:t}=this,{eventType:n}=e,r=t&(s.g.Began|s.g.Changed),o=this.attrTest(e);return r&&(n&i.TL.Cancel||!o)?t|s.g.Cancelled:r||o?n&i.TL.End?t|s.g.Ended:t&s.g.Began?t|s.g.Changed:s.g.Began:s.g.Failed}}},36958:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(25285);class s extends r.A{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}},37906:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(87597);const s=[255,255,255],i=1,o=[0,0,-1];let a=0;class c{constructor(e={}){this.type="directional";const{color:t=s}=e,{intensity:n=i}=e,{direction:c=o}=e,{_shadow:l=!1}=e;this.id=e.id||"directional-"+a++,this.color=t,this.intensity=n,this.type="directional",this.direction=new r.P(c).normalize().toArray(),this.shadow=l}getProjectedLight(e){return this}}},37925:(e,t,n)=>{n.d(t,{g:()=>a});var r=n(83588),s=n(88967),i=n(70177);const o=Math.PI/180;function a(e,t=0){const{width:n,height:r,unproject:s}=e,i={targetZ:t},a=s([0,r],i),l=s([n,r],i);let u,h;return(e.fovy?.5*e.fovy*o:Math.atan(.5/e.altitude))>(90-e.pitch)*o-.01?(u=c(e,0,t),h=c(e,n,t)):(u=s([0,0],i),h=s([n,0],i)),[a,l,h,u]}function c(e,t,n){const{pixelUnprojectionMatrix:o}=e,a=(0,i._U)(o,[t,0,1,1]),c=(0,i._U)(o,[t,e.height,1,1]),l=(n*e.distanceScales.unitsPerMeter[2]-a[2])/(c[2]-a[2]),u=r.Cc([],a,c,l),h=(0,s.iV)(u);return h.push(n),h}},37946:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(327);class s{constructor(e,t,n){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=n,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const n=++this._loadCount;let s=e;"string"==typeof e&&(s=(0,r.H)(e)),s instanceof Promise?(this.isLoaded=!1,this._loader=s.then(e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=e)}).catch(e=>{this._loadCount===n&&(this.isLoaded=!0,this._error=e||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const r of this._subscribers)r.onChange(this.getData())}}},38055:(e,t,n)=>{function r(e,t=()=>!0){return Array.isArray(e)?s(e,t,[]):t(e)?[e]:[]}function s(e,t,n){let r=-1;for(;++r<e.length;){const i=e[r];Array.isArray(i)?s(i,t,n):t(i)&&n.push(i)}return n}function i({target:e,source:t,start:n=0,count:r=1}){const s=t.length,i=r*s;let o=0;for(let a=n;o<s;o++)e[a++]=t[o];for(;o<i;)o<i-o?(e.copyWithin(n+o,n,n+o),o*=2):(e.copyWithin(n+o,n,n+i-o),o=i);return e}n.d(t,{B:()=>r,R:()=>i})},38228:(e,t,n)=>{function r(e,t){let n=e;for(;n;){if(n===t)return!0;n=n.parentNode}return!1}n.d(t,{A:()=>r})},38494:(e,t,n)=>{n.d(t,{K:()=>u});var r=n(70177),s=n(88967),i=n(34336),o=n(37925),a=n(90218),c=n(83588),l=n(82859);class u{constructor(e={width:1,height:1}){this.equals=e=>e instanceof u&&(e.width===this.width&&e.height===this.height&&a.aI(e.projectionMatrix,this.projectionMatrix)&&a.aI(e.viewMatrix,this.viewMatrix)),this.project=(e,t={})=>{const{topLeft:n=!0}=t,r=this.projectPosition(e),i=(0,s.VJ)(r,this.pixelProjectionMatrix),[o,a]=i,c=n?a:this.height-a;return 2===e.length?[o,c]:[o,c,i[2]]},this.unproject=(e,t={})=>{const{topLeft:n=!0,targetZ:r}=t,[i,o,a]=e,c=n?o:this.height-o,l=r&&r*this.distanceScales.unitsPerMeter[2],u=(0,s.xJ)([i,c,a],this.pixelUnprojectionMatrix,l),[h,d,f]=this.unprojectPosition(u);return Number.isFinite(a)?[h,d,f]:Number.isFinite(r)?[h,d,r]:[h,d]},this.projectPosition=e=>{const[t,n]=(0,s.Gw)(e);return[t,n,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]},this.unprojectPosition=e=>{const[t,n]=(0,s.iV)(e);return[t,n,(e[2]||0)*this.distanceScales.metersPerUnit[2]]};let{width:t,height:n,altitude:r=null,fovy:i=null}=e;const{latitude:o=0,longitude:c=0,zoom:h=0,pitch:d=0,bearing:f=0,position:p=null,nearZMultiplier:g=.02,farZMultiplier:_=1.01}=e;t=t||1,n=n||1,null===i&&null===r?(r=s.h0,i=(0,s.Os)(r)):null===i?i=(0,s.Os)(r):null===r&&(r=(0,s.wZ)(i));const m=(0,s.XM)(h);r=Math.max(.75,r);const v=(0,s.nI)({longitude:c,latitude:o}),b=(0,s.Gw)([c,o]);b.push(0),p&&l.WQ(b,b,l.lK([],p,v.unitsPerMeter)),this.projectionMatrix=(0,s.Jh)({width:t,height:n,scale:m,center:b,pitch:d,fovy:i,nearZMultiplier:g,farZMultiplier:_}),this.viewMatrix=(0,s.rY)({height:n,scale:m,center:b,pitch:d,bearing:f,altitude:r}),this.width=t,this.height=n,this.scale=m,this.latitude=o,this.longitude=c,this.zoom=h,this.pitch=d,this.bearing=f,this.altitude=r,this.fovy=i,this.center=b,this.meterOffset=p||[0,0,0],this.distanceScales=v,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:e,height:t,projectionMatrix:n,viewMatrix:s}=this,i=(0,r.$M)();a.lw(i,i,n),a.lw(i,i,s),this.viewProjectionMatrix=i;const o=(0,r.$M)();a.hs(o,o,[e/2,-t/2,1]),a.Tl(o,o,[1,-1,0]),a.lw(o,o,i);const c=a.B8((0,r.$M)(),o);if(!c)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=c}projectFlat(e){return(0,s.Gw)(e)}unprojectFlat(e){return(0,s.iV)(e)}getMapCenterByLngLatPosition({lngLat:e,pos:t}){const n=(0,s.xJ)(t,this.pixelUnprojectionMatrix),r=(0,s.Gw)(e),i=c.WQ([],r,c.ze([],n)),o=c.WQ([],this.center,i);return(0,s.iV)(o)}fitBounds(e,t={}){const{width:n,height:r}=this,{longitude:s,latitude:o,zoom:a}=(0,i.F)(Object.assign({width:n,height:r,bounds:e},t));return new u({width:n,height:r,longitude:s,latitude:o,zoom:a})}getBounds(e){const t=this.getBoundingRegion(e),n=Math.min(...t.map(e=>e[0])),r=Math.max(...t.map(e=>e[0]));return[[n,Math.min(...t.map(e=>e[1]))],[r,Math.max(...t.map(e=>e[1]))]]}getBoundingRegion(e={}){return(0,o.g)(this,e.z||0)}getLocationAtPoint({lngLat:e,pos:t}){return this.getMapCenterByLngLatPosition({lngLat:e,pos:t})}}},38503:(e,t,n)=>{n.d(t,{Bd:()=>r,Fr:()=>s});"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;const r="object"!=typeof process||"[object process]"!==String(process)||process.browser,s="undefined"!=typeof window&&void 0!==window.orientation,i="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);i&&parseFloat(i[1])},38591:(e,t,n)=>{n.d(t,{d:()=>c});var r=n(19023),s=n(73390),i=n(44921),o=n(60742),a=n(57516);class c extends r.o{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return"Chrome"===(0,i.X)()}constructor(e,t){super(e,t),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const t=e;if(t&&34963!==t.glTarget)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,t?t.handle:null),this.indexBuffer=t,this.device.gl.bindVertexArray(null)}setBuffer(e,t){const n=t;if(34963===n.glTarget)throw new Error("Use .setIndexBuffer()");const{size:r,type:s,stride:i,offset:o,normalized:a,integer:c,divisor:l}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,n.handle),c?this.device.gl.vertexAttribIPointer(e,r,s,i,o):this.device.gl.vertexAttribPointer(e,r,s,a,i,o),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,l||0),this.attributes[e]=n,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,t){this._enable(e,!1),this.attributes[e]=t}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const t=this.attributes[e];ArrayBuffer.isView(t)&&this.device.setConstantAttributeWebGL(e,t)}}_getAccessor(e){const t=this.attributeInfos[e];if(!t)throw new Error(`Unknown attribute location ${e}`);const n=(0,o.q1)(t.bufferDataType);return{size:t.bufferComponents,type:n,stride:t.byteStride,offset:t.byteOffset,normalized:t.normalized,integer:t.integer,divisor:"instance"===t.stepMode?1:0}}_enable(e,t=!0){const n=c.isConstantAttributeZeroSupported(this.device);(t||(n||0!==e))&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),t?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,t){const n=function(e){if(Array.isArray(e))return new Float32Array(e);return e}(t),r=n.byteLength*e,i=n.length*e;if(this.buffer&&r!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${r} !== ${this.buffer.byteLength}.`);let o=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:r}),o||=!function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(n,this.bufferValue),o){const e=(0,s.X)(t.constructor,i);(0,a.R)({target:e,source:n,start:0,count:i}),this.buffer.write(e),this.bufferValue=t}return this.buffer}}},39375:(e,t,n)=>{n.d(t,{M:()=>i});var r=n(56769);const s=["keydown","keyup"];class i extends r.p{constructor(e,t,n){super(e,t,{enable:!0,tabIndex:0,...n}),this.handleEvent=e=>{const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:"keydown",srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",s.forEach(t=>e.addEventListener(t,this.handleEvent))}destroy(){s.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"keydown"===e&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}}},39426:(e,t,n)=>{n.d(t,{Z0:()=>i,hs:()=>s});var r=n(50741);function s(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}function i(e,t,n){const r=t[0],s=t[1],i=t[2],o=t[3];return e[0]=n[0]*r+n[4]*s+n[8]*i+n[12]*o,e[1]=n[1]*r+n[5]*s+n[9]*i+n[13]*o,e[2]=n[2]*r+n[6]*s+n[10]*i+n[14]*o,e[3]=n[3]*r+n[7]*s+n[11]*i+n[15]*o,e}!function(){const e=function(){const e=new r.tb(4);return r.tb!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}()},39769:(e,t,n)=>{n.d(t,{l:()=>a});var r=n(36157),s=n(93871),i=n(77264);const o=["","start","move","end","cancel","in","out"];class a extends r.o{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[s.uR]}getEventNames(){return o.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||Boolean(this.state&i.g.Began))}emit(e){if(1!==e.scale){const t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}super.emit(e)}}},39965:(e,t,n)=>{n.d(t,{t:()=>_});var r=n(74003),s=n(4360),i=n(55482),o=n(50426),a=n(53434),c=n(84565),l=n(87835),u=n(81312);const h={debug:(0,r.B)()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},d={enabled:!0,level:0};function f(){}const p={},g={once:!0};class _{constructor({id:e}={id:""}){this.VERSION=s.xv,this._startTs=(0,u.i)(),this._deltaTs=(0,u.i)(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new i.D(`__probe-${this.id}__`,d),this.timeStamp(`${this.id} started`),(0,c.d)(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number(((0,u.i)()-this._startTs).toPrecision(10))}getDelta(){return Number(((0,u.i)()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,h.warn,arguments,g)}error(e){return this._getLogFunction(0,e,h.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,h.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,h.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,h.debug||h.info,arguments,g)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||f,n&&[n],{tag:b(t)}):f}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||f)}group(e,t,n={collapsed:!1}){const r=v({logLevel:e,message:t,opts:n}),{collapsed:s}=n;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,t,n={}){return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||f)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=m(e)}_getLogFunction(e,t,n,r,s){if(this._shouldLog(e)){s=v({logLevel:e,message:t,args:r,opts:s}),n=n||s.method,(0,l.A)(n),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=(0,u.i)();const i=s.tag||s.message;if(s.once&&i){if(p[i])return f;p[i]=(0,u.i)()}return t=function(e,t,n){if("string"==typeof t){const r=n.time?(0,o.PX)((0,o.fU)(n.total)):"";t=n.time?`${e}: ${r}  ${t}`:`${e}: ${t}`,t=(0,a.n)(t,n.color,n.background)}return t}(this.id,s.message,s),n.bind(console,t,...s.args)}return f}}function m(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return(0,l.A)(Number.isFinite(t)&&t>=0),t}function v(e){const{logLevel:t,message:n}=e;e.logLevel=m(t);const r=e.args?Array.from(e.args):[];for(;r.length&&r.shift()!==n;);switch(typeof t){case"string":case"function":void 0!==n&&r.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());const s=typeof e.message;return(0,l.A)("string"===s||"object"===s),Object.assign(e,{args:r},e.opts)}function b(e){for(const t in e)for(const n in e[t])return n||"untitled";return"empty"}_.VERSION=s.xv},40352:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(7914),s=n(88981);const i=new s.A;class o{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find(t=>t.id===e.id)){const n=t.findIndex(t=>{return n=e,(t.order??1/0)-(n.order??1/0)>0;var n});n<0?t.push(e):t.splice(n,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&((0,r.b)(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const r of this.effects)t[r.id]=r;const n=[];for(const r of e){const e=t[r.id];let s=r;e&&e!==r?e.setProps?(e.setProps(r.props),s=e):e.cleanup(this._context):e||r.setup(this._context),n.push(s),delete t[r.id]}for(const r in t)t[r].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some(e=>e instanceof s.A)||this._resolvedEffects.push(i),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}},40424:(e,t,n)=>{n.d(t,{Te:()=>a,nk:()=>i});var r=n(29651),s=n(83593);function i(e,t,n,r){if(d(t))return r(e);const i=e;i.pushState();try{return o(e,t),(0,s.wb)(i.gl,n),r(e)}finally{i.popState()}}function o(e,t){const n=e,{gl:s}=n;if(t.cullMode)switch(t.cullMode){case"none":s.disable(2884);break;case"front":s.enable(2884),s.cullFace(1028);break;case"back":s.enable(2884),s.cullFace(1029)}if(t.frontFace&&s.frontFace(h("frontFace",t.frontFace,{ccw:2305,cw:2304})),t.unclippedDepth&&e.features.has("depth-clip-control")&&s.enable(34383),void 0!==t.depthBias&&(s.enable(32823),s.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0)),t.provokingVertex&&e.features.has("provoking-vertex-webgl")){const e=n.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,r=h("provokingVertex",t.provokingVertex,{first:36429,last:36430});e?.provokingVertexWEBGL(r)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){const e=n.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,r=h("polygonMode",t.polygonMode,{fill:6914,line:6913});e?.polygonModeWEBGL(1028,r),e?.polygonModeWEBGL(1029,r)}t.polygonOffsetLine&&s.enable(10754)}if(e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&s.enable(12288),t.clipDistance1&&s.enable(12289),t.clipDistance2&&s.enable(12290),t.clipDistance3&&s.enable(12291),t.clipDistance4&&s.enable(12292),t.clipDistance5&&s.enable(12293),t.clipDistance6&&s.enable(12294),t.clipDistance7&&s.enable(12295)),void 0!==t.depthWriteEnabled&&s.depthMask(t.depthWriteEnabled),t.depthCompare&&("always"!==t.depthCompare?s.enable(2929):s.disable(2929),s.depthFunc(a("depthCompare",t.depthCompare))),t.stencilWriteMask){const e=t.stencilWriteMask;s.stencilMaskSeparate(1028,e),s.stencilMaskSeparate(1029,e)}if(t.stencilReadMask&&r.R.warn("stencilReadMask not supported under WebGL"),t.stencilCompare){const e=t.stencilReadMask||4294967295,n=a("depthCompare",t.stencilCompare);"always"!==t.stencilCompare?s.enable(2960):s.disable(2960),s.stencilFuncSeparate(1028,n,0,e),s.stencilFuncSeparate(1029,n,0,e)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){const e=c("stencilPassOperation",t.stencilPassOperation),n=c("stencilFailOperation",t.stencilFailOperation),r=c("stencilDepthFailOperation",t.stencilDepthFailOperation);s.stencilOpSeparate(1028,n,r,e),s.stencilOpSeparate(1029,n,r,e)}switch(t.blend){case!0:s.enable(3042);break;case!1:s.disable(3042)}if(t.blendColorOperation||t.blendAlphaOperation){const e=l("blendColorOperation",t.blendColorOperation||"add"),n=l("blendAlphaOperation",t.blendAlphaOperation||"add");s.blendEquationSeparate(e,n);const r=u("blendColorSrcFactor",t.blendColorSrcFactor||"one"),i=u("blendColorDstFactor",t.blendColorDstFactor||"zero"),o=u("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),a=u("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");s.blendFuncSeparate(r,i,o,a)}}function a(e,t){return h(e,t,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function c(e,t){return h(e,t,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function l(e,t){return h(e,t,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function u(e,t,n="color"){return h(e,t,{one:1,zero:0,src:768,"one-minus-src":769,dst:774,"one-minus-dst":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,constant:"color"===n?32769:32771,"one-minus-constant":"color"===n?32770:32772,src1:768,"one-minus-src1":769,"src1-alpha":770,"one-minus-src1-alpha":771})}function h(e,t,n){if(!(t in n))throw new Error(function(e,t){return`Illegal parameter ${t} for ${e}`}(e,t));return n[t]}function d(e){let t=!0;for(const n in e){t=!1;break}return t}},41019:(e,t,n)=>{n.d(t,{R:()=>d,w:()=>h});var r=n(9350),s=n(74334),i=n(69502),o=n(82859),a=n(39426),c=n(73279);const l=[0,0,0];function u(e,t,n=!1){const r=t.projectPosition(e);if(n&&t instanceof i.A){const[n,s,i=0]=e,o=t.getDistanceScales([n,s]);r[2]=i*o.unitsPerMeter[2]}return r}function h(e,{viewport:t,modelMatrix:n,coordinateSystem:s,coordinateOrigin:i,offsetMode:o}){let[l,h,d=0]=e;switch(n&&([l,h,d]=a.Z0([],[l,h,d,1],n)),s){case r.rf.LNGLAT:return u([l,h,d],t,o);case r.rf.LNGLAT_OFFSETS:return u([l+i[0],h+i[1],d+(i[2]||0)],t,o);case r.rf.METER_OFFSETS:return u((0,c.dT)(i,[l,h,d]),t,o);case r.rf.CARTESIAN:default:return t.isGeospatial?[l+i[0],h+i[1],d+i[2]]:t.projectPosition([l,h,d])}}function d(e,t){const{viewport:n,coordinateSystem:i,coordinateOrigin:a,modelMatrix:c,fromCoordinateSystem:u,fromCoordinateOrigin:d}=function(e){const{viewport:t,modelMatrix:n,coordinateOrigin:s}=e;let{coordinateSystem:i,fromCoordinateSystem:o,fromCoordinateOrigin:a}=e;return i===r.rf.DEFAULT&&(i=t.isGeospatial?r.rf.LNGLAT:r.rf.CARTESIAN),void 0===o&&(o=i),void 0===a&&(a=s),{viewport:t,coordinateSystem:i,coordinateOrigin:s,modelMatrix:n,fromCoordinateSystem:o,fromCoordinateOrigin:a}}(t),{autoOffset:f=!0}=t,{geospatialOrigin:p=l,shaderCoordinateOrigin:g=l,offsetMode:_=!1}=f?(0,s.o)(n,i,a):{},m=h(e,{viewport:n,modelMatrix:c,coordinateSystem:u,coordinateOrigin:d,offsetMode:_});if(_){const e=n.projectPosition(p||g);o.jb(m,m,e)}return m}},41708:(e,t,n)=>{n.d(t,{f:()=>r});class r extends Error{constructor(e,t){super(e),this.reason=t.reason,this.url=t.url,this.response=t.response}reason;url;response}},42221:(e,t,n)=>{n.d(t,{JQ:()=>i,OA:()=>o,d_:()=>a});const r=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,s=/^([-\w.]+\/[-\w.+]+)/;function i(e,t){return e.toLowerCase()===t.toLowerCase()}function o(e){const t=s.exec(e);return t?t[1]:e}function a(e){const t=r.exec(e);return t?t[1]:""}},42719:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(5153);class s extends r.F{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){super(e,t=s.normalizeProps(e,t),s.defaultProps)}static normalizeProps(e,t){return t}static defaultProps={...r.F.defaultProps,framebuffer:null,parameters:void 0,clearColor:s.defaultClearColor,clearColors:void 0,clearDepth:s.defaultClearDepth,clearStencil:s.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}}},42947:(e,t,n)=>{n.d(t,{w:()=>p});var r=n(38228),s=n(35356),i=n(50258),o=n(20736),a=n(55904),c=n(60682),l=n(5689),u=n(18160),h=n(96573),d=n(70137),f=n(92285);function p(e,t){const{session:n}=e,{pointers:p}=t,{length:g}=p;n.firstInput||(n.firstInput=(0,s.g)(t)),g>1&&!n.firstMultiple?n.firstMultiple=(0,s.g)(t):1===g&&(n.firstMultiple=!1);const{firstInput:_,firstMultiple:m}=n,v=m?m.center:_.center,b=t.center=(0,i.q)(p);t.timeStamp=Date.now(),t.deltaTime=t.timeStamp-_.timeStamp,t.angle=(0,a.U)(v,b),t.distance=(0,o.C)(v,b);const{deltaX:y,deltaY:E}=(0,l.F)(n,t);t.deltaX=y,t.deltaY=E,t.offsetDirection=(0,c.u)(t.deltaX,t.deltaY);const w=(0,u.O)(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=w.x,t.overallVelocityY=w.y,t.overallVelocity=Math.abs(w.x)>Math.abs(w.y)?w.x:w.y,t.scale=m?(0,h.X)(m.pointers,p):1,t.rotation=m?(0,d.l)(m.pointers,p):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length;let x=e.element;return(0,r.A)(t.srcEvent.target,x)&&(x=t.srcEvent.target),t.target=x,(0,f.d)(n,t),t}},43411:(e,t,n)=>{n.d(t,{A:()=>o,k:()=>i});var r=n(3459);let s={};function i(e){s=e}function o(e,t,n,i){r.A.level>0&&s[e]&&s[e].call(null,t,n,i)}},43424:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(7914),s=n(3459),i=n(38055);class o{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t="string"==typeof e?this.getView(e):e,n=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,t){const n=this.getViewports(),r={x:e[0],y:e[1]};for(let s=n.length-1;s>=0;--s){const i=n[s];if(i.containsPixel(r)){const n=e.slice();return n[0]-=i.x,n[1]-=i.y,i.unproject(n,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){e===this.width&&t===this.height||(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=(0,i.B)(e,Boolean);this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){if(e){!(0,r.b)(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e}else s.A.warn("missing `viewState` or `initialViewState`")()}_createController(e,t){return new(0,t.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:t=>this.getView(e.id)?.makeViewport({viewState:t,width:this.width,height:this.height})})}_updateController(e,t,n,r){const s=e.controller;if(s&&n){const i={...t,...s,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height};return r&&r.constructor===s.type||(r=this._createController(e,i)),r&&r.setProps(i),r}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let r=e.length;r--;){const s=e[r],i=this.getViewState(s),o=s.makeViewport({viewState:i,width:this.width,height:this.height});let a=t[s.id];const c=Boolean(s.controller);c&&!a&&(n=!0),!n&&c||!a||(a.finalize(),a=null),this.controllers[s.id]=this._updateController(s,i,o,a),o&&this._viewports.unshift(o)}for(const r in t){const e=t[r];e&&!this.controllers[r]&&e.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((n,r)=>!e[r].equals(t[r]))}}},44133:(e,t,n)=>{n.d(t,{O:()=>l,f:()=>u});var r=n(47612);const s=globalThis.loaders?.parseImageNode,i="undefined"!=typeof Image,o="undefined"!=typeof ImageBitmap,a=Boolean(s),c=!!r.Bd||a;function l(e){switch(e){case"auto":return o||i||c;case"imagebitmap":return o;case"image":return i;case"data":return c;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}function u(){if(o)return"imagebitmap";if(i)return"image";if(c)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}},44333:(e,t,n)=>{n.d(t,{E:()=>u});var r=n(9241),s=n(20471),i=n(26397),o=n(39375),a=n(85960),c=n(66727);function l(e){if("recognizer"in e)return e;let t;const n=Array.isArray(e)?[...e]:[e];if("function"==typeof n[0]){t=new(n.shift())(n.shift()||{})}else t=n.shift();return{recognizer:t,recognizeWith:"string"==typeof n[0]?[n[0]]:n[0],requireFailure:"string"==typeof n[1]?[n[1]]:n[1]}}class u{constructor(e=null,t={}){if(this._onBasicInput=e=>{this.manager.emit(e.srcEvent.type,e)},this._onOtherEvent=e=>{this.manager.emit(e.type,e)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...t},this.events=new Map,this.element=e,e){this.manager=new r.mS(e,this.options);for(const e of this.options.recognizers){const{recognizer:t,recognizeWith:n,requireFailure:r}=l(e);this.manager.add(t),n&&t.recognizeWith(n),r&&t.requireFailure(r)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new s.a(e,this._onOtherEvent,{enable:!1}),this.moveInput=new i._(e,this._onOtherEvent,{enable:!1}),this.keyInput=new o.M(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new a.P(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:n}=this;if(!n)return;const r=n.get(e);r&&(r.set({enable:t}),n.touchAction.update()),this.wheelInput?.enableEventType(e,t),this.moveInput?.enableEventType(e,t),this.keyInput?.enableEventType(e,t),this.contextmenuInput?.enableEventType(e,t)}_addEventHandler(e,t,n,r,s){if("string"!=typeof e){n=t;for(const[t,i]of Object.entries(e))this._addEventHandler(t,i,n,r,s);return}const{manager:i,events:o}=this;if(!i)return;let a=o.get(e);if(!a){const t=this._getRecognizerName(e)||e;a=new c.K(this,t),o.set(e,a),i&&i.on(e,a.handleEvent)}a.add(e,t,n,r,s),a.isEmpty()||this._toggleRecognizer(a.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const[t,n]of Object.entries(e))this._removeEventHandler(t,n);return}const{events:n}=this,r=n.get(e);if(r&&(r.remove(e,t),r.isEmpty())){const{recognizerName:e}=r;let t=!1;for(const r of n.values())if(r.recognizerName===e&&!r.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(t=>t.getEventNames().includes(e))?.options.event}}},44684:(e,t,n)=>{function r(e,t){const n={},r="Values";if(0===e.attributes.length&&!e.varyings?.length)return{"No attributes or varyings":{[r]:"N/A"}};for(const s of e.attributes)if(s){n[`in ${`${s.location} ${s.name}: ${s.type}`}`]={[r]:s.stepMode||"vertex"}}for(const s of e.varyings||[]){n[`out ${`${s.location} ${s.name}`}`]={[r]:JSON.stringify(s)}}return n}n.d(t,{m:()=>r})},44860:(e,t,n)=>{n.d(t,{f:()=>o});var r=n(77264),s=n(7480),i=n(2047);class o{constructor(e){this.options=e,this.id=(0,s.N)(),this.state=r.g.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const t of e)this.recognizeWith(t);return this}let t;if("string"==typeof e){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{simultaneous:n}=this;return n[t.id]||(n[t.id]=t,t.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const t of e)this.dropRecognizeWith(t);return this}let t;return t="string"==typeof e?this.manager.get(e):e,t&&delete this.simultaneous[t.id],this}requireFailure(e){if(Array.isArray(e)){for(const t of e)this.requireFailure(t);return this}let t;if("string"==typeof e){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{requireFail:n}=this;return-1===n.indexOf(t)&&(n.push(t),t.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const t of e)this.dropRequireFailure(t);return this}let t;if(t="string"==typeof e?this.manager.get(e):e,t){const e=this.requireFail.indexOf(t);e>-1&&this.requireFail.splice(e,1)}return this}hasRequireFailures(){return Boolean(this.requireFail.find(e=>e.options.enable))}canRecognizeWith(e){return Boolean(this.simultaneous[e.id])}emit(e){if(!e)return;const{state:t}=this;t<r.g.Ended&&this.manager.emit(this.options.event+(0,i.l)(t),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),t>=r.g.Ended&&this.manager.emit(this.options.event+(0,i.l)(t),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=r.g.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(r.g.Failed|r.g.Possible)))return!1;e++}return!0}recognize(e){const t={...e};if(!this.options.enable)return this.reset(),void(this.state=r.g.Failed);this.state&(r.g.Recognized|r.g.Cancelled|r.g.Failed)&&(this.state=r.g.Possible),this.state=this.process(t),this.state&(r.g.Began|r.g.Changed|r.g.Ended|r.g.Cancelled)&&this.tryEmit(t)}getEventNames(){return[this.options.event]}reset(){}}},44921:(e,t,n)=>{n.d(t,{X:()=>o});var r=n(74003),s=n(77989),i=n(93640);function o(e){if(!e&&!(0,r.B)())return"Node";if((0,s.b)(e))return"Electron";return(e||i.gM.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown"}},45728:(e,t,n)=>{function r(){let e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),resolve:e,reject:t}}n.d(t,{Y:()=>r})},45800:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(17393),s=n(69502),i=n(97564);class o extends r.A{constructor(e={}){super(e)}getViewportType(){return s.A}get ControllerType(){return i.A}}o.displayName="MapView";const a=o},46022:(e,t,n)=>{n.d(t,{u:()=>o});var r=n(58073),s=n(73731),i=n(54901);class o extends r.a{toString(){let e="[";if(i.$W.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let n=0;n<this.RANK;++n)e+=` ${this[n*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,n){return this[t*this.RANK+e]=(0,s.ws)(n),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const n=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[n+r];return t}setColumn(e,t){const n=e*this.RANK;for(let r=0;r<this.RANK;++r)this[n+r]=t[r];return this}}},46208:(e,t,n)=>{function r(e,t){return{name:s(e,t),language:"glsl",version:i(e)}}function s(e,t="unnamed"){const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(e);return n?n[1]:t}function i(e){let t=100;const n=e.match(/[^\s]+/g);if(n&&n.length>=2&&"#version"===n[0]){const e=parseInt(n[1],10);Number.isFinite(e)&&(t=e)}if(100!==t&&300!==t)throw new Error(`Invalid GLSL version ${t}`);return t}n.d(t,{i:()=>r})},46487:(e,t,n)=>{n.d(t,{A:()=>r});const r={name:"color",dependencies:[],source:"\n\nstruct ColorUniforms {\n  opacity: f32,\n};\n\nvar<private> color: ColorUniforms = ColorUniforms(1.0);\n// TODO (kaapp) avoiding binding index collisions to handle layer opacity \n// requires some thought.\n// @group(0) @binding(0) var<uniform> color: ColorUniforms;\n\n@must_use\nfn deckgl_premultiplied_alpha(fragColor: vec4<f32>) -> vec4<f32> {\n    return vec4(fragColor.rgb * fragColor.a, fragColor.a); \n};\n",getUniforms:e=>({}),uniformTypes:{opacity:"f32"}}},46555:(e,t,n)=>{n.d(t,{Mz:()=>c,wv:()=>a});var r=n(8521),s=n(41708),i=n(72548),o=n(28071);async function a(e){if((0,r.Sv)(e))return e;const t={},n=(0,i._E)(e);n>=0&&(t["content-length"]=String(n));const s=(0,i.Al)(e),o=(0,i.z4)(e);o&&(t["content-type"]=o);const a=await async function(e){const t=5;if("string"==typeof e)return`data:,${e.slice(0,t)}`;if(e instanceof Blob){const t=e.slice(0,5);return await new Promise(e=>{const n=new FileReader;n.onload=t=>e(t?.target?.result),n.readAsDataURL(t)})}if(e instanceof ArrayBuffer){return`data:base64,${function(e){let t="";const n=new Uint8Array(e);for(let r=0;r<n.byteLength;r++)t+=String.fromCharCode(n[r]);return btoa(t)}(e.slice(0,t))}`}return null}(e);a&&(t["x-first-bytes"]=a),"string"==typeof e&&(e=(new TextEncoder).encode(e));const c=new Response(e,{headers:t});return Object.defineProperty(c,"url",{value:s}),c}async function c(e){if(!e.ok){const t=await async function(e){const n=(0,o.E1)(e.url);let r=`Failed to fetch resource (${e.status}) ${e.statusText}: ${n}`;r=r.length>100?`${r.slice(0,100)}...`:r;const i={reason:e.statusText,url:e.url,response:e};try{const t=e.headers.get("Content-Type");i.reason=!e.bodyUsed&&t?.includes("application/json")?await e.json():await e.text()}catch(t){}return new s.f(r,i)}(e);throw t}}},47095:(e,t,n)=>{n.d(t,{K:()=>s});var r=n(83909);class s extends r.PI{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderVariables(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return void 0===this.limits[e]&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}},47173:(e,t,n)=>{n.d(t,{i:()=>s});var r=n(5153);class s extends r.F{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,s.defaultProps)}static defaultProps={...r.F.defaultProps,measureExecutionTime:void 0}}},47345:(e,t,n)=>{n.d(t,{A:()=>_});var r=n(3459),s=n(25667),i=n(87597),o=n(31886),a=n(54901),c=n(90218),l=n(73279),u=n(9350);const h=Math.PI/180,d=(0,s.$M)(),f=[0,0,0],p={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class g{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||p,this.focalDistance=e.focalDistance||1,this.position=e.position||f,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?u.Kx.WEB_MERCATOR:u.Kx.WEB_MERCATOR_AUTO_OFFSET:u.Kx.IDENTITY}equals(e){return e instanceof g&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&(0,a.aI)(e.projectionMatrix,this.projectionMatrix)&&(0,a.aI)(e.viewMatrix,this.viewMatrix))}project(e,{topLeft:t=!0}={}){const n=this.projectPosition(e),r=(0,l.VJ)(n,this.pixelProjectionMatrix),[s,i]=r,o=t?i:this.height-i;return 2===e.length?[s,o]:[s,o,r[2]]}unproject(e,{topLeft:t=!0,targetZ:n}={}){const[r,s,i]=e,o=t?s:this.height-s,a=n&&n*this.distanceScales.unitsPerMeter[2],c=(0,l.xJ)([r,o,i],this.pixelUnprojectionMatrix,a),[u,h,d]=this.unprojectPosition(c);return Number.isFinite(i)?[u,h,d]:Number.isFinite(n)?[u,h,n]:[u,h]}projectPosition(e){const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){if(this.isGeospatial){const t=(0,l.Gw)(e);return t[1]=(0,a.qE)(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?(0,l.iV)(e):e}getBounds(e={}){const t={targetZ:e.z||0},n=this.unproject([0,0],t),r=this.unproject([this.width,0],t),s=this.unproject([0,this.height],t),i=this.unproject([this.width,this.height],t);return[Math.min(n[0],r[0],s[0],i[0]),Math.min(n[1],r[1],s[1],i[1]),Math.max(n[0],r[0],s[0],i[0]),Math.max(n[1],r[1],s[1],i[1])]}getDistanceScales(e){return e&&this.isGeospatial?(0,l.nI)({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:t,width:n=1,height:r=1}){return e<this.x+this.width&&this.x<e+n&&t<this.y+this.height&&this.y<t+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,(0,s.on)(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=(0,l.fO)({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||(0,l.nI)({latitude:n,longitude:t}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:s,modelMatrix:a}=e;let c=f;if(s&&(c=a?new o.k(a).transformAsVector(s,[]):s),this.isGeospatial){const e=this.projectPosition([t,n,0]);this.center=new i.P(c).scale(this.distanceScales.unitsPerMeter).add(e)}else this.center=this.projectPosition(c)}_initMatrices(e){const{viewMatrix:t=d,projectionMatrix:n=null,orthographic:l=!1,fovyRadians:u,fovy:f=75,near:p=.1,far:g=1e3,padding:_=null,focalDistance:m=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=(new o.k).multiplyRight(t).translate(new i.P(this.center).negate()),this.projectionMatrix=n||function({width:e,height:t,orthographic:n,fovyRadians:r,focalDistance:s,padding:i,near:c,far:l}){const u=e/t,h=n?(new o.k).orthographic({fovy:r,aspect:u,focalDistance:s,near:c,far:l}):(new o.k).perspective({fovy:r,aspect:u,near:c,far:l});if(i){const{left:n=0,right:r=0,top:s=0,bottom:o=0}=i,c=(0,a.qE)((n+e-r)/2,0,e)-e/2,l=(0,a.qE)((s+t-o)/2,0,t)-t/2;h[8]-=2*c/e,h[9]+=2*l/t}return h}({width:this.width,height:this.height,orthographic:l,fovyRadians:u||f*h,focalDistance:m,padding:_,near:p,far:g});const v=(0,s.$M)();c.lw(v,v,this.projectionMatrix),c.lw(v,v,this.viewMatrix),this.viewProjectionMatrix=v,this.viewMatrixInverse=c.B8([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=(0,s.Vl)(this.viewMatrixInverse);const b=(0,s.$M)(),y=(0,s.$M)();c.hs(b,b,[this.width/2,-this.height/2,1]),c.Tl(b,b,[1,-1,0]),c.lw(y,b,this.viewProjectionMatrix),this.pixelProjectionMatrix=y,this.pixelUnprojectionMatrix=c.B8((0,s.$M)(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||r.A.warn("Pixel project matrix not invertible")()}}g.displayName="Viewport";const _=g},47612:(e,t,n)=>{n.d(t,{Bd:()=>r});"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;const r=Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),s="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);s&&parseFloat(s[1])},47787:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(12897),s=n(94541);let i=0;class o{constructor(...e){this.props=(0,s.x)(this,e),this.id=this.props.id,this.count=i++}clone(e){const{props:t}=this,n={};for(const s in t[r.jA])s in t[r.vf]?n[s]=t[r.vf][s]:s in t[r.YN]&&(n[s]=t[r.YN][s]);return new this.constructor({...t,...n,...e})}}o.componentName="Component",o.defaultProps={};const a=o},48244:(e,t,n)=>{n.d(t,{B:()=>s});var r=n(9350);const s=`${`${Object.keys(r.rf).map(e=>`const COORDINATE_SYSTEM_${e}: i32 = ${r.rf[e]};`).join("")}\n${Object.keys(r.Kx).map(e=>`const PROJECTION_MODE_${e}: i32 = ${r.Kx[e]};`).join("")}\n${Object.keys(r.p5).map(e=>`const UNIT_${e.toUpperCase()}: i32 = ${r.p5[e]};`).join("")}\n\nconst TILE_SIZE: f32 = 512.0;\nconst PI: f32 = 3.1415926536;\nconst WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);\nconst ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);\nconst EARTH_RADIUS: f32 = 6370972.0; // meters\nconst GLOBE_RADIUS: f32 = 256.0;\n\n// -----------------------------------------------------------------------------\n// Uniform block (converted from GLSL uniform block)\n// -----------------------------------------------------------------------------\nstruct ProjectUniforms {\n  wrapLongitude: i32,\n  coordinateSystem: i32,\n  commonUnitsPerMeter: vec3<f32>,\n  projectionMode: i32,\n  scale: f32,\n  commonUnitsPerWorldUnit: vec3<f32>,\n  commonUnitsPerWorldUnit2: vec3<f32>,\n  center: vec4<f32>,\n  modelMatrix: mat4x4<f32>,\n  viewProjectionMatrix: mat4x4<f32>,\n  viewportSize: vec2<f32>,\n  devicePixelRatio: f32,\n  focalDistance: f32,\n  cameraPosition: vec3<f32>,\n  coordinateOrigin: vec3<f32>,\n  commonOrigin: vec3<f32>,\n  pseudoMeters: i32,\n};\n\n@group(0) @binding(0)\nvar<uniform> project: ProjectUniforms;\n\n// -----------------------------------------------------------------------------\n// Geometry data\n// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,\n// you might supply this via vertex attributes or a uniform. Here we define a\n// uniform struct for demonstration.)\n// -----------------------------------------------------------------------------\n\n// Structure to carry additional geometry data used by deck.gl filters.\nstruct Geometry {\n  worldPosition: vec3<f32>,\n  worldPositionAlt: vec3<f32>,\n  position: vec4<f32>,\n  normal: vec3<f32>,\n  uv: vec2<f32>,\n  pickingColor: vec3<f32>,\n};\n\n// @group(0) @binding(1)\nvar<private> geometry: Geometry;\n`}\n\n// -----------------------------------------------------------------------------\n// Functions\n// -----------------------------------------------------------------------------\n\n// Returns an adjustment factor for commonUnitsPerMeter\nfn _project_size_at_latitude(lat: f32) -> f32 {\n  let y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\n// Overloaded version: scales a value in meters at a given latitude.\nfn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {\n  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);\n}\n\n// Computes a non-linear scale factor based on geometry.\n// (Note: This function relies on "geometry" being provided.)\nfn project_size() -> f32 {\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n      project.pseudoMeters == 0) {\n    if (geometry.position.w == 0.0) {\n      return _project_size_at_latitude(geometry.worldPosition.y);\n    }\n    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    let y2 = y * y;\n    let y4 = y2 * y2;\n    let y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\n// Overloads to scale offsets (meters to world units)\nfn project_size_float(meters: f32) -> f32 {\n  return meters * project.commonUnitsPerMeter.z * project_size();\n}\n\nfn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {\n  return meters * project.commonUnitsPerMeter.xy * project_size();\n}\n\nfn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {\n  return meters * project.commonUnitsPerMeter * project_size();\n}\n\nfn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {\n  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);\n}\n\n// Returns a rotation matrix aligning the z\u2011axis with the given up vector.\nfn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {\n  let uz = normalize(up);\n  let ux = select(\n    vec3<f32>(1.0, 0.0, 0.0),\n    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),\n    abs(uz.z) == 1.0\n  );\n  let uy = cross(uz, ux);\n  return mat3x3<f32>(ux, uy, uz);\n}\n\n// Since WGSL does not support "out" parameters, we return a struct.\nstruct RotationResult {\n  needsRotation: bool,\n  transform: mat3x3<f32>,\n};\n\nfn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {\n  if (project.projectionMode == PROJECTION_MODE_GLOBE) {\n    return RotationResult(true, project_get_orientation_matrix(commonPosition));\n  } else {\n    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed\n  };\n}\n\n// Projects a normal vector from the current coordinate system to world space.\nfn project_normal(vector: vec3<f32>) -> vec3<f32> {\n  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);\n  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);\n  let rotResult = project_needs_rotation(geometry.position.xyz);\n  if (rotResult.needsRotation) {\n    n = rotResult.transform * n;\n  }\n  return n;\n}\n\n// Applies a scale offset based on y-offset (dy)\nfn project_offset_(offset: vec4<f32>) -> vec4<f32> {\n  let dy: f32 = offset.y;\n  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;\n  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n// Projects lng/lat coordinates to a unit tile [0,1]\nfn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {\n  var x = lnglat.x;\n  if (project.wrapLongitude != 0) {\n    x = ((x + 180.0) % 360.0) - 180.0;\n  }\n  let y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2<f32>(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// Projects lng/lat/z coordinates for a globe projection.\nfn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {\n  let lambda = radians(lnglatz.x);\n  let phi = radians(lnglatz.y);\n  let cosPhi = cos(phi);\n  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n  return vec3<f32>(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n// Projects positions (with an optional 64-bit low part) from the input\n// coordinate system to the common space.\nfn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {\n  var position_world = project.modelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug:\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4<f32>(\n        project_mercator_(position_world.xy),\n        _project_size_at_latitude_m(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_GLOBE) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4<f32>(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {\n        return vec4<f32>(\n          project_mercator_(position_world.xy) - project.commonOrigin.xy,\n          project_size_float(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||\n      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);\n  }\n\n  return project_offset_(position_world) +\n         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));\n}\n\n// Overloaded versions for different input types.\nfn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {\n  return project_position_vec4_f64(position, ZERO_64_LOW);\n}\n\nfn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nfn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nfn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {\n  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\n// Transforms a common space position to clip space.\nfn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {\n  return viewProjectionMatrix * position + center;\n}\n\n// Uses the project viewProjectionMatrix and center.\nfn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {\n  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);\n}\n\n// Returns a clip space offset corresponding to a given number of screen pixels.\nfn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {\n  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;\n  return offset * project.focalDistance;\n}\n\nfn project_meter_size_to_pixel(meters: f32) -> f32 {\n  return project_size_float(meters) * project.scale;\n}\n\nfn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {\n  if (unit == UNIT_METERS) {\n    return project_meter_size_to_pixel(size);\n  } else if (unit == UNIT_COMMON) {\n    return size * project.scale;\n  }\n  // UNIT_PIXELS: no scaling applied.\n  return size;\n}\n\nfn project_pixel_size_float(pixels: f32) -> f32 {\n  return pixels / project.scale;\n}\n\nfn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {\n  return pixels / project.scale;\n}\n`},48900:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(12489),s=n(2776),i=n(3459);const o={interpolation:r.A,spring:s.A};class a{constructor(e,{id:t,timeline:n}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=t,this.device=e,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:n}){this.numInstances=n||1;for(const r in e){const n=e[r],s=n.getTransitionSetting(t);s&&this._updateAttribute(r,n,s)}for(const r in this.transitions){const n=e[r];n&&n.getTransitionSetting(t)||this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const n=this.transitions[t];n.inProgress&&(e[t]=n.attributeInTransition)}return e}run(){if(0===this.numInstances)return!1;for(const t in this.transitions){this.transitions[t].update()&&(this.needsRedraw=!0)}const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,t,n){const r=this.transitions[e];let s=!r||r.type!==n.type;if(s){r&&this._removeTransition(e);const a=o[n.type];a?this.transitions[e]=new a({attribute:t,timeline:this.timeline,device:this.device}):(i.A.error(`unsupported transition type '${n.type}'`)(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}},49042:(e,t,n)=>{n.d(t,{q:()=>r});const r={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:[0,1,1,1]},vs:"uniform pickingUniforms {\n  float isActive;\n  float isAttribute;\n  float isHighlightActive;\n  float useFloatColors;\n  vec3 highlightedObjectColor;\n  vec4 highlightColor;\n} picking;\n\nout vec4 picking_vRGBcolor_Avalid;\n\n// Normalize unsigned byte color to 0-1 range\nvec3 picking_normalizeColor(vec3 color) {\n  return picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\n\n// Normalize unsigned byte color to 0-1 range\nvec4 picking_normalizeColor(vec4 color) {\n  return picking.useFloatColors > 0.5 ? color : color / 255.0;\n}\n\nbool picking_isColorZero(vec3 color) {\n  return dot(color, vec3(1.0)) < 0.00001;\n}\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.00001;\n}\n\n// Check if this vertex is highlighted \nbool isVertexHighlighted(vec3 vertexColor) {\n  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);\n  return\n    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));\n}\n\n// Set the current picking color\nvoid picking_setPickingColor(vec3 pickingColor) {\n  pickingColor = picking_normalizeColor(pickingColor);\n\n  if (bool(picking.isActive)) {\n    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!bool(picking.isAttribute)) {\n      // Stores the picking color so that the fragment shader can render it during picking\n      picking_vRGBcolor_Avalid.rgb = pickingColor;\n    }\n  } else {\n    // Do the comparison with selected item color in vertex shader as it should mean fewer compares\n    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\n\nvoid picking_setPickingAttribute(vec2 value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\n\nvoid picking_setPickingAttribute(vec3 value) {\n  if (bool(picking.isAttribute)) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform pickingUniforms {\n  float isActive;\n  float isAttribute;\n  float isHighlightActive;\n  float useFloatColors;\n  vec3 highlightedObjectColor;\n  vec4 highlightColor;\n} picking;\n\nin vec4 picking_vRGBcolor_Avalid;\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 picking_filterHighlightColor(vec4 color) {\n  // If we are still picking, we don't highlight\n  if (picking.isActive > 0.5) {\n    return color;\n  }\n\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    // Blend in highlight color based on its alpha value\n    float highLightAlpha = picking.highlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 picking_filterPickingColor(vec4 color) {\n  if (bool(picking.isActive)) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 picking_filterColor(vec4 color) {\n  vec4 highlightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highlightColor);\n}\n",getUniforms:function(e={},t){const n={};if(void 0===e.highlightedObjectColor);else if(null===e.highlightedObjectColor)n.isHighlightActive=!1;else{n.isHighlightActive=!0;const t=e.highlightedObjectColor.slice(0,3);n.highlightedObjectColor=t}if(e.highlightColor){const t=Array.from(e.highlightColor,e=>e/255);Number.isFinite(t[3])||(t[3]=1),n.highlightColor=t}void 0!==e.isActive&&(n.isActive=Boolean(e.isActive),n.isAttribute=Boolean(e.isAttribute));void 0!==e.useFloatColors&&(n.useFloatColors=Boolean(e.useFloatColors));return n}}},49187:(e,t,n)=>{function r(e){return l[e]}function s(e){return a[e]}function i(e){return Boolean(c[e])}function o(e){return c[e]}n.d(t,{MS:()=>i,OA:()=>o,k2:()=>r,rz:()=>s});const a={5126:"f32",35664:"vec2<f32>",35665:"vec3<f32>",35666:"vec4<f32>",5124:"i32",35667:"vec2<i32>",35668:"vec3<i32>",35669:"vec4<i32>",5125:"u32",36294:"vec2<u32>",36295:"vec3<u32>",36296:"vec4<u32>",35670:"f32",35671:"vec2<f32>",35672:"vec3<f32>",35673:"vec4<f32>",35674:"mat2x2<f32>",35685:"mat2x3<f32>",35686:"mat2x4<f32>",35687:"mat3x2<f32>",35675:"mat3x3<f32>",35688:"mat3x4<f32>",35689:"mat4x2<f32>",35690:"mat4x3<f32>",35676:"mat4x4<f32>"},c={35678:{viewDimension:"2d",sampleType:"float"},35680:{viewDimension:"cube",sampleType:"float"},35679:{viewDimension:"3d",sampleType:"float"},35682:{viewDimension:"3d",sampleType:"depth"},36289:{viewDimension:"2d-array",sampleType:"float"},36292:{viewDimension:"2d-array",sampleType:"depth"},36293:{viewDimension:"cube",sampleType:"float"},36298:{viewDimension:"2d",sampleType:"sint"},36299:{viewDimension:"3d",sampleType:"sint"},36300:{viewDimension:"cube",sampleType:"sint"},36303:{viewDimension:"2d-array",sampleType:"uint"},36306:{viewDimension:"2d",sampleType:"uint"},36307:{viewDimension:"3d",sampleType:"uint"},36308:{viewDimension:"cube",sampleType:"uint"},36311:{viewDimension:"2d-array",sampleType:"uint"}},l={uint8:5121,sint8:5120,unorm8:5121,snorm8:5120,uint16:5123,sint16:5122,unorm16:5123,snorm16:5122,uint32:5125,sint32:5124,float16:5131,float32:5126}},49243:(e,t,n)=>{n.d(t,{Y:()=>s});const r=262144;function*s(e,t){const n=t?.chunkSize||r;let s=0;const i=new TextEncoder;for(;s<e.length;){const t=Math.min(e.length-s,n),r=e.slice(s,s+t);s+=t,yield i.encode(r)}}},49987:(e,t,n)=>{function r(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function s(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}n.d(t,{iW:()=>r,pD:()=>s})},50258:(e,t,n)=>{function r(e){const t=e.length;if(1===t)return{x:Math.round(e[0].clientX),y:Math.round(e[0].clientY)};let n=0,r=0,s=0;for(;s<t;)n+=e[s].clientX,r+=e[s].clientY,s++;return{x:Math.round(n/t),y:Math.round(r/t)}}n.d(t,{q:()=>r})},50426:(e,t,n)=>{function r(e){let t;return t=e<10?`${e.toFixed(2)}ms`:e<100?`${e.toFixed(1)}ms`:e<1e3?`${e.toFixed(0)}ms`:`${(e/1e3).toFixed(2)}s`,t}function s(e,t=8){const n=Math.max(t-e.length,0);return`${" ".repeat(n)}${e}`}n.d(t,{PX:()=>s,fU:()=>r})},50486:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(38503),s=n(13004),i=n(61273);class o{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return s.A.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e,t=(e,t,n)=>e.done(n),n=(e,t)=>e.error(t)){const r=new Promise(r=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:r}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new i.A(t.name,e);e.onMessage=e=>t.onMessage(r,e.type,e.payload),e.onError=e=>t.onError(r,e),t.onStart(r);try{await r.result}catch(n){console.error(`Worker exception: ${n}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!r.Bd||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new s.A({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return r.Fr?this.maxMobileConcurrency:this.maxConcurrency}}},50677:(e,t,n)=>{n.d(t,{x:()=>r});const r="4.3.3"},50708:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(22549),s=n(24067),i=n(53439),o=n(38055),a=n(15992),c=n(1069),l=n(8199);class u extends r.A{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:a.eW}),this.constant=!1,this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var t;(t=this.state).layoutChanged||(t.layoutChanged=!(0,c.Lk)(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,n=this.settings.transition,r=Array.isArray(t)?e[t.find(t=>e[t])]:e[t];return(0,l.K)(r,n)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:e=0,endRow:n=1/0}=t;this.state.updateRanges=a.WQ(this.state.updateRanges,[e,n])}else this.state.updateRanges=a.eW}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=a.wg}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate(e,t.updateRanges!==a.eW),!0))}updateBuffer({numInstances:e,data:t,props:n,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:i,noAlloc:o}}=this;let a=!0;if(i){for(const[o,a]of s)i.call(r,this,{data:t,startRow:o,endRow:a,props:n,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[t,n]of s){const r=Number.isFinite(t)?this.getVertexOffset(t):0,s=Number.isFinite(n)?this.getVertexOffset(n):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:r,endOffset:s})}else;this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(e,t){const n="webgpu"===this.device.type;if(n||void 0===t||"function"==typeof t){if(n&&"function"!=typeof t){const e=this._normalizeValue(t,[],0);this._areValuesEqual(e,this.value)||this.setNeedsUpdate("WebGPU constant updated")}return!1}const r=this.settings.transform&&e?this.settings.transform.call(e,t):t;return this.setData({constant:!0,value:r})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:n,settings:r}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;n.binaryValue=e,this.setNeedsRedraw();if(r.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;(0,s.A)(ArrayBuffer.isView(o.value),`invalid ${r.accessor}`);const a=Boolean(o.size)&&o.size!==this.size;return n.binaryAccessor=(0,i.I)(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:t,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,t=super.getValue();if(!e)return t;for(const n in e)Object.assign(t,super.getValue(n,e[n]));return t}getBufferLayout(e){this.state.layoutChanged=!1;const t=this.settings.shaderAttributes,n=super._getBufferLayout(),{stepMode:r}=this.settings;if(n.stepMode="dynamic"===r?e?e.isInstanced?"instance":"vertex":"instance":r??"vertex",!t)return n;for(const s in t){const e=super._getBufferLayout(s,t[s]);n.attributes.push(...e.attributes)}return n}_autoUpdater(e,{data:t,startRow:n,endRow:r,props:a,numInstances:c}){if(e.constant&&"webgpu"!==this.context.device.type)return;const{settings:l,state:u,value:h,size:d,startIndices:f}=e,{accessor:p,transform:g}=l;let _=u.binaryAccessor||("function"==typeof p?p:a[p]);"function"!=typeof _&&"string"==typeof p&&(_=()=>a[p]),(0,s.A)("function"==typeof _,`accessor "${p}" is not a function`);let m=e.getVertexOffset(n);const{iterable:v,objectInfo:b}=(0,i.X)(t,n,r);for(const s of v){b.index++;let t=_(s,b);if(g&&(t=g.call(this,t)),f){const n=(b.index<f.length-1?f[b.index+1]:c)-f[b.index];if(t&&Array.isArray(t[0])){let n=m;for(const r of t)e._normalizeValue(r,h,n),n+=d}else t&&t.length>d?h.set(t,m):(e._normalizeValue(t,b.target,0),(0,o.R)({target:h,source:b.target,start:m,count:n}));m+=n*d}else e._normalizeValue(t,h,m),m+=d}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||"function"==typeof e.update))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let n=!0;switch(t){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error(`Illegal attribute generated for ${this.id}`)}}}},50741:(e,t,n)=>{n.d(t,{p8:()=>r,tb:()=>s});const r=1e-6;let s="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI},51387:(e,t,n)=>{n.d(t,{A:()=>r});const r={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(e){const t=e[0],n=e[e.length-1];return"{"===t&&"}"===n||"["===t&&"]"===n},parseTextSync:JSON.parse}},52027:(e,t,n)=>{n.d(t,{R:()=>o});var r=n(39965);const s="4.3.3",i=s[0]>="0"&&s[0]<="9"?`v${s}`:"";const o=function(){const e=new r.t({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=e,globalThis.loaders.version=i,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=e,e}()},53034:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(5993);const s=new Map;function i(e){(0,r.v)(e.source&&!e.url||!e.source&&e.url);let t=s.get(e.source||e.url);return t||(e.url&&(t=function(e){if(!e.startsWith("http"))return e;return o((t=e,`try {\n  importScripts('${t}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`));var t}(e.url),s.set(e.url,t)),e.source&&(t=o(e.source),s.set(e.source,t))),(0,r.v)(t),t}function o(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}},53081:(e,t,n)=>{n.d(t,{w:()=>s});var r=n(5153);class s extends r.F{static defaultProps={...r.F.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,s.defaultProps)}}},53302:(e,t,n)=>{n.d(t,{$:()=>o});const r=[255,255,255],s=1;let i=0;class o{constructor(e={}){this.type="ambient";const{color:t=r}=e,{intensity:n=s}=e;this.id=e.id||"ambient-"+i++,this.color=t,this.intensity=n}}},53434:(e,t,n)=>{n.d(t,{n:()=>a,o:()=>r});var r,s=n(74003);!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(r||(r={}));const i=10;function o(e){return"string"!=typeof e?e:(e=e.toUpperCase(),r[e]||r.WHITE)}function a(e,t,n){if(!s.B&&"string"==typeof e){if(t){e=`\x1b[${o(t)}m${e}\x1b[39m`}if(n){e=`\x1b[${o(n)+i}m${e}\x1b[49m`}}return e}},53439:(e,t,n)=>{n.d(t,{I:()=>a,Td:()=>o,X:()=>i});const r=[],s=[];function i(e,t=0,n=1/0){let i=r;const o={index:-1,data:e,target:[]};return e?"function"==typeof e[Symbol.iterator]?i=e:e.length>0&&(s.length=e.length,i=s):i=r,(t>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(t,n),o.index=t-1),{iterable:i,objectInfo:o}}function o(e){return e&&e[Symbol.asyncIterator]}function a(e,t){const{size:n,stride:r,offset:s,startIndices:i,nested:o}=t,a=e.BYTES_PER_ELEMENT,c=r?r/a:n,l=s?s/a:0,u=Math.floor((e.length-l)/c);return(t,{index:r,target:s})=>{if(!i){const t=r*c+l;for(let r=0;r<n;r++)s[r]=e[t+r];return s}const a=i[r],h=i[r+1]||u;let d;if(o){d=new Array(h-a);for(let t=a;t<h;t++){const r=t*c+l;s=new Array(n);for(let t=0;t<n;t++)s[t]=e[r+t];d[t-a]=s}}else if(c===n)d=e.subarray(a*n+l,h*n+l);else{d=new e.constructor((h-a)*n);let t=0;for(let r=a;r<h;r++){const s=r*c+l;for(let r=0;r<n;r++)d[t++]=e[s+r]}}return d}}},53905:(e,t,n)=>{function r(e){const t=i(e);if(!t)throw new Error("Not an image");return t}function s(e){switch(r(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("getImageData");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),n.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function i(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&e instanceof Image?"image":e&&"object"==typeof e&&e.data&&e.width&&e.height?"data":null}n.d(t,{M5:()=>s})},54017:(e,t,n)=>{n.d(t,{$X:()=>vt});class r{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class s{constructor(e,t,n){this.name=e,this.type=t,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class i extends r{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class o extends r{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}}class a extends r{constructor(e,t,n){super(e,n),this.format=t}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}}class c extends r{constructor(e,t,n,r){super(e,n),this.format=t,this.access=r}get isTemplate(){return!0}getTypeName(){let e=this.name;if(null!==this.format){if("vec2"===e||"vec3"===e||"vec4"===e||"mat2x2"===e||"mat2x3"===e||"mat2x4"===e||"mat3x2"===e||"mat3x3"===e||"mat3x4"===e||"mat4x2"===e||"mat4x3"===e||"mat4x4"===e){if("f32"===this.format.name)return e+="f",e;if("i32"===this.format.name)return e+="i",e;if("u32"===this.format.name)return e+="u",e;if("bool"===this.format.name)return e+="b",e;if("f16"===this.format.name)return e+="h",e}e+=`<${this.format.name}>`}else if("vec2"===e||"vec3"===e||"vec4"===e)return e;return e}}var l;(e=>{e[e.Uniform=0]="Uniform",e[e.Storage=1]="Storage",e[e.Texture=2]="Texture",e[e.Sampler=3]="Sampler",e[e.StorageTexture=4]="StorageTexture"})(l||(l={}));class u{constructor(e,t,n,r,s,i,o){this.name=e,this.type=t,this.group=n,this.binding=r,this.attributes=s,this.resourceType=i,this.access=o}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class h{constructor(e,t){this.name=e,this.type=t}}class d{constructor(e,t,n,r){this.name=e,this.type=t,this.locationType=n,this.location=r,this.interpolation=null}}class f{constructor(e,t,n,r){this.name=e,this.type=t,this.locationType=n,this.location=r}}class p{constructor(e,t,n,r){this.name=e,this.type=t,this.attributes=n,this.id=r}}class g{constructor(e,t,n){this.name=e,this.type=t,this.attributes=n}}class _{constructor(e,t=null,n){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t,this.attributes=n}}class m{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}function v(e){var t=(32768&e)>>15,n=(31744&e)>>10,r=1023&e;return 0==n?(t?-1:1)*Math.pow(2,-14)*(r/Math.pow(2,10)):31==n?r?NaN:1/0*(t?-1:1):(t?-1:1)*Math.pow(2,n-15)*(1+r/Math.pow(2,10))}const b=new Float32Array(1),y=new Int32Array(b.buffer),E=new Uint16Array(1);function w(e){b[0]=e;const t=y[0],n=t>>31&1;let r=t>>23&255,s=8388607&t;if(255===r)return E[0]=n<<15|31744|(0!==s?512:0),E[0];if(0===r){if(0===s)return E[0]=n<<15,E[0];s|=8388608;let e=113;for(;!(8388608&s);)s<<=1,e--;return r=127-e,s&=8388607,r>0?(s=(s>>126-r)+(s>>127-r&1),E[0]=n<<15|r<<10|s>>13,E[0]):(E[0]=n<<15,E[0])}return r=r-127+15,r>=31?(E[0]=n<<15|31744,E[0]):r<=0?r<-10?(E[0]=n<<15,E[0]):(s=(8388608|s)>>1-r,E[0]=n<<15|s>>13,E[0]):(s>>=13,E[0]=n<<15|r<<10|s,E[0])}const x=new Uint32Array(1),T=new Float32Array(x.buffer,0,1);function A(e){const t=112+(e>>6&31)<<23|(63&e)<<17;return x[0]=t,T[0]}function S(e,t,n,r){const s=[0,0,0,0];for(let i=0;i<r;++i)switch(n){case"8unorm":s[i]=e[t]/255,t++;break;case"8snorm":s[i]=e[t]/255*2-1,t++;break;case"8uint":s[i]=e[t],t++;break;case"8sint":s[i]=e[t]-127,t++;break;case"16uint":s[i]=e[t]|e[t+1]<<8,t+=2;break;case"16sint":s[i]=(e[t]|e[t+1]<<8)-32768,t+=2;break;case"16float":s[i]=v(e[t]|e[t+1]<<8),t+=2;break;case"32uint":case"32sint":s[i]=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24,t+=4;break;case"32float":s[i]=new Float32Array(e.buffer,t,1)[0],t+=4}return s}function R(e,t,n,r,s){for(let i=0;i<r;++i)switch(n){case"8unorm":e[t]=255*s[i],t++;break;case"8snorm":e[t]=.5*(s[i]+1)*255,t++;break;case"8uint":e[t]=s[i],t++;break;case"8sint":e[t]=s[i]+127,t++;break;case"16uint":new Uint16Array(e.buffer,t,1)[0]=s[i],t+=2;break;case"16sint":new Int16Array(e.buffer,t,1)[0]=s[i],t+=2;break;case"16float":{const n=w(s[i]);new Uint16Array(e.buffer,t,1)[0]=n,t+=2;break}case"32uint":new Uint32Array(e.buffer,t,1)[0]=s[i],t+=4;break;case"32sint":new Int32Array(e.buffer,t,1)[0]=s[i],t+=4;break;case"32float":new Float32Array(e.buffer,t,1)[0]=s[i],t+=4}return s}const I={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class C{constructor(){this.id=C._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,t){if(e){t(P.instance);for(const n of e)n instanceof Array?this.searchBlock(n,t):n.search(t);t(L.instance)}}constEvaluate(e,t){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}C._id=0;class P extends C{}P.instance=new P;class L extends C{}L.instance=new L;const M=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class k extends C{constructor(){super()}}class O extends k{constructor(e,t,n,r,s,i){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=n,this.body=r,this.startLine=s,this.endLine=i}get astNodeType(){return"function"}search(e){if(this.attributes)for(const t of this.attributes)e(t);e(this);for(const t of this.args)e(t);this.searchBlock(this.body,e)}}class N extends k{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class F extends k{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class D extends k{constructor(e,t){super(),this.body=e,this.loopId=t}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class B extends k{constructor(e,t,n,r){super(),this.init=e,this.condition=t,this.increment=n,this.body=r}get astNodeType(){return"for"}search(e){var t,n,r;null===(t=this.init)||void 0===t||t.search(e),null===(n=this.condition)||void 0===n||n.search(e),null===(r=this.increment)||void 0===r||r.search(e),this.searchBlock(this.body,e)}}class U extends k{constructor(e,t,n,r,s){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=r,this.value=s}get astNodeType(){return"var"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class V extends k{constructor(e,t,n){super(),this.attributes=null,this.name=e,this.type=t,this.value=n}get astNodeType(){return"override"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class G extends k{constructor(e,t,n,r,s){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=r,this.value=s}get astNodeType(){return"let"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class $ extends k{constructor(e,t,n,r,s){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=r,this.value=s}get astNodeType(){return"const"}constEvaluate(e,t){return this.value.constEvaluate(e,t)}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}var W,j,z,H;(e=>{e.increment="++",e.decrement="--"})(W||(W={})),(e=>{e.parse=function(t){const n=t;if("parse"==n)throw new Error("Invalid value for IncrementOperator");return e[n]}})(W||(W={}));class X extends k{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(e=>{e.assign="=",e.addAssign="+=",e.subtractAssin="-=",e.multiplyAssign="*=",e.divideAssign="/=",e.moduloAssign="%=",e.andAssign="&=",e.orAssign="|=",e.xorAssign="^=",e.shiftLeftAssign="<<=",e.shiftRightAssign=">>="})(j||(j={})),(e=>{e.parse=function(e){const t=e;if("parse"==t)throw new Error("Invalid value for AssignOperator");return t}})(j||(j={}));class q extends k{constructor(e,t,n){super(),this.operator=e,this.variable=t,this.value=n}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class Y extends k{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}isBuiltin(){return M.has(this.name)}search(e){for(const t of this.args)t.search(e);e(this)}}class K extends k{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}search(e){var t;this.searchBlock(this.body,e),null===(t=this.continuing)||void 0===t||t.search(e)}}class Z extends k{constructor(e,t){super(),this.condition=e,this.cases=t}get astNodeType(){return"switch"}search(e){e(this);for(const t of this.cases)t.search(e)}}class Q extends k{constructor(e,t,n,r){super(),this.condition=e,this.body=t,this.elseif=n,this.else=r}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class J extends k{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class ee extends k{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class te extends k{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class ne extends k{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}}class re extends k{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}}class se extends k{constructor(){super()}get astNodeType(){return"discard"}}class ie extends k{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class oe extends k{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class ae extends k{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let t=e[0];if("f32"===t.name)return t;for(let n=1;n<e.length;++n){const r=ae._priority.get(t.name);ae._priority.get(e[n].name)<r&&(t=e[n])}return"x32"===t.name?ae.i32:t}getTypeName(){return this.name}}ae.x32=new ae("x32"),ae.f32=new ae("f32"),ae.i32=new ae("i32"),ae.u32=new ae("u32"),ae.f16=new ae("f16"),ae.bool=new ae("bool"),ae.void=new ae("void"),ae._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class ce extends ae{constructor(e){super(e)}}class le extends ae{constructor(e,t,n,r){super(e),this.members=t,this.startLine=n,this.endLine=r}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}search(e){for(const t of this.members)e(t)}}class ue extends ae{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(null!==this.format){if("vec2"===e||"vec3"===e||"vec4"===e||"mat2x2"===e||"mat2x3"===e||"mat2x4"===e||"mat3x2"===e||"mat3x3"===e||"mat3x4"===e||"mat4x2"===e||"mat4x3"===e||"mat4x4"===e){if("f32"===this.format.name)return e+="f",e;if("i32"===this.format.name)return e+="i",e;if("u32"===this.format.name)return e+="u",e;if("bool"===this.format.name)return e+="b",e;if("f16"===this.format.name)return e+="h",e}e+=`<${this.format.name}>`}else if("vec2"===e||"vec3"===e||"vec4"===e)return e;return e}}ue.vec2f=new ue("vec2",ae.f32,null),ue.vec3f=new ue("vec3",ae.f32,null),ue.vec4f=new ue("vec4",ae.f32,null),ue.vec2i=new ue("vec2",ae.i32,null),ue.vec3i=new ue("vec3",ae.i32,null),ue.vec4i=new ue("vec4",ae.i32,null),ue.vec2u=new ue("vec2",ae.u32,null),ue.vec3u=new ue("vec3",ae.u32,null),ue.vec4u=new ue("vec4",ae.u32,null),ue.vec2h=new ue("vec2",ae.f16,null),ue.vec3h=new ue("vec3",ae.f16,null),ue.vec4h=new ue("vec4",ae.f16,null),ue.vec2b=new ue("vec2",ae.bool,null),ue.vec3b=new ue("vec3",ae.bool,null),ue.vec4b=new ue("vec4",ae.bool,null),ue.mat2x2f=new ue("mat2x2",ae.f32,null),ue.mat2x3f=new ue("mat2x3",ae.f32,null),ue.mat2x4f=new ue("mat2x4",ae.f32,null),ue.mat3x2f=new ue("mat3x2",ae.f32,null),ue.mat3x3f=new ue("mat3x3",ae.f32,null),ue.mat3x4f=new ue("mat3x4",ae.f32,null),ue.mat4x2f=new ue("mat4x2",ae.f32,null),ue.mat4x3f=new ue("mat4x3",ae.f32,null),ue.mat4x4f=new ue("mat4x4",ae.f32,null),ue.mat2x2h=new ue("mat2x2",ae.f16,null),ue.mat2x3h=new ue("mat2x3",ae.f16,null),ue.mat2x4h=new ue("mat2x4",ae.f16,null),ue.mat3x2h=new ue("mat3x2",ae.f16,null),ue.mat3x3h=new ue("mat3x3",ae.f16,null),ue.mat3x4h=new ue("mat3x4",ae.f16,null),ue.mat4x2h=new ue("mat4x2",ae.f16,null),ue.mat4x3h=new ue("mat4x3",ae.f16,null),ue.mat4x4h=new ue("mat4x4",ae.f16,null),ue.mat2x2i=new ue("mat2x2",ae.i32,null),ue.mat2x3i=new ue("mat2x3",ae.i32,null),ue.mat2x4i=new ue("mat2x4",ae.i32,null),ue.mat3x2i=new ue("mat3x2",ae.i32,null),ue.mat3x3i=new ue("mat3x3",ae.i32,null),ue.mat3x4i=new ue("mat3x4",ae.i32,null),ue.mat4x2i=new ue("mat4x2",ae.i32,null),ue.mat4x3i=new ue("mat4x3",ae.i32,null),ue.mat4x4i=new ue("mat4x4",ae.i32,null),ue.mat2x2u=new ue("mat2x2",ae.u32,null),ue.mat2x3u=new ue("mat2x3",ae.u32,null),ue.mat2x4u=new ue("mat2x4",ae.u32,null),ue.mat3x2u=new ue("mat3x2",ae.u32,null),ue.mat3x3u=new ue("mat3x3",ae.u32,null),ue.mat3x4u=new ue("mat3x4",ae.u32,null),ue.mat4x2u=new ue("mat4x2",ae.u32,null),ue.mat4x3u=new ue("mat4x3",ae.u32,null),ue.mat4x4u=new ue("mat4x4",ae.u32,null);class he extends ae{constructor(e,t,n,r){super(e),this.storage=t,this.type=n,this.access=r}get astNodeType(){return"pointer"}}class de extends ae{constructor(e,t,n,r){super(e),this.attributes=t,this.format=n,this.count=r}get astNodeType(){return"array"}get isArray(){return!0}}class fe extends ae{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"sampler"}}class pe extends C{constructor(){super(),this.postfix=null}}class ge extends pe{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class _e extends pe{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const t of this.args)t.search(e)}constEvaluate(e,t){return t&&(t[0]=this.type),e.evalExpression(this,e.context)}}class me extends pe{constructor(e,t){super(),this.cachedReturnValue=null,this.name=e,this.args=t}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return M.has(this.name)}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){for(const t of this.args)t.search(e);e(this)}}class ve extends pe{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,t){return e.evalExpression(this,e.context)}}class be extends pe{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}constEvaluate(e,t){if(this.initializer){const t=e.evalExpression(this.initializer,e.context);return null!==t&&this.postfix?t.getSubData(e,this.postfix,e.context):t}return null}search(e){this.initializer.search(e)}}class ye extends pe{constructor(e,t){super(),this.value=e,this.type=t}get astNodeType(){return"literalExpr"}constEvaluate(e,t){return void 0!==t&&(t[0]=this.type),this.value}get isScalar(){return this.value instanceof De}get isVector(){return this.value instanceof Ue||this.value instanceof Ve}get scalarValue(){return this.value instanceof De?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof Ue||this.value instanceof Ve?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class Ee extends pe{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class we extends pe{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class xe extends pe{constructor(){super()}}class Te extends xe{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class Ae extends xe{constructor(e,t,n){super(),this.operator=e,this.left=t,this.right=n}get astNodeType(){return"binaryOp"}_getPromotedType(e,t){return e.name===t.name?e:"f32"===e.name||"f32"===t.name?ae.f32:"u32"===e.name||"u32"===t.name?ae.u32:ae.i32}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class Se extends C{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class Re extends pe{constructor(){super()}get astNodeType(){return"default"}}class Ie extends Se{constructor(e,t){super(t),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class Ce extends Se{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class Pe extends C{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"argument"}}class Le extends C{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class Me extends C{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"member"}}class ke extends C{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}}class Oe{constructor(e,t){this.parent=null,this.typeInfo=e,this.parent=t,this.id=Oe._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,t,n,r){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,t,n){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}}Oe._id=0;class Ne extends Oe{constructor(){super(new r("void",null),null)}toString(){return"void"}}Ne.void=new Ne;class Fe extends Oe{constructor(e){super(new a("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,t,n,r){this.reference.setDataValue(e,t,n,r)}getSubData(e,t,n){return t?this.reference.getSubData(e,t,n):this}toString(){return`&${this.reference.toString()}`}}class De extends Oe{constructor(e,t,n=null){super(t,n),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:"x32"===this.typeInfo.name?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):"i32"===this.typeInfo.name||"bool"===this.typeInfo.name?this.data=new Int32Array([e]):"u32"===this.typeInfo.name?this.data=new Uint32Array([e]):"f32"===this.typeInfo.name||"f16"===this.typeInfo.name?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",t)}clone(){if(this.data instanceof Float32Array)return new De(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new De(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new De(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,t,n,r){if(n)return void console.error("SetDataValue: Scalar data does not support postfix",n);if(!(t instanceof De))return void console.error("SetDataValue: Invalid value",t);let s=t.data[0];"i32"===this.typeInfo.name||"u32"===this.typeInfo.name?s=Math.floor(s):"bool"===this.typeInfo.name&&(s=s?1:0),this.data[0]=s}getSubData(e,t,n){return t?(console.error("getSubData: Scalar data does not support postfix",t),null):this}toString(){return`${this.value}`}}function Be(e,t,n){const r=t.length;return 2===r?"f32"===n?new Ue(new Float32Array(t),e.getTypeInfo("vec2f")):"i32"===n||"bool"===n?new Ue(new Int32Array(t),e.getTypeInfo("vec2i")):"u32"===n?new Ue(new Uint32Array(t),e.getTypeInfo("vec2u")):"f16"===n?new Ue(new Float32Array(t),e.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${n}`),null):3===r?"f32"===n?new Ue(new Float32Array(t),e.getTypeInfo("vec3f")):"i32"===n||"bool"===n?new Ue(new Int32Array(t),e.getTypeInfo("vec3i")):"u32"===n?new Ue(new Uint32Array(t),e.getTypeInfo("vec3u")):"f16"===n?new Ue(new Float32Array(t),e.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${n}`),null):4===r?"f32"===n?new Ue(new Float32Array(t),e.getTypeInfo("vec4f")):"i32"===n||"bool"===n?new Ue(new Int32Array(t),e.getTypeInfo("vec4i")):"u32"===n?new Ue(new Uint32Array(t),e.getTypeInfo("vec4u")):"f16"===n?new Ue(new Float32Array(t),e.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${n}`),null):(console.error(`getSubData: Invalid vector size ${t.length}`),null)}class Ue extends Oe{constructor(e,t,n=null){if(super(t,n),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const t=this.typeInfo.name;"vec2f"===t||"vec3f"===t||"vec4f"===t?this.data=new Float32Array(e):"vec2i"===t||"vec3i"===t||"vec4i"===t?this.data=new Int32Array(e):"vec2u"===t||"vec3u"===t||"vec4u"===t?this.data=new Uint32Array(e):"vec2h"===t||"vec3h"===t||"vec4h"===t?this.data=new Float32Array(e):"vec2b"===t||"vec3b"===t||"vec4b"===t?this.data=new Int32Array(e):"vec2"===t||"vec3"===t||"vec4"===t?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${t}`)}}clone(){if(this.data instanceof Float32Array)return new Ue(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new Ue(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new Ue(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,t,n,r){n instanceof ge?console.error("TODO: Set vector postfix"):t instanceof Ue?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,n){if(null===t)return this;let r=e.getTypeInfo("f32");if(this.typeInfo instanceof c)r=this.typeInfo.format||r;else{const t=this.typeInfo.name;"vec2f"===t||"vec3f"===t||"vec4f"===t?r=e.getTypeInfo("f32"):"vec2i"===t||"vec3i"===t||"vec4i"===t?r=e.getTypeInfo("i32"):"vec2b"===t||"vec3b"===t||"vec4b"===t?r=e.getTypeInfo("bool"):"vec2u"===t||"vec3u"===t||"vec4u"===t?r=e.getTypeInfo("u32"):"vec2h"===t||"vec3h"===t||"vec4h"===t?r=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${t}`)}let s=this;for(;null!==t&&null!==s;){if(t instanceof we){const i=t.index;let o=-1;if(i instanceof ye){if(!(i.value instanceof De))return console.error(`GetSubData: Invalid array index ${i.value}`),null;o=i.value.value}else{const t=e.evalExpression(i,n);if(!(t instanceof De))return console.error("GetSubData: Unknown index type",i),null;o=t.value}if(o<0||o>=s.data.length)return console.error("GetSubData: Index out of range",o),null;if(s.data instanceof Float32Array){const e=new Float32Array(s.data.buffer,s.data.byteOffset+4*o,1);return new De(e,r)}if(s.data instanceof Int32Array){const e=new Int32Array(s.data.buffer,s.data.byteOffset+4*o,1);return new De(e,r)}if(s.data instanceof Uint32Array){const e=new Uint32Array(s.data.buffer,s.data.byteOffset+4*o,1);return new De(e,r)}throw"GetSubData: Invalid data type"}if(!(t instanceof ge))return console.error("GetSubData: Unknown postfix",t),null;{const n=t.value.toLowerCase();if(1===n.length){let e=0;if("x"===n||"r"===n)e=0;else if("y"===n||"g"===n)e=1;else if("z"===n||"b"===n)e=2;else{if("w"!==n&&"a"!==n)return console.error(`GetSubData: Unknown member ${n}`),null;e=3}if(this.data instanceof Float32Array){let t=new Float32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new De(t,r,this)}if(this.data instanceof Int32Array){let t=new Int32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new De(t,r,this)}if(this.data instanceof Uint32Array){let t=new Uint32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new De(t,r,this)}}const i=[];for(const e of n)"x"===e||"r"===e?i.push(this.data[0]):"y"===e||"g"===e?i.push(this.data[1]):"z"===e||"b"===e?i.push(this.data[2]):"w"===e||"a"===e?i.push(this.data[3]):console.error(`GetDataValue: Unknown member ${e}`);s=Be(e,i,r.name)}t=t.postfix}return s}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}}class Ve extends Oe{constructor(e,t,n=null){super(t,n),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new Ve(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,t,n,r){n instanceof ge?console.error("TODO: Set matrix postfix"):t instanceof Ve?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,n){if(null===t)return this;const r=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof c)this.typeInfo.format;else if(r.endsWith("f"))e.getTypeInfo("f32");else if(r.endsWith("i"))e.getTypeInfo("i32");else if(r.endsWith("u"))e.getTypeInfo("u32");else{if(!r.endsWith("h"))return console.error(`GetDataValue: Unknown type ${r}`),null;e.getTypeInfo("f16")}if(t instanceof we){const s=t.index;let i=-1;if(s instanceof ye){if(!(s.value instanceof De))return console.error(`GetDataValue: Invalid array index ${s.value}`),null;i=s.value.value}else{const t=e.evalExpression(s,n);if(!(t instanceof De))return console.error("GetDataValue: Unknown index type",s),null;i=t.value}if(i<0||i>=this.data.length)return console.error("GetDataValue: Index out of range",i),null;const o=r.endsWith("h")?"h":"f";let a;if("mat2x2"===r||"mat2x2f"===r||"mat2x2h"===r||"mat3x2"===r||"mat3x2f"===r||"mat3x2h"===r||"mat4x2"===r||"mat4x2f"===r||"mat4x2h"===r)a=new Ue(new Float32Array(this.data.buffer,this.data.byteOffset+2*i*4,2),e.getTypeInfo(`vec2${o}`));else if("mat2x3"===r||"mat2x3f"===r||"mat2x3h"===r||"mat3x3"===r||"mat3x3f"===r||"mat3x3h"===r||"mat4x3"===r||"mat4x3f"===r||"mat4x3h"===r)a=new Ue(new Float32Array(this.data.buffer,this.data.byteOffset+3*i*4,3),e.getTypeInfo(`vec3${o}`));else{if("mat2x4"!==r&&"mat2x4f"!==r&&"mat2x4h"!==r&&"mat3x4"!==r&&"mat3x4f"!==r&&"mat3x4h"!==r&&"mat4x4"!==r&&"mat4x4f"!==r&&"mat4x4h"!==r)return console.error(`GetDataValue: Unknown type ${r}`),null;a=new Ue(new Float32Array(this.data.buffer,this.data.byteOffset+4*i*4,4),e.getTypeInfo(`vec4${o}`))}return t.postfix?a.getSubData(e,t.postfix,n):a}return console.error("GetDataValue: Invalid postfix",t),null}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}}class Ge extends Oe{constructor(e,t,n=0,r=null){super(t,r),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=n}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new Ge(e.buffer,this.typeInfo,0,null)}setDataValue(e,t,n,s){if(null===t)return void console.log("setDataValue: NULL data.");let a=this.offset,c=this.typeInfo;for(;n;){if(n instanceof we)if(c instanceof o){const t=n.index;if(t instanceof ye){if(!(t.value instanceof De))return void console.error(`SetDataValue: Invalid index type ${t.value}`);a+=t.value.value*c.stride}else{const n=e.evalExpression(t,s);if(!(n instanceof De))return void console.error("SetDataValue: Unknown index type",t);a+=n.value*c.stride}c=c.format}else console.error(`SetDataValue: Type ${c.getTypeName()} is not an array`);else{if(!(n instanceof ge))return void console.error("SetDataValue: Unknown postfix type",n);{const e=n.value;if(c instanceof i){let t=!1;for(const n of c.members)if(n.name===e){a+=n.offset,c=n.type,t=!0;break}if(!t)return void console.error(`SetDataValue: Member ${e} not found`)}else if(c instanceof r){const n=c.getTypeName();let r=0;if("x"===e||"r"===e)r=0;else if("y"===e||"g"===e)r=1;else if("z"===e||"b"===e)r=2;else{if("w"!==e&&"a"!==e)return void console.error(`SetDataValue: Unknown member ${e}`);r=3}if(!(t instanceof De))return void console.error("SetDataValue: Invalid value",t);const s=t.value;return"vec2f"===n?void(new Float32Array(this.buffer,a,2)[r]=s):"vec3f"===n?void(new Float32Array(this.buffer,a,3)[r]=s):"vec4f"===n?void(new Float32Array(this.buffer,a,4)[r]=s):"vec2i"===n?void(new Int32Array(this.buffer,a,2)[r]=s):"vec3i"===n?void(new Int32Array(this.buffer,a,3)[r]=s):"vec4i"===n?void(new Int32Array(this.buffer,a,4)[r]=s):"vec2u"===n?void(new Uint32Array(this.buffer,a,2)[r]=s):"vec3u"===n?void(new Uint32Array(this.buffer,a,3)[r]=s):"vec4u"===n?void(new Uint32Array(this.buffer,a,4)[r]=s):void console.error(`SetDataValue: Type ${n} is not a struct`)}}}n=n.postfix}this.setData(e,t,c,a,s)}setData(e,t,n,r,s){const i=n.getTypeName();if("f32"!==i&&"f16"!==i)if("i32"!==i&&"atomic<i32>"!==i&&"x32"!==i)if("u32"!==i&&"atomic<u32>"!==i)if("bool"!==i){if("vec2f"===i||"vec2h"===i){const e=new Float32Array(this.buffer,r,2);return void(t instanceof Ue?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3f"===i||"vec3h"===i){const e=new Float32Array(this.buffer,r,3);return void(t instanceof Ue?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4f"===i||"vec4h"===i){const e=new Float32Array(this.buffer,r,4);return void(t instanceof Ue?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("vec2i"===i){const e=new Int32Array(this.buffer,r,2);return void(t instanceof Ue?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3i"===i){const e=new Int32Array(this.buffer,r,3);return void(t instanceof Ue?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4i"===i){const e=new Int32Array(this.buffer,r,4);return void(t instanceof Ue?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("vec2u"===i){const e=new Uint32Array(this.buffer,r,2);return void(t instanceof Ue?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3u"===i){const e=new Uint32Array(this.buffer,r,3);return void(t instanceof Ue?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4u"===i){const e=new Uint32Array(this.buffer,r,4);return void(t instanceof Ue?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("vec2b"===i){const e=new Uint32Array(this.buffer,r,2);return void(t instanceof Ue?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3b"===i){const e=new Uint32Array(this.buffer,r,3);return void(t instanceof Ue?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4b"===i){const e=new Uint32Array(this.buffer,r,4);return void(t instanceof Ue?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("mat2x2f"===i||"mat2x2h"===i){const e=new Float32Array(this.buffer,r,4);return void(t instanceof Ve?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("mat2x3f"===i||"mat2x3h"===i){const e=new Float32Array(this.buffer,r,6);return void(t instanceof Ve?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5]))}if("mat2x4f"===i||"mat2x4h"===i){const e=new Float32Array(this.buffer,r,8);return void(t instanceof Ve?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7]))}if("mat3x2f"===i||"mat3x2h"===i){const e=new Float32Array(this.buffer,r,6);return void(t instanceof Ve?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5]))}if("mat3x3f"===i||"mat3x3h"===i){const e=new Float32Array(this.buffer,r,9);return void(t instanceof Ve?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]))}if("mat3x4f"===i||"mat3x4h"===i){const e=new Float32Array(this.buffer,r,12);return void(t instanceof Ve?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8],e[9]=t.data[9],e[10]=t.data[10],e[11]=t.data[11]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]))}if("mat4x2f"===i||"mat4x2h"===i){const e=new Float32Array(this.buffer,r,8);return void(t instanceof Ve?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7]))}if("mat4x3f"===i||"mat4x3h"===i){const e=new Float32Array(this.buffer,r,12);return void(t instanceof Ve?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8],e[9]=t.data[9],e[10]=t.data[10],e[11]=t.data[11]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]))}if("mat4x4f"===i||"mat4x4h"===i){const e=new Float32Array(this.buffer,r,16);return void(t instanceof Ve?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8],e[9]=t.data[9],e[10]=t.data[10],e[11]=t.data[11],e[12]=t.data[12],e[13]=t.data[13],e[14]=t.data[14],e[15]=t.data[15]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}if(t instanceof Ge){if(n===t.typeInfo)return void new Uint8Array(this.buffer,r,t.buffer.byteLength).set(new Uint8Array(t.buffer));console.error("SetDataValue: Type mismatch",i,t.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${i}`)}else t instanceof De&&(new Int32Array(this.buffer,r,1)[0]=t.value);else t instanceof De&&(new Uint32Array(this.buffer,r,1)[0]=t.value);else t instanceof De&&(new Int32Array(this.buffer,r,1)[0]=t.value);else t instanceof De&&(new Float32Array(this.buffer,r,1)[0]=t.value)}getSubData(e,t,n){var s,a,l;if(null===t)return this;let u=this.offset,h=this.typeInfo;for(;t;){if(t instanceof we){const r=t.index,s=r instanceof pe?e.evalExpression(r,n):r;let i=0;if(s instanceof De?i=s.value:"number"==typeof s?i=s:console.error("GetDataValue: Invalid index type",r),h instanceof o)u+=i*h.stride,h=h.format;else{const t=h.getTypeName();"mat4x4"===t||"mat4x4f"===t||"mat4x4h"===t?(u+=16*i,h=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${h.getTypeName()} is not an array`)}}else{if(!(t instanceof ge))return console.error("GetDataValue: Unknown postfix type",t),null;{const n=t.value;if(h instanceof i){let e=!1;for(const t of h.members)if(t.name===n){u+=t.offset,h=t.type,e=!0;break}if(!e)return console.error(`GetDataValue: Member ${n} not found`),null}else if(h instanceof r){const t=h.getTypeName();if("vec2f"===t||"vec3f"===t||"vec4f"===t||"vec2i"===t||"vec3i"===t||"vec4i"===t||"vec2u"===t||"vec3u"===t||"vec4u"===t||"vec2b"===t||"vec3b"===t||"vec4b"===t||"vec2h"===t||"vec3h"===t||"vec4h"===t||"vec2"===t||"vec3"===t||"vec4"===t){if(n.length>0&&n.length<5){let r="f";const s=[];for(let i=0;i<n.length;++i){const o=n[i].toLowerCase();let a=0;if("x"===o||"r"===o)a=0;else if("y"===o||"g"===o)a=1;else if("z"===o||"b"===o)a=2;else{if("w"!==o&&"a"!==o)return console.error(`Unknown member ${n}`),null;a=3}if(1===n.length){if(t.endsWith("f"))return this.buffer.byteLength<u+4*a+4?(console.log("Insufficient buffer data"),null):new De(new Float32Array(this.buffer,u+4*a,1),e.getTypeInfo("f32"),this);if(t.endsWith("h"))return new De(new Float32Array(this.buffer,u+4*a,1),e.getTypeInfo("f16"),this);if(t.endsWith("i"))return new De(new Int32Array(this.buffer,u+4*a,1),e.getTypeInfo("i32"),this);if(t.endsWith("b"))return new De(new Int32Array(this.buffer,u+4*a,1),e.getTypeInfo("bool"),this);if(t.endsWith("u"))return new De(new Uint32Array(this.buffer,u+4*a,1),e.getTypeInfo("i32"),this)}if("vec2f"===t)s.push(new Float32Array(this.buffer,u,2)[a]);else if("vec3f"===t){if(u+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const e=new Float32Array(this.buffer,u,3);s.push(e[a])}else if("vec4f"===t)s.push(new Float32Array(this.buffer,u,4)[a]);else if("vec2i"===t)r="i",s.push(new Int32Array(this.buffer,u,2)[a]);else if("vec3i"===t)r="i",s.push(new Int32Array(this.buffer,u,3)[a]);else if("vec4i"===t)r="i",s.push(new Int32Array(this.buffer,u,4)[a]);else if("vec2u"===t){r="u";const e=new Uint32Array(this.buffer,u,2);s.push(e[a])}else"vec3u"===t?(r="u",s.push(new Uint32Array(this.buffer,u,3)[a])):"vec4u"===t&&(r="u",s.push(new Uint32Array(this.buffer,u,4)[a]))}return 2===s.length?h=e.getTypeInfo(`vec2${r}`):3===s.length?h=e.getTypeInfo(`vec3${r}`):4===s.length?h=e.getTypeInfo(`vec4${r}`):console.error(`GetDataValue: Invalid vector length ${s.length}`),new Ue(s,h,null)}return console.error(`GetDataValue: Unknown member ${n}`),null}return console.error(`GetDataValue: Type ${t} is not a struct`),null}}}t=t.postfix}const d=h.getTypeName();return"f32"===d?new De(new Float32Array(this.buffer,u,1),h,this):"i32"===d?new De(new Int32Array(this.buffer,u,1),h,this):"u32"===d?new De(new Uint32Array(this.buffer,u,1),h,this):"vec2f"===d?new Ue(new Float32Array(this.buffer,u,2),h,this):"vec3f"===d?new Ue(new Float32Array(this.buffer,u,3),h,this):"vec4f"===d?new Ue(new Float32Array(this.buffer,u,4),h,this):"vec2i"===d?new Ue(new Int32Array(this.buffer,u,2),h,this):"vec3i"===d?new Ue(new Int32Array(this.buffer,u,3),h,this):"vec4i"===d?new Ue(new Int32Array(this.buffer,u,4),h,this):"vec2u"===d?new Ue(new Uint32Array(this.buffer,u,2),h,this):"vec3u"===d?new Ue(new Uint32Array(this.buffer,u,3),h,this):"vec4u"===d?new Ue(new Uint32Array(this.buffer,u,4),h,this):h instanceof c&&"atomic"===h.name?"u32"===(null===(s=h.format)||void 0===s?void 0:s.name)?new De(new Uint32Array(this.buffer,u,1)[0],h.format,this):"i32"===(null===(a=h.format)||void 0===a?void 0:a.name)?new De(new Int32Array(this.buffer,u,1)[0],h.format,this):(console.error(`GetDataValue: Invalid atomic format ${null===(l=h.format)||void 0===l?void 0:l.name}`),null):new Ge(this.buffer,h,u,this)}toString(){let e="";if(this.typeInfo instanceof o)if("f32"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let n=1;n<t.length;++n)e+=`, ${t[n]}`}else if("i32"===this.typeInfo.format.name){const t=new Int32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let n=1;n<t.length;++n)e+=`, ${t[n]}`}else if("u32"===this.typeInfo.format.name){const t=new Uint32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let n=1;n<t.length;++n)e+=`, ${t[n]}`}else if("vec2f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}]`;for(let n=1;n<t.length/2;++n)e+=`, [${t[2*n]}, ${t[2*n+1]}]`}else if("vec3f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}]`;for(let n=4;n<t.length;n+=4)e+=`, [${t[n]}, ${t[n+1]}, ${t[n+2]}]`}else if("vec4f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}]`;for(let n=4;n<t.length;n+=4)e+=`, [${t[n]}, ${t[n+1]}, ${t[n+2]}, ${t[n+3]}]`}else e="[...]";else this.typeInfo instanceof i?e+="{...}":e="[...]";return e}}class $e extends Oe{constructor(e,t,n,r){super(t,null),this.data=e,this.descriptor=n,this.view=r}clone(){return new $e(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>0?null!==(e=n[0])&&void 0!==e?e:0:n instanceof Object&&null!==(t=n.width)&&void 0!==t?t:0}get height(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>1?null!==(e=n[1])&&void 0!==e?e:0:n instanceof Object&&null!==(t=n.height)&&void 0!==t?t:0}get depthOrArrayLayers(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>2?null!==(e=n[2])&&void 0!==e?e:0:n instanceof Object&&null!==(t=n.depthOrArrayLayers)&&void 0!==t?t:0}get format(){var e;return this.descriptor&&null!==(e=this.descriptor.format)&&void 0!==e?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&null!==(e=this.descriptor.sampleCount)&&void 0!==e?e:1}get mipLevelCount(){var e;return this.descriptor&&null!==(e=this.descriptor.mipLevelCount)&&void 0!==e?e:1}get dimension(){var e;return this.descriptor&&null!==(e=this.descriptor.dimension)&&void 0!==e?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const t=[this.width,this.height,this.depthOrArrayLayers];for(let n=0;n<t.length;++n)t[n]=Math.max(1,t[n]>>e);return t}get texelByteSize(){const e=this.format,t=I[e];return t?t.isDepthStencil?4:t.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,t=I[e];return!!t&&t.isDepthStencil}getGpuSize(){const e=this.format,t=I[e],n=this.width;if(!e||n<=0||!t)return-1;const r=this.height,s=this.depthOrArrayLayers,i=this.dimension;return n/t.blockWidth*("1d"===i?1:r/t.blockHeight)*t.bytesPerBlock*s}getPixel(e,t,n=0,r=0){const s=this.texelByteSize,i=this.bytesPerRow,o=this.height,a=this.data[r];return function(e,t,n,r,s,i,o,a,c){const l=r*(o>>=s)*(i>>=s)+n*o+t*a;switch(c){case"r8unorm":return[S(e,l,"8unorm",1)[0]];case"r8snorm":return[S(e,l,"8snorm",1)[0]];case"r8uint":return[S(e,l,"8uint",1)[0]];case"r8sint":return[S(e,l,"8sint",1)[0]];case"rg8unorm":{const t=S(e,l,"8unorm",2);return[t[0],t[1]]}case"rg8snorm":{const t=S(e,l,"8snorm",2);return[t[0],t[1]]}case"rg8uint":{const t=S(e,l,"8uint",2);return[t[0],t[1]]}case"rg8sint":{const t=S(e,l,"8sint",2);return[t[0],t[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const t=S(e,l,"8unorm",4);return[t[0],t[1],t[2],t[3]]}case"rgba8snorm":{const t=S(e,l,"8snorm",4);return[t[0],t[1],t[2],t[3]]}case"rgba8uint":{const t=S(e,l,"8uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba8sint":{const t=S(e,l,"8sint",4);return[t[0],t[1],t[2],t[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const t=S(e,l,"8unorm",4);return[t[2],t[1],t[0],t[3]]}case"r16uint":return[S(e,l,"16uint",1)[0]];case"r16sint":return[S(e,l,"16sint",1)[0]];case"r16float":return[S(e,l,"16float",1)[0]];case"rg16uint":{const t=S(e,l,"16uint",2);return[t[0],t[1]]}case"rg16sint":{const t=S(e,l,"16sint",2);return[t[0],t[1]]}case"rg16float":{const t=S(e,l,"16float",2);return[t[0],t[1]]}case"rgba16uint":{const t=S(e,l,"16uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba16sint":{const t=S(e,l,"16sint",4);return[t[0],t[1],t[2],t[3]]}case"rgba16float":{const t=S(e,l,"16float",4);return[t[0],t[1],t[2],t[3]]}case"r32uint":return[S(e,l,"32uint",1)[0]];case"r32sint":return[S(e,l,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[S(e,l,"32float",1)[0]];case"rg32uint":{const t=S(e,l,"32uint",2);return[t[0],t[1]]}case"rg32sint":{const t=S(e,l,"32sint",2);return[t[0],t[1]]}case"rg32float":{const t=S(e,l,"32float",2);return[t[0],t[1]]}case"rgba32uint":{const t=S(e,l,"32uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba32sint":{const t=S(e,l,"32sint",4);return[t[0],t[1],t[2],t[3]]}case"rgba32float":{const t=S(e,l,"32float",4);return[t[0],t[1],t[2],t[3]]}case"rg11b10ufloat":{const t=new Uint32Array(e.buffer,l,1)[0],n=(4192256&t)>>11,r=(4290772992&t)>>22;return[A(2047&t),A(n),function(e){const t=112+(e>>5&31)<<23|(31&e)<<18;return x[0]=t,T[0]}(r),1]}}return null}(new Uint8Array(a),e,t,n,r,o,i,s,this.format)}setPixel(e,t,n,r,s){const i=this.texelByteSize,o=this.bytesPerRow,a=this.height,c=this.data[r];!function(e,t,n,r,s,i,o,a,c,l){const u=r*(o>>=s)*(i>>=s)+n*o+t*a;switch(c){case"r8unorm":return void R(e,u,"8unorm",1,l);case"r8snorm":return void R(e,u,"8snorm",1,l);case"r8uint":return void R(e,u,"8uint",1,l);case"r8sint":return void R(e,u,"8sint",1,l);case"rg8unorm":return void R(e,u,"8unorm",2,l);case"rg8snorm":return void R(e,u,"8snorm",2,l);case"rg8uint":return void R(e,u,"8uint",2,l);case"rg8sint":return void R(e,u,"8sint",2,l);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void R(e,u,"8unorm",4,l);case"rgba8snorm":return void R(e,u,"8snorm",4,l);case"rgba8uint":return void R(e,u,"8uint",4,l);case"rgba8sint":return void R(e,u,"8sint",4,l);case"r16uint":return void R(e,u,"16uint",1,l);case"r16sint":return void R(e,u,"16sint",1,l);case"r16float":return void R(e,u,"16float",1,l);case"rg16uint":return void R(e,u,"16uint",2,l);case"rg16sint":return void R(e,u,"16sint",2,l);case"rg16float":return void R(e,u,"16float",2,l);case"rgba16uint":return void R(e,u,"16uint",4,l);case"rgba16sint":return void R(e,u,"16sint",4,l);case"rgba16float":return void R(e,u,"16float",4,l);case"r32uint":return void R(e,u,"32uint",1,l);case"r32sint":return void R(e,u,"32sint",1,l);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void R(e,u,"32float",1,l);case"rg32uint":return void R(e,u,"32uint",2,l);case"rg32sint":return void R(e,u,"32sint",2,l);case"rg32float":return void R(e,u,"32float",2,l);case"rgba32uint":return void R(e,u,"32uint",4,l);case"rgba32sint":return void R(e,u,"32sint",4,l);case"rgba32float":return void R(e,u,"32float",4,l);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}}(new Uint8Array(c),e,t,n,r,a,o,i,this.format,s)}}(e=>{e[e.token=0]="token",e[e.keyword=1]="keyword",e[e.reserved=2]="reserved"})(H||(H={}));class We{constructor(e,t,n){this.name=e,this.type=t,this.rule=n}toString(){return this.name}}class je{}z=je,je.none=new We("",H.reserved,""),je.eof=new We("EOF",H.token,""),je.reserved={asm:new We("asm",H.reserved,"asm"),bf16:new We("bf16",H.reserved,"bf16"),do:new We("do",H.reserved,"do"),enum:new We("enum",H.reserved,"enum"),f16:new We("f16",H.reserved,"f16"),f64:new We("f64",H.reserved,"f64"),handle:new We("handle",H.reserved,"handle"),i8:new We("i8",H.reserved,"i8"),i16:new We("i16",H.reserved,"i16"),i64:new We("i64",H.reserved,"i64"),mat:new We("mat",H.reserved,"mat"),premerge:new We("premerge",H.reserved,"premerge"),regardless:new We("regardless",H.reserved,"regardless"),typedef:new We("typedef",H.reserved,"typedef"),u8:new We("u8",H.reserved,"u8"),u16:new We("u16",H.reserved,"u16"),u64:new We("u64",H.reserved,"u64"),unless:new We("unless",H.reserved,"unless"),using:new We("using",H.reserved,"using"),vec:new We("vec",H.reserved,"vec"),void:new We("void",H.reserved,"void")},je.keywords={array:new We("array",H.keyword,"array"),atomic:new We("atomic",H.keyword,"atomic"),bool:new We("bool",H.keyword,"bool"),f32:new We("f32",H.keyword,"f32"),i32:new We("i32",H.keyword,"i32"),mat2x2:new We("mat2x2",H.keyword,"mat2x2"),mat2x3:new We("mat2x3",H.keyword,"mat2x3"),mat2x4:new We("mat2x4",H.keyword,"mat2x4"),mat3x2:new We("mat3x2",H.keyword,"mat3x2"),mat3x3:new We("mat3x3",H.keyword,"mat3x3"),mat3x4:new We("mat3x4",H.keyword,"mat3x4"),mat4x2:new We("mat4x2",H.keyword,"mat4x2"),mat4x3:new We("mat4x3",H.keyword,"mat4x3"),mat4x4:new We("mat4x4",H.keyword,"mat4x4"),ptr:new We("ptr",H.keyword,"ptr"),sampler:new We("sampler",H.keyword,"sampler"),sampler_comparison:new We("sampler_comparison",H.keyword,"sampler_comparison"),struct:new We("struct",H.keyword,"struct"),texture_1d:new We("texture_1d",H.keyword,"texture_1d"),texture_2d:new We("texture_2d",H.keyword,"texture_2d"),texture_2d_array:new We("texture_2d_array",H.keyword,"texture_2d_array"),texture_3d:new We("texture_3d",H.keyword,"texture_3d"),texture_cube:new We("texture_cube",H.keyword,"texture_cube"),texture_cube_array:new We("texture_cube_array",H.keyword,"texture_cube_array"),texture_multisampled_2d:new We("texture_multisampled_2d",H.keyword,"texture_multisampled_2d"),texture_storage_1d:new We("texture_storage_1d",H.keyword,"texture_storage_1d"),texture_storage_2d:new We("texture_storage_2d",H.keyword,"texture_storage_2d"),texture_storage_2d_array:new We("texture_storage_2d_array",H.keyword,"texture_storage_2d_array"),texture_storage_3d:new We("texture_storage_3d",H.keyword,"texture_storage_3d"),texture_depth_2d:new We("texture_depth_2d",H.keyword,"texture_depth_2d"),texture_depth_2d_array:new We("texture_depth_2d_array",H.keyword,"texture_depth_2d_array"),texture_depth_cube:new We("texture_depth_cube",H.keyword,"texture_depth_cube"),texture_depth_cube_array:new We("texture_depth_cube_array",H.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new We("texture_depth_multisampled_2d",H.keyword,"texture_depth_multisampled_2d"),texture_external:new We("texture_external",H.keyword,"texture_external"),u32:new We("u32",H.keyword,"u32"),vec2:new We("vec2",H.keyword,"vec2"),vec3:new We("vec3",H.keyword,"vec3"),vec4:new We("vec4",H.keyword,"vec4"),bitcast:new We("bitcast",H.keyword,"bitcast"),block:new We("block",H.keyword,"block"),break:new We("break",H.keyword,"break"),case:new We("case",H.keyword,"case"),continue:new We("continue",H.keyword,"continue"),continuing:new We("continuing",H.keyword,"continuing"),default:new We("default",H.keyword,"default"),diagnostic:new We("diagnostic",H.keyword,"diagnostic"),discard:new We("discard",H.keyword,"discard"),else:new We("else",H.keyword,"else"),enable:new We("enable",H.keyword,"enable"),fallthrough:new We("fallthrough",H.keyword,"fallthrough"),false:new We("false",H.keyword,"false"),fn:new We("fn",H.keyword,"fn"),for:new We("for",H.keyword,"for"),function:new We("function",H.keyword,"function"),if:new We("if",H.keyword,"if"),let:new We("let",H.keyword,"let"),const:new We("const",H.keyword,"const"),loop:new We("loop",H.keyword,"loop"),while:new We("while",H.keyword,"while"),private:new We("private",H.keyword,"private"),read:new We("read",H.keyword,"read"),read_write:new We("read_write",H.keyword,"read_write"),return:new We("return",H.keyword,"return"),requires:new We("requires",H.keyword,"requires"),storage:new We("storage",H.keyword,"storage"),switch:new We("switch",H.keyword,"switch"),true:new We("true",H.keyword,"true"),alias:new We("alias",H.keyword,"alias"),type:new We("type",H.keyword,"type"),uniform:new We("uniform",H.keyword,"uniform"),var:new We("var",H.keyword,"var"),override:new We("override",H.keyword,"override"),workgroup:new We("workgroup",H.keyword,"workgroup"),write:new We("write",H.keyword,"write"),r8unorm:new We("r8unorm",H.keyword,"r8unorm"),r8snorm:new We("r8snorm",H.keyword,"r8snorm"),r8uint:new We("r8uint",H.keyword,"r8uint"),r8sint:new We("r8sint",H.keyword,"r8sint"),r16uint:new We("r16uint",H.keyword,"r16uint"),r16sint:new We("r16sint",H.keyword,"r16sint"),r16float:new We("r16float",H.keyword,"r16float"),rg8unorm:new We("rg8unorm",H.keyword,"rg8unorm"),rg8snorm:new We("rg8snorm",H.keyword,"rg8snorm"),rg8uint:new We("rg8uint",H.keyword,"rg8uint"),rg8sint:new We("rg8sint",H.keyword,"rg8sint"),r32uint:new We("r32uint",H.keyword,"r32uint"),r32sint:new We("r32sint",H.keyword,"r32sint"),r32float:new We("r32float",H.keyword,"r32float"),rg16uint:new We("rg16uint",H.keyword,"rg16uint"),rg16sint:new We("rg16sint",H.keyword,"rg16sint"),rg16float:new We("rg16float",H.keyword,"rg16float"),rgba8unorm:new We("rgba8unorm",H.keyword,"rgba8unorm"),rgba8unorm_srgb:new We("rgba8unorm_srgb",H.keyword,"rgba8unorm_srgb"),rgba8snorm:new We("rgba8snorm",H.keyword,"rgba8snorm"),rgba8uint:new We("rgba8uint",H.keyword,"rgba8uint"),rgba8sint:new We("rgba8sint",H.keyword,"rgba8sint"),bgra8unorm:new We("bgra8unorm",H.keyword,"bgra8unorm"),bgra8unorm_srgb:new We("bgra8unorm_srgb",H.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new We("rgb10a2unorm",H.keyword,"rgb10a2unorm"),rg11b10float:new We("rg11b10float",H.keyword,"rg11b10float"),rg32uint:new We("rg32uint",H.keyword,"rg32uint"),rg32sint:new We("rg32sint",H.keyword,"rg32sint"),rg32float:new We("rg32float",H.keyword,"rg32float"),rgba16uint:new We("rgba16uint",H.keyword,"rgba16uint"),rgba16sint:new We("rgba16sint",H.keyword,"rgba16sint"),rgba16float:new We("rgba16float",H.keyword,"rgba16float"),rgba32uint:new We("rgba32uint",H.keyword,"rgba32uint"),rgba32sint:new We("rgba32sint",H.keyword,"rgba32sint"),rgba32float:new We("rgba32float",H.keyword,"rgba32float"),static_assert:new We("static_assert",H.keyword,"static_assert")},je.tokens={decimal_float_literal:new We("decimal_float_literal",H.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new We("hex_float_literal",H.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new We("int_literal",H.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new We("uint_literal",H.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new We("name",H.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new We("ident",H.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new We("and",H.token,"&"),and_and:new We("and_and",H.token,"&&"),arrow:new We("arrow ",H.token,"->"),attr:new We("attr",H.token,"@"),forward_slash:new We("forward_slash",H.token,"/"),bang:new We("bang",H.token,"!"),bracket_left:new We("bracket_left",H.token,"["),bracket_right:new We("bracket_right",H.token,"]"),brace_left:new We("brace_left",H.token,"{"),brace_right:new We("brace_right",H.token,"}"),colon:new We("colon",H.token,":"),comma:new We("comma",H.token,","),equal:new We("equal",H.token,"="),equal_equal:new We("equal_equal",H.token,"=="),not_equal:new We("not_equal",H.token,"!="),greater_than:new We("greater_than",H.token,">"),greater_than_equal:new We("greater_than_equal",H.token,">="),shift_right:new We("shift_right",H.token,">>"),less_than:new We("less_than",H.token,"<"),less_than_equal:new We("less_than_equal",H.token,"<="),shift_left:new We("shift_left",H.token,"<<"),modulo:new We("modulo",H.token,"%"),minus:new We("minus",H.token,"-"),minus_minus:new We("minus_minus",H.token,"--"),period:new We("period",H.token,"."),plus:new We("plus",H.token,"+"),plus_plus:new We("plus_plus",H.token,"++"),or:new We("or",H.token,"|"),or_or:new We("or_or",H.token,"||"),paren_left:new We("paren_left",H.token,"("),paren_right:new We("paren_right",H.token,")"),semicolon:new We("semicolon",H.token,";"),star:new We("star",H.token,"*"),tilde:new We("tilde",H.token,"~"),underscore:new We("underscore",H.token,"_"),xor:new We("xor",H.token,"^"),plus_equal:new We("plus_equal",H.token,"+="),minus_equal:new We("minus_equal",H.token,"-="),times_equal:new We("times_equal",H.token,"*="),division_equal:new We("division_equal",H.token,"/="),modulo_equal:new We("modulo_equal",H.token,"%="),and_equal:new We("and_equal",H.token,"&="),or_equal:new We("or_equal",H.token,"|="),xor_equal:new We("xor_equal",H.token,"^="),shift_right_equal:new We("shift_right_equal",H.token,">>="),shift_left_equal:new We("shift_left_equal",H.token,"<<=")},je.simpleTokens={"@":z.tokens.attr,"{":z.tokens.brace_left,"}":z.tokens.brace_right,":":z.tokens.colon,",":z.tokens.comma,"(":z.tokens.paren_left,")":z.tokens.paren_right,";":z.tokens.semicolon},je.literalTokens={"&":z.tokens.and,"&&":z.tokens.and_and,"->":z.tokens.arrow,"/":z.tokens.forward_slash,"!":z.tokens.bang,"[":z.tokens.bracket_left,"]":z.tokens.bracket_right,"=":z.tokens.equal,"==":z.tokens.equal_equal,"!=":z.tokens.not_equal,">":z.tokens.greater_than,">=":z.tokens.greater_than_equal,">>":z.tokens.shift_right,"<":z.tokens.less_than,"<=":z.tokens.less_than_equal,"<<":z.tokens.shift_left,"%":z.tokens.modulo,"-":z.tokens.minus,"--":z.tokens.minus_minus,".":z.tokens.period,"+":z.tokens.plus,"++":z.tokens.plus_plus,"|":z.tokens.or,"||":z.tokens.or_or,"*":z.tokens.star,"~":z.tokens.tilde,_:z.tokens.underscore,"^":z.tokens.xor,"+=":z.tokens.plus_equal,"-=":z.tokens.minus_equal,"*=":z.tokens.times_equal,"/=":z.tokens.division_equal,"%=":z.tokens.modulo_equal,"&=":z.tokens.and_equal,"|=":z.tokens.or_equal,"^=":z.tokens.xor_equal,">>=":z.tokens.shift_right_equal,"<<=":z.tokens.shift_left_equal},je.regexTokens={decimal_float_literal:z.tokens.decimal_float_literal,hex_float_literal:z.tokens.hex_float_literal,int_literal:z.tokens.int_literal,uint_literal:z.tokens.uint_literal,ident:z.tokens.ident},je.storage_class=[z.keywords.function,z.keywords.private,z.keywords.workgroup,z.keywords.uniform,z.keywords.storage],je.access_mode=[z.keywords.read,z.keywords.write,z.keywords.read_write],je.sampler_type=[z.keywords.sampler,z.keywords.sampler_comparison],je.sampled_texture_type=[z.keywords.texture_1d,z.keywords.texture_2d,z.keywords.texture_2d_array,z.keywords.texture_3d,z.keywords.texture_cube,z.keywords.texture_cube_array],je.multisampled_texture_type=[z.keywords.texture_multisampled_2d],je.storage_texture_type=[z.keywords.texture_storage_1d,z.keywords.texture_storage_2d,z.keywords.texture_storage_2d_array,z.keywords.texture_storage_3d],je.depth_texture_type=[z.keywords.texture_depth_2d,z.keywords.texture_depth_2d_array,z.keywords.texture_depth_cube,z.keywords.texture_depth_cube_array,z.keywords.texture_depth_multisampled_2d],je.texture_external_type=[z.keywords.texture_external],je.any_texture_type=[...z.sampled_texture_type,...z.multisampled_texture_type,...z.storage_texture_type,...z.depth_texture_type,...z.texture_external_type],je.texel_format=[z.keywords.r8unorm,z.keywords.r8snorm,z.keywords.r8uint,z.keywords.r8sint,z.keywords.r16uint,z.keywords.r16sint,z.keywords.r16float,z.keywords.rg8unorm,z.keywords.rg8snorm,z.keywords.rg8uint,z.keywords.rg8sint,z.keywords.r32uint,z.keywords.r32sint,z.keywords.r32float,z.keywords.rg16uint,z.keywords.rg16sint,z.keywords.rg16float,z.keywords.rgba8unorm,z.keywords.rgba8unorm_srgb,z.keywords.rgba8snorm,z.keywords.rgba8uint,z.keywords.rgba8sint,z.keywords.bgra8unorm,z.keywords.bgra8unorm_srgb,z.keywords.rgb10a2unorm,z.keywords.rg11b10float,z.keywords.rg32uint,z.keywords.rg32sint,z.keywords.rg32float,z.keywords.rgba16uint,z.keywords.rgba16sint,z.keywords.rgba16float,z.keywords.rgba32uint,z.keywords.rgba32sint,z.keywords.rgba32float],je.const_literal=[z.tokens.int_literal,z.tokens.uint_literal,z.tokens.decimal_float_literal,z.tokens.hex_float_literal,z.keywords.true,z.keywords.false],je.literal_or_ident=[z.tokens.ident,z.tokens.int_literal,z.tokens.uint_literal,z.tokens.decimal_float_literal,z.tokens.hex_float_literal,z.tokens.name],je.element_count_expression=[z.tokens.int_literal,z.tokens.uint_literal,z.tokens.ident],je.template_types=[z.keywords.vec2,z.keywords.vec3,z.keywords.vec4,z.keywords.mat2x2,z.keywords.mat2x3,z.keywords.mat2x4,z.keywords.mat3x2,z.keywords.mat3x3,z.keywords.mat3x4,z.keywords.mat4x2,z.keywords.mat4x3,z.keywords.mat4x4,z.keywords.atomic,z.keywords.bitcast,...z.any_texture_type],je.attribute_name=[z.tokens.ident,z.keywords.block,z.keywords.diagnostic],je.assignment_operators=[z.tokens.equal,z.tokens.plus_equal,z.tokens.minus_equal,z.tokens.times_equal,z.tokens.division_equal,z.tokens.modulo_equal,z.tokens.and_equal,z.tokens.or_equal,z.tokens.xor_equal,z.tokens.shift_right_equal,z.tokens.shift_left_equal],je.increment_operators=[z.tokens.plus_plus,z.tokens.minus_minus];class ze{constructor(e,t,n,r,s){this.type=e,this.lexeme=t,this.line=n,this.start=r,this.end=s}toString(){return this.lexeme}isTemplateType(){return-1!=je.template_types.indexOf(this.type)}isArrayType(){return this.type==je.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class He{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=null!=e?e:""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new ze(je.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if("\n"==e)return this._line++,!0;if(this._isWhitespace(e))return!0;if("/"==e){if("/"==this._peekAhead()){for(;"\n"!=e;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if("*"==this._peekAhead()){this._advance();let t=1;for(;t>0;){if(this._isAtEnd())return!0;if(e=this._advance(),"\n"==e)this._line++;else if("*"==e){if("/"==this._peekAhead()&&(this._advance(),t--,0==t))return!0}else"/"==e&&"*"==this._peekAhead()&&(this._advance(),t++)}return!0}}const t=je.simpleTokens[e];if(t)return this._addToken(t),!0;let n=je.none;const r=this._isAlpha(e),s="_"===e;if(this._isAlphaNumeric(e)){let t=this._peekAhead();for(;this._isAlphaNumeric(t);)e+=this._advance(),t=this._peekAhead()}if(r){const t=je.keywords[e];if(t)return this._addToken(t),!0}if(r||s)return this._addToken(je.tokens.ident),!0;for(;;){let t=this._findType(e);const r=this._peekAhead();if("-"==e&&this._tokens.length>0){if("="==r)return this._current++,e+=r,this._addToken(je.tokens.minus_equal),!0;if("-"==r)return this._current++,e+=r,this._addToken(je.tokens.minus_minus),!0;const n=this._tokens.length-1;if((-1!=je.literal_or_ident.indexOf(this._tokens[n].type)||this._tokens[n].type==je.tokens.paren_right)&&">"!=r)return this._addToken(t),!0}if(">"==e&&(">"==r||"="==r)){let e=!1,n=this._tokens.length-1;for(let t=0;t<5&&n>=0&&-1===je.assignment_operators.indexOf(this._tokens[n].type);++t,--n)if(this._tokens[n].type===je.tokens.less_than){n>0&&this._tokens[n-1].isArrayOrTemplateType()&&(e=!0);break}if(e)return this._addToken(t),!0}if(t===je.none){let r=e,s=0;const i=2;for(let e=0;e<i;++e)if(r+=this._peekAhead(e),t=this._findType(r),t!==je.none){s=e;break}if(t===je.none)return n!==je.none&&(this._current--,this._addToken(n),!0);e=r,this._current+=s+1}if(n=t,this._isAtEnd())break;e+=this._advance()}return n!==je.none&&(this._addToken(n),!0)}_findType(e){for(const t in je.regexTokens){const n=je.regexTokens[t];if(this._match(e,n.rule))return n}return je.literalTokens[e]||je.none}_match(e,t){const n=t.exec(e);return n&&0==n.index&&n[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&"_"!==e&&"."!==e&&"("!==e&&")"!==e&&"["!==e&&"]"!==e&&"{"!==e&&"}"!==e&&","!==e&&";"!==e&&":"!==e&&"="!==e&&"!"!==e&&"<"!==e&&">"!==e&&"+"!==e&&"-"!==e&&"*"!==e&&"/"!==e&&"%"!==e&&"&"!==e&&"|"!==e&&"^"!==e&&"~"!==e&&"@"!==e&&"#"!==e&&"?"!==e&&"'"!==e&&"`"!==e&&'"'!==e&&"\\"!==e&&"\n"!==e&&"\r"!==e&&"\t"!==e&&"\0"!==e}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||"_"===e}_isWhitespace(e){return" "==e||"\t"==e||"\r"==e}_advance(e=0){let t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new ze(e,t,this._line,this._start,this._current))}}function Xe(e){return Array.isArray(e)||(null==e?void 0:e.buffer)instanceof ArrayBuffer}const qe=new Float32Array(1),Ye=new Uint32Array(qe.buffer),Ke=new Uint32Array(qe.buffer),Ze=new Int32Array(1),Qe=new Float32Array(Ze.buffer),Je=new Uint32Array(Ze.buffer),et=new Uint32Array(1),tt=new Float32Array(et.buffer),nt=new Int32Array(et.buffer);function rt(e,t,n){if(t===n)return e;if("f32"===t){if("i32"===n||"x32"===n)return qe[0]=e,Ye[0];if("u32"===n)return qe[0]=e,Ke[0]}else if("i32"===t||"x32"===t){if("f32"===n)return Ze[0]=e,Qe[0];if("u32"===n)return Ze[0]=e,Je[0]}else if("u32"===t){if("f32"===n)return et[0]=e,tt[0];if("i32"===n||"x32"===n)return et[0]=e,nt[0]}return console.error(`Unsupported cast from ${t} to ${n}`),e}class st{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class it{constructor(e,t){this.align=e,this.size=t}}class ot{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new m,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return"texture_storage_1d"==e.name||"texture_storage_2d"==e.name||"texture_storage_2d_array"==e.name||"texture_storage_3d"==e.name}updateAST(e){for(const t of e)t instanceof O&&this._functions.set(t.name,new st(t));for(const t of e)if(t instanceof le){const e=this.getTypeInfo(t,null);e instanceof i&&this.structs.push(e)}for(const t of e)if(t instanceof re)this.aliases.push(this._getAliasInfo(t));else{if(t instanceof V){const e=t,n=this._getAttributeNum(e.attributes,"id",0),r=null!=e.type?this.getTypeInfo(e.type,e.attributes):null;this.overrides.push(new p(e.name,r,e.attributes,n));continue}if(this._isUniformVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),s=this.getTypeInfo(e.type,e.attributes),i=new u(e.name,s,n,r,e.attributes,l.Uniform,e.access);i.access||(i.access="read"),this.uniforms.push(i);continue}if(this._isStorageVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),s=this.getTypeInfo(e.type,e.attributes),i=this._isStorageTexture(s),o=new u(e.name,s,n,r,e.attributes,i?l.StorageTexture:l.Storage,e.access);o.access||(o.access="read"),this.storage.push(o);continue}if(this._isTextureVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),s=this.getTypeInfo(e.type,e.attributes),i=this._isStorageTexture(s),o=new u(e.name,s,n,r,e.attributes,i?l.StorageTexture:l.Texture,e.access);o.access||(o.access="read"),i?this.storage.push(o):this.textures.push(o);continue}if(this._isSamplerVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),s=this.getTypeInfo(e.type,e.attributes),i=new u(e.name,s,n,r,e.attributes,l.Sampler,e.access);this.samplers.push(i);continue}}for(const t of e)if(t instanceof O){const e=this._getAttribute(t,"vertex"),n=this._getAttribute(t,"fragment"),r=this._getAttribute(t,"compute"),s=e||n||r,i=new _(t.name,null==s?void 0:s.name,t.attributes);i.attributes=t.attributes,i.startLine=t.startLine,i.endLine=t.endLine,this.functions.push(i),this._functions.get(t.name).info=i,s&&(this._functions.get(t.name).inUse=!0,i.inUse=!0,i.resources=this._findResources(t,!!s),i.inputs=this._getInputs(t.args),i.outputs=this._getOutputs(t.returnType),this.entry[s.name].push(i)),i.arguments=t.args.map(e=>new g(e.name,this.getTypeInfo(e.type,e.attributes),e.attributes)),i.returnType=t.returnType?this.getTypeInfo(t.returnType,t.attributes):null;continue}for(const t of this._functions.values())t.info&&(t.info.inUse=t.inUse,this._addCalls(t.node,t.info.calls));for(const t of this._functions.values())t.node.search(e=>{var n,r,s;if(e instanceof ke){if(e.value)if(Xe(e.value))for(const i of e.value)for(const e of this.overrides)i===e.name&&(null===(n=t.info)||void 0===n||n.overrides.push(e));else for(const i of this.overrides)e.value===i.name&&(null===(r=t.info)||void 0===r||r.overrides.push(i))}else if(e instanceof ve)for(const i of this.overrides)e.name===i.name&&(null===(s=t.info)||void 0===s||s.overrides.push(i))});for(const t of this.uniforms)this._markStructsInUse(t.type);for(const t of this.storage)this._markStructsInUse(t.type)}getFunctionInfo(e){for(const t of this.functions)if(t.name==e)return t;return null}getStructInfo(e){for(const t of this.structs)if(t.name==e)return t;return null}getOverrideInfo(e){for(const t of this.overrides)if(t.name==e)return t;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var n;for(const r of e.calls){const e=null===(n=this._functions.get(r.name))||void 0===n?void 0:n.info;e&&t.add(e)}}findResource(e,t,n){if(n){for(const r of this.entry.compute)if(r.name===n)for(const n of r.resources)if(n.group==e&&n.binding==t)return n;for(const r of this.entry.vertex)if(r.name===n)for(const n of r.resources)if(n.group==e&&n.binding==t)return n;for(const r of this.entry.fragment)if(r.name===n)for(const n of r.resources)if(n.group==e&&n.binding==t)return n}for(const r of this.uniforms)if(r.group==e&&r.binding==t)return r;for(const r of this.storage)if(r.group==e&&r.binding==t)return r;for(const r of this.textures)if(r.group==e&&r.binding==t)return r;for(const r of this.samplers)if(r.group==e&&r.binding==t)return r;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this.getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const n=[],r=this,s=[];return e.search(i=>{if(i instanceof P)s.push({});else if(i instanceof L)s.pop();else if(i instanceof U){const e=i;t&&null!==e.type&&this._markStructsFromAST(e.type),s.length>0&&(s[s.length-1][e.name]=e)}else if(i instanceof _e){const e=i;t&&null!==e.type&&this._markStructsFromAST(e.type)}else if(i instanceof G){const e=i;t&&null!==e.type&&this._markStructsFromAST(e.type),s.length>0&&(s[s.length-1][e.name]=e)}else if(i instanceof ve){const e=i;if(s.length>0&&s[s.length-1][e.name])return;const t=r._findResource(e.name);t&&n.push(t)}else if(i instanceof me){const s=i,o=r._functions.get(s.name);o&&(t&&(o.inUse=!0),e.calls.add(o.node),null===o.resources&&(o.resources=r._findResources(o.node,t)),n.push(...o.resources))}else if(i instanceof Y){const s=i,o=r._functions.get(s.name);o&&(t&&(o.inUse=!0),e.calls.add(o.node),null===o.resources&&(o.resources=r._findResources(o.node,t)),n.push(...o.resources))}}),[...new Map(n.map(e=>[e.name,e])).values()]}getBindGroups(){const e=[];function t(t,n){t>=e.length&&(e.length=t+1),void 0===e[t]&&(e[t]=[]),n>=e[t].length&&(e[t].length=n+1)}for(const n of this.uniforms)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.storage)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.textures)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.samplers)t(n.group,n.binding),e[n.group][n.binding]=n;return e}_getOutputs(e,t=void 0){if(void 0===t&&(t=[]),e instanceof le)this._getStructOutputs(e,t);else{const n=this._getOutputInfo(e);null!==n&&t.push(n)}return t}_getStructOutputs(e,t){for(const n of e.members)if(n.type instanceof le)this._getStructOutputs(n.type,t);else{const e=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(null!==e){const r=this.getTypeInfo(n.type,n.type.attributes),s=this._parseInt(e.value),i=new f(n.name,r,e.name,s);t.push(i)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const n=this.getTypeInfo(e,e.attributes),r=this._parseInt(t.value);return new f("",n,t.name,r)}return null}_getInputs(e,t=void 0){void 0===t&&(t=[]);for(const n of e)if(n.type instanceof le)this._getStructInputs(n.type,t);else{const e=this._getInputInfo(n);null!==e&&t.push(e)}return t}_getStructInputs(e,t){for(const n of e.members)if(n.type instanceof le)this._getStructInputs(n.type,t);else{const e=this._getInputInfo(n);null!==e&&t.push(e)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const n=this._getAttribute(e,"interpolation"),r=this.getTypeInfo(e.type,e.attributes),s=this._parseInt(t.value),i=new d(e.name,r,t.name,s);return null!==n&&(i.interpolation=this._parseString(n.value)),i}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new h(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const t of this.structs)if(t.name==e)return t;for(const t of this.aliases)if(t.name==e)return t.type;return null}getTypeInfo(e,t=null){if(this._types.has(e))return this._types.get(e);if(e instanceof he){const n=e.type?this.getTypeInfo(e.type,e.attributes):null,r=new a(e.name,n,t);return this._types.set(e,r),this._updateTypeInfo(r),r}if(e instanceof de){const n=e,r=n.format?this.getTypeInfo(n.format,n.attributes):null,s=new o(n.name,t);return s.format=r,s.count=n.count,this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof le){const n=e,r=new i(n.name,t);r.startLine=n.startLine,r.endLine=n.endLine;for(const e of n.members){const t=this.getTypeInfo(e.type,e.attributes);r.members.push(new s(e.name,t,e.attributes))}return this._types.set(e,r),this._updateTypeInfo(r),r}if(e instanceof fe){const n=e,s=n.format instanceof ae,i=n.format?s?this.getTypeInfo(n.format,null):new r(n.format,null):null,o=new c(n.name,i,t,n.access);return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof ue){const n=e,r=n.format?this.getTypeInfo(n.format,null):null,s=new c(n.name,r,t,n.access);return this._types.set(e,s),this._updateTypeInfo(s),s}const n=new r(e.name,t);return this._types.set(e,n),this._updateTypeInfo(n),n}_updateTypeInfo(e){var t,n,r;const s=this._getTypeSize(e);if(e.size=null!==(t=null==s?void 0:s.size)&&void 0!==t?t:0,e instanceof o&&e.format){const t=this._getTypeSize(e.format);e.stride=Math.max(null!==(n=null==t?void 0:t.size)&&void 0!==n?n:0,null!==(r=null==t?void 0:t.align)&&void 0!==r?r:0),this._updateTypeInfo(e.format)}e instanceof a&&this._updateTypeInfo(e.format),e instanceof i&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let n=0,r=0,s=0,i=0;for(let o=0,a=e.members.length;o<a;++o){const a=e.members[o],c=this._getTypeSize(a);if(!c)continue;null!==(t=this._getAlias(a.type.name))&&void 0!==t||a.type;const l=c.align,u=c.size;n=this._roundUp(l,n+r),r=u,s=n,i=Math.max(i,l),a.offset=n,a.size=u,this._updateTypeInfo(a.type)}e.size=this._roundUp(i,s+r),e.align=i}_getTypeSize(e){var t,n;if(null==e)return null;const a=this._getAttributeNum(e.attributes,"size",0),c=this._getAttributeNum(e.attributes,"align",0);if(e instanceof s&&(e=e.type),e instanceof r){const t=this._getAlias(e.name);null!==t&&(e=t)}{const n=ot._typeInfo[e.name];if(void 0!==n){const r="f16"===(null===(t=e.format)||void 0===t?void 0:t.name)?2:1;return new it(Math.max(c,n.align/r),Math.max(a,n.size/r))}}{const t=ot._typeInfo[e.name.substring(0,e.name.length-1)];if(t){const n="h"===e.name[e.name.length-1]?2:1;return new it(Math.max(c,t.align/n),Math.max(a,t.size/n))}}if(e instanceof o){let t=e,r=8,s=8;const i=this._getTypeSize(t.format);return null!==i&&(s=i.size,r=i.align),s=t.count*this._getAttributeNum(null!==(n=null==e?void 0:e.attributes)&&void 0!==n?n:null,"stride",this._roundUp(r,s)),a&&(s=a),new it(Math.max(c,r),Math.max(a,s))}if(e instanceof i){let t=0,n=0,r=0,s=0,i=0;for(const o of e.members){const e=this._getTypeSize(o.type);null!==e&&(t=Math.max(e.align,t),r=this._roundUp(e.align,r+s),s=e.size,i=r)}return n=this._roundUp(t,i+s),new it(Math.max(c,t),Math.max(a,n))}return null}_isUniformVar(e){return e instanceof U&&"uniform"==e.storage}_isStorageVar(e){return e instanceof U&&"storage"==e.storage}_isTextureVar(e){return e instanceof U&&null!==e.type&&-1!=ot._textureTypes.indexOf(e.type.name)}_isSamplerVar(e){return e instanceof U&&null!==e.type&&-1!=ot._samplerTypes.indexOf(e.type.name)}_getAttribute(e,t){const n=e;if(!n||!n.attributes)return null;const r=n.attributes;for(let s of r)if(s.name==t)return s;return null}_getAttributeNum(e,t,n){if(null===e)return n;for(let r of e)if(r.name==t){let e=null!==r&&null!==r.value?r.value:n;return e instanceof Array&&(e=e[0]),"number"==typeof e?e:"string"==typeof e?parseInt(e):n}return n}_roundUp(e,t){return Math.ceil(t/e)*e}}ot._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},ot._textureTypes=je.any_texture_type.map(e=>e.name),ot._samplerTypes=je.sampler_type.map(e=>e.name);let at=0;class ct{constructor(e,t,n){this.id=at++,this.name=e,this.value=t,this.node=n}clone(){return new ct(this.name,this.value,this.node)}}class lt{constructor(e){this.id=at++,this.name=e.name,this.node=e}clone(){return new lt(this.node)}}class ut{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=at++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var t;return this.variables.has(e)?null!==(t=this.variables.get(e))&&void 0!==t?t:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var t;return this.functions.has(e)?null!==(t=this.functions.get(e))&&void 0!==t?t:null:this.parent?this.parent.getFunction(e):null}createVariable(e,t,n){this.variables.set(e,new ct(e,t,null!=n?n:null))}setVariable(e,t,n){const r=this.getVariable(e);null!==r?r.value=t:this.createVariable(e,t,n)}getVariableValue(e){var t;const n=this.getVariable(e);return null!==(t=null==n?void 0:n.value)&&void 0!==t?t:null}clone(){return new ut(this)}}class ht{evalExpression(e,t){return null}getTypeInfo(e){return null}getVariableName(e,t){return""}}class dt{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,t){const n=this.exec.evalExpression(e.args[0],t);let r=!0;if(n instanceof Ue)return n.data.forEach(e=>{e||(r=!1)}),new De(r?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue){const e=n.data.some(e=>e);return new De(e?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,t){const n=this.exec.evalExpression(e.args[2],t);if(!(n instanceof De))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return n.value?this.exec.evalExpression(e.args[1],t):this.exec.evalExpression(e.args[0],t)}ArrayLength(e,t){let n=e.args[0];n instanceof Te&&(n=n.right);const r=this.exec.evalExpression(n,t);if(r instanceof Ge&&0===r.typeInfo.size){const e=r.typeInfo,t=r.buffer.byteLength/e.stride;return new De(t,this.getTypeInfo("u32"))}return new De(r.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.abs(e)),n.typeInfo);const r=n;return new De(Math.abs(r.value),r.typeInfo)}Acos(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.acos(e)),n.typeInfo);const r=n;return new De(Math.acos(r.value),n.typeInfo)}Acosh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.acosh(e)),n.typeInfo);const r=n;return new De(Math.acosh(r.value),n.typeInfo)}Asin(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.asin(e)),n.typeInfo);const r=n;return new De(Math.asin(r.value),n.typeInfo)}Asinh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.asinh(e)),n.typeInfo);const r=n;return new De(Math.asinh(r.value),n.typeInfo)}Atan(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.atan(e)),n.typeInfo);const r=n;return new De(Math.atan(r.value),n.typeInfo)}Atanh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.atanh(e)),n.typeInfo);const r=n;return new De(Math.atanh(r.value),n.typeInfo)}Atan2(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof Ue&&r instanceof Ue)return new Ue(n.data.map((e,t)=>Math.atan2(e,r.data[t])),n.typeInfo);const s=n,i=r;return new De(Math.atan2(s.value,i.value),n.typeInfo)}Ceil(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.ceil(e)),n.typeInfo);const r=n;return new De(Math.ceil(r.value),n.typeInfo)}_clamp(e,t,n){return Math.min(Math.max(e,t),n)}Clamp(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(n instanceof Ue&&r instanceof Ue&&s instanceof Ue)return new Ue(n.data.map((e,t)=>this._clamp(e,r.data[t],s.data[t])),n.typeInfo);const i=n,o=r,a=s;return new De(this._clamp(i.value,o.value,a.value),n.typeInfo)}Cos(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.cos(e)),n.typeInfo);const r=n;return new De(Math.cos(r.value),n.typeInfo)}Cosh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.cosh(e)),n.typeInfo);const r=n;return new De(Math.cos(r.value),n.typeInfo)}CountLeadingZeros(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.clz32(e)),n.typeInfo);const r=n;return new De(Math.clz32(r.value),n.typeInfo)}_countOneBits(e){let t=0;for(;0!==e;)1&e&&t++,e>>=1;return t}CountOneBits(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>this._countOneBits(e)),n.typeInfo);const r=n;return new De(this._countOneBits(r.value),n.typeInfo)}_countTrailingZeros(e){if(0===e)return 32;let t=0;for(;!(1&e);)e>>=1,t++;return t}CountTrailingZeros(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>this._countTrailingZeros(e)),n.typeInfo);const r=n;return new De(this._countTrailingZeros(r.value),n.typeInfo)}Cross(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof Ue&&r instanceof Ue){if(3!==n.data.length||3!==r.data.length)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const t=n.data,s=r.data;return new Ue([t[1]*s[2]-s[1]*t[2],t[2]*s[0]-s[2]*t[0],t[0]*s[1]-s[0]*t[1]],n.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,t){const n=this.exec.evalExpression(e.args[0],t),r=180/Math.PI;return n instanceof Ue?new Ue(n.data.map(e=>e*r),n.typeInfo):new De(n.value*r,this.getTypeInfo("f32"))}Determinant(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ve){const e=n.data,t=n.typeInfo.getTypeName(),r=t.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if("mat2x2"===t||"mat2x2f"===t||"mat2x2h"===t)return new De(e[0]*e[3]-e[1]*e[2],r);if("mat2x3"===t||"mat2x3f"===t||"mat2x3h"===t)return new De(e[0]*(e[4]*e[8]-e[5]*e[7])-e[1]*(e[3]*e[8]-e[5]*e[6])+e[2]*(e[3]*e[7]-e[4]*e[6]),r);if("mat2x4"===t||"mat2x4f"===t||"mat2x4h"===t)console.error(`TODO: Determinant for ${t}`);else if("mat3x2"===t||"mat3x2f"===t||"mat3x2h"===t)console.error(`TODO: Determinant for ${t}`);else{if("mat3x3"===t||"mat3x3f"===t||"mat3x3h"===t)return new De(e[0]*(e[4]*e[8]-e[5]*e[7])-e[1]*(e[3]*e[8]-e[5]*e[6])+e[2]*(e[3]*e[7]-e[4]*e[6]),r);"mat3x4"===t||"mat3x4f"===t||"mat3x4h"===t||"mat4x2"===t||"mat4x2f"===t||"mat4x2h"===t||"mat4x3"===t||"mat4x3f"===t||"mat4x3h"===t?console.error(`TODO: Determinant for ${t}`):"mat4x4"!==t&&"mat4x4f"!==t&&"mat4x4h"!==t||console.error(`TODO: Determinant for ${t}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof Ue&&r instanceof Ue){let e=0;for(let t=0;t<n.data.length;++t)e+=(n.data[t]-r.data[t])*(n.data[t]-r.data[t]);return new De(Math.sqrt(e),this.getTypeInfo("f32"))}const s=n,i=r;return new De(Math.abs(s.value-i.value),n.typeInfo)}_dot(e,t){let n=0;for(let r=0;r<e.length;++r)n+=t[r]*e[r];return n}Dot(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);return n instanceof Ue&&r instanceof Ue?new De(this._dot(n.data,r.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,t){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,t){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.exp(e)),n.typeInfo);const r=n;return new De(Math.exp(r.value),n.typeInfo)}Exp2(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.pow(2,e)),n.typeInfo);const r=n;return new De(Math.pow(2,r.value),n.typeInfo)}ExtractBits(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if("u32"!==r.typeInfo.name&&"x32"!==r.typeInfo.name)return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if("u32"!==s.typeInfo.name&&"x32"!==s.typeInfo.name)return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const i=r.value,o=s.value;if(n instanceof Ue)return new Ue(n.data.map(e=>e>>i&(1<<o)-1),n.typeInfo);if("i32"!==n.typeInfo.name&&"x32"!==n.typeInfo.name)return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const a=n.value;return new De(a>>i&(1<<o)-1,this.getTypeInfo("i32"))}FaceForward(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(n instanceof Ue&&r instanceof Ue&&s instanceof Ue){const e=this._dot(r.data,s.data);return new Ue(e<0?Array.from(n.data):n.data.map(e=>-e),n.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return 0===e?-1:31-Math.clz32(e)}FirstLeadingBit(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>this._firstLeadingBit(e)),n.typeInfo);const r=n;return new De(this._firstLeadingBit(r.value),n.typeInfo)}_firstTrailingBit(e){return 0===e?-1:Math.log2(e&-e)}FirstTrailingBit(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>this._firstTrailingBit(e)),n.typeInfo);const r=n;return new De(this._firstTrailingBit(r.value),n.typeInfo)}Floor(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.floor(e)),n.typeInfo);const r=n;return new De(Math.floor(r.value),n.typeInfo)}Fma(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(n instanceof Ue&&r instanceof Ue&&s instanceof Ue)return n.data.length!==r.data.length||n.data.length!==s.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new Ue(n.data.map((e,t)=>e*r.data[t]+s.data[t]),n.typeInfo);const i=n,o=r,a=s;return new De(i.value*o.value+a.value,i.typeInfo)}Fract(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>e-Math.floor(e)),n.typeInfo);const r=n;return new De(r.value-Math.floor(r.value),n.typeInfo)}Frexp(e,t){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t),i=this.exec.evalExpression(e.args[3],t);if("u32"!==s.typeInfo.name&&"x32"!==s.typeInfo.name)return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const o=s.value,a=(1<<i.value)-1<<o,c=~a;if(n instanceof Ue&&r instanceof Ue)return new Ue(n.data.map((e,t)=>e&c|r.data[t]<<o&a),n.typeInfo);const l=n.value,u=r.value;return new De(l&c|u<<o&a,n.typeInfo)}InverseSqrt(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>1/Math.sqrt(e)),n.typeInfo);const r=n;return new De(1/Math.sqrt(r.value),n.typeInfo)}Ldexp(e,t){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue){let e=0;return n.data.forEach(t=>{e+=t*t}),new De(Math.sqrt(e),this.getTypeInfo("f32"))}const r=n;return new De(Math.abs(r.value),n.typeInfo)}Log(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.log(e)),n.typeInfo);const r=n;return new De(Math.log(r.value),n.typeInfo)}Log2(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.log2(e)),n.typeInfo);const r=n;return new De(Math.log2(r.value),n.typeInfo)}Max(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof Ue&&r instanceof Ue)return new Ue(n.data.map((e,t)=>Math.max(e,r.data[t])),n.typeInfo);const s=n,i=r;return new De(Math.max(s.value,i.value),n.typeInfo)}Min(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof Ue&&r instanceof Ue)return new Ue(n.data.map((e,t)=>Math.min(e,r.data[t])),n.typeInfo);const s=n,i=r;return new De(Math.min(s.value,i.value),n.typeInfo)}Mix(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(n instanceof Ue&&r instanceof Ue&&s instanceof Ue)return new Ue(n.data.map((e,t)=>n.data[t]*(1-s.data[t])+r.data[t]*s.data[t]),n.typeInfo);const i=r,o=s;return new De(n.value*(1-o.value)+i.value*o.value,n.typeInfo)}Modf(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof Ue&&r instanceof Ue)return new Ue(n.data.map((e,t)=>e%r.data[t]),n.typeInfo);const s=r;return new De(n.value%s.value,n.typeInfo)}Normalize(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue){const r=this.Length(e,t).value;return new Ue(n.data.map(e=>e/r),n.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof Ue&&r instanceof Ue)return new Ue(n.data.map((e,t)=>Math.pow(e,r.data[t])),n.typeInfo);const s=n,i=r;return new De(Math.pow(s.value,i.value),n.typeInfo)}QuantizeToF16(e,t){const n=this.exec.evalExpression(e.args[0],t);return n instanceof Ue?new Ue(n.data.map(e=>e),n.typeInfo):new De(n.value,n.typeInfo)}Radians(e,t){const n=this.exec.evalExpression(e.args[0],t);return n instanceof Ue?new Ue(n.data.map(e=>e*Math.PI/180),n.typeInfo):new De(n.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,t){let n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(n instanceof Ue&&r instanceof Ue){const e=this._dot(n.data,r.data);return new Ue(n.data.map((t,n)=>t-2*e*r.data[n]),n.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,t){let n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(n instanceof Ue&&r instanceof Ue&&s instanceof De){const e=this._dot(r.data,n.data);return new Ue(n.data.map((t,n)=>{const i=1-s.value*s.value*(1-e*e);if(i<0)return 0;const o=Math.sqrt(i);return s.value*t-(s.value*e+o)*r.data[n]}),n.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,t){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.round(e)),n.typeInfo);const r=n;return new De(Math.round(r.value),n.typeInfo)}Saturate(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.min(Math.max(e,0),1)),n.typeInfo);const r=n;return new De(Math.min(Math.max(r.value,0),1),n.typeInfo)}Sign(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.sign(e)),n.typeInfo);const r=n;return new De(Math.sign(r.value),n.typeInfo)}Sin(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.sin(e)),n.typeInfo);const r=n;return new De(Math.sin(r.value),n.typeInfo)}Sinh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.sinh(e)),n.typeInfo);const r=n;return new De(Math.sinh(r.value),n.typeInfo)}_smoothstep(e,t,n){const r=Math.min(Math.max((n-e)/(t-e),0),1);return r*r*(3-2*r)}SmoothStep(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(s instanceof Ue&&n instanceof Ue&&r instanceof Ue)return new Ue(s.data.map((e,t)=>this._smoothstep(n.data[t],r.data[t],e)),s.typeInfo);const i=n,o=r,a=s;return new De(this._smoothstep(i.value,o.value,a.value),s.typeInfo)}Sqrt(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.sqrt(e)),n.typeInfo);const r=n;return new De(Math.sqrt(r.value),n.typeInfo)}Step(e,t){const n=this.exec.evalExpression(e.args[0],t),r=this.exec.evalExpression(e.args[1],t);if(r instanceof Ue&&n instanceof Ue)return new Ue(r.data.map((e,t)=>e<n.data[t]?0:1),r.typeInfo);const s=n;return new De(r.value<s.value?0:1,s.typeInfo)}Tan(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.tan(e)),n.typeInfo);const r=n;return new De(Math.tan(r.value),n.typeInfo)}Tanh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.tanh(e)),n.typeInfo);const r=n;return new De(Math.tanh(r.value),n.typeInfo)}_getTransposeType(e){const t=e.getTypeName();return"mat2x2f"===t||"mat2x2h"===t?e:"mat2x3f"===t?this.getTypeInfo("mat3x2f"):"mat2x3h"===t?this.getTypeInfo("mat3x2h"):"mat2x4f"===t?this.getTypeInfo("mat4x2f"):"mat2x4h"===t?this.getTypeInfo("mat4x2h"):"mat3x2f"===t?this.getTypeInfo("mat2x3f"):"mat3x2h"===t?this.getTypeInfo("mat2x3h"):"mat3x3f"===t||"mat3x3h"===t?e:"mat3x4f"===t?this.getTypeInfo("mat4x3f"):"mat3x4h"===t?this.getTypeInfo("mat4x3h"):"mat4x2f"===t?this.getTypeInfo("mat2x4f"):"mat4x2h"===t?this.getTypeInfo("mat2x4h"):"mat4x3f"===t?this.getTypeInfo("mat3x4f"):"mat4x3h"===t?this.getTypeInfo("mat3x4h"):("mat4x4f"===t||"mat4x4h"===t||console.error(`Invalid matrix type ${t}`),e)}Transpose(e,t){const n=this.exec.evalExpression(e.args[0],t);if(!(n instanceof Ve))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const r=this._getTransposeType(n.typeInfo);if("mat2x2"===n.typeInfo.name||"mat2x2f"===n.typeInfo.name||"mat2x2h"===n.typeInfo.name){const e=n.data;return new Ve([e[0],e[2],e[1],e[3]],r)}if("mat2x3"===n.typeInfo.name||"mat2x3f"===n.typeInfo.name||"mat2x3h"===n.typeInfo.name){const e=n.data;return new Ve([e[0],e[3],e[6],e[1],e[4],e[7]],r)}if("mat2x4"===n.typeInfo.name||"mat2x4f"===n.typeInfo.name||"mat2x4h"===n.typeInfo.name){const e=n.data;return new Ve([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13]],r)}if("mat3x2"===n.typeInfo.name||"mat3x2f"===n.typeInfo.name||"mat3x2h"===n.typeInfo.name){const e=n.data;return new Ve([e[0],e[3],e[1],e[4],e[2],e[5]],r)}if("mat3x3"===n.typeInfo.name||"mat3x3f"===n.typeInfo.name||"mat3x3h"===n.typeInfo.name){const e=n.data;return new Ve([e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]],r)}if("mat3x4"===n.typeInfo.name||"mat3x4f"===n.typeInfo.name||"mat3x4h"===n.typeInfo.name){const e=n.data;return new Ve([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14]],r)}if("mat4x2"===n.typeInfo.name||"mat4x2f"===n.typeInfo.name||"mat4x2h"===n.typeInfo.name){const e=n.data;return new Ve([e[0],e[4],e[1],e[5],e[2],e[6]],r)}if("mat4x3"===n.typeInfo.name||"mat4x3f"===n.typeInfo.name||"mat4x3h"===n.typeInfo.name){const e=n.data;return new Ve([e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]],r)}if("mat4x4"===n.typeInfo.name||"mat4x4f"===n.typeInfo.name||"mat4x4h"===n.typeInfo.name){const e=n.data;return new Ve([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]],r)}return console.error(`Invalid matrix type ${n.typeInfo.name}`),null}Trunc(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Ue)return new Ue(n.data.map(e=>Math.trunc(e)),n.typeInfo);const r=n;return new De(Math.trunc(r.value),n.typeInfo)}Dpdx(e,t){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,t){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,t){return console.error("TODO: dpdxFine"),null}Dpdy(e,t){return console.error("TODO: dpdy"),null}DpdyCoarse(e,t){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,t){return console.error("TODO: dpdyFine"),null}Fwidth(e,t){return console.error("TODO: fwidth"),null}FwidthCoarse(e,t){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,t){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,t){const n=e.args[0],r=e.args.length>1?this.exec.evalExpression(e.args[1],t).value:0;if(n instanceof ve){const s=n.name,i=t.getVariableValue(s);if(i instanceof $e){if(r<0||r>=i.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const t=i.getMipLevelSize(r),n=i.dimension;return"1d"===n?new De(t[0],this.getTypeInfo("u32")):"3d"===n?new Ue(t,this.getTypeInfo("vec3u")):"2d"===n?new Ue(t.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${n} not found. Line ${e.line}`),null)}return console.error(`Texture ${s} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,t){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,t){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,t){const n=e.args[0],r=this.exec.evalExpression(e.args[1],t),s=e.args.length>2?this.exec.evalExpression(e.args[2],t).value:0;if(!(r instanceof Ue)||2!==r.data.length)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(n instanceof ve){const i=n.name,o=t.getVariableValue(i);if(o instanceof $e){const t=Math.floor(r.data[0]),n=Math.floor(r.data[1]);if(t<0||t>=o.width||n<0||n>=o.height)return console.error(`Texture ${i} out of bounds. Line ${e.line}`),null;const a=o.getPixel(t,n,0,s);return null===a?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new Ue(a,this.getTypeInfo("vec4f"))}return console.error(`Texture ${i} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,t){const n=e.args[0];if(n instanceof ve){const r=n.name,s=t.getVariableValue(r);return s instanceof $e?new De(s.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${r} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,t){const n=e.args[0];if(n instanceof ve){const r=n.name,s=t.getVariableValue(r);return s instanceof $e?new De(s.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${r} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,t){const n=e.args[0];if(n instanceof ve){const r=n.name,s=t.getVariableValue(r);return s instanceof $e?new De(s.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${r} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,t){return console.error("TODO: textureSample"),null}TextureSampleBias(e,t){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,t){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,t){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,t){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,t){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,t){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,t){const n=e.args[0],r=this.exec.evalExpression(e.args[1],t),s=4===e.args.length?this.exec.evalExpression(e.args[2],t).value:0,i=4===e.args.length?this.exec.evalExpression(e.args[3],t).data:this.exec.evalExpression(e.args[2],t).data;if(4!==i.length)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(r instanceof Ue)||2!==r.data.length)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(n instanceof ve){const o=n.name,a=t.getVariableValue(o);if(a instanceof $e){const t=a.getMipLevelSize(0),n=Math.floor(r.data[0]),c=Math.floor(r.data[1]);return n<0||n>=t[0]||c<0||c>=t[1]?(console.error(`Texture ${o} out of bounds. Line ${e.line}`),null):(a.setPixel(n,c,0,s,Array.from(i)),null)}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,t){let n=e.args[0];n instanceof Te&&(n=n.right);const r=this.exec.getVariableName(n,t);return t.getVariable(r).value.getSubData(this.exec,n.postfix,t)}AtomicStore(e,t){let n=e.args[0];n instanceof Te&&(n=n.right);const r=this.exec.getVariableName(n,t),s=t.getVariable(r);let i=e.args[1];const o=this.exec.evalExpression(i,t),a=s.value.getSubData(this.exec,n.postfix,t);return a instanceof De&&o instanceof De&&(a.value=o.value),s.value instanceof Ge&&s.value.setDataValue(this.exec,a,n.postfix,t),null}AtomicAdd(e,t){let n=e.args[0];n instanceof Te&&(n=n.right);const r=this.exec.getVariableName(n,t),s=t.getVariable(r);let i=e.args[1];const o=this.exec.evalExpression(i,t),a=s.value.getSubData(this.exec,n.postfix,t),c=new De(a.value,a.typeInfo);return a instanceof De&&o instanceof De&&(a.value+=o.value),s.value instanceof Ge&&s.value.setDataValue(this.exec,a,n.postfix,t),c}AtomicSub(e,t){let n=e.args[0];n instanceof Te&&(n=n.right);const r=this.exec.getVariableName(n,t),s=t.getVariable(r);let i=e.args[1];const o=this.exec.evalExpression(i,t),a=s.value.getSubData(this.exec,n.postfix,t),c=new De(a.value,a.typeInfo);return a instanceof De&&o instanceof De&&(a.value-=o.value),s.value instanceof Ge&&s.value.setDataValue(this.exec,a,n.postfix,t),c}AtomicMax(e,t){let n=e.args[0];n instanceof Te&&(n=n.right);const r=this.exec.getVariableName(n,t),s=t.getVariable(r);let i=e.args[1];const o=this.exec.evalExpression(i,t),a=s.value.getSubData(this.exec,n.postfix,t),c=new De(a.value,a.typeInfo);return a instanceof De&&o instanceof De&&(a.value=Math.max(a.value,o.value)),s.value instanceof Ge&&s.value.setDataValue(this.exec,a,n.postfix,t),c}AtomicMin(e,t){let n=e.args[0];n instanceof Te&&(n=n.right);const r=this.exec.getVariableName(n,t),s=t.getVariable(r);let i=e.args[1];const o=this.exec.evalExpression(i,t),a=s.value.getSubData(this.exec,n.postfix,t),c=new De(a.value,a.typeInfo);return a instanceof De&&o instanceof De&&(a.value=Math.min(a.value,o.value)),s.value instanceof Ge&&s.value.setDataValue(this.exec,a,n.postfix,t),c}AtomicAnd(e,t){let n=e.args[0];n instanceof Te&&(n=n.right);const r=this.exec.getVariableName(n,t),s=t.getVariable(r);let i=e.args[1];const o=this.exec.evalExpression(i,t),a=s.value.getSubData(this.exec,n.postfix,t),c=new De(a.value,a.typeInfo);return a instanceof De&&o instanceof De&&(a.value=a.value&o.value),s.value instanceof Ge&&s.value.setDataValue(this.exec,a,n.postfix,t),c}AtomicOr(e,t){let n=e.args[0];n instanceof Te&&(n=n.right);const r=this.exec.getVariableName(n,t),s=t.getVariable(r);let i=e.args[1];const o=this.exec.evalExpression(i,t),a=s.value.getSubData(this.exec,n.postfix,t),c=new De(a.value,a.typeInfo);return a instanceof De&&o instanceof De&&(a.value=a.value|o.value),s.value instanceof Ge&&s.value.setDataValue(this.exec,a,n.postfix,t),c}AtomicXor(e,t){let n=e.args[0];n instanceof Te&&(n=n.right);const r=this.exec.getVariableName(n,t),s=t.getVariable(r);let i=e.args[1];const o=this.exec.evalExpression(i,t),a=s.value.getSubData(this.exec,n.postfix,t),c=new De(a.value,a.typeInfo);return a instanceof De&&o instanceof De&&(a.value=a.value^o.value),s.value instanceof Ge&&s.value.setDataValue(this.exec,a,n.postfix,t),c}AtomicExchange(e,t){let n=e.args[0];n instanceof Te&&(n=n.right);const r=this.exec.getVariableName(n,t),s=t.getVariable(r);let i=e.args[1];const o=this.exec.evalExpression(i,t),a=s.value.getSubData(this.exec,n.postfix,t),c=new De(a.value,a.typeInfo);return a instanceof De&&o instanceof De&&(a.value=o.value),s.value instanceof Ge&&s.value.setDataValue(this.exec,a,n.postfix,t),c}AtomicCompareExchangeWeak(e,t){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,t){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,t){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,t){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,t){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,t){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,t){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,t){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,t){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,t){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,t){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,t){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,t){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,t){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,t){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,t){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,t){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,t){return null}TextureBarrier(e,t){return null}WorkgroupBarrier(e,t){return null}WorkgroupUniformLoad(e,t){return null}SubgroupAdd(e,t){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,t){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,t){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,t){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,t){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,t){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,t){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,t){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,t){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,t){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,t){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,t){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,t){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,t){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,t){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,t){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,t){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,t){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,t){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,t){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,t){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,t){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,t){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,t){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,t){return console.error("TODO: quadSwapY"),null}}const ft={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},pt={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class gt extends ht{constructor(e,t){var n;super(),this.ast=null!=e?e:[],this.reflection=new ot,this.reflection.updateAST(this.ast),this.context=null!==(n=null==t?void 0:t.clone())&&void 0!==n?n:new ut,this.builtins=new dt(this),this.typeInfo={bool:this.getTypeInfo(ae.bool),i32:this.getTypeInfo(ae.i32),u32:this.getTypeInfo(ae.u32),f32:this.getTypeInfo(ae.f32),f16:this.getTypeInfo(ae.f16),vec2f:this.getTypeInfo(ue.vec2f),vec2u:this.getTypeInfo(ue.vec2u),vec2i:this.getTypeInfo(ue.vec2i),vec2h:this.getTypeInfo(ue.vec2h),vec3f:this.getTypeInfo(ue.vec3f),vec3u:this.getTypeInfo(ue.vec3u),vec3i:this.getTypeInfo(ue.vec3i),vec3h:this.getTypeInfo(ue.vec3h),vec4f:this.getTypeInfo(ue.vec4f),vec4u:this.getTypeInfo(ue.vec4u),vec4i:this.getTypeInfo(ue.vec4i),vec4h:this.getTypeInfo(ue.vec4h),mat2x2f:this.getTypeInfo(ue.mat2x2f),mat2x3f:this.getTypeInfo(ue.mat2x3f),mat2x4f:this.getTypeInfo(ue.mat2x4f),mat3x2f:this.getTypeInfo(ue.mat3x2f),mat3x3f:this.getTypeInfo(ue.mat3x3f),mat3x4f:this.getTypeInfo(ue.mat3x4f),mat4x2f:this.getTypeInfo(ue.mat4x2f),mat4x3f:this.getTypeInfo(ue.mat4x3f),mat4x4f:this.getTypeInfo(ue.mat4x4f)}}getVariableValue(e){var t,n;const r=null!==(n=null===(t=this.context.getVariable(e))||void 0===t?void 0:t.value)&&void 0!==n?n:null;if(null===r)return null;if(r instanceof De)return r.value;if(r instanceof Ue)return Array.from(r.data);if(r instanceof Ve)return Array.from(r.data);if(r instanceof Ge&&r.typeInfo instanceof o){if("u32"===r.typeInfo.format.name)return Array.from(new Uint32Array(r.buffer,r.offset,r.typeInfo.count));if("i32"===r.typeInfo.format.name)return Array.from(new Int32Array(r.buffer,r.offset,r.typeInfo.count));if("f32"===r.typeInfo.format.name)return Array.from(new Float32Array(r.buffer,r.offset,r.typeInfo.count))}return console.error(`Unsupported return variable type ${r.typeInfo.name}`),null}execute(e){(e=null!=e?e:{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,t,n,r){const s=this.context.clone();(r=null!=r?r:{}).constants&&this._setOverrides(r.constants,s),this._execStatements(this.ast,s);const i=s.getFunction(e);if(!i)return void console.error(`Function ${e} not found`);if("number"==typeof t)t=[t,1,1];else{if(0===t.length)return void console.error("Invalid dispatch count");1===t.length?t=[t[0],1,1]:2===t.length?t=[t[0],t[1],1]:t.length>3&&(t=[t[0],t[1],t[2]])}const o=t[0],a=t[1],c=t[2],l=this.getTypeInfo("vec3u");s.setVariable("@num_workgroups",new Ue(t,l));const u=this.reflection.getFunctionInfo(e);null===u&&console.error(`Function ${e} not found in reflection data`);for(const h in n)for(const e in n[h]){const t=n[h][e];s.variables.forEach(n=>{var r;const s=n.node;if(null==s?void 0:s.attributes){let i=null,o=null;for(const e of s.attributes)"binding"===e.name?i=e.value:"group"===e.name&&(o=e.value);if(e==i&&h==o){let i=!1;for(const t of u.resources)if(t.name===n.name&&t.group===parseInt(h)&&t.binding===parseInt(e)){i=!0;break}if(i)if(void 0!==t.texture&&void 0!==t.descriptor){const e=new $e(t.texture,this.getTypeInfo(s.type),t.descriptor,null!==(r=t.texture.view)&&void 0!==r?r:null);n.value=e}else void 0!==t.uniform?n.value=new Ge(t.uniform,this.getTypeInfo(s.type)):n.value=new Ge(t,this.getTypeInfo(s.type))}}})}for(let h=0;h<c;++h)for(let e=0;e<a;++e)for(let t=0;t<o;++t)s.setVariable("@workgroup_id",new Ue([t,e,h],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(i,[t,e,h],s)}execStatement(e,t){if(e instanceof J)return this.evalExpression(e.value,t);if(e instanceof ie){if(e.condition){const n=this.evalExpression(e.condition,t);if(!(n instanceof De))throw new Error("Invalid break-if condition");if(!n.value)return null}return gt._breakObj}if(e instanceof oe)return gt._continueObj;if(e instanceof G)this._let(e,t);else if(e instanceof U)this._var(e,t);else if(e instanceof $)this._const(e,t);else if(e instanceof O)this._function(e,t);else{if(e instanceof Q)return this._if(e,t);if(e instanceof Z)return this._switch(e,t);if(e instanceof B)return this._for(e,t);if(e instanceof F)return this._while(e,t);if(e instanceof K)return this._loop(e,t);if(e instanceof D){const n=t.clone();return n.currentFunctionName=t.currentFunctionName,this._execStatements(e.body,n)}if(e instanceof q)this._assign(e,t);else if(e instanceof X)this._increment(e,t);else{if(e instanceof le)return null;if(e instanceof V){const n=e.name;null===t.getVariable(n)&&t.setVariable(n,new De(0,this.getTypeInfo("u32")))}else if(e instanceof Y)this._call(e,t);else{if(e instanceof ne)return null;if(e instanceof re)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,t){return e instanceof Ae?this._evalBinaryOp(e,t):e instanceof ye?this._evalLiteral(e,t):e instanceof ve?this._evalVariable(e,t):e instanceof me?this._evalCall(e,t):e instanceof _e?this._evalCreate(e,t):e instanceof be?this._evalConst(e,t):e instanceof Ee?this._evalBitcast(e,t):e instanceof Te?this._evalUnaryOp(e,t):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var t;if(e instanceof ae){const t=this.reflection.getTypeInfo(e);if(null!==t)return t}let n=null!==(t=this.typeInfo[e])&&void 0!==t?t:null;return null!==n||(n=this.reflection.getTypeInfoByName(e)),n}_setOverrides(e,t){for(const n in e){const r=e[n],s=this.reflection.getOverrideInfo(n);null!==s?(null===s.type&&(s.type=this.getTypeInfo("u32")),"u32"===s.type.name||"i32"===s.type.name||"f32"===s.type.name||"f16"===s.type.name?t.setVariable(n,new De(r,s.type)):"bool"===s.type.name?t.setVariable(n,new De(r?1:0,s.type)):"vec2"===s.type.name||"vec3"===s.type.name||"vec4"===s.type.name||"vec2f"===s.type.name||"vec3f"===s.type.name||"vec4f"===s.type.name||"vec2i"===s.type.name||"vec3i"===s.type.name||"vec4i"===s.type.name||"vec2u"===s.type.name||"vec3u"===s.type.name||"vec4u"===s.type.name||"vec2h"===s.type.name||"vec3h"===s.type.name||"vec4h"===s.type.name?t.setVariable(n,new Ue(r,s.type)):console.error(`Invalid constant type for ${n}`)):console.error(`Override ${n} does not exist in the shader.`)}}_dispatchWorkgroup(e,t,n){const r=[1,1,1];for(const l of e.node.attributes)if("workgroup_size"===l.name){if(l.value.length>0){const e=n.getVariableValue(l.value[0]);r[0]=e instanceof De?e.value:parseInt(l.value[0])}if(l.value.length>1){const e=n.getVariableValue(l.value[1]);r[1]=e instanceof De?e.value:parseInt(l.value[1])}if(l.value.length>2){const e=n.getVariableValue(l.value[2]);r[2]=e instanceof De?e.value:parseInt(l.value[2])}}const s=this.getTypeInfo("vec3u"),i=this.getTypeInfo("u32");n.setVariable("@workgroup_size",new Ue(r,s));const o=r[0],a=r[1],c=r[2];for(let l=0,u=0;l<c;++l)for(let c=0;c<a;++c)for(let a=0;a<o;++a,++u){const o=[a,c,l],h=[a+t[0]*r[0],c+t[1]*r[1],l+t[2]*r[2]];n.setVariable("@local_invocation_id",new Ue(o,s)),n.setVariable("@global_invocation_id",new Ue(h,s)),n.setVariable("@local_invocation_index",new De(u,i)),this._dispatchExec(e,n)}}_dispatchExec(e,t){for(const n of e.node.args)for(const e of n.attributes)if("builtin"===e.name){const r=`@${e.value}`,s=t.getVariable(r);void 0!==s&&t.variables.set(n.name,s)}this._execStatements(e.node.body,t)}getVariableName(e,t){for(;e instanceof Te;)e=e.right;return e instanceof ve?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,t){for(const n of e){if(n instanceof Array){const e=t.clone(),r=this._execStatements(n,e);if(r)return r;continue}const e=this.execStatement(n,t);if(e)return e}return null}_call(e,t){const n=t.clone();n.currentFunctionName=e.name;const r=t.getFunction(e.name);if(r){for(let t=0;t<r.node.args.length;++t){const s=r.node.args[t],i=this.evalExpression(e.args[t],n);n.setVariable(s.name,i,s)}this._execStatements(r.node.body,n)}else e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)&&this._evalCreate(e,t)}_increment(e,t){const n=this.getVariableName(e.variable,t),r=t.getVariable(n);r?"++"===e.operator?r.value instanceof De?r.value.value++:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):"--"===e.operator?r.value instanceof De?r.value.value--:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${n} not found. Line ${e.line}`)}_getVariableData(e,t){if(e instanceof ve){const n=this.getVariableName(e,t),r=t.getVariable(n);return null===r?(console.error(`Variable ${n} not found. Line ${e.line}`),null):r.value.getSubData(this,e.postfix,t)}if(e instanceof Te){if("*"===e.operator){const n=this._getVariableData(e.right,t);return n instanceof Fe?n.reference.getSubData(this,e.postfix,t):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if("&"===e.operator){const n=this._getVariableData(e.right,t);return new Fe(n)}}return null}_assign(e,t){let n=null,r="<var>",s=null;if(e.variable instanceof Te){const n=this._getVariableData(e.variable,t),r=this.evalExpression(e.value,t),s=e.operator;if("="===s){if(n instanceof De||n instanceof Ue||n instanceof Ve){if(r instanceof De||r instanceof Ue||r instanceof Ve&&n.data.length===r.data.length)return void n.data.set(r.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(n instanceof Ge&&r instanceof Ge&&n.buffer.byteLength-n.offset>=r.buffer.byteLength-r.offset)return void(n.buffer.byteLength%4==0?new Uint32Array(n.buffer,n.offset,n.typeInfo.size/4).set(new Uint32Array(r.buffer,r.offset,r.typeInfo.size/4)):new Uint8Array(n.buffer,n.offset,n.typeInfo.size).set(new Uint8Array(r.buffer,r.offset,r.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if("+="===s)return n instanceof De||n instanceof Ue||n instanceof Ve?r instanceof De||r instanceof Ue||r instanceof Ve?void n.data.set(r.data.map((e,t)=>n.data[t]+e)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if("-="===s)return(n instanceof De||n instanceof Ue||n instanceof Ve)&&(r instanceof De||r instanceof Ue||r instanceof Ve)?void n.data.set(r.data.map((e,t)=>n.data[t]-e)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof Te){if("*"===e.variable.operator){r=this.getVariableName(e.variable.right,t);const s=t.getVariable(r);if(!(s&&s.value instanceof Fe))return void console.error(`Variable ${r} is not a pointer. Line ${e.line}`);n=s.value.reference;let i=e.variable.postfix;if(!i){let t=e.variable.right;for(;t instanceof Te;){if(t.postfix){i=t.postfix;break}t=t.right}}i&&(n=n.getSubData(this,i,t))}}else{s=e.variable.postfix,r=this.getVariableName(e.variable,t);const i=t.getVariable(r);if(null===i)return void console.error(`Variable ${r} not found. Line ${e.line}`);n=i.value}if(n instanceof Fe&&(n=n.reference),null===n)return void console.error(`Variable ${r} not found. Line ${e.line}`);const i=this.evalExpression(e.value,t),o=e.operator;if("="!==o){const r=n.getSubData(this,s,t);if(r instanceof Ue&&i instanceof De){const t=r.data,n=i.value;if("+="===o)for(let e=0;e<t.length;++e)t[e]+=n;else if("-="===o)for(let e=0;e<t.length;++e)t[e]-=n;else if("*="===o)for(let e=0;e<t.length;++e)t[e]*=n;else if("/="===o)for(let e=0;e<t.length;++e)t[e]/=n;else if("%="===o)for(let e=0;e<t.length;++e)t[e]%=n;else if("&="===o)for(let e=0;e<t.length;++e)t[e]&=n;else if("|="===o)for(let e=0;e<t.length;++e)t[e]|=n;else if("^="===o)for(let e=0;e<t.length;++e)t[e]^=n;else if("<<="===o)for(let e=0;e<t.length;++e)t[e]<<=n;else if(">>="===o)for(let e=0;e<t.length;++e)t[e]>>=n;else console.error(`Invalid operator ${o}. Line ${e.line}`)}else if(r instanceof Ue&&i instanceof Ue){const t=r.data,n=i.data;if(t.length!==n.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if("+="===o)for(let e=0;e<t.length;++e)t[e]+=n[e];else if("-="===o)for(let e=0;e<t.length;++e)t[e]-=n[e];else if("*="===o)for(let e=0;e<t.length;++e)t[e]*=n[e];else if("/="===o)for(let e=0;e<t.length;++e)t[e]/=n[e];else if("%="===o)for(let e=0;e<t.length;++e)t[e]%=n[e];else if("&="===o)for(let e=0;e<t.length;++e)t[e]&=n[e];else if("|="===o)for(let e=0;e<t.length;++e)t[e]|=n[e];else if("^="===o)for(let e=0;e<t.length;++e)t[e]^=n[e];else if("<<="===o)for(let e=0;e<t.length;++e)t[e]<<=n[e];else if(">>="===o)for(let e=0;e<t.length;++e)t[e]>>=n[e];else console.error(`Invalid operator ${o}. Line ${e.line}`)}else{if(!(r instanceof De&&i instanceof De))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);"+="===o?r.value+=i.value:"-="===o?r.value-=i.value:"*="===o?r.value*=i.value:"/="===o?r.value/=i.value:"%="===o?r.value%=i.value:"&="===o?r.value&=i.value:"|="===o?r.value|=i.value:"^="===o?r.value^=i.value:"<<="===o?r.value<<=i.value:">>="===o?r.value>>=i.value:console.error(`Invalid operator ${o}. Line ${e.line}`)}return void(n instanceof Ge&&n.setDataValue(this,r,s,t))}if(n instanceof Ge)n.setDataValue(this,i,s,t);else if(s){if(!(n instanceof Ue||n instanceof Ve))return void console.error(`Variable ${r} is not a vector or matrix. Line ${e.line}`);if(s instanceof we){const o=this.evalExpression(s.index,t).value;if(n instanceof Ue){if(!(i instanceof De))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);n.data[o]=i.value}else{if(!(n instanceof Ve))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);{const o=this.evalExpression(s.index,t).value;if(o<0)return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);if(!(i instanceof Ue))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);{const t=n.typeInfo.getTypeName();if("mat2x2"===t||"mat2x2f"===t||"mat2x2h"===t){if(!(o<2&&2===i.data.length))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);n.data[2*o]=i.data[0],n.data[2*o+1]=i.data[1]}else if("mat2x3"===t||"mat2x3f"===t||"mat2x3h"===t){if(!(o<2&&3===i.data.length))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);n.data[3*o]=i.data[0],n.data[3*o+1]=i.data[1],n.data[3*o+2]=i.data[2]}else if("mat2x4"===t||"mat2x4f"===t||"mat2x4h"===t){if(!(o<2&&4===i.data.length))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);n.data[4*o]=i.data[0],n.data[4*o+1]=i.data[1],n.data[4*o+2]=i.data[2],n.data[4*o+3]=i.data[3]}else if("mat3x2"===t||"mat3x2f"===t||"mat3x2h"===t){if(!(o<3&&2===i.data.length))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);n.data[2*o]=i.data[0],n.data[2*o+1]=i.data[1]}else if("mat3x3"===t||"mat3x3f"===t||"mat3x3h"===t){if(!(o<3&&3===i.data.length))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);n.data[3*o]=i.data[0],n.data[3*o+1]=i.data[1],n.data[3*o+2]=i.data[2]}else if("mat3x4"===t||"mat3x4f"===t||"mat3x4h"===t){if(!(o<3&&4===i.data.length))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);n.data[4*o]=i.data[0],n.data[4*o+1]=i.data[1],n.data[4*o+2]=i.data[2],n.data[4*o+3]=i.data[3]}else if("mat4x2"===t||"mat4x2f"===t||"mat4x2h"===t){if(!(o<4&&2===i.data.length))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);n.data[2*o]=i.data[0],n.data[2*o+1]=i.data[1]}else if("mat4x3"===t||"mat4x3f"===t||"mat4x3h"===t){if(!(o<4&&3===i.data.length))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);n.data[3*o]=i.data[0],n.data[3*o+1]=i.data[1],n.data[3*o+2]=i.data[2]}else{if("mat4x4"!==t&&"mat4x4f"!==t&&"mat4x4h"!==t)return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);if(!(o<4&&4===i.data.length))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);n.data[4*o]=i.data[0],n.data[4*o+1]=i.data[1],n.data[4*o+2]=i.data[2],n.data[4*o+3]=i.data[3]}}}}}else if(s instanceof ge){const t=s.value;if(!(n instanceof Ue))return void console.error(`Invalid assignment to ${t}. Variable ${r} is not a vector. Line ${e.line}`);if(i instanceof De){if(t.length>1)return void console.error(`Invalid assignment to ${t} for variable ${r}. Line ${e.line}`);if("x"===t)n.data[0]=i.value;else if("y"===t){if(n.data.length<2)return void console.error(`Invalid assignment to ${t} for variable ${r}. Line ${e.line}`);n.data[1]=i.value}else if("z"===t){if(n.data.length<3)return void console.error(`Invalid assignment to ${t} for variable ${r}. Line ${e.line}`);n.data[2]=i.value}else if("w"===t){if(n.data.length<4)return void console.error(`Invalid assignment to ${t} for variable ${r}. Line ${e.line}`);n.data[3]=i.value}}else{if(!(i instanceof Ue))return void console.error(`Invalid assignment to ${r}. Line ${e.line}`);if(t.length!==i.data.length)return void console.error(`Invalid assignment to ${t} for variable ${r}. Line ${e.line}`);for(let s=0;s<t.length;++s){const o=t[s];if("x"===o||"r"===o)n.data[0]=i.data[s];else if("y"===o||"g"===o){if(i.data.length<2)return void console.error(`Invalid assignment to ${o} for variable ${r}. Line ${e.line}`);n.data[1]=i.data[s]}else if("z"===o||"b"===o){if(i.data.length<3)return void console.error(`Invalid assignment to ${o} for variable ${r}. Line ${e.line}`);n.data[2]=i.data[s]}else{if("w"!==o&&"a"!==o)return void console.error(`Invalid assignment to ${o} for variable ${r}. Line ${e.line}`);if(i.data.length<4)return void console.error(`Invalid assignment to ${o} for variable ${r}. Line ${e.line}`);n.data[3]=i.data[s]}}}}}else n instanceof De&&i instanceof De?n.value=i.value:n instanceof Ue&&i instanceof Ue||n instanceof Ve&&i instanceof Ve?n.data.set(i.data):console.error(`Invalid assignment to ${r}. Line ${e.line}`)}_function(e,t){const n=new lt(e);t.functions.set(e.name,n)}_const(e,t){let n=null;null!==e.value&&(n=this.evalExpression(e.value,t)),t.createVariable(e.name,n,e)}_let(e,t){let n=null;if(null!==e.value){if(n=this.evalExpression(e.value,t),null===n)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof Te||(n=n.clone())}else{const r=e.type.name;if("f32"===r||"i32"===r||"u32"===r||"bool"===r||"f16"===r||"vec2"===r||"vec3"===r||"vec4"===r||"vec2f"===r||"vec3f"===r||"vec4f"===r||"vec2i"===r||"vec3i"===r||"vec4i"===r||"vec2u"===r||"vec3u"===r||"vec4u"===r||"vec2h"===r||"vec3h"===r||"vec4h"===r||"vec2b"===r||"vec3b"===r||"vec4b"===r||"mat2x2"===r||"mat2x3"===r||"mat2x4"===r||"mat3x2"===r||"mat3x3"===r||"mat3x4"===r||"mat4x2"===r||"mat4x3"===r||"mat4x4"===r||"mat2x2f"===r||"mat2x3f"===r||"mat2x4f"===r||"mat3x2f"===r||"mat3x3f"===r||"mat3x4f"===r||"mat4x2f"===r||"mat4x3f"===r||"mat4x4f"===r||"mat2x2h"===r||"mat2x3h"===r||"mat2x4h"===r||"mat3x2h"===r||"mat3x3h"===r||"mat3x4h"===r||"mat4x2h"===r||"mat4x3h"===r||"mat4x4h"===r||"array"===r){const r=new _e(e.type,[]);n=this._evalCreate(r,t)}}t.createVariable(e.name,n,e)}_var(e,t){let n=null;if(null!==e.value){if(n=this.evalExpression(e.value,t),null===n)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof Te||(n=n.clone())}else{if(null===e.type)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const r=e.type.name;if("f32"===r||"i32"===r||"u32"===r||"bool"===r||"f16"===r||"vec2"===r||"vec3"===r||"vec4"===r||"vec2f"===r||"vec3f"===r||"vec4f"===r||"vec2i"===r||"vec3i"===r||"vec4i"===r||"vec2u"===r||"vec3u"===r||"vec4u"===r||"vec2h"===r||"vec3h"===r||"vec4h"===r||"vec2b"===r||"vec3b"===r||"vec4b"===r||"mat2x2"===r||"mat2x3"===r||"mat2x4"===r||"mat3x2"===r||"mat3x3"===r||"mat3x4"===r||"mat4x2"===r||"mat4x3"===r||"mat4x4"===r||"mat2x2f"===r||"mat2x3f"===r||"mat2x4f"===r||"mat3x2f"===r||"mat3x3f"===r||"mat3x4f"===r||"mat4x2f"===r||"mat4x3f"===r||"mat4x4f"===r||"mat2x2h"===r||"mat2x3h"===r||"mat2x4h"===r||"mat3x2h"===r||"mat3x3h"===r||"mat3x4h"===r||"mat4x2h"===r||"mat4x3h"===r||"mat4x4h"===r||e.type instanceof de||e.type instanceof le||e.type instanceof ue){const r=new _e(e.type,[]);n=this._evalCreate(r,t)}}t.createVariable(e.name,n,e)}_switch(e,t){t=t.clone();const n=this.evalExpression(e.condition,t);if(!(n instanceof De))return console.error(`Invalid if condition. Line ${e.line}`),null;let r=null;for(const s of e.cases)if(s instanceof Ie)for(const i of s.selectors){if(i instanceof Re){r=s;continue}const o=this.evalExpression(i,t);if(!(o instanceof De))return console.error(`Invalid case selector. Line ${e.line}`),null;if(o.value===n.value)return this._execStatements(s.body,t)}else s instanceof Ce&&(r=s);return r?this._execStatements(r.body,t):null}_if(e,t){t=t.clone();const n=this.evalExpression(e.condition,t);if(!(n instanceof De))return console.error(`Invalid if condition. Line ${e.line}`),null;if(n.value)return this._execStatements(e.body,t);for(const r of e.elseif){const n=this.evalExpression(r.condition,t);if(!(n instanceof De))return console.error(`Invalid if condition. Line ${e.line}`),null;if(n.value)return this._execStatements(r.body,t)}return e.else?this._execStatements(e.else,t):null}_getScalarValue(e){return e instanceof De?e.value:(console.error("Expected scalar value.",e),0)}_for(e,t){for(t=t.clone(),this.execStatement(e.init,t);this._getScalarValue(this.evalExpression(e.condition,t));){const n=this._execStatements(e.body,t);if(n===gt._breakObj)break;if(null!==n&&n!==gt._continueObj)return n;this.execStatement(e.increment,t)}return null}_loop(e,t){for(t=t.clone();;){const n=this._execStatements(e.body,t);if(n===gt._breakObj)break;if(n===gt._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,t)===gt._breakObj)break}else if(null!==n)return n}return null}_while(e,t){for(t=t.clone();this._getScalarValue(this.evalExpression(e.condition,t));){const n=this._execStatements(e.body,t);if(n===gt._breakObj)break;if(n!==gt._continueObj&&null!==n)return n}return null}_evalBitcast(e,t){const n=this.evalExpression(e.value,t),r=e.type;if(n instanceof De){const e=rt(n.value,n.typeInfo.name,r.name);return new De(e,this.getTypeInfo(r))}if(n instanceof Ue){const t=n.typeInfo.getTypeName();let s="";if(t.endsWith("f"))s="f32";else if(t.endsWith("i"))s="i32";else if(t.endsWith("u"))s="u32";else if(t.endsWith("b"))s="bool";else{if(!t.endsWith("h"))return console.error(`Unknown vector type ${t}. Line ${e.line}`),null;s="f16"}const i=r.getTypeName();let o="";if(i.endsWith("f"))o="f32";else if(i.endsWith("i"))o="i32";else if(i.endsWith("u"))o="u32";else if(i.endsWith("b"))o="bool";else{if(!i.endsWith("h"))return console.error(`Unknown vector type ${o}. Line ${e.line}`),null;o="f16"}const a=function(e,t,n){if(t===n)return e;const r=new Array(e.length);for(let s=0;s<e.length;s++)r[s]=rt(e[s],t,n);return r}(Array.from(n.data),s,o);return new Ue(a,this.getTypeInfo(r))}return console.error(`TODO: bitcast for ${n.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,t){return t.getVariableValue(e.name).clone().getSubData(this,e.postfix,t)}_evalCreate(e,t){var n;if(e instanceof _e){if(null===e.type)return Ne.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,t);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,t);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,t)}}const r=e instanceof _e?e.type.name:e.name,s=e instanceof _e?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(null===s)return console.error(`Unknown type ${r}. Line ${e.line}`),null;if(0===s.size)return null;const a=new Ge(new ArrayBuffer(s.size),s,0);if(s instanceof i){if(e.args)for(let i=0;i<e.args.length;++i){const n=s.members[i],r=e.args[i],o=this.evalExpression(r,t);a.setData(this,o,n.type,n.offset,t)}}else if(s instanceof o){let r=0;if(e.args)for(let i=0;i<e.args.length;++i){const o=e.args[i],c=this.evalExpression(o,t);null===s.format&&("x32"===(null===(n=c.typeInfo)||void 0===n?void 0:n.name)?s.format=this.getTypeInfo("i32"):s.format=c.typeInfo),a.setData(this,c,s.format,r,t),r+=s.stride}}else console.error(`Unknown type "${r}". Line ${e.line}`);return e instanceof _e?a.getSubData(this,e.postfix,t):a}_evalLiteral(e,t){const n=this.getTypeInfo(e.type),r=n.name;return"x32"===r||"u32"===r||"f32"===r||"f16"===r||"i32"===r||"bool"===r?new De(e.scalarValue,n):"vec2"===r||"vec3"===r||"vec4"===r||"vec2f"===r||"vec3f"===r||"vec4f"===r||"vec2h"===r||"vec3h"===r||"vec4h"===r||"vec2i"===r||"vec3i"===r||"vec4i"===r||"vec2u"===r||"vec3u"===r||"vec4u"===r?this._callConstructorVec(e,t):"mat2x2"===r||"mat2x3"===r||"mat2x4"===r||"mat3x2"===r||"mat3x3"===r||"mat3x4"===r||"mat4x2"===r||"mat4x3"===r||"mat4x4"===r||"mat2x2f"===r||"mat2x3f"===r||"mat2x4f"===r||"mat3x2f"===r||"mat3x3f"===r||"mat3x4f"===r||"mat4x2f"===r||"mat4x3f"===r||"mat4x4f"===r||"mat2x2h"===r||"mat2x3h"===r||"mat2x4h"===r||"mat3x2h"===r||"mat3x3h"===r||"mat3x4h"===r||"mat4x2h"===r||"mat4x3h"===r||"mat4x4h"===r?this._callConstructorMatrix(e,t):e.value}_evalVariable(e,t){const n=t.getVariableValue(e.name);return null===n?n:n.getSubData(this,e.postfix,t)}_maxFormatTypeInfo(e){let t=e[0];if("f32"===t.name)return t;for(let n=1;n<e.length;++n){const r=gt._priority.get(t.name);gt._priority.get(e[n].name)<r&&(t=e[n])}return"x32"===t.name?this.getTypeInfo("i32"):t}_evalUnaryOp(e,t){const n=this.evalExpression(e.right,t);if("&"===e.operator)return new Fe(n);if("*"===e.operator)return n instanceof Fe?n.reference.getSubData(this,e.postfix,t):(console.error(`Invalid dereference. Line ${e.line}`),null);const r=n instanceof De?n.value:n instanceof Ue?Array.from(n.data):null;switch(e.operator){case"+":{if(Xe(r)){const e=r.map((e,t)=>+e);return new Ue(e,n.typeInfo)}const e=r,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new De(+e,t)}case"-":{if(Xe(r)){const e=r.map((e,t)=>-e);return new Ue(e,n.typeInfo)}const e=r,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new De(-e,t)}case"!":{if(Xe(r)){const e=r.map((e,t)=>e?0:1);return new Ue(e,n.typeInfo)}const e=r,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new De(e?0:1,t)}case"~":{if(Xe(r)){const e=r.map((e,t)=>~e);return new Ue(e,n.typeInfo)}const e=r,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new De(~e,t)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,t){const n=this.evalExpression(e.left,t),r=this.evalExpression(e.right,t),s=n instanceof De?n.value:n instanceof Ue||n instanceof Ve?Array.from(n.data):null,i=r instanceof De?r.value:r instanceof Ue||r instanceof Ve?Array.from(r.data):null;switch(e.operator){case"+":{if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e+r[t]);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t+e);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e+t);return new Ue(t,r.typeInfo)}const t=s,o=i,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new De(t+o,a)}case"-":{if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e-r[t]);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t-e);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e-t);return new Ue(t,r.typeInfo)}const t=s,o=i,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new De(t-o,a)}case"*":{if(Xe(s)&&Xe(i)){const t=s,o=i;if(n instanceof Ve&&r instanceof Ve){const s=function(e,t,n,r){if(void 0===pt[t.name]||void 0===pt[r.name])return null;const s=pt[t.name][0],i=pt[t.name][1],o=pt[r.name][0];if(s!==pt[r.name][1])return null;const a=new Array(o*i);for(let c=0;c<i;c++)for(let t=0;t<o;t++){let r=0;for(let o=0;o<s;o++)r+=e[o*i+c]*n[t*s+o];a[c*o+t]=r}return a}(t,n.typeInfo,o,r.typeInfo);if(null===s)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const i=pt[r.typeInfo.name][0],a=pt[n.typeInfo.name][1],c=this.getTypeInfo(`mat${i}x${a}f`);return new Ve(s,c)}if(n instanceof Ve&&r instanceof Ue){const s=function(e,t,n,r){if(void 0===pt[t.name]||void 0===ft[r.name])return null;const s=pt[t.name][0],i=pt[t.name][1];if(s!==n.length)return null;const o=new Array(i);for(let a=0;a<i;a++){let t=0;for(let r=0;r<s;r++)t+=e[r*i+a]*n[r];o[a]=t}return o}(t,n.typeInfo,o,r.typeInfo);return null===s?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new Ue(s,r.typeInfo)}if(n instanceof Ue&&r instanceof Ve){const s=function(e,t,n,r){if(void 0===ft[t.name]||void 0===pt[r.name])return null;const s=pt[r.name][0],i=pt[r.name][1];if(i!==e.length)return null;const o=[];for(let a=0;a<s;a++){let t=0;for(let r=0;r<i;r++)t+=e[r]*n[r*s+a];o[a]=t}return o}(t,n.typeInfo,o,r.typeInfo);return null===s?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new Ue(s,n.typeInfo)}{if(t.length!==o.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const r=t.map((e,t)=>e*o[t]);return new Ue(r,n.typeInfo)}}if(Xe(s)){const e=i,t=s.map((t,n)=>t*e);return n instanceof Ve?new Ve(t,n.typeInfo):new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e*t);return r instanceof Ve?new Ve(t,r.typeInfo):new Ue(t,r.typeInfo)}const t=s,o=i,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new De(t*o,a)}case"%":{if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e%r[t]);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t%e);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e%t);return new Ue(t,r.typeInfo)}const t=s,o=i,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new De(t%o,a)}case"/":{if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e/r[t]);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t/e);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e/t);return new Ue(t,r.typeInfo)}const t=s,o=i,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new De(t/o,a)}case"&":{if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e&r[t]);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t&e);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e&t);return new Ue(t,r.typeInfo)}const t=s,o=i,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new De(t&o,a)}case"|":{if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e|r[t]);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t|e);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e|t);return new Ue(t,r.typeInfo)}const t=s,o=i,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new De(t|o,a)}case"^":{if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e^r[t]);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t^e);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e^t);return new Ue(t,r.typeInfo)}const t=s,o=i,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new De(t^o,a)}case"<<":{if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e<<r[t]);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t<<e);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e<<t);return new Ue(t,r.typeInfo)}const t=s,o=i,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new De(t<<o,a)}case">>":{if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e>>r[t]);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t>>e);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e>>t);return new Ue(t,r.typeInfo)}const t=s,o=i,a=this._maxFormatTypeInfo([n.typeInfo,r.typeInfo]);return new De(t>>o,a)}case">":if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e>r[t]?1:0);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t>e?1:0);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e>t?1:0);return new Ue(t,r.typeInfo)}return new De(s>i?1:0,this.getTypeInfo("bool"));case"<":if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e<r[t]?1:0);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t<e?1:0);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e<t?1:0);return new Ue(t,r.typeInfo)}return new De(s<i?1:0,this.getTypeInfo("bool"));case"==":if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e===r[t]?1:0);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t==e?1:0);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e==t?1:0);return new Ue(t,r.typeInfo)}return new De(s===i?1:0,this.getTypeInfo("bool"));case"!=":if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e!==r[t]?1:0);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t!==e?1:0);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e!==t?1:0);return new Ue(t,r.typeInfo)}return new De(s!==i?1:0,this.getTypeInfo("bool"));case">=":if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e>=r[t]?1:0);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t>=e?1:0);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e>=t?1:0);return new Ue(t,r.typeInfo)}return new De(s>=i?1:0,this.getTypeInfo("bool"));case"<=":if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e<=r[t]?1:0);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t<=e?1:0);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e<=t?1:0);return new Ue(t,r.typeInfo)}return new De(s<=i?1:0,this.getTypeInfo("bool"));case"&&":if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e&&r[t]?1:0);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t&&e?1:0);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e&&t?1:0);return new Ue(t,r.typeInfo)}return new De(s&&i?1:0,this.getTypeInfo("bool"));case"||":if(Xe(s)&&Xe(i)){const t=s,r=i;if(t.length!==r.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const o=t.map((e,t)=>e||r[t]?1:0);return new Ue(o,n.typeInfo)}if(Xe(s)){const e=i,t=s.map((t,n)=>t||e?1:0);return new Ue(t,n.typeInfo)}if(Xe(i)){const e=s,t=i.map((t,n)=>e||t?1:0);return new Ue(t,r.typeInfo)}return new De(s||i?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,t){if(null!==e.cachedReturnValue)return e.cachedReturnValue;const n=t.clone();n.currentFunctionName=e.name;const r=t.getFunction(e.name);if(!r)return e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)?this._evalCreate(e,t):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let s=0;s<r.node.args.length;++s){const t=r.node.args[s],i=this.evalExpression(e.args[s],n);n.createVariable(t.name,i,t)}return this._execStatements(r.node.body,n)}_callBuiltinFunction(e,t){switch(e.name){case"all":return this.builtins.All(e,t);case"any":return this.builtins.Any(e,t);case"select":return this.builtins.Select(e,t);case"arrayLength":return this.builtins.ArrayLength(e,t);case"abs":return this.builtins.Abs(e,t);case"acos":return this.builtins.Acos(e,t);case"acosh":return this.builtins.Acosh(e,t);case"asin":return this.builtins.Asin(e,t);case"asinh":return this.builtins.Asinh(e,t);case"atan":return this.builtins.Atan(e,t);case"atanh":return this.builtins.Atanh(e,t);case"atan2":return this.builtins.Atan2(e,t);case"ceil":return this.builtins.Ceil(e,t);case"clamp":return this.builtins.Clamp(e,t);case"cos":return this.builtins.Cos(e,t);case"cosh":return this.builtins.Cosh(e,t);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,t);case"countOneBits":return this.builtins.CountOneBits(e,t);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,t);case"cross":return this.builtins.Cross(e,t);case"degrees":return this.builtins.Degrees(e,t);case"determinant":return this.builtins.Determinant(e,t);case"distance":return this.builtins.Distance(e,t);case"dot":return this.builtins.Dot(e,t);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,t);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,t);case"exp":return this.builtins.Exp(e,t);case"exp2":return this.builtins.Exp2(e,t);case"extractBits":return this.builtins.ExtractBits(e,t);case"faceForward":return this.builtins.FaceForward(e,t);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,t);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,t);case"floor":return this.builtins.Floor(e,t);case"fma":return this.builtins.Fma(e,t);case"fract":return this.builtins.Fract(e,t);case"frexp":return this.builtins.Frexp(e,t);case"insertBits":return this.builtins.InsertBits(e,t);case"inverseSqrt":return this.builtins.InverseSqrt(e,t);case"ldexp":return this.builtins.Ldexp(e,t);case"length":return this.builtins.Length(e,t);case"log":return this.builtins.Log(e,t);case"log2":return this.builtins.Log2(e,t);case"max":return this.builtins.Max(e,t);case"min":return this.builtins.Min(e,t);case"mix":return this.builtins.Mix(e,t);case"modf":return this.builtins.Modf(e,t);case"normalize":return this.builtins.Normalize(e,t);case"pow":return this.builtins.Pow(e,t);case"quantizeToF16":return this.builtins.QuantizeToF16(e,t);case"radians":return this.builtins.Radians(e,t);case"reflect":return this.builtins.Reflect(e,t);case"refract":return this.builtins.Refract(e,t);case"reverseBits":return this.builtins.ReverseBits(e,t);case"round":return this.builtins.Round(e,t);case"saturate":return this.builtins.Saturate(e,t);case"sign":return this.builtins.Sign(e,t);case"sin":return this.builtins.Sin(e,t);case"sinh":return this.builtins.Sinh(e,t);case"smoothstep":return this.builtins.SmoothStep(e,t);case"sqrt":return this.builtins.Sqrt(e,t);case"step":return this.builtins.Step(e,t);case"tan":return this.builtins.Tan(e,t);case"tanh":return this.builtins.Tanh(e,t);case"transpose":return this.builtins.Transpose(e,t);case"trunc":return this.builtins.Trunc(e,t);case"dpdx":return this.builtins.Dpdx(e,t);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,t);case"dpdxFine":return this.builtins.DpdxFine(e,t);case"dpdy":return this.builtins.Dpdy(e,t);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,t);case"dpdyFine":return this.builtins.DpdyFine(e,t);case"fwidth":return this.builtins.Fwidth(e,t);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,t);case"fwidthFine":return this.builtins.FwidthFine(e,t);case"textureDimensions":return this.builtins.TextureDimensions(e,t);case"textureGather":return this.builtins.TextureGather(e,t);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,t);case"textureLoad":return this.builtins.TextureLoad(e,t);case"textureNumLayers":return this.builtins.TextureNumLayers(e,t);case"textureNumLevels":return this.builtins.TextureNumLevels(e,t);case"textureNumSamples":return this.builtins.TextureNumSamples(e,t);case"textureSample":return this.builtins.TextureSample(e,t);case"textureSampleBias":return this.builtins.TextureSampleBias(e,t);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,t);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,t);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,t);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,t);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,t);case"textureStore":return this.builtins.TextureStore(e,t);case"atomicLoad":return this.builtins.AtomicLoad(e,t);case"atomicStore":return this.builtins.AtomicStore(e,t);case"atomicAdd":return this.builtins.AtomicAdd(e,t);case"atomicSub":return this.builtins.AtomicSub(e,t);case"atomicMax":return this.builtins.AtomicMax(e,t);case"atomicMin":return this.builtins.AtomicMin(e,t);case"atomicAnd":return this.builtins.AtomicAnd(e,t);case"atomicOr":return this.builtins.AtomicOr(e,t);case"atomicXor":return this.builtins.AtomicXor(e,t);case"atomicExchange":return this.builtins.AtomicExchange(e,t);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,t);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,t);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,t);case"pack4xI8":return this.builtins.Pack4xI8(e,t);case"pack4xU8":return this.builtins.Pack4xU8(e,t);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,t);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,t);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,t);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,t);case"pack2x16float":return this.builtins.Pack2x16float(e,t);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,t);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,t);case"unpack4xI8":return this.builtins.Unpack4xI8(e,t);case"unpack4xU8":return this.builtins.Unpack4xU8(e,t);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,t);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,t);case"unpack2x16float":return this.builtins.Unpack2x16float(e,t);case"storageBarrier":return this.builtins.StorageBarrier(e,t);case"textureBarrier":return this.builtins.TextureBarrier(e,t);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,t);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,t);case"subgroupAdd":return this.builtins.SubgroupAdd(e,t);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,t);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,t);case"subgroupAll":return this.builtins.SubgroupAll(e,t);case"subgroupAnd":return this.builtins.SubgroupAnd(e,t);case"subgroupAny":return this.builtins.SubgroupAny(e,t);case"subgroupBallot":return this.builtins.SubgroupBallot(e,t);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,t);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,t);case"subgroupElect":return this.builtins.SubgroupElect(e,t);case"subgroupMax":return this.builtins.SubgroupMax(e,t);case"subgroupMin":return this.builtins.SubgroupMin(e,t);case"subgroupMul":return this.builtins.SubgroupMul(e,t);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,t);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,t);case"subgroupOr":return this.builtins.SubgroupOr(e,t);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,t);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,t);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,t);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,t);case"subgroupXor":return this.builtins.SubgroupXor(e,t);case"quadBroadcast":return this.builtins.QuadBroadcast(e,t);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,t);case"quadSwapX":return this.builtins.QuadSwapX(e,t);case"quadSwapY":return this.builtins.QuadSwapY(e,t)}const n=t.getFunction(e.name);if(n){const r=t.clone();for(let t=0;t<n.node.args.length;++t){const s=n.node.args[t],i=this.evalExpression(e.args[t],r);r.setVariable(s.name,i,s)}return this._execStatements(n.node.body,r)}return null}_callConstructorValue(e,t){if(!e.args||0===e.args.length)return new De(0,this.getTypeInfo(e.type));const n=this.evalExpression(e.args[0],t);return n.typeInfo=this.getTypeInfo(e.type),n.getSubData(this,e.postfix,t).clone()}_callConstructorVec(e,t){const n=this.getTypeInfo(e.type),r=e.type.getTypeName(),s=ft[r];if(void 0===s)return console.error(`Invalid vec constructor ${r}. Line ${e.line}`),null;const i=[];if(e instanceof ye)if(e.isVector){const t=e.vectorValue;for(const e of t)i.push(e)}else i.push(e.scalarValue);else if(e.args)for(const o of e.args){const e=this.evalExpression(o,t);if(e instanceof Ue){const t=e.data;for(let e=0;e<t.length;++e){let n=t[e];i.push(n)}}else if(e instanceof De){let t=e.value;i.push(t)}}if(e.type instanceof ue&&null===e.type.format&&(e.type.format=ue.f32),0===i.length){const r=new Array(s).fill(0);return new Ue(r,n).getSubData(this,e.postfix,t)}if(1===i.length)for(;i.length<s;)i.push(i[0]);return i.length<s?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new Ue(i.length>s?i.slice(0,s):i,n).getSubData(this,e.postfix,t)}_callConstructorMatrix(e,t){const n=this.getTypeInfo(e.type),r=e.type.getTypeName(),s=pt[r];if(void 0===s)return console.error(`Invalid matrix constructor ${r}. Line ${e.line}`),null;const i=[];if(e instanceof ye)if(e.isVector){const t=e.vectorValue;for(const e of t)i.push(e)}else i.push(e.scalarValue);else if(e.args)for(const o of e.args){const e=this.evalExpression(o,t);e instanceof Ue?i.push(...e.data):e instanceof De?i.push(e.value):e instanceof Ve&&i.push(...e.data)}if(n instanceof c&&null===n.format&&(n.format=this.getTypeInfo("f32")),0===i.length){const r=new Array(s[2]).fill(0);return new Ve(r,n).getSubData(this,e.postfix,t)}return i.length!==s[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new Ve(i,n).getSubData(this,e.postfix,t)}}gt._breakObj=new Oe(new r("BREAK",null),null),gt._continueObj=new Oe(new r("CONTINUE",null),null),gt._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class _t{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class mt{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new _t,this._exec=new gt,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const e=this._global_decl_or_directive();if(!e)break;t.push(e)}if(this._deferArrayCountEval.length>0){for(const t of this._deferArrayCountEval){const n=t.arrayType,r=t.countNode;if(r instanceof ve){const t=r.name,s=this._context.constants.get(t);if(s)try{const e=s.constEvaluate(this._exec);n.count=e}catch(e){}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const n of t)n.search(e=>{e instanceof Me||e instanceof he?e.type=this._forwardType(e.type):e instanceof de?e.format=this._forwardType(e.format):e instanceof U||e instanceof G||e instanceof $?e.type=this._forwardType(e.type):e instanceof O?e.returnType=this._forwardType(e.returnType):e instanceof Pe&&(e.type=this._forwardType(e.type))});return t}_forwardType(e){if(e instanceof ce){const t=this._getType(e.name);if(t)return t}else e instanceof he?e.type=this._forwardType(e.type):e instanceof de&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if("string"==typeof e){const t=new He(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,t){return e.line=null!=t?t:this._currentLine,e}_error(e,t){return{token:e,message:t,toString:()=>`${t}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==je.eof}_match(e){if(e instanceof We)return!!this._check(e)&&(this._advance(),!0);for(let t=0,n=e.length;t<n;++t){const n=e[t];if(this._check(n))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),`${t}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const n=t.type;let r=!1;for(const t of e){if(n===t)return!0;t===je.tokens.name&&(r=!0)}if(r){const e=je.tokens.name.rule.exec(t.lexeme);if(e&&0==e.index&&e[0]==t.lexeme)return!0}return!1}if(t.type===e)return!0;if(e===je.tokens.name){const e=je.tokens.name.rule.exec(t.lexeme);return e&&0==e.index&&e[0]==t.lexeme}return!1}_advance(){var e,t;return this._currentLine=null!==(t=null===(e=this._peek())||void 0===e?void 0:e.line)&&void 0!==t?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(je.tokens.semicolon)&&!this._isAtEnd(););if(this._match(je.keywords.alias)){const e=this._type_alias();return this._consume(je.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(je.keywords.diagnostic)){const e=this._diagnostic();return this._consume(je.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(je.keywords.requires)){const e=this._requires_directive();return this._consume(je.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(je.keywords.enable)){const e=this._enable_directive();return this._consume(je.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}const e=this._attribute();if(this._check(je.keywords.var)){const t=this._global_variable_decl();return null!=t&&(t.attributes=e),this._consume(je.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(je.keywords.override)){const t=this._override_variable_decl();return null!=t&&(t.attributes=e),this._consume(je.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(je.keywords.let)){const t=this._global_let_decl();return null!=t&&(t.attributes=e),this._consume(je.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(je.keywords.const)){const t=this._global_const_decl();return null!=t&&(t.attributes=e),this._consume(je.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(je.keywords.struct)){const t=this._struct_decl();return null!=t&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}if(this._check(je.keywords.fn)){const t=this._function_decl();return null!=t&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}return null}_function_decl(){if(!this._match(je.keywords.fn))return null;const e=this._currentLine,t=this._consume(je.tokens.ident,"Expected function name.").toString();this._consume(je.tokens.paren_left,"Expected '(' for function arguments.");const n=[];if(!this._check(je.tokens.paren_right))do{if(this._check(je.tokens.paren_right))break;const e=this._attribute(),t=this._consume(je.tokens.name,"Expected argument name.").toString();this._consume(je.tokens.colon,"Expected ':' for argument type.");const r=this._attribute(),s=this._type_decl();null!=s&&(s.attributes=r,n.push(this._updateNode(new Pe(t,s,e))))}while(this._match(je.tokens.comma));this._consume(je.tokens.paren_right,"Expected ')' after function arguments.");let r=null;if(this._match(je.tokens.arrow)){const e=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=e)}const s=this._compound_statement(),i=this._currentLine;return this._updateNode(new O(t,n,r,s,e,i),e)}_compound_statement(){const e=[];for(this._consume(je.tokens.brace_left,"Expected '{' for block.");!this._check(je.tokens.brace_right);){const t=this._statement();null!==t&&e.push(t)}return this._consume(je.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(je.tokens.semicolon)&&!this._isAtEnd(););if(this._check(je.tokens.attr)&&this._attribute(),this._check(je.keywords.if))return this._if_statement();if(this._check(je.keywords.switch))return this._switch_statement();if(this._check(je.keywords.loop))return this._loop_statement();if(this._check(je.keywords.for))return this._for_statement();if(this._check(je.keywords.while))return this._while_statement();if(this._check(je.keywords.continuing))return this._continuing_statement();if(this._check(je.keywords.static_assert))return this._static_assert_statement();if(this._check(je.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(je.keywords.return))e=this._return_statement();else if(this._check([je.keywords.var,je.keywords.let,je.keywords.const]))e=this._variable_statement();else if(this._match(je.keywords.discard))e=this._updateNode(new se);else if(this._match(je.keywords.break)){const t=this._updateNode(new ie);if(this._currentLoop.length>0){const e=this._currentLoop[this._currentLoop.length-1];t.loopId=e.id}e=t,this._check(je.keywords.if)&&(this._advance(),t.condition=this._optional_paren_expression())}else if(this._match(je.keywords.continue)){const t=this._updateNode(new oe);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${t.line}`);{const e=this._currentLoop[this._currentLoop.length-1];t.loopId=e.id}e=t}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return null!=e&&this._consume(je.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(je.keywords.static_assert))return null;const e=this._currentLine,t=this._optional_paren_expression();return this._updateNode(new N(t),e)}_while_statement(){if(!this._match(je.keywords.while))return null;const e=this._updateNode(new F(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(je.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(je.keywords.continuing))return null;const t=this._currentLine,n=this._compound_statement();return this._updateNode(new D(n,e),t)}_for_statement(){if(!this._match(je.keywords.for))return null;this._consume(je.tokens.paren_left,"Expected '('.");const e=this._updateNode(new B(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(je.tokens.semicolon)?null:this._for_init(),this._consume(je.tokens.semicolon,"Expected ';'."),e.condition=this._check(je.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(je.tokens.semicolon,"Expected ';'."),e.increment=this._check(je.tokens.paren_right)?null:this._for_increment(),this._consume(je.tokens.paren_right,"Expected ')'."),this._check(je.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(je.keywords.var)){const e=this._variable_decl();if(null===e)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(je.tokens.equal)&&(t=this._short_circuit_or_expression()),this._updateNode(new U(e.name,e.type,e.storage,e.access,t),e.line)}if(this._match(je.keywords.let)){const e=this._currentLine,t=this._consume(je.tokens.name,"Expected name for let.").toString();let n=null;if(this._match(je.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}this._consume(je.tokens.equal,"Expected '=' for let.");const r=this._short_circuit_or_expression();return this._updateNode(new G(t,n,null,null,r),e)}if(this._match(je.keywords.const)){const e=this._currentLine,t=this._consume(je.tokens.name,"Expected name for const.").toString();let n=null;if(this._match(je.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}this._consume(je.tokens.equal,"Expected '=' for const.");const r=this._short_circuit_or_expression();return null===n&&r instanceof ye&&(n=r.type),this._updateNode(new $(t,n,null,null,r),e)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(null==t)return null;if(!this._check(je.increment_operators))return this._current=e,null;const n=this._consume(je.increment_operators,"Expected increment operator");return this._updateNode(new X(n.type===je.tokens.plus_plus?W.increment:W.decrement,t))}_assignment_statement(){let e=null;const t=this._currentLine;if(this._check(je.tokens.brace_right))return null;let n=this._match(je.tokens.underscore);if(n||(e=this._unary_expression()),!n&&null==e)return null;const r=this._consume(je.assignment_operators,"Expected assignment operator."),s=this._short_circuit_or_expression();return this._updateNode(new q(j.parse(r.lexeme),e,s),t)}_func_call_statement(){if(!this._check(je.tokens.ident))return null;const e=this._currentLine,t=this._current,n=this._consume(je.tokens.ident,"Expected function name."),r=this._argument_expression_list();return null===r?(this._current=t,null):this._updateNode(new Y(n.lexeme,r),e)}_loop_statement(){if(!this._match(je.keywords.loop))return null;this._check(je.tokens.attr)&&this._attribute(),this._consume(je.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new K([],null));this._currentLoop.push(e);let t=this._statement();for(;null!==t;){if(Array.isArray(t))for(let n of t)e.body.push(n);else e.body.push(t);if(t instanceof D){e.continuing=t;break}t=this._statement()}return this._currentLoop.pop(),this._consume(je.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(je.keywords.switch))return null;const e=this._updateNode(new Z(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(je.tokens.attr)&&this._attribute(),this._consume(je.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),null==e.cases||0==e.cases.length)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(je.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let t=!1;for(;this._check([je.keywords.default,je.keywords.case]);){if(this._match(je.keywords.case)){const n=this._case_selectors();for(const e of n)if(e instanceof Re){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");t=!0;break}this._match(je.tokens.colon),this._check(je.tokens.attr)&&this._attribute(),this._consume(je.tokens.brace_left,"Exected '{' for switch case.");const r=this._case_body();this._consume(je.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new Ie(n,r)))}if(this._match(je.keywords.default)){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(je.tokens.colon),this._check(je.tokens.attr)&&this._attribute(),this._consume(je.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(je.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new Ce(n)))}}return e}_case_selectors(){const e=[];for(this._match(je.keywords.default)?e.push(this._updateNode(new Re)):e.push(this._shift_expression());this._match(je.tokens.comma);)this._match(je.keywords.default)?e.push(this._updateNode(new Re)):e.push(this._shift_expression());return e}_case_body(){if(this._match(je.keywords.fallthrough))return this._consume(je.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(null==e)return[];e instanceof Array||(e=[e]);const t=this._case_body();return 0==t.length?e:[...e,t[0]]}_if_statement(){if(!this._match(je.keywords.if))return null;const e=this._currentLine,t=this._optional_paren_expression();this._check(je.tokens.attr)&&this._attribute();const n=this._compound_statement();let r=[];this._match_elseif()&&(this._check(je.tokens.attr)&&this._attribute(),r=this._elseif_statement(r));let s=null;return this._match(je.keywords.else)&&(this._check(je.tokens.attr)&&this._attribute(),s=this._compound_statement()),this._updateNode(new Q(t,n,r,s),e)}_match_elseif(){return this._tokens[this._current].type===je.keywords.else&&this._tokens[this._current+1].type===je.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const t=this._optional_paren_expression(),n=this._compound_statement();return e.push(this._updateNode(new Le(t,n))),this._match_elseif()&&(this._check(je.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(je.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new J(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(je.tokens.or_or);)e=this._updateNode(new Ae(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(je.tokens.and_and);)e=this._updateNode(new Ae(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(je.tokens.or);)e=this._updateNode(new Ae(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(je.tokens.xor);)e=this._updateNode(new Ae(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(je.tokens.and);)e=this._updateNode(new Ae(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([je.tokens.equal_equal,je.tokens.not_equal])?this._updateNode(new Ae(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([je.tokens.less_than,je.tokens.greater_than,je.tokens.less_than_equal,je.tokens.greater_than_equal]);)e=this._updateNode(new Ae(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([je.tokens.shift_left,je.tokens.shift_right]);)e=this._updateNode(new Ae(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([je.tokens.plus,je.tokens.minus]);)e=this._updateNode(new Ae(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([je.tokens.star,je.tokens.forward_slash,je.tokens.modulo]);)e=this._updateNode(new Ae(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([je.tokens.minus,je.tokens.bang,je.tokens.tilde,je.tokens.star,je.tokens.and])?this._updateNode(new Te(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(je.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(je.tokens.bracket_right,"Expected ']'.");const t=this._updateNode(new we(e)),n=this._postfix_expression();return n&&(t.postfix=n),t}if(this._match(je.tokens.period)){const e=this._consume(je.tokens.name,"Expected member name."),t=this._postfix_expression(),n=this._updateNode(new ge(e.lexeme));return t&&(n.postfix=t),n}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const t=this._getStruct(e);if(null!==t)return t;switch(e){case"void":return ae.void;case"bool":return ae.bool;case"i32":return ae.i32;case"u32":return ae.u32;case"f32":return ae.f32;case"f16":return ae.f16;case"vec2f":return ue.vec2f;case"vec3f":return ue.vec3f;case"vec4f":return ue.vec4f;case"vec2i":return ue.vec2i;case"vec3i":return ue.vec3i;case"vec4i":return ue.vec4i;case"vec2u":return ue.vec2u;case"vec3u":return ue.vec3u;case"vec4u":return ue.vec4u;case"vec2h":return ue.vec2h;case"vec3h":return ue.vec3h;case"vec4h":return ue.vec4h;case"mat2x2f":return ue.mat2x2f;case"mat2x3f":return ue.mat2x3f;case"mat2x4f":return ue.mat2x4f;case"mat3x2f":return ue.mat3x2f;case"mat3x3f":return ue.mat3x3f;case"mat3x4f":return ue.mat3x4f;case"mat4x2f":return ue.mat4x2f;case"mat4x3f":return ue.mat4x3f;case"mat4x4f":return ue.mat4x4f;case"mat2x2h":return ue.mat2x2h;case"mat2x3h":return ue.mat2x3h;case"mat2x4h":return ue.mat2x4h;case"mat3x2h":return ue.mat3x2h;case"mat3x3h":return ue.mat3x3h;case"mat3x4h":return ue.mat3x4h;case"mat4x2h":return ue.mat4x2h;case"mat4x3h":return ue.mat4x3h;case"mat4x4h":return ue.mat4x4h;case"mat2x2i":return ue.mat2x2i;case"mat2x3i":return ue.mat2x3i;case"mat2x4i":return ue.mat2x4i;case"mat3x2i":return ue.mat3x2i;case"mat3x3i":return ue.mat3x3i;case"mat3x4i":return ue.mat3x4i;case"mat4x2i":return ue.mat4x2i;case"mat4x3i":return ue.mat4x3i;case"mat4x4i":return ue.mat4x4i;case"mat2x2u":return ue.mat2x2u;case"mat2x3u":return ue.mat2x3u;case"mat2x4u":return ue.mat2x4u;case"mat3x2u":return ue.mat3x2u;case"mat3x3u":return ue.mat3x3u;case"mat3x4u":return ue.mat3x4u;case"mat4x2u":return ue.mat4x2u;case"mat4x3u":return ue.mat4x3u;case"mat4x4u":return ue.mat4x4u}return null}_validateTypeRange(e,t){if("i32"===t.name){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if("u32"===t.name&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(je.tokens.ident)){const e=this._previous().toString();if(this._check(je.tokens.paren_left)){const t=this._argument_expression_list(),n=this._getType(e);return null!==n?this._updateNode(new _e(n,t)):this._updateNode(new me(e,t))}if(this._context.constants.has(e)){const t=this._context.constants.get(e);return this._updateNode(new be(e,t.value))}return this._updateNode(new ve(e))}if(this._match(je.tokens.int_literal)){const e=this._previous().toString();let t=e.endsWith("i")||e.endsWith("i")?ae.i32:e.endsWith("u")||e.endsWith("U")?ae.u32:ae.x32;const n=parseInt(e);return this._validateTypeRange(n,t),this._updateNode(new ye(new De(n,this._exec.getTypeInfo(t)),t))}if(this._match(je.tokens.uint_literal)){const e=parseInt(this._previous().toString());return this._validateTypeRange(e,ae.u32),this._updateNode(new ye(new De(e,this._exec.getTypeInfo(ae.u32)),ae.u32))}if(this._match([je.tokens.decimal_float_literal,je.tokens.hex_float_literal])){let e=this._previous().toString(),t=e.endsWith("h");t&&(e=e.substring(0,e.length-1));const n=parseFloat(e);this._validateTypeRange(n,t?ae.f16:ae.f32);const r=t?ae.f16:ae.f32;return this._updateNode(new ye(new De(n,this._exec.getTypeInfo(r)),r))}if(this._match([je.keywords.true,je.keywords.false])){let e=this._previous().toString()===je.keywords.true.rule;return this._updateNode(new ye(new De(e?1:0,this._exec.getTypeInfo(ae.bool)),ae.bool))}if(this._check(je.tokens.paren_left))return this._paren_expression();if(this._match(je.keywords.bitcast)){this._consume(je.tokens.less_than,"Expected '<'.");const e=this._type_decl();this._consume(je.tokens.greater_than,"Expected '>'.");const t=this._paren_expression();return this._updateNode(new Ee(e,t))}const e=this._type_decl(),t=this._argument_expression_list();return this._updateNode(new _e(e,t))}_argument_expression_list(){if(!this._match(je.tokens.paren_left))return null;const e=[];do{if(this._check(je.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(je.tokens.comma));return this._consume(je.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(je.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(je.tokens.paren_right),e}_paren_expression(){this._consume(je.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(je.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(je.keywords.struct))return null;const e=this._currentLine,t=this._consume(je.tokens.ident,"Expected name for struct.").toString();this._consume(je.tokens.brace_left,"Expected '{' for struct body.");const n=[];for(;!this._check(je.tokens.brace_right);){const e=this._attribute(),t=this._consume(je.tokens.name,"Expected variable name.").toString();this._consume(je.tokens.colon,"Expected ':' for struct member type.");const r=this._attribute(),s=this._type_decl();null!=s&&(s.attributes=r),this._check(je.tokens.brace_right)?this._match(je.tokens.comma):this._consume(je.tokens.comma,"Expected ',' for struct member."),n.push(this._updateNode(new Me(t,s,e)))}this._consume(je.tokens.brace_right,"Expected '}' after struct body.");const r=this._currentLine,s=this._updateNode(new le(t,n,e,r),e);return this._context.structs.set(t,s),s}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(je.tokens.equal)){const t=this._const_expression();e.value=t}if(null!==e.type&&e.value instanceof ye){if("x32"!==e.value.type.name&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else null===e.type&&e.value instanceof ye&&(e.type="x32"===e.value.type.name?ae.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(je.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(je.keywords.const))return null;const t=this._consume(je.tokens.name,"Expected variable name"),n=this._currentLine;let r=null;if(this._match(je.tokens.colon)){const e=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=e)}let s=null;this._consume(je.tokens.equal,"const declarations require an assignment");const i=this._short_circuit_or_expression();try{let e=[ae.f32],n=i.constEvaluate(this._exec,e);n instanceof De&&this._validateTypeRange(n.value,e[0]),e[0]instanceof ue&&null===e[0].format&&n.typeInfo instanceof c&&null!==n.typeInfo.format&&("f16"===n.typeInfo.format.name?e[0].format=ae.f16:"f32"===n.typeInfo.format.name?e[0].format=ae.f32:"i32"===n.typeInfo.format.name?e[0].format=ae.i32:"u32"===n.typeInfo.format.name?e[0].format=ae.u32:"bool"===n.typeInfo.format.name?e[0].format=ae.bool:console.error(`TODO: impelement template format type ${n.typeInfo.format.name}`)),s=this._updateNode(new ye(n,e[0])),this._exec.context.setVariable(t.toString(),n)}catch(e){s=i}if(null!==r&&s instanceof ye){if("x32"!==s.type.name&&r.getTypeName()!==s.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${s.type.name} to ${r.name}. Line:${this._currentLine}`);s.type=r,s.isScalar&&this._validateTypeRange(s.scalarValue,s.type)}else null===r&&s instanceof ye&&(r=null!==(e=null==s?void 0:s.type)&&void 0!==e?e:ae.f32,r===ae.x32&&(r=ae.i32));const o=this._updateNode(new $(t.toString(),r,"","",s),n);return this._context.constants.set(o.name,o),o}_global_let_decl(){if(!this._match(je.keywords.let))return null;const e=this._currentLine,t=this._consume(je.tokens.name,"Expected variable name");let n=null;if(this._match(je.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}let r=null;if(this._match(je.tokens.equal)&&(r=this._const_expression()),null!==n&&r instanceof ye){if("x32"!==r.type.name&&n.getTypeName()!==r.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${r.type.name} to ${n.name}. Line:${this._currentLine}`);r.type=n}else null===n&&r instanceof ye&&(n="x32"===r.type.name?ae.i32:r.type);return r instanceof ye&&r.isScalar&&this._validateTypeRange(r.scalarValue,n),this._updateNode(new G(t.toString(),n,"","",r),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(je.keywords.var))return null;const e=this._currentLine;let t="",n="";this._match(je.tokens.less_than)&&(t=this._consume(je.storage_class,"Expected storage_class.").toString(),this._match(je.tokens.comma)&&(n=this._consume(je.access_mode,"Expected access_mode.").toString()),this._consume(je.tokens.greater_than,"Expected '>'."));const r=this._consume(je.tokens.name,"Expected variable name");let s=null;if(this._match(je.tokens.colon)){const e=this._attribute();s=this._type_decl(),null!=s&&(s.attributes=e)}return this._updateNode(new U(r.toString(),s,t,n,null),e)}_override_decl(){if(!this._match(je.keywords.override))return null;const e=this._consume(je.tokens.name,"Expected variable name");let t=null;if(this._match(je.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}return this._updateNode(new V(e.toString(),t,null))}_diagnostic(){this._consume(je.tokens.paren_left,"Expected '('");const e=this._consume(je.tokens.ident,"Expected severity control name.");this._consume(je.tokens.comma,"Expected ','");let t=this._consume(je.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(je.tokens.period)&&(t+=`.${this._consume(je.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(je.tokens.paren_right,"Expected ')'"),this._updateNode(new ne(e.toString(),t))}_enable_directive(){const e=this._consume(je.tokens.ident,"identity expected.");return this._updateNode(new ee(e.toString()))}_requires_directive(){const e=[this._consume(je.tokens.ident,"identity expected.").toString()];for(;this._match(je.tokens.comma);){const t=this._consume(je.tokens.ident,"identity expected.");e.push(t.toString())}return this._updateNode(new te(e))}_type_alias(){const e=this._consume(je.tokens.ident,"identity expected.");this._consume(je.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(null===t)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const n=this._updateNode(new re(e.toString(),t));return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([je.tokens.ident,...je.texel_format,je.keywords.bool,je.keywords.f32,je.keywords.i32,je.keywords.u32])){const e=this._advance().toString();if(this._context.structs.has(e))return this._context.structs.get(e);if(this._context.aliases.has(e))return this._context.aliases.get(e).type;if(!this._getType(e)){const t=this._updateNode(new ce(e));return this._forwardTypeCount++,t}return this._updateNode(new ae(e))}let e=this._texture_sampler_types();if(e)return e;if(this._check(je.template_types)){let e=this._advance().toString(),t=null,n=null;return this._match(je.tokens.less_than)&&(t=this._type_decl(),n=null,this._match(je.tokens.comma)&&(n=this._consume(je.access_mode,"Expected access_mode for pointer").toString()),this._consume(je.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new ue(e,t,n))}if(this._match(je.keywords.ptr)){let e=this._previous().toString();this._consume(je.tokens.less_than,"Expected '<' for pointer.");const t=this._consume(je.storage_class,"Expected storage_class for pointer");this._consume(je.tokens.comma,"Expected ',' for pointer.");const n=this._type_decl();let r=null;return this._match(je.tokens.comma)&&(r=this._consume(je.access_mode,"Expected access_mode for pointer").toString()),this._consume(je.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new he(e,t.toString(),n,r))}const t=this._attribute();if(this._match(je.keywords.array)){let n=null,r=-1;const s=this._previous();let i=null;if(this._match(je.tokens.less_than)){n=this._type_decl(),this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);let t="";if(this._match(je.tokens.comma)){i=this._shift_expression();try{t=i.constEvaluate(this._exec).toString(),i=null}catch(e){t="1"}}this._consume(je.tokens.greater_than,"Expected '>' for array."),r=t?parseInt(t):0}const o=this._updateNode(new de(s.toString(),t,n,r));return i&&this._deferArrayCountEval.push({arrayType:o,countNode:i}),o}return null}_texture_sampler_types(){if(this._match(je.sampler_type))return this._updateNode(new fe(this._previous().toString(),null,null));if(this._match(je.depth_texture_type))return this._updateNode(new fe(this._previous().toString(),null,null));if(this._match(je.sampled_texture_type)||this._match(je.multisampled_texture_type)){const e=this._previous();this._consume(je.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(je.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new fe(e.toString(),t,null))}if(this._match(je.storage_texture_type)){const e=this._previous();this._consume(je.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(je.texel_format,"Invalid texel format.").toString();this._consume(je.tokens.comma,"Expected ',' after texel format.");const n=this._consume(je.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(je.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new fe(e.toString(),t,n))}return null}_attribute(){let e=[];for(;this._match(je.tokens.attr);){const t=this._consume(je.attribute_name,"Expected attribute name"),n=this._updateNode(new ke(t.toString(),null));if(this._match(je.tokens.paren_left)){if(n.value=this._consume(je.literal_or_ident,"Expected attribute value").toString(),this._check(je.tokens.comma)){this._advance();do{const e=this._consume(je.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(e)}while(this._match(je.tokens.comma))}this._consume(je.tokens.paren_right,"Expected ')'")}e.push(n)}return 0==e.length?null:e}}class vt extends ot{constructor(e){super(),e&&this.update(e)}update(e){const t=(new mt).parse(e);this.updateAST(t)}}},54128:(e,t,n)=>{n.d(t,{K:()=>i});var r=n(86231),s=n(49187);function i(e,t){const n={attributes:[],bindings:[]};n.attributes=function(e,t){const n=[],r=e.getProgramParameter(t,35721);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i);if(!r)throw new Error("activeInfo");const{name:o,type:a}=r,c=e.getAttribLocation(t,o);if(c>=0){const e=(0,s.rz)(a),t=/instance/i.test(o)?"instance":"vertex";n.push({name:o,location:c,stepMode:t,type:e})}}return n.sort((e,t)=>e.location-t.location),n}(e,t);const i=function(e,t){const n=(n,r)=>e.getActiveUniformBlockParameter(t,n,r),r=[],i=e.getProgramParameter(t,35382);for(let o=0;o<i;o++){const i={name:e.getActiveUniformBlockName(t,o)||"",location:n(o,35391),byteLength:n(o,35392),vertex:n(o,35396),fragment:n(o,35398),uniformCount:n(o,35394),uniforms:[]},a=n(o,35395)||[],c=e.getActiveUniforms(t,a,35383),l=e.getActiveUniforms(t,a,35384),u=e.getActiveUniforms(t,a,35387),h=e.getActiveUniforms(t,a,35388);for(let n=0;n<i.uniformCount;++n){const r=e.getActiveUniform(t,a[n]);if(!r)throw new Error("activeInfo");const o=(0,s.rz)(c[n]);i.uniforms.push({name:r.name,format:o,type:c[n],arrayLength:l[n],byteOffset:u[n],byteStride:h[n]})}r.push(i)}return r.sort((e,t)=>e.location-t.location),r}(e,t);for(const r of i){const e=r.uniforms.map(e=>({name:e.name,format:e.format,byteOffset:e.byteOffset,byteStride:e.byteStride,arrayLength:e.arrayLength}));n.bindings.push({type:"uniform",name:r.name,group:0,location:r.location,visibility:(r.vertex?1:0)&(r.fragment?2:0),minBindingSize:r.byteLength,uniforms:e})}const a=function(e,t){const n=[],r=e.getProgramParameter(t,35718);for(let s=0;s<r;s++){const r=e.getActiveUniform(t,s);if(!r)throw new Error("activeInfo");const{name:i,size:a,type:c}=r,{name:l,isArray:u}=o(i);let h=e.getUniformLocation(t,l);const d={location:h,name:l,size:a,type:c,isArray:u};if(n.push(d),d.size>1)for(let s=0;s<d.size;s++){const r=`${l}[${s}]`;h=e.getUniformLocation(t,r);const i={...d,name:r,location:h};n.push(i)}}return n}(e,t);let c=0;for(const r of a)if((0,s.MS)(r.type)){const{viewDimension:e,sampleType:t}=(0,s.OA)(r.type);n.bindings.push({type:"texture",name:r.name,group:0,location:c,viewDimension:e,sampleType:t}),r.textureUnit=c,c+=1}a.length&&(n.uniforms=a);const l=function(e,t){const n=[],i=e.getProgramParameter(t,35971);for(let o=0;o<i;o++){const i=e.getTransformFeedbackVarying(t,o);if(!i)throw new Error("activeInfo");const{name:a,type:c,size:l}=i,u=(0,s.rz)(c),{type:h,components:d}=(0,r.k0)(u);n.push({location:o,name:a,type:h,size:l*d})}return n.sort((e,t)=>e.location-t.location),n}(e,t);return l?.length&&(n.varyings=l),n}function o(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${e}`);return{name:t[1],length:t[2]?1:0,isArray:Boolean(t[2])}}},54272:(e,t,n)=>{n.d(t,{M:()=>o});var r=n(58073),s=n(73731),i=n(4990);class o extends r.a{get x(){return this[0]}set x(e){this[0]=(0,s.ws)(e)}get y(){return this[1]}set y(e){this[1]=(0,s.ws)(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-e[n];t+=r*r}return(0,s.ws)(t)}dot(e){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return(0,s.ws)(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t[e];return this.check()}divide(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t[e];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return(0,i.v)(e>=0&&e<this.ELEMENTS,"index is out of range"),(0,s.ws)(this[e])}setComponent(e,t){return(0,i.v)(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}},54787:(e,t,n)=>{n.d(t,{W:()=>i,l:()=>s});var r=n(85753);function s(e,t,n){if(e)for(const s of(0,r.M)(t))e.addEventListener(s,n,!1)}function i(e,t,n){if(e)for(const s of(0,r.M)(t))e.removeEventListener(s,n,!1)}},54901:(e,t,n)=>{n.d(t,{$W:()=>r,Cc:()=>a,Fl:()=>s,aI:()=>c,cy:()=>i,qE:()=>o});Math.PI,Math.PI;globalThis.mathgl=globalThis.mathgl||{config:{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1}};const r=globalThis.mathgl.config;function s(e,{precision:t=r.precision}={}){return e=function(e){return Math.round(e/r.EPSILON)*r.EPSILON}(e),`${parseFloat(e.toPrecision(t))}`}function i(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function o(e,t,n){return l(e,e=>Math.max(t,Math.min(n,e)))}function a(e,t,n){return i(e)?e.map((e,r)=>a(e,t[r],n)):n*t+(1-n)*e}function c(e,t,n){const s=r.EPSILON;n&&(r.EPSILON=n);try{if(e===t)return!0;if(i(e)&&i(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!c(e[n],t[n]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):"number"==typeof e&&"number"==typeof t&&Math.abs(e-t)<=r.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{r.EPSILON=s}}function l(e,t,n){if(i(e)){const r=e;n=n||function(e){return e.clone?e.clone():new Array(e.length)}(r);for(let s=0;s<n.length&&s<r.length;++s){const r="number"==typeof e?e:e[s];n[s]=t(r,s,n)}return n}return t(e)}},55026:(e,t,n)=>{n.d(t,{T:()=>r,b:()=>s});const r="#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",s="#ifdef MODULE_MATERIAL\n  fragColor = material_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  fragColor = lighting_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_FOG\n  fragColor = fog_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  fragColor = picking_filterHighlightColor(fragColor);\n  fragColor = picking_filterPickingColor(fragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},55482:(e,t,n)=>{n.d(t,{D:()=>r});class r{constructor(e,t,n="sessionStorage"){this.storage=function(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch(t){return null}}(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}},55607:(e,t,n)=>{n.d(t,{Q:()=>s,x:()=>r});const r="latest";const s=(globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version)},55904:(e,t,n)=>{function r(e,t){const n=t.x-e.x,r=t.y-e.y;return 180*Math.atan2(r,n)/Math.PI}function s(e,t){const n=t.clientX-e.clientX,r=t.clientY-e.clientY;return 180*Math.atan2(r,n)/Math.PI}n.d(t,{U:()=>r,q:()=>s})},56769:(e,t,n)=>{n.d(t,{p:()=>r});class r{constructor(e,t,n){this.element=e,this.callback=t,this.options=n}}},56980:(e,t,n)=>{n.d(t,{A:()=>f});var r=n(3726),s=n(88976),i=n(65424),o=n(12897),a=n(3459),c=n(43411),l=n(38055),u=n(88755),h=n(70504),d=n(47345);class f{constructor(e,t){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=e=>{(0,c.A)("layerManager.activateViewport",this,e),e&&(this.context.viewport=e)};const{deck:n,stats:o,viewport:a,timeline:l}=t||{};this.layers=[],this.resourceManager=new h.A({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:n,shaderAssembler:(0,s.cN)(e?.info?.shadingLanguage||"glsl"),defaultShaderModules:[i.B],renderPass:void 0,stats:o||new u.A({id:"deck.gl"}),viewport:a||new d.A({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:l||new r.K,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(t=>e.find(e=>0===t.id.indexOf(e))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){(0,c.A)("layerManager.setLayers",this,t,e),this._lastRenderedLayers=e;const n=(0,l.B)(e,Boolean);for(const r of n)r.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:t}=this.context;t.find(t=>t.name===e.name)||(t.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:t}=this.context,n=t.findIndex(t=>t.name===e.name);n>=0&&(t.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(e,t,n){n.raiseError(t,`${e} of ${n}`)}_updateLayers(e,t){const n={};for(const i of e)n[i.id]?a.A.warn(`Multiple old layers with same id ${i.id}`)():n[i.id]=i;if(this._defaultShaderModulesChanged){for(const t of e)t.setNeedsUpdate(),t.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const r=[];this._updateSublayersRecursively(t,n,r),this._finalizeOldLayers(n);let s=!1;for(const i of r)if(i.hasUniformTransition()){s=`Uniform transition in ${i}`;break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,n){for(const s of e){s.context=this.context;const e=t[s.id];null===e&&a.A.warn(`Multiple new layers with same id ${s.id}`)(),t[s.id]=null;let i=null;try{this._debug&&e!==s&&s.validateProps(),e?(this._transferLayerState(e,s),this._updateLayer(s)):this._initializeLayer(s),n.push(s),i=s.isComposite?s.getSubLayers():null}catch(r){this._handleError("matching",r,s)}i&&this._updateSublayersRecursively(i,t,n)}}_finalizeOldLayers(e){for(const t in e){const n=e[t];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=o.VD.INITIALIZED}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=o.VD.MATCHED,t!==e&&(e.lifecycle=o.VD.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=o.VD.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=o.VD.FINALIZED}catch(t){this._handleError("finalization",t,e)}}}},57516:(e,t,n)=>{function r(e){const{target:t,source:n,start:r=0,count:s=1}=e,i=n.length,o=s*i;let a=0;for(let c=r;a<i;a++)t[c++]=n[a];for(;a<o;)a<o-a?(t.copyWithin(r+a,r,r+a),a*=2):(t.copyWithin(r+a,r,r+o-a),a=o);return e.target}n.d(t,{R:()=>r})},57662:(e,t,n)=>{n.d(t,{o:()=>c});var r=n(36157),s=n(88171),i=n(77264),o=n(93871);const a=["","start","move","end","cancel","up","down","left","right"];class c extends r.o{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:s.e8.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,t=[];return e&s.e8.Horizontal&&t.push(o.LU),e&s.e8.Vertical&&t.push(o.Sw),t}getEventNames(){return a.map(e=>this.options.event+e)}directionTest(e){const{options:t}=this;let n=!0,{distance:r}=e,{direction:i}=e;const o=e.deltaX,a=e.deltaY;return i&t.direction||(t.direction&s.e8.Horizontal?(i=0===o?s.e8.None:o<0?s.e8.Left:s.e8.Right,n=o!==this.pX,r=Math.abs(e.deltaX)):(i=0===a?s.e8.None:a<0?s.e8.Up:s.e8.Down,n=a!==this.pY,r=Math.abs(e.deltaY))),e.direction=i,n&&r>t.threshold&&Boolean(i&t.direction)}attrTest(e){return super.attrTest(e)&&(Boolean(this.state&i.g.Began)||!(this.state&i.g.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const t=s.e8[e.direction].toLowerCase();t&&(e.additionalEvent=this.options.event+t),super.emit(e)}}},57856:(e,t,n)=>{n.d(t,{d:()=>s});var r=n(5153);class s extends r.F{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,s.defaultProps)}static defaultProps={...r.F.defaultProps,type:void 0,count:void 0}}},58073:(e,t,n)=>{n.d(t,{a:()=>s});var r=n(54901);class s extends Array{clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}toArray(e=[],t=0){for(let n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:(0,r.cy)(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(r.$W)}formatString(e){let t="";for(let n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+(0,r.Fl)(this[n],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!(0,r.aI)(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,n){if(void 0===n)return this.lerp(this,e,t);for(let r=0;r<this.ELEMENTS;++r){const s=e[r],i="number"==typeof t?t:t[r];this[r]=s+n*(i-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}add(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]+=t[e];return this.check()}subtract(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]-=t[e];return this.check()}scale(e){if("number"==typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(r.$W.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}get elements(){return this}}},58373:(e,t,n)=>{n.d(t,{A:()=>_});var r=n(9350),s=n(31327),i=n(87597),o=n(31886),a=n(82417),c=n(73279);const l="\nuniform shadowUniforms {\n  bool drawShadowMap;\n  bool useShadowMap;\n  vec4 color;\n  highp int lightId;\n  float lightCount;\n  mat4 viewProjectionMatrix0;\n  mat4 viewProjectionMatrix1;\n  vec4 projectCenter0;\n  vec4 projectCenter1;\n} shadow;\n",u=`\n${l}\n\nconst int max_lights = 2;\n\nout vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  mat4 viewProjectionMatrices[max_lights];\n  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;\n  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;\n  vec4 projectCenters[max_lights];\n  projectCenters[0] = shadow.projectCenter0;\n  projectCenters[1] = shadow.projectCenter1;\n\n  if (shadow.drawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);\n  }\n  if (shadow.useShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow.lightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n\n`,h=`\n${l}\n\nconst int max_lights = 2;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\n\nin vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow.drawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow.useShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow.lightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow.color.a / shadow.lightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n\n`,d=(0,a.A)(function({viewport:e,center:t}){return new o.k(e.viewProjectionMatrix).invert().transform(t)}),f=(0,a.A)(function({viewport:e,shadowMatrices:t}){const n=[],r=e.pixelUnprojectionMatrix,s=e.isGeospatial?void 0:1,a=[[0,0,s],[e.width,0,s],[0,e.height,s],[e.width,e.height,s],[0,0,-1],[e.width,0,-1],[0,e.height,-1],[e.width,e.height,-1]].map(e=>function(e,t){const[n,r,s]=e,i=(0,c.xJ)([n,r,s],t);if(Number.isFinite(s))return i;return[i[0],i[1],0]}(e,r));for(const c of t){const t=c.clone().translate(new i.P(e.center).negate()),r=a.map(e=>t.transform(e)),s=(new o.k).ortho({left:Math.min(...r.map(e=>e[0])),right:Math.max(...r.map(e=>e[0])),bottom:Math.min(...r.map(e=>e[1])),top:Math.max(...r.map(e=>e[1])),near:Math.min(...r.map(e=>-e[2])),far:Math.max(...r.map(e=>-e[2]))});n.push(s.multiplyRight(c))}return n}),p=[0,0,0,1],g=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];const _={name:"shadow",dependencies:[s.A],vs:u,fs:h,inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:function(e){const{shadowEnabled:t=!0,project:n}=e;if(!(t&&n&&e.shadowMatrices&&e.shadowMatrices.length))return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};const o=s.A.getUniforms(n),a=d({viewport:n.viewport,center:o.center}),c=[],l=f({shadowMatrices:e.shadowMatrices,viewport:n.viewport}).slice();for(let s=0;s<e.shadowMatrices.length;s++){const e=l[s],t=e.clone().translate(new i.P(n.viewport.center).negate());o.coordinateSystem===r.rf.LNGLAT&&o.projectionMode===r.Kx.WEB_MERCATOR?(l[s]=t,c[s]=a):(l[s]=e.clone().multiplyRight(g),c[s]=t.transform(a))}const u={drawShadowMap:Boolean(e.drawToShadowMap),useShadowMap:!!e.shadowMaps&&e.shadowMaps.length>0,color:e.shadowColor||p,lightId:e.shadowLightId||0,lightCount:e.shadowMatrices.length,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};for(let r=0;r<l.length;r++)u[`viewProjectionMatrix${r}`]=l[r],u[`projectCenter${r}`]=c[r];for(let r=0;r<2;r++)u[`shadow_uShadowMap${r}`]=e.shadowMaps&&e.shadowMaps[r]||e.dummyShadowMap;return u},uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}}},58587:(e,t,n)=>{n.d(t,{N:()=>s});var r=n(68643);function s(e,t){const n=e.getParameter(7936),s=e.getParameter(7937);(0,r.T)(e,"WEBGL_debug_renderer_info",t);const o=t.WEBGL_debug_renderer_info,a=e.getParameter(o?o.UNMASKED_VENDOR_WEBGL:7936)||n,c=e.getParameter(o?o.UNMASKED_RENDERER_WEBGL:7937)||s,l=e.getParameter(7938),u=i(a,c),h=function(e,t){if(/Metal/i.exec(e)||/Metal/i.exec(t))return"metal";if(/ANGLE/i.exec(e)||/ANGLE/i.exec(t))return"opengl";return"unknown"}(a,c),d=function(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(i(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}(a,c);return{type:"webgl",gpu:u,gpuType:d,gpuBackend:h,vendor:a,renderer:c,version:l,shadingLanguage:"glsl",shadingLanguageVersion:300}}function i(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}},58813:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(54901),s=n(2357);class i extends s.A{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:n,duration:s,easing:i}}=this,o=i(e/s);this._value=(0,r.Cc)(t,n,o)}}},59583:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(88171),s=n(42947);function i(e,t,n){const i=n.pointers.length,o=n.changedPointers.length,a=t&r.TL.Start&&i-o===0,c=t&(r.TL.End|r.TL.Cancel)&&i-o===0;n.isFirst=Boolean(a),n.isFinal=Boolean(c),a&&(e.session={}),n.eventType=t;const l=(0,s.w)(e,n);e.emit("hammer.input",l),e.recognize(l),e.session.prevInput=l}},60517:(e,t,n)=>{n.d(t,{Q:()=>o});var r=n(74003),s=n(74683),i=n(45728);class o{static isHTMLCanvas(e){return"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement}static isOffscreenCanvas(e){return"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas}static defaultProps={id:void 0,canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb",trackPosition:!1};id;props;canvas;htmlCanvas;offscreenCanvas;type;initialized;isInitialized=!1;isVisible=!0;cssWidth;cssHeight;devicePixelRatio;devicePixelWidth;devicePixelHeight;drawingBufferWidth;drawingBufferHeight;_initializedResolvers=(0,i.Y)();_resizeObserver;_intersectionObserver;_position;destroyed=!1;toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...o.defaultProps,...e},e=this.props,this.initialized=this._initializedResolvers.promise,(0,r.B)()?e.canvas?"string"==typeof e.canvas?this.canvas=function(e){const t=document.getElementById(e);if(!o.isHTMLCanvas(t))throw new Error("Object is not a canvas element");return t}(e.canvas):this.canvas=e.canvas:this.canvas=function(e){const{width:t,height:n}=e,r=document.createElement("canvas");r.id=(0,s.L)("lumagl-auto-created-canvas"),r.width=t||1,r.height=n||1,r.style.width=Number.isFinite(t)?`${t}px`:"100%",r.style.height=Number.isFinite(n)?`${n}px`:"100%",e?.visible||(r.style.visibility="hidden");const i=function(e){if("string"==typeof e){const t=document.getElementById(e);if(!t)throw new Error(`${e} is not an HTML element`);return t}if(e)return e;return document.body}(e?.container||null);return i.insertBefore(r,i.firstChild),r}(e):this.canvas={width:e.width||1,height:e.height||1},o.isHTMLCanvas(this.canvas)?(this.id=e.id||this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):o.isOffscreenCanvas(this.canvas)?(this.id=e.id||"offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas):(this.id=e.id||"node-canvas-context",this.type="node"),this.cssWidth=this.htmlCanvas?.clientWidth||this.canvas.width,this.cssHeight=this.htmlCanvas?.clientHeight||this.canvas.height,this.devicePixelWidth=this.canvas.width,this.devicePixelHeight=this.canvas.height,this.drawingBufferWidth=this.canvas.width,this.drawingBufferHeight=this.canvas.height,this.devicePixelRatio=globalThis.devicePixelRatio||1,this._position=[0,0],o.isHTMLCanvas(this.canvas)){this._intersectionObserver=new IntersectionObserver(e=>this._handleIntersection(e)),this._intersectionObserver.observe(this.canvas),this._resizeObserver=new ResizeObserver(e=>this._handleResize(e));try{this._resizeObserver.observe(this.canvas,{box:"device-pixel-content-box"})}catch{this._resizeObserver.observe(this.canvas,{box:"content-box"})}setTimeout(()=>this._observeDevicePixelRatio(),0),this.props.trackPosition&&this._trackPosition()}}destroy(){this.destroyed=!0}setProps(e){return"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1,this._updateDrawingBufferSize()),this}getCSSSize(){return[this.cssWidth,this.cssHeight]}getPosition(){return this._position}getDevicePixelSize(){return[this.devicePixelWidth,this.devicePixelHeight]}getDrawingBufferSize(){return[this.drawingBufferWidth,this.drawingBufferHeight]}getMaxDrawingBufferSize(){const e=this.device.limits.maxTextureDimension2D;return[e,e]}setDrawingBufferSize(e,t){this.canvas.width=e,this.canvas.height=t,this.drawingBufferWidth=e,this.drawingBufferHeight=t}getDevicePixelRatio(){return"undefined"!=typeof window&&window.devicePixelRatio||1}cssToDevicePixels(e,t=!0){const n=this.cssToDeviceRatio(),[r,s]=this.getDrawingBufferSize();return function(e,t,n,r,s){const i=e,o=a(i[0],t,n);let l=c(i[1],t,r,s),u=a(i[0]+1,t,n);const h=u===n-1?u:u-1;let d;u=c(i[1]+1,t,r,s),s?(u=0===u?u:u+1,d=l,l=u):d=u===r-1?u:u-1;return{x:o,y:l,width:Math.max(h-o+1,1),height:Math.max(d-l+1,1)}}(e,n,r,s,t)}getPixelSize(){return this.getDevicePixelSize()}getAspect(){const[e,t]=this.getDevicePixelSize();return e/t}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),[t]=this.getCSSSize();return t?e/t:1}catch{return 1}}resize(e){this.setDrawingBufferSize(e.width,e.height)}_setAutoCreatedCanvasId(e){"lumagl-auto-created-canvas"===this.htmlCanvas?.id&&(this.htmlCanvas.id=e)}_handleIntersection(e){const t=e.find(e=>e.target===this.canvas);if(!t)return;const n=t.isIntersecting;this.isVisible!==n&&(this.isVisible=n,this.device.props.onVisibilityChange(this))}_handleResize(e){const t=e.find(e=>e.target===this.canvas);if(!t)return;this.cssWidth=t.contentBoxSize[0].inlineSize,this.cssHeight=t.contentBoxSize[0].blockSize;const n=this.getDevicePixelSize(),r=t.devicePixelContentBoxSize?.[0].inlineSize||t.contentBoxSize[0].inlineSize*devicePixelRatio,s=t.devicePixelContentBoxSize?.[0].blockSize||t.contentBoxSize[0].blockSize*devicePixelRatio,[i,o]=this.getMaxDrawingBufferSize();this.devicePixelWidth=Math.max(1,Math.min(r,i)),this.devicePixelHeight=Math.max(1,Math.min(s,o)),this._updateDrawingBufferSize(),this.device.props.onResize(this,{oldPixelSize:n})}_updateDrawingBufferSize(){if(this.props.autoResize){if("number"==typeof this.props.useDevicePixels){const e=this.props.useDevicePixels;this.setDrawingBufferSize(this.cssWidth*e,this.cssHeight*e)}else this.props.useDevicePixels?this.setDrawingBufferSize(this.devicePixelWidth,this.devicePixelHeight):this.setDrawingBufferSize(this.cssWidth,this.cssHeight);this._updateDevice()}this._initializedResolvers.resolve(),this.isInitialized=!0,this.updatePosition()}_observeDevicePixelRatio(){const e=this.devicePixelRatio;this.devicePixelRatio=window.devicePixelRatio,this.updatePosition(),this.device.props.onDevicePixelRatioChange(this,{oldRatio:e}),matchMedia(`(resolution: ${this.devicePixelRatio}dppx)`).addEventListener("change",()=>this._observeDevicePixelRatio(),{once:!0})}_trackPosition(e=100){const t=setInterval(()=>{this.destroyed?clearInterval(t):this.updatePosition()},e)}updatePosition(){const e=this.htmlCanvas?.getBoundingClientRect();if(e){const t=[e.left,e.top];this._position??=t;if(t[0]!==this._position[0]||t[1]!==this._position[1]){const e=this._position;this._position=t,this.device.props.onPositionChange?.(this,{oldPosition:e})}}}}function a(e,t,n){return Math.min(Math.round(e*t),n-1)}function c(e,t,n,r){return r?Math.max(0,n-1-Math.round(e*t)):Math.min(Math.round(e*t),n-1)}},60676:(e,t,n)=>{n.d(t,{A:()=>r});class r{constructor(e,t){this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}},60682:(e,t,n)=>{n.d(t,{u:()=>s});var r=n(88171);function s(e,t){return e===t?r.e8.None:Math.abs(e)>=Math.abs(t)?e<0?r.e8.Left:r.e8.Right:t<0?r.e8.Up:r.e8.Down}},60742:(e,t,n)=>{function r(e){switch(e){case"uint8":case"unorm8":return 5121;case"sint8":case"snorm8":return 5120;case"uint16":case"unorm16":return 5123;case"sint16":case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(e))}n.d(t,{q1:()=>r})},61166:(e,t,n)=>{n.d(t,{F:()=>s});var r=n(29651);class s{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(t=>t.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(e=>e.attribute):[e.name]}mergeBufferLayouts(e,t){const n=[...e];for(const r of t){const e=n.findIndex(e=>e.name===r.name);e<0?n.push(r):n[e]=r}return n}getBufferIndex(e){const t=this.bufferLayouts.findIndex(t=>t.name===e);return-1===t&&r.R.warn(`BufferLayout: Missing buffer for "${e}".`)(),t}}},61273:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(5993);class s{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,t){this.name=e,this.workerThread=t,this.result=new Promise((e,t)=>{this._resolve=e,this._reject=t})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){(0,r.v)(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){(0,r.v)(this.isRunning),this.isRunning=!1,this._reject(e)}}},61313:(e,t,n)=>{n.d(t,{l:()=>s});var r=n(76282);function s(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach(n=>{const s=e[n];var i;i=s,(0,r.H9)(i)||"number"==typeof i||"boolean"==typeof i?t.uniforms[n]=s:t.bindings[n]=s}),t}},62053:(e,t,n)=>{n.d(t,{c:()=>a});const r={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},s=e=>({drawBuffersWEBGL:t=>e.drawBuffers(t),COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),i=e=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES:()=>e.createVertexArray(),deleteVertexArrayOES:t=>e.deleteVertexArray(t),isVertexArrayOES:t=>e.isVertexArray(t),bindVertexArrayOES:t=>e.bindVertexArray(t)}),o=e=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE:(...t)=>e.drawArraysInstanced(...t),drawElementsInstancedANGLE:(...t)=>e.drawElementsInstanced(...t),vertexAttribDivisorANGLE:(...t)=>e.vertexAttribDivisor(...t)});function a(e=!0){const t=HTMLCanvasElement.prototype;if(!e&&t.originalGetContext)return t.getContext=t.originalGetContext,void(t.originalGetContext=void 0);t.originalGetContext=t.getContext,t.getContext=function(e,t){if("webgl"===e||"experimental-webgl"===e){const e=this.originalGetContext("webgl2",t);return e instanceof HTMLElement&&function(e){e.getExtension("EXT_color_buffer_float");const t={...r,WEBGL_disjoint_timer_query:e.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:s(e),OES_vertex_array_object:i(e),ANGLE_instanced_arrays:o(e)},n=e.getExtension;e.getExtension=function(r){const s=n.call(e,r);return s||(r in t?t[r]:null)};const a=e.getSupportedExtensions;e.getSupportedExtensions=function(){const n=a.apply(e)||[];return n?.concat(Object.keys(t))}}(e),e}return this.originalGetContext(e,t)}}},62088:(e,t,n)=>{n.d(t,{J:()=>o});var r=n(83593),s=n(3593),i=n(31661);class o{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,t){this.gl=e,this.log=t?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];(0,r.wb)(this.gl,e),this.stateStack.pop()}trackState(e,t){if(this.cache=t?.copyState?(0,r.OO)(e):Object.assign({},i.V_),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,function(e){const t=e.useProgram.bind(e);e.useProgram=function(n){const r=o.get(e);r.program!==n&&(t(n),r.program=n)}}(e);for(const n in i.Mg){c(e,n,i.Mg[n])}a(e,"getParameter"),a(e,"isEnabled")}_updateCache(e){let t,n=!1;const r=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const i in e){const o=e[i],a=this.cache[i];(0,s.Q)(o,a)||(n=!0,t=a,r&&!(i in r)&&(r[i]=a),this.cache[i]=o)}return{valueChanged:n,oldValue:t}}}function a(e,t){const n=e[t].bind(e);e[t]=function(t){if(void 0===t||i.Kd.has(t))return n(t);const r=o.get(e);return t in r.cache||(r.cache[t]=n(t)),r.enable?r.cache[t]:n(t)},Object.defineProperty(e[t],"name",{value:`${t}-from-cache`,configurable:!1})}function c(e,t,n){if(!e[t])return;const r=e[t].bind(e);e[t]=function(...t){const s=o.get(e),{valueChanged:i,oldValue:a}=n(s._updateCache,...t);return i&&r(...t),a},Object.defineProperty(e[t],"name",{value:`${t}-to-cache`,configurable:!1})}},62372:(e,t,n)=>{n.d(t,{l:()=>o});var r=n(13364),s=n(29651),i=n(22749);class o extends r.M{device;handle;constructor(e,t){switch(super(e,t),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0,this.handle.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>(this._getCompilationStatus(),this.compilationStatus))}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?(0,i.E)(e):[]}getTranslatedSource(){const e=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return e?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es\n${e}`;const{gl:t}=this.device;if(t.shaderSource(this.handle,e),t.compileShader(this.handle),this.device.props.debug){if(this.device.features.has("compilation-status-async-webgl"))s.R.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),s.R.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader();else if(this._getCompilationStatus(),this.debugShader(),"error"===this.compilationStatus)throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`)}else this.compilationStatus="pending"}async _waitForCompilationComplete(){const e=async e=>await new Promise(t=>setTimeout(t,e));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}},62477:(e,t,n)=>{n.d(t,{e:()=>i});var r=n(89277),s=n(85038);class i extends r.L{device;handle;parameters;constructor(e,t){super(e,t),this.device=e,this.parameters=(0,s.e)(t),this.handle=t.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[t,n]of Object.entries(e)){const e=Number(t);switch(e){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,e,n);break;default:this.device.gl.samplerParameteri(this.handle,e,n)}}}}},64756:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(2357);const s=1e-5;function i(e,t,n,r,s){const i=t-e;return(n-t)*s+-i*r+i+t}function o(e,t){if(Array.isArray(e)){let n=0;for(let r=0;r<e.length;r++){const s=e[r]-t[r];n+=s*s}return Math.sqrt(n)}return Math.abs(e-t)}class a extends r.A{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:n,stiffness:r}=this.settings,{_prevValue:a=e,_currValue:c=e}=this;let l=function(e,t,n,r,s){if(Array.isArray(n)){const o=[];for(let a=0;a<n.length;a++)o[a]=i(e[a],t[a],n[a],r,s);return o}return i(e,t,n,r,s)}(a,c,t,n,r);const u=o(l,t),h=o(l,c);u<s&&h<s&&(l=t,this.end()),this._prevValue=c,this._currValue=l}}},65424:(e,t,n)=>{n.d(t,{B:()=>s});const r="uniform layerUniforms {\n  uniform float opacity;\n} layer;\n",s={name:"layer",vs:r,fs:r,getUniforms:e=>({opacity:Math.pow(e.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}}},65640:(e,t,n)=>{function r(e,t){t&&Object.entries(t).map(([t,n])=>{t.startsWith("--")?e.style.setProperty(t,n):e.style[t]=n})}function s(e,t){t&&Object.keys(t).map(t=>{t.startsWith("--")?e.style.removeProperty(t):e.style[t]=""})}n.d(t,{Z:()=>r,h:()=>s})},66008:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(50486),s=n(13004);const i={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class o{props;workerPools=new Map;static _workerFarm;static isSupported(){return s.A.isSupported()}static getWorkerFarm(e={}){return o._workerFarm=o._workerFarm||new o({}),o._workerFarm.setProps(e),o._workerFarm}constructor(e){this.props={...i},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:s}=e;let i=this.workerPools.get(t);return i||(i=new r.A({name:t,source:n,url:s}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}},66037:(e,t,n)=>{n.d(t,{x:()=>c});var r=n(5223),s=n(70752),i=n(3459),o=n(43411),a=n(51387);const c=function(){const e="9.2.2",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==e)throw new Error(`deck.gl - multiple versions detected: ${t} vs ${e}`);return t||(i.A.log(1,`deck.gl ${e}`)(),globalThis.deck={...globalThis.deck,VERSION:e,version:e,log:i.A,_registerLoggers:o.k},(0,r.mk)([a.A,[s.$,{imagebitmap:{premultiplyAlpha:"none"}}]])),e}()},66347:(e,t,n)=>{n.d(t,{x:()=>i});var r=n(7914),s=n(65640);class i{constructor(e){this.viewId=null,this.props={...this.constructor.defaultProps,...e},this.id=this.props.id}setProps(e){const t=this.props,n=this.rootElement;n&&t.className!==e.className&&(t.className&&n.classList.remove(t.className),e.className&&n.classList.add(e.className)),n&&!(0,r.b)(t.style,e.style,1)&&((0,s.h)(n,t.style),(0,s.Z)(n,e.style)),Object.assign(this.props,e),this.updateHTML()}updateHTML(){this.rootElement&&this.onRenderHTML(this.rootElement)}onCreateRootElement(){const e=["deck-widget",this.className,this.props.className],t=document.createElement("div");return e.filter(e=>"string"==typeof e&&e.length>0).forEach(e=>t.classList.add(e)),(0,s.Z)(t,this.props.style),t}_onAdd(e){return this.onAdd(e)??this.onCreateRootElement()}onAdd(e){}onRemove(){}onViewportChange(e){}onRedraw(e){}onHover(e,t){}onClick(e,t){}onDrag(e,t){}onDragStart(e,t){}onDragEnd(e,t){}}i.defaultProps={id:"widget",style:{},className:""}},66540:(e,t,n)=>{function r(e,t){if(!t)return e;const n={...e,...t};if("defines"in t&&(n.defines={...e.defines,...t.defines}),"modules"in t&&(n.modules=(e.modules||[]).concat(t.modules),t.modules.some(e=>"project64"===e.name))){const e=n.modules.findIndex(e=>"project32"===e.name);e>=0&&n.modules.splice(e,1)}if("inject"in t)if(e.inject){const r={...e.inject};for(const e in t.inject)r[e]=(r[e]||"")+t.inject[e];n.inject=r}else n.inject=t.inject;return n}n.d(t,{n:()=>r})},66727:(e,t,n)=>{n.d(t,{K:()=>i});var r=n(14221);const s={srcElement:"root",priority:0};class i{constructor(e,t){this.handleEvent=e=>{if(this.isEmpty())return;const t=this._normalizeEvent(e);let n=e.srcEvent.target;for(;n&&n!==t.rootElement;){if(this._emit(t,n),t.handled)return;n=n.parentNode}this._emit(t,"root")},this.eventManager=e,this.recognizerName=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,n,r=!1,i=!1){const{handlers:o,handlersByElement:a}=this,c={...s,...n};let l=a.get(c.srcElement);l||(l=[],a.set(c.srcElement,l));const u={type:e,handler:t,srcElement:c.srcElement,priority:c.priority};r&&(u.once=!0),i&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let h=l.length-1;for(;h>=0&&!(l[h].priority>=u.priority);)h--;l.splice(h+1,0,u)}remove(e,t){const{handlers:n,handlersByElement:r}=this;for(let s=n.length-1;s>=0;s--){const i=n[s];if(i.type===e&&i.handler===t){n.splice(s,1);const e=r.get(i.srcElement);e.splice(e.indexOf(i),1),0===e.length&&r.delete(i.srcElement)}}this._active=n.some(e=>!e.passive)}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let t=!1;const r=()=>{e.handled=!0},s=()=>{e.handled=!0,t=!0},i=[];for(let o=0;o<n.length;o++){const{type:a,handler:c,once:l}=n[o];if(c({...e,type:a,stopPropagation:r,stopImmediatePropagation:s}),l&&i.push(n[o]),t)break}for(let e=0;e<i.length;e++){const{type:t,handler:n}=i[e];this.remove(t,n)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...(0,r.H)(e),...(0,r.$)(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}},66829:(e,t,n)=>{n.d(t,{z:()=>i});var r=n(5993),s=n(55607);function i(e,t=s.Q){(0,r.v)(e,"no worker provided");const n=e.version;return!(!t||!n)}},67118:(e,t,n)=>{n.d(t,{A:()=>I});var r=n(26839),s=n(185),i=n(9350),o=n(69190),a=n(82041),c=n(12294),l=n(12897),u=n(10062),h=n(3459),d=n(43411),f=n(24067),p=n(82417),g=n(66540),_=n(41019),m=n(23459),v=n(47787),b=n(72214),y=n(73279),E=n(327);const w=2**24-1,x=Object.freeze([]),T=(0,p.A)(({oldViewport:e,viewport:t})=>e.equals(t));let A=new Uint8ClampedArray(0);const S={data:{type:"data",value:x,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:e=>e&&e.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(e,{propName:t,layer:n,loaders:r,loadOptions:s,signal:i})=>{const{resourceManager:o}=n.context;s=s||n.getLoadOptions(),r=r||n.props.loaders,i&&(s={...s,fetch:{...s?.fetch,signal:i}});let a=o.contains(e);return a||s||(o.add({resourceId:e,data:(0,E.H)(e,r),persistent:!1}),a=!0),a?o.subscribe({resourceId:e,onChange:e=>n.internalState?.reloadAsyncProp(t,e),consumerId:n.id,requestId:t}):(0,E.H)(e,r,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:i.rf.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:e})=>[0,100*-e]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class R extends v.A{constructor(){super(...arguments),this.internalState=null,this.lifecycle=l.VD.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){(0,f.A)(this.internalState);const t=this.internalState.viewport||this.context.viewport,n=(0,_.w)(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,s,i]=(0,y.VJ)(n,t.pixelProjectionMatrix);return 2===e.length?[r,s]:[r,s,i]}unproject(e){(0,f.A)(this.internalState);return(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){(0,f.A)(this.internalState);const n=this.internalState.viewport||this.context.viewport;return(0,_.R)(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const t of this.getModels())t.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===i.rf.DEFAULT||e===i.rf.LNGLAT||e===i.rf.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,t=[]){return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){(0,f.A)(e instanceof Uint8Array);const[t,n,r]=e;return t+256*n+65536*r-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:(0,u.U)(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=(0,g.n)(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const t of this.props.extensions)e=(0,g.n)(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&t)if(Array.isArray(n))for(const r of n)t.invalidateAll(r);else t.invalidateAll();if(t){const{props:n}=e,r=this.internalState.hasPickingBuffer,s=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some(e=>e.getNeedsPickingBuffer.call(this,e));if(r!==s){this.internalState.hasPickingBuffer=s;const{pickingColors:e,instancePickingColors:n}=t.attributes,r=e||n;r&&(s&&r.constant&&(r.constant=!1,t.invalidate(r.id)),r.value||s||(r.constant=!0,r.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.destroy();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e.renderPass)}getPickingInfo({info:e,mode:t,sourceLayer:n}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,t){t&&(e=new Error(`${t}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,t&&T({oldViewport:t,viewport:e})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const t=this.getAttributeManager();t&&("all"===e?t.invalidateAll():t.invalidate(e))}updateAttributes(e){let t=!1;for(const n in e)e[n].layoutChanged()&&(t=!0);for(const n of this.getModels())this._setModelAttributes(n,e,t)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,n=this.getNumInstances(),r=this.getStartIndices();e.update({data:t.data,numInstances:n,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),n=Object.create(this.props);for(const e in t)Object.defineProperty(n,e,{value:t[e]});return n}return this.props}calculateInstancePickingColors(e,{numInstances:t}){if(e.constant)return;const n=Math.floor(A.length/4);if(this.internalState.usesPickingColorCache=!0,n<t){t>w&&h.A.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),A=m.A.allocate(A,t,{size:4,copy:!0,maxCount:Math.max(t,w)});const e=Math.floor(A.length/4),r=[0,0,0];for(let t=n;t<e;t++)this.encodePickingColor(t,r),A[4*t+0]=r[0],A[4*t+1]=r[1],A[4*t+2]=r[2],A[4*t+3]=0}e.value=A.subarray(0,4*t)}_setModelAttributes(e,t,n=!1){if(!Object.keys(t).length)return;if(n){const n=this.getAttributeManager();e.setBufferLayout(n.getBufferLayouts(e)),t=n.getAttributes()}const s=e.userData?.excludeAttributes||{},i={},o={};for(const a in t){if(s[a])continue;const n=t[a].getValue();for(const s in n){const c=n[s];c instanceof r.h?t[a].settings.isIndexed?e.setIndexBuffer(c):i[s]=c:c&&(o[s]=c)}}e.setAttributes(i),e.setConstantAttributes(o)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t))return void this._disablePickingIndex(e);const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,s=n||r,i=s&&t.attributes&&t.attributes[s.id];if(i&&i.value){const n=i.value,r=this.encodePickingColor(e);for(let e=0;e<t.length;e++){const t=s.getVertexOffset(e);n[t]===r[0]&&n[t+1]===r[1]&&n[t+2]===r[2]&&this._disablePickingIndex(e)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:n}=this.getAttributeManager().attributes,r=t||n;if(!r)return;const s=r.getVertexOffset(e),i=r.getVertexOffset(e+1);r.buffer.write(new Uint8Array(i-s),s)}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,n=e||t;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==A.buffer&&(n.value=A.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){(0,f.A)(!this.internalState),(0,f.A)(Number.isFinite(this.props.coordinateSystem)),(0,d.A)("layer.initialize",this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new b.A({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(h.A.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new a.A(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){(0,d.A)("layer.matched",this,this===e);const{state:t,internalState:n}=e;this!==e&&(this.internalState=n,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if((0,d.A)("layer.update",this,e),!e)return;const t=this.props,n=this.context,r=this.internalState,s=n.viewport,i=this._updateUniformTransition();r.propsInTransition=i,n.viewport=r.viewport||s,this.props=i;try{const e=this._getUpdateParams(),t=this.getModels();if(n.device)this.updateState(e);else try{this.updateState(e)}catch(o){}for(const n of this.props.extensions)n.updateState.call(this,e,n);this.setNeedsRedraw(),this._updateAttributes();const r=this.getModels()[0]!==t[0];this._postUpdate(e,r)}finally{n.viewport=s,this.props=t,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){(0,d.A)("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:t=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,o=this.context;this.props=this.internalState.propsInTransition||i;try{t&&this.setShaderModuleProps(t);const{getPolygonOffset:i}=this.props,a=i&&i(n)||[0,0];o.device instanceof s.WebGLDevice&&o.device.setParametersWebGL({polygonOffset:a});for(const e of this.getModels())"webgpu"===e.device.type?e.setParameters({...e.parameters,...r}):e.setParameters(r);if(o.device instanceof s.WebGLDevice)o.device.withParametersWebGL(r,()=>{const s={renderPass:e,shaderModuleProps:t,uniforms:n,parameters:r,context:o};for(const e of this.props.extensions)e.draw.call(this,s,e);this.draw(s)});else{const s={renderPass:e,shaderModuleProps:t,uniforms:n,parameters:r,context:o};for(const e of this.props.extensions)e.draw.call(this,s,e);this.draw(s)}}finally{this.props=i}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const r in e)if(e[r]){let n=!1;if("dataChanged"===r){const s=e[r],i=t[r];s&&Array.isArray(i)&&(t.dataChanged=Array.isArray(s)?i.concat(s):s,n=!0)}t[r]||(t[r]=e[r],n=!0),n&&(0,d.A)("layer.changeFlag",this,r,e)}const n=Boolean(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=n,t.somethingChanged=n||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const n=(0,c.mg)(e,t);if(n.updateTriggersChanged)for(const r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(n.transitionsChanged)for(const r in n.transitionsChanged)this.internalState.uniformTransitions.add(r,t[r],e[r],e.transitions?.[r]);return this.setChangeFlags(n)}validateProps(){(0,c.zo)(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={highlightedObjectColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&"function"==typeof n&&(t.highlightColor=n(e)),this.setShaderModuleProps({picking:t}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new o.A(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:n,oldProps:r}=e,s=this.state.model;s?.isInstanced&&s.setInstanceCount(this.getNumInstances());const{autoHighlight:i,highlightedObjectIndex:o,highlightColor:a}=n;if(t||r.autoHighlight!==i||r.highlightedObjectIndex!==o||r.highlightColor!==a){const e={};Array.isArray(a)&&(e.highlightColor=a),(t||r.autoHighlight!==i||o!==r.highlightedObjectIndex)&&(e.highlightedObjectColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setShaderModuleProps({picking:e})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),r=!!n&&n.getNeedsRedraw(e);if(t=t||r,t)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}R.defaultProps=S,R.layerName="Layer";const I=R},67483:(e,t,n)=>{n.d(t,{$:()=>l,l:()=>u});var r=n(29651),s=n(91858),i=n(74003),o=n(32077);const a="https://unpkg.com/webgl-debug@2.0.1/index.js";function c(e){return e.luma=e.luma||{},e.luma}async function l(){(0,i.B)()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await(0,o.k)(a))}function u(e,t={}){return t.debugWebGL||t.traceWebGL?function(e,t){if(!globalThis.WebGLDebugUtils)return r.R.warn("webgl-debug not loaded")(),e;const n=c(e);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init({...s.GL,...e});const i=globalThis.WebGLDebugUtils.makeDebugContext(e,d.bind(null,t),f.bind(null,t));for(const r in s.GL)r in i||"number"!=typeof s.GL[r]||(i[r]=s.GL[r]);class o{}Object.setPrototypeOf(i,Object.getPrototypeOf(e)),Object.setPrototypeOf(o,i);const a=Object.create(o);return n.realContext=e,n.debugContext=a,a.debug=!0,a}(e,t):function(e){const t=c(e);return t.realContext?t.realContext:e}(e)}function h(e,t){t=Array.from(t).map(e=>void 0===e?"undefined":e);let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return n=`${n.slice(0,100)}${n.length>100?"...":""}`,`gl.${e}(${n})`}function d(e,t,n,s){s=Array.from(s).map(e=>void 0===e?"undefined":e);const i=`${globalThis.WebGLDebugUtils.glEnumToString(t)} in gl.${n}(${globalThis.WebGLDebugUtils.glFunctionArgsToString(n,s)})`;r.R.error(i)()}function f(e,t,n){let s="";r.R.level>=1&&(s=h(t,n),e.traceWebGL&&r.R.log(1,s)());for(const r of n)void 0===r&&(s=s||h(t,n))}},67637:(e,t,n)=>{n.d(t,{a:()=>s});var r=n(33814);async function s(e,t,n){const s=(0,r.s6)(e,n),i=self.URL||self.webkitURL,o="string"!=typeof s&&i.createObjectURL(s);try{return await async function(e,t){const n=new Image;if(n.src=e,t.image&&t.image.decode&&n.decode)return await n.decode(),n;return await new Promise((e,t)=>{try{n.onload=()=>e(n),n.onerror=e=>{const n=e instanceof Error?e.message:"error";t(new Error(n))}}catch(r){t(r)}})}(o||s,t)}finally{o&&i.revokeObjectURL(o)}}},68074:(e,t,n)=>{function r(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}n.d(t,{v:()=>r})},68225:(e,t,n)=>{function r(e,t,n){const r=t[0],s=t[1],i=n[3]*r+n[7]*s||1;return e[0]=(n[0]*r+n[4]*s)/i,e[1]=(n[1]*r+n[5]*s)/i,e}function s(e,t,n){const r=t[0],s=t[1],i=t[2],o=n[3]*r+n[7]*s+n[11]*i||1;return e[0]=(n[0]*r+n[4]*s+n[8]*i)/o,e[1]=(n[1]*r+n[5]*s+n[9]*i)/o,e[2]=(n[2]*r+n[6]*s+n[10]*i)/o,e}function i(e,t,n){const r=t[0],s=t[1];return e[0]=n[0]*r+n[2]*s,e[1]=n[1]*r+n[3]*s,e[2]=t[2],e}n.d(t,{B$:()=>r,J4:()=>i,cL:()=>s})},68475:(e,t,n)=>{n.d(t,{p:()=>o});var r=n(26839),s=n(73288),i=n(33027);class o{device;model;transformFeedback;static defaultProps={...i.K.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return"webgl"===e?.info?.type}constructor(e,t=o.defaultProps){if(!o.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new i.K(this.device,{id:t.id||"buffer-transform-model",fs:t.fs||(0,s.Wk)(),topology:t.topology||"point-list",varyings:t.outputs||t.varyings,...t}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:t.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const t=this.device.beginRenderPass(e);this.model.draw(t),t.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const t=this.getBuffer(e);if(!t)throw new Error("BufferTransform#getBuffer");if(t instanceof r.h)return t.readAsync();const{buffer:n,byteOffset:s=0,byteLength:i=n.byteLength}=t;return n.readAsync(s,i)}}},68643:(e,t,n)=>{function r(e,t,n){return void 0===n[t]&&(n[t]=e.getExtension(t)||null),n[t]}n.d(t,{T:()=>r})},69190:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(50708),s=n(3459),i=n(82417),o=n(25667),a=n(43411),c=n(48900);const l="attributeManager.invalidate";class u{constructor(e,{id:t="attribute-manager",stats:n,timeline:r}={}){this.mergeBoundsMemoized=(0,i.A)(o._Z),this.id=t,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new c.A(e,{id:`${t}-transitions`,timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const t of e)void 0!==this.attributes[t]&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const n=this._invalidateTrigger(e,t);(0,a.A)(l,this,e,n)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);(0,a.A)(l,this,"all")}update({data:e,numInstances:t,startIndices:n=null,transitions:r,props:i={},buffers:o={},context:c={}}){let l=!1;(0,a.A)("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const a in this.attributes){const r=this.attributes[a],u=r.settings.accessor;r.startIndices=n,r.numInstances=t,i[a]&&s.A.removed(`props.${a}`,`data.attributes.${a}`)(),r.setExternalBuffer(o[a])||r.setBinaryValue("string"==typeof u?o[u]:void 0,e.startIndices)||"string"==typeof u&&!o[u]&&r.setConstantValue(c,i[u])||r.needsUpdate()&&(l=!0,this._updateAttribute({attribute:r,numInstances:t,data:e,props:i,context:c})),this.needsRedraw=this.needsRedraw||r.needsRedraw()}l&&(0,a.A)("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const t=e.map(e=>this.attributes[e]?.getBounds());return this.mergeBoundsMemoized(t)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:n}=this,r={...n.getAttributes()};for(const s in t){const i=t[s];i.needsRedraw(e)&&!n.hasAttribute(s)&&(r[s]=i)}return r}getBufferLayouts(e){return Object.values(this.getAttributes()).map(t=>t.getBufferLayout(e))}_add(e,t){for(const n in e){const s=e[n],i={...s,id:n,size:(s.isIndexed?1:s.size)||1,...t};this.attributes[n]=new r.A(this.device,i)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes){this.attributes[t].getUpdateTriggers().forEach(n=>{e[n]||(e[n]=[]),e[n].push(t)})}this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:n,updateTriggers:r}=this,s=r[e];return s&&s.forEach(e=>{const r=n[e];r&&r.setNeedsUpdate(r.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:n}=e;if((0,a.A)("attribute.updateStart",t),t.constant)return void t.setConstantValue(e.context,t.value);t.allocate(n)&&(0,a.A)("attribute.allocate",t,n);t.updateBuffer(e)&&(this.needsRedraw=!0,(0,a.A)("attribute.updateEnd",t,n))}}},69258:(e,t,n)=>{n.d(t,{p:()=>o});var r=n(54787),s=n(5147),i=n(59583);class o{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=e=>{this.manager.options.enable&&this.handler(e)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,t){(0,i.Z)(this.manager,e,t)}init(){(0,r.l)(this.element,this.evEl,this.domHandler),(0,r.l)(this.target,this.evTarget,this.domHandler),(0,r.l)((0,s.S)(this.element),this.evWin,this.domHandler)}destroy(){(0,r.W)(this.element,this.evEl,this.domHandler),(0,r.W)(this.target,this.evTarget,this.domHandler),(0,r.W)((0,s.S)(this.element),this.evWin,this.domHandler)}}},69499:(e,t,n)=>{n.d(t,{C:()=>s});var r=n(5153);class s extends r.F{get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,t){super(e,t,s.defaultProps),this.shaderLayout=t.shaderLayout}static defaultProps={...r.F.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0}}},69502:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(47345),s=n(73279),i=n(31886),o=n(54901),a=n(83588);class c extends r.A{constructor(e={}){const{latitude:t=0,longitude:n=0,zoom:r=0,pitch:a=0,bearing:c=0,nearZMultiplier:l=.1,farZMultiplier:u=1.01,nearZ:h,farZ:d,orthographic:f=!1,projectionMatrix:p,repeat:g=!1,worldOffset:_=0,position:m,padding:v,legacyMeterSizes:b=!1}=e;let{width:y,height:E,altitude:w=1.5}=e;const x=Math.pow(2,r);let T;y=y||1,E=E||1;let A=null;if(p)w=p[5]/2,T=(0,s.Os)(w);else{let n;if(e.fovy?(T=e.fovy,w=(0,s.wZ)(T)):T=(0,s.Os)(w),v){const{top:e=0,bottom:t=0}=v;n=[0,(0,o.qE)((e+E-t)/2,0,E)-E/2]}A=(0,s.om)({width:y,height:E,scale:x,center:m&&[0,0,m[2]*(0,s.mY)(t)],offset:n,pitch:a,fovy:T,nearZMultiplier:l,farZMultiplier:u}),Number.isFinite(h)&&(A.near=h),Number.isFinite(d)&&(A.far=d)}let S=(0,s.rY)({height:E,pitch:a,bearing:c,scale:x,altitude:w});if(_){S=(new i.k).translate([512*_,0,0]).multiplyLeft(S)}super({...e,width:y,height:E,viewMatrix:S,longitude:n,latitude:t,zoom:r,...A,fovy:T,focalDistance:w}),this.latitude=t,this.longitude=n,this.zoom=r,this.pitch=a,this.bearing=c,this.altitude=w,this.fovy=T,this.orthographic=f,this._subViewports=g?[]:null,this._pseudoMeters=b,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let r=t;r<=n;r++){const e=r?new c({...this,worldOffset:r}):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,n]=this.projectFlat(e);return[t,n,(e[2]||0)*(0,s.mY)(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,n]=this.unprojectFlat(e);return[t,n,(e[2]||0)/(0,s.mY)(n)]}addMetersToLngLat(e,t){return(0,s.dT)(e,t)}panByPosition(e,t){const n=(0,s.xJ)(t,this.pixelUnprojectionMatrix),r=this.projectFlat(e),i=a.WQ([],r,a.ze([],n)),o=a.WQ([],this.center,i),[c,l]=this.unprojectFlat(o);return{longitude:c,latitude:l}}getBounds(e={}){const t=(0,s.gW)(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(e,t={}){const{width:n,height:r}=this,{longitude:i,latitude:o,zoom:a}=(0,s.Fe)({width:n,height:r,bounds:e,...t});return new c({width:n,height:r,longitude:i,latitude:o,zoom:a})}}c.displayName="WebMercatorViewport";const l=c},69616:(e,t,n)=>{n.d(t,{l4:()=>f,uO:()=>p});var r=n(35185),s=n(8965),i=n(33429),o=n(16534),a=n(13995),c=n(22535),l=n(68074),u=n(46208);const h=`\n\n${i.O_}\n`,d="precision highp float;\n";function f(e){const t=(0,r.$Q)(e.modules||[]);return{source:g(e.platformInfo,{...e,source:e.source,stage:"vertex",modules:t}),getUniforms:m(t)}}function p(e){const{vs:t,fs:n}=e,s=(0,r.$Q)(e.modules||[]);return{vs:_(e.platformInfo,{...e,source:t,stage:"vertex",modules:s}),fs:_(e.platformInfo,{...e,source:n,stage:"fragment",modules:s}),getUniforms:m(s)}}function g(e,t){const{source:n,stage:r,modules:s,hookFunctions:o=[],inject:u={},log:d}=t;(0,l.v)("string"==typeof n,"shader source must be a string");const f=n;let p="";const g=(0,c.R)(o),_={},m={},b={};for(const i in u){const e="string"==typeof u[i]?{injection:u[i],order:0}:u[i],t=/^(v|f)s:(#)?([\w-]+)$/.exec(i);if(t){const n=t[2],r=t[3];n?"decl"===r?m[i]=[e]:b[i]=[e]:_[i]=[e]}else b[i]=[e]}const y=s;for(const i of y){d&&(0,a.ZG)(i,f,d);p+=v(i,"wgsl");const e=i.injections?.[r]||{};for(const t in e){const n=/^(v|f)s:#([\w-]+)$/.exec(t);if(n){const r="decl"===n[2]?m:b;r[t]=r[t]||[],r[t].push(e[t])}else _[t]=_[t]||[],_[t].push(e[t])}}return p+=h,p=(0,i.bv)(p,r,m),p+=(0,c.m)(g[r],_),p+=f,p=(0,i.bv)(p,r,b),p}function _(e,t){const{source:n,stage:r,language:f="glsl",modules:p,defines:g={},hookFunctions:_=[],inject:m={},prologue:b=!0,log:y}=t;(0,l.v)("string"==typeof n,"shader source must be a string");const E="glsl"===f?(0,u.i)(n).version:-1,w=e.shaderLanguageVersion,x=100===E?"#version 100":"#version 300 es",T=n.split("\n").slice(1).join("\n"),A={};p.forEach(e=>{Object.assign(A,e.defines)}),Object.assign(A,g);let S="";switch(f){case"wgsl":break;case"glsl":S=b?`${x}\n\n// ----- PROLOGUE -------------------------\n#define SHADER_TYPE_${r.toUpperCase()}\n\n${(0,s.B)(e)}\n${"fragment"===r?d:""}\n\n// ----- APPLICATION DEFINES -------------------------\n\n${function(e={}){let t="";for(const n in e){const r=e[n];(r||Number.isFinite(r))&&(t+=`#define ${n.toUpperCase()} ${e[n]}\n`)}return t}(A)}\n\n`:`${x}\n`}const R=(0,c.R)(_),I={},C={},P={};for(const s in m){const e="string"==typeof m[s]?{injection:m[s],order:0}:m[s],t=/^(v|f)s:(#)?([\w-]+)$/.exec(s);if(t){const n=t[2],r=t[3];n?"decl"===r?C[s]=[e]:P[s]=[e]:I[s]=[e]}else P[s]=[e]}for(const s of p){y&&(0,a.ZG)(s,T,y);S+=v(s,r);const e=s.instance?.normalizedInjections[r]||{};for(const t in e){const n=/^(v|f)s:#([\w-]+)$/.exec(t);if(n){const r="decl"===n[2]?C:P;r[t]=r[t]||[],r[t].push(e[t])}else I[t]=I[t]||[],I[t].push(e[t])}}return S+="// ----- MAIN SHADER SOURCE -------------------------",S+=h,S=(0,i.bv)(S,r,C),S+=(0,c.m)(R[r],I),S+=T,S=(0,i.bv)(S,r,P),"glsl"===f&&E!==w&&(S=(0,o.o)(S,r)),S.trim()}function m(e){return function(t){const n={};for(const r of e){const e=r.getUniforms?.(t,n);Object.assign(n,e)}return n}}function v(e,t){let n;switch(t){case"vertex":n=e.vs||"";break;case"fragment":n=e.fs||"";break;case"wgsl":n=e.source||"";break;default:(0,l.v)(!1)}if(!e.name)throw new Error("Shader module must have a name");const r=e.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let s=`// ----- MODULE ${e.name} ---------------\n\n`;return"wgsl"!==t&&(s+=`#define MODULE_${r}\n`),s+=`${n}\n`,s}},69833:(e,t,n)=>{n.d(t,{cy:()=>s});var r=n(10048);async function s(e){const t=[];for await(const n of e)t.push(n);return(0,r.AQ)(...t)}},70053:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(78715),s=n(54901);const i=["longitude","latitude","zoom","bearing","pitch"],o=["longitude","latitude","zoom"];class a extends r.A{constructor(e={}){const t=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:i,required:o},super(n.transitionProps),this.opts=n}initializeProps(e,t){const n=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const i=r(e),o=r(t),a=i.unproject(s);n.start.around=s,Object.assign(n.end,{around:o.project(a),aroundPosition:a,width:t.width,height:t.height})}return n}interpolateProps(e,t,n){const r={};for(const i of this._propsToExtract)r[i]=(0,s.Cc)(e[i]||0,t[i]||0,n);if(t.aroundPosition&&this.opts.makeViewport){const i=this.opts.makeViewport({...t,...r});Object.assign(r,i.panByPosition(t.aroundPosition,(0,s.Cc)(e.around,t.around,n)))}return r}}},70137:(e,t,n)=>{n.d(t,{l:()=>s});var r=n(55904);function s(e,t){return(0,r.q)(t[1],t[0])-(0,r.q)(e[1],e[0])}},70177:(e,t,n)=>{n.d(t,{$M:()=>s,_U:()=>i,p6:()=>c,qE:()=>a,zi:()=>o});var r=n(39426);function s(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function i(e,t){const n=r.Z0([],t,e);return r.hs(n,n,1/n[3]),n}function o(e,t){const n=e%t;return n<0?t+n:n}function a(e,t,n){return e<t?t:e>n?n:e}const c=Math.log2||function(e){return Math.log(e)*Math.LOG2E}},70504:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(37946);class s{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:n=!1,persistent:s=!0}){let i=this._resources[e];i?i.setData(t,n):(i=new r.A(e,t,this._context),this._resources[e]=i),i.persistent=s}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const e in t){const n=t[e],r=this._resources[n.resourceId];r&&r.unsubscribe(n)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:n,requestId:r="default"}){const{_resources:s,protocol:i}=this;e.startsWith(i)&&(s[e=e.replace(i,"")]||this.add({resourceId:e,data:null,persistent:!1}));const o=s[e];if(this._track(n,r,o,t),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,n,r){const s=this._consumers,i=s[e]=s[e]||{};let o=i[t];const a=o&&o.resourceId&&this._resources[o.resourceId];a&&(a.unsubscribe(o),this.prune()),n&&(o?(o.onChange=r,o.resourceId=n.id):o={onChange:r,resourceId:n.id},i[t]=o,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];t.persistent||t.inUse()||(t.delete(),delete this._resources[e])}}}},70752:(e,t,n)=>{n.d(t,{$:()=>o});var r=n(50677),s=n(17043),i=n(23793);const o={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:r.x,mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:s.z,tests:[e=>Boolean((0,i.m)(new DataView(e)))],options:{image:{type:"auto",decode:!0}}}},71511:(e,t,n)=>{n.d(t,{o1:()=>i});let r="";const s={};function i(e){for(const t in s)if(e.startsWith(t)){const n=s[t];e=e.replace(t,n)}return e.startsWith("http://")||e.startsWith("https://")||(e=`${r}${e}`),e}},71651:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(53439),s=n(12897);const i=Object.freeze({});class o{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||i}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[s.r3]||this.component;const t=e[s.vf]||{},n=e[s.YN]||e,r=e[s.jA]||{};for(const s in t){const e=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,e),t[s]=this.getAsyncProp(s)}for(const s in n){const e=n[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,e)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){this._didAsyncInputValueChange(e,t)&&("string"==typeof t&&(t=this._fetch(e,t)),t instanceof Promise?this._watchPromise(e,t):(0,r.Td)(t)?this._resolveAsyncIterable(e,t):this._setPropValue(e,t))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const n=this.asyncProps[e];return t!==n.resolvedValue&&t!==n.lastValue&&(n.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(t=this._postProcessValue(n,t),n.resolvedValue=t,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,t,n){const r=this.asyncProps[e];r&&n>=r.resolvedLoadCount&&void 0!==t&&(this._freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=n,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const r=n.pendingLoadCount;t.then(t=>{this.component&&(t=this._postProcessValue(n,t),this._setAsyncPropValue(e,t,r),this._onResolve(e,t))}).catch(t=>{this._onError(e,t)})}}async _resolveAsyncIterable(e,t){if("data"!==e)return void this._setPropValue(e,t);const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const r=n.pendingLoadCount;let s=[],i=0;for await(const o of t){if(!this.component)return;const{dataTransform:t}=this.component.props;s=t?t(o,s):s.concat(o),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:i,endRow:s.length}]}),i=s.length,this._setAsyncPropValue(e,s,r)}this._onResolve(e,s)}_postProcessValue(e,t){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(t,n,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const n=this.component&&this.component.props[s.fW];this.asyncProps[e]={type:n&&n[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}},71845:(e,t,n)=>{function r(){let e;if("undefined"!=typeof window&&window.performance)e=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}n.d(t,{A:()=>r})},72214:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(71651);class s extends r.A{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const n=this.layer,r=n?.props.fetch;return r?r(t,{propName:e,layer:n}):super._fetch(e,t)}_onResolve(e,t){const n=this.layer;if(n){const r=n.props.onDataLoad;"data"===e&&r&&r(t,{propName:e,layer:n})}}_onError(e,t){const n=this.layer;n&&n.raiseError(t,`loading ${e} of ${this.layer}`)}}},72246:(e,t,n)=>{function r(e){const[t,n,r]=c[e],s=e.includes("norm");return{signedType:t,primitiveType:n,byteLength:r,normalized:s,integer:!s&&!e.startsWith("float"),signed:e.startsWith("s")}}function s(e){const t=e;switch(t){case"uint8":return"unorm8";case"sint8":return"snorm8";case"uint16":return"unorm16";case"sint16":return"snorm16";default:return t}}function i(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}function o(e){const t=ArrayBuffer.isView(e)?e.constructor:e;if(t===Uint8ClampedArray)return"uint8";const n=Object.values(c).find(e=>t===e[4]);if(!n)throw new Error(t.name);return n[0]}function a(e){const[,,,,t]=c[e];return t}n.d(t,{Ak:()=>a,JP:()=>i,K7:()=>s,h1:()=>o,vE:()=>r});const c={uint8:["uint8","u32",1,!1,Uint8Array],sint8:["sint8","i32",1,!1,Int8Array],unorm8:["uint8","f32",1,!0,Uint8Array],snorm8:["sint8","f32",1,!0,Int8Array],uint16:["uint16","u32",2,!1,Uint16Array],sint16:["sint16","i32",2,!1,Int16Array],unorm16:["uint16","u32",2,!0,Uint16Array],snorm16:["sint16","i32",2,!0,Int16Array],float16:["float16","f16",2,!1,Uint16Array],float32:["float32","f32",4,!1,Float32Array],uint32:["uint32","u32",4,!1,Uint32Array],sint32:["sint32","i32",4,!1,Int32Array]}},72548:(e,t,n)=>{n.d(t,{Al:()=>o,_E:()=>c,z4:()=>a});var r=n(8521),s=n(42221),i=n(28071);function o(e){if((0,r.Sv)(e)){return e.url}if((0,r.qf)(e)){return e.name||""}return"string"==typeof e?e:""}function a(e){if((0,r.Sv)(e)){const t=e,n=t.headers.get("content-type")||"",r=(0,i.S3)(t.url);return(0,s.OA)(n)||(0,s.d_)(r)}if((0,r.qf)(e)){return e.type||""}return"string"==typeof e?(0,s.d_)(e):""}function c(e){if((0,r.Sv)(e)){return e.headers["content-length"]||-1}if((0,r.qf)(e)){return e.size}return"string"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}},72959:(e,t,n)=>{n.d(t,{Rm:()=>a});var r=n(80698),s=n(6895),i=n(85450),o=n(21719);class a extends s.M{device;handle=null;commands=[];constructor(e){super(e,{}),this.device=e}_executeCommands(e=this.commands){for(const t of e)switch(t.name){case"copy-buffer-to-buffer":c(this.device,t.options);break;case"copy-buffer-to-texture":l(this.device,t.options);break;case"copy-texture-to-buffer":u(this.device,t.options);break;case"copy-texture-to-texture":h(this.device,t.options);break;default:throw new Error(t.name)}}}function c(e,t){const n=t.sourceBuffer,r=t.destinationBuffer;e.gl.bindBuffer(36662,n.handle),e.gl.bindBuffer(36663,r.handle),e.gl.copyBufferSubData(36662,36663,t.sourceOffset??0,t.destinationOffset??0,t.size),e.gl.bindBuffer(36662,null),e.gl.bindBuffer(36663,null)}function l(e,t){throw new Error("Not implemented")}function u(e,t){const{sourceTexture:n,mipLevel:r=0,aspect:s="all",width:i=t.sourceTexture.width,height:a=t.sourceTexture.height,depthOrArrayLayers:c=0,origin:l=[0,0],destinationBuffer:u,byteOffset:h=0,bytesPerRow:f,rowsPerImage:p}=t;if("all"!==s)throw new Error("aspect not supported in WebGL");if(0!==r||0!==c||f||p)throw new Error("not implemented");const{framebuffer:g,destroyFramebuffer:_}=d(n);let m;try{const t=u,n=i||g.width,r=a||g.height,s=(0,o.M8)(g.colorAttachments[0].texture.props.format),c=s.format,d=s.type;e.gl.bindBuffer(35051,t.handle),m=e.gl.bindFramebuffer(36160,g.handle),e.gl.readPixels(l[0],l[1],n,r,c,d,h)}finally{e.gl.bindBuffer(35051,null),void 0!==m&&e.gl.bindFramebuffer(36160,m),_&&g.destroy()}}function h(e,t){const{sourceTexture:n,destinationMipLevel:r=0,origin:s=[0,0],destinationOrigin:o=[0,0],destinationTexture:a}=t;let{width:c=t.destinationTexture.width,height:l=t.destinationTexture.height}=t;const{framebuffer:u,destroyFramebuffer:h}=d(n),[f,p]=s,[g,_,m]=o,v=e.gl.bindFramebuffer(36160,u.handle);let b,y;if(!(a instanceof i.d_))throw new Error("invalid destination");switch(b=a,c=Number.isFinite(c)?c:b.width,l=Number.isFinite(l)?l:b.height,b._bind(0),y=b.glTarget,y){case 3553:case 34067:e.gl.copyTexSubImage2D(y,r,g,_,f,p,c,l);break;case 35866:case 32879:e.gl.copyTexSubImage3D(y,r,g,_,m,f,p,c,l)}b&&b._unbind(),e.gl.bindFramebuffer(36160,v),h&&u.destroy()}function d(e){if(e instanceof r.g){const{width:t,height:n,id:r}=e;return{framebuffer:e.device.createFramebuffer({id:`framebuffer-for-${r}`,width:t,height:n,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}},72963:(e,t,n)=>{function r(e,t,n){let r="";const o=t.split(/\r?\n/),a=e.slice().sort((e,t)=>e.lineNum-t.lineNum);switch(n?.showSourceCode||"no"){case"all":let t=0;for(let e=1;e<=o.length;e++)for(r+=i(o[e-1],e,n);a.length>t&&a[t].lineNum===e;){const e=a[t++];r+=s(e,o,e.lineNum,{...n,inlineSource:!1})}for(;a.length>t;){r+=s(a[t++],[],0,{...n,inlineSource:!1})}return r;case"issues":case"no":for(const i of e)r+=s(i,o,i.lineNum,{inlineSource:"no"!==n?.showSourceCode});return r}}function s(e,t,n,r){if(r?.inlineSource){const r=function(e,t,n){let r="";for(let s=t-2;s<=t;s++){const o=e[s-1];void 0!==o&&(r+=i(o,t,n))}return r}(t,n);return`\n${r}${e.linePos>0?`${" ".repeat(e.linePos+5)}^^^\n`:""}${e.type.toUpperCase()}: ${e.message}\n\n`}const s="error"===e.type?"red":"#8B4000";return r?.html?`<div class='luma-compiler-log-error' style="color:${s};"><b> ${e.type.toUpperCase()}: ${e.message}</b></div>`:`${e.type.toUpperCase()}: ${e.message}`}function i(e,t,n){const r=n?.html?e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"):e;return`${function(e,t){let n="";for(let r=e.length;r<t;++r)n+=" ";return n+e}(String(t),4)}: ${r}${n?.html?"<br/>":"\n"}`}n.d(t,{B:()=>r})},73156:(e,t,n)=>{n.d(t,{Dt:()=>s});let r="";async function s(e,t){const n=new Image;return n.crossOrigin=t?.crossOrigin||"anonymous",n.src=e.startsWith("http")?e:r+e,await n.decode(),t?await createImageBitmap(n,t):await createImageBitmap(n)}},73279:(e,t,n)=>{n.d(t,{CK:()=>o.C,Fe:()=>i.F,Gw:()=>a.Gw,KH:()=>r.K,Os:()=>a.Os,VJ:()=>a.VJ,dT:()=>a.dT,fO:()=>a.fO,gW:()=>s.g,iV:()=>a.iV,mY:()=>a.mY,nI:()=>a.nI,om:()=>a.om,rY:()=>a.rY,wZ:()=>a.wZ,xJ:()=>a.xJ});var r=n(38494),s=n(37925),i=n(34336),o=n(32264),a=(n(34617),n(88967))},73288:(e,t,n)=>{n.d(t,{Wk:()=>s});const r="#version 300 es\nout vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}";function s(e){const{input:t,inputChannels:n,output:s}=e||{};if(!t)return r;if(!n)throw new Error("inputChannels");return`#version 300 es\nin ${function(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${e}`)}}(n)} ${t};\nout vec4 ${s};\nvoid main() {\n  ${s} = ${function(e,t){switch(t){case 1:return`vec4(${e}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${e}, 0.0, 1.0)`;case 3:return`vec4(${e}, 1.0)`;case 4:return e;default:throw new Error(`invalid channels: ${t}`)}}(t,n)};\n}`}},73390:(e,t,n)=>{let r;function s(e){return(!r||r.byteLength<e)&&(r=new ArrayBuffer(e)),r}function i(e,t){return new e(s(e.BYTES_PER_ELEMENT*t),0,t)}n.d(t,{X:()=>i,o:()=>s})},73731:(e,t,n)=>{n.d(t,{qk:()=>i,ws:()=>s});var r=n(54901);function s(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function i(e,t,n=""){if(r.$W.debug&&!function(e,t){if(e.length!==t)return!1;for(let n=0;n<e.length;++n)if(!Number.isFinite(e[n]))return!1;return!0}(e,t))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return e}},73756:(e,t,n)=>{function r(e,t,n,r){const s=e;let i=r;!0===i&&(i=1),!1===i&&(i=0);const o="number"==typeof i?[i]:i;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if("number"!=typeof r)throw new Error("samplers must be set to integers");return e.uniform1i(t,r);case 5126:return e.uniform1fv(t,o);case 35664:return e.uniform2fv(t,o);case 35665:return e.uniform3fv(t,o);case 35666:return e.uniform4fv(t,o);case 5124:case 35670:return e.uniform1iv(t,o);case 35667:case 35671:return e.uniform2iv(t,o);case 35668:case 35672:return e.uniform3iv(t,o);case 35669:case 35673:return e.uniform4iv(t,o);case 5125:return s.uniform1uiv(t,o,1);case 36294:return s.uniform2uiv(t,o,2);case 36295:return s.uniform3uiv(t,o,3);case 36296:return s.uniform4uiv(t,o,4);case 35674:return e.uniformMatrix2fv(t,!1,o);case 35675:return e.uniformMatrix3fv(t,!1,o);case 35676:return e.uniformMatrix4fv(t,!1,o);case 35685:return s.uniformMatrix2x3fv(t,!1,o);case 35686:return s.uniformMatrix2x4fv(t,!1,o);case 35687:return s.uniformMatrix3x2fv(t,!1,o);case 35688:return s.uniformMatrix3x4fv(t,!1,o);case 35689:return s.uniformMatrix4x2fv(t,!1,o);case 35690:return s.uniformMatrix4x3fv(t,!1,o)}throw new Error("Illegal uniform")}n.d(t,{B:()=>r})},73968:(e,t,n)=>{n.d(t,{z:()=>o});var r=n(8521),s=n(76522),i=n(3481);function o(e,t){const n=(0,i.pp)(),o=e||n;return"function"==typeof o.fetch?o.fetch:(0,r.Gv)(o.fetch)?e=>(0,s.t2)(e,o.fetch):t?.fetch?t?.fetch:s.t2}},74003:(e,t,n)=>{n.d(t,{B:()=>s});var r=n(77989);function s(){return!("object"==typeof process&&"[object process]"===String(process)&&!process?.browser)||(0,r.b)()}},74092:(e,t,n)=>{function r(e,t){const n=Object.fromEntries(e.attributes.map(e=>[e.name,e.location])),r=t.slice();return r.sort((e,t)=>{const r=e.attributes?e.attributes.map(e=>e.attribute):[e.name],s=t.attributes?t.attributes.map(e=>e.attribute):[t.name];return Math.min(...r.map(e=>n[e]))-Math.min(...s.map(e=>n[e]))}),r}n.d(t,{F:()=>r})},74334:(e,t,n)=>{n.d(t,{a:()=>p,o:()=>f});var r=n(90218),s=n(39426),i=n(9350),o=n(82417);const a=[0,0,0,0],c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=[0,0,0],h=[0,0,0],d=(0,o.A)(function({viewport:e,devicePixelRatio:t,coordinateSystem:n,coordinateOrigin:o}){const{projectionCenter:h,viewProjectionMatrix:d,originCommon:p,cameraPosCommon:g,shaderCoordinateOrigin:_,geospatialOrigin:m}=function(e,t,n){const{viewMatrixUncentered:i,projectionMatrix:o}=e;let{viewMatrix:l,viewProjectionMatrix:u}=e,h=a,d=a,p=e.cameraPosition;const{geospatialOrigin:g,shaderCoordinateOrigin:_,offsetMode:m}=f(e,t,n);m&&(d=e.projectPosition(g||_),p=[p[0]-d[0],p[1]-d[1],p[2]-d[2]],d[3]=1,h=s.Z0([],d,u),l=i||l,u=r.lw([],o,l),u=r.lw([],u,c));return{viewMatrix:l,viewProjectionMatrix:u,projectionCenter:h,originCommon:d,cameraPosCommon:p,shaderCoordinateOrigin:_,geospatialOrigin:g}}(e,n,o),v=e.getDistanceScales(),b=[e.width*t,e.height*t],y=s.Z0([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,E={coordinateSystem:n,projectionMode:e.projectionMode,coordinateOrigin:_,commonOrigin:p.slice(0,3),center:h,pseudoMeters:Boolean(e._pseudoMeters),viewportSize:b,devicePixelRatio:t,focalDistance:y,commonUnitsPerMeter:v.unitsPerMeter,commonUnitsPerWorldUnit:v.unitsPerMeter,commonUnitsPerWorldUnit2:u,scale:e.scale,wrapLongitude:!1,viewProjectionMatrix:d,modelMatrix:l,cameraPosition:g};if(m){const t=e.getDistanceScales(m);switch(n){case i.rf.METER_OFFSETS:E.commonUnitsPerWorldUnit=t.unitsPerMeter,E.commonUnitsPerWorldUnit2=t.unitsPerMeter2;break;case i.rf.LNGLAT:case i.rf.LNGLAT_OFFSETS:e._pseudoMeters||(E.commonUnitsPerMeter=t.unitsPerMeter),E.commonUnitsPerWorldUnit=t.unitsPerDegree,E.commonUnitsPerWorldUnit2=t.unitsPerDegree2;break;case i.rf.CARTESIAN:E.commonUnitsPerWorldUnit=[1,1,t.unitsPerMeter[2]],E.commonUnitsPerWorldUnit2=[0,0,t.unitsPerMeter2[2]]}}return E});function f(e,t,n=h){n.length<3&&(n=[n[0],n[1],0]);let r,s=n,o=!0;switch(r=t===i.rf.LNGLAT_OFFSETS||t===i.rf.METER_OFFSETS?n:e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case i.Kx.WEB_MERCATOR:t!==i.rf.LNGLAT&&t!==i.rf.CARTESIAN||(r=[0,0,0],o=!1);break;case i.Kx.WEB_MERCATOR_AUTO_OFFSET:t===i.rf.LNGLAT?s=r:t===i.rf.CARTESIAN&&(s=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],r=e.unprojectPosition(s),s[0]-=n[0],s[1]-=n[1],s[2]-=n[2]);break;case i.Kx.IDENTITY:s=e.position.map(Math.fround),s[2]=s[2]||0;break;case i.Kx.GLOBE:o=!1,r=null;break;default:o=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:s,offsetMode:o}}function p({viewport:e,devicePixelRatio:t=1,modelMatrix:n=null,coordinateSystem:r=i.rf.DEFAULT,coordinateOrigin:s=h,autoWrapLongitude:o=!1}){r===i.rf.DEFAULT&&(r=e.isGeospatial?i.rf.LNGLAT:i.rf.CARTESIAN);const a=d({viewport:e,devicePixelRatio:t,coordinateSystem:r,coordinateOrigin:s});return a.wrapLongitude=o,a.modelMatrix=n||l,a}},74559:(e,t,n)=>{function r(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let s=0;s<e.length;s++)if(!r(e[s],t[s],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"==typeof e&&"object"==typeof t){const s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(const o of s){if(!t.hasOwnProperty(o))return!1;if(!r(e[o],t[o],n-1))return!1}return!0}return!1}n.d(t,{b:()=>r})},74588:(e,t,n)=>{n.d(t,{Y:()=>s});var r=n(74003);class s{get pageLoaded(){return function(){a||(a=o()||"undefined"==typeof window?Promise.resolve():new Promise(e=>window.addEventListener("load",()=>e())));return a}()}}const i=(0,r.B)()&&"undefined"!=typeof document,o=()=>i&&"complete"===document.readyState;let a=null},74683:(e,t,n)=>{n.d(t,{L:()=>s});const r={};function s(e="id"){r[e]=r[e]||1;return`${e}-${r[e]++}`}},74805:(e,t,n)=>{n.d(t,{$:()=>i});var r=n(29651),s=n(54017);function i(e){const t={attributes:[],bindings:[]};let n;try{n=function(e){try{return new s.$X(e)}catch(t){if(t instanceof Error)throw t;let e="WGSL parse error";throw"object"==typeof t&&t?.message&&(e+=`: ${t.message} `),"object"==typeof t&&t?.token&&(e+=t.token.line||""),new Error(e,{cause:t})}}(e)}catch(c){return r.R.error(c.message)(),t}for(const r of n.uniforms){const e=[];for(const t of r.type?.members||[])e.push({name:t.name,type:o(t.type)});t.bindings.push({type:"uniform",name:r.name,group:r.group,location:r.binding,members:e})}for(const r of n.textures)t.bindings.push({type:"texture",name:r.name,group:r.group,location:r.binding});for(const r of n.samplers)t.bindings.push({type:"sampler",name:r.name,group:r.group,location:r.binding});const i=n.entry.vertex[0],a=i?.inputs.length||0;for(let r=0;r<a;r++){const e=i.inputs[r];if("location"===e.locationType){const n=o(e.type);t.attributes.push({name:e.name,location:Number(e.location),type:n})}}return t}function o(e){return e?.format?`${e.name}<${e.format.name}>`:e.name}},74918:(e,t,n)=>{n.d(t,{G:()=>o});var r=n(5153),s=n(80698),i=n(29651);class o extends r.F{get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e,t={}){super(e,t,o.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const t=this.colorAttachments.map(t=>t.texture.clone(e)),n=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:t,depthStencilAttachment:n})}resize(e){let t=!e;if(e){const[n,r]=Array.isArray(e)?e:[e.width,e.height];t=t||r!==this.height||n!==this.width,this.width=n,this.height=r}t&&(i.R.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(0===this.props.colorAttachments.length&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((e,t)=>{if("string"==typeof e){const n=this.createColorTexture(e,t);return this.attachResource(n),n.view}return e instanceof s.g?e.view:e});const e=this.props.depthStencilAttachment;if(e)if("string"==typeof e){const t=this.createDepthStencilTexture(e);this.attachResource(t),this.depthStencilAttachment=t.view}else e instanceof s.g?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,t){return this.device.createTexture({id:`${this.id}-color-attachment-${t}`,usage:s.g.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:s.g.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height})}resizeAttachments(e,t){for(let n=0;n<this.colorAttachments.length;++n)if(this.colorAttachments[n]){const r=this.colorAttachments[n].texture.clone({width:e,height:t});this.destroyAttachedResource(this.colorAttachments[n]),this.colorAttachments[n]=r.view,this.attachResource(r.view)}if(this.depthStencilAttachment){const n=this.depthStencilAttachment.texture.clone({width:e,height:t});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=n.view,this.attachResource(n)}this.updateAttachments()}static defaultProps={...r.F.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null}}},75638:(e,t,n)=>{n.d(t,{X:()=>s});var r=n(5153);class s extends r.F{get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,s.defaultProps)}static defaultProps={...r.F.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0}}},76028:(e,t,n)=>{n.d(t,{d:()=>s});var r=n(88755);const s=new class{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new r.A({id:e})),this.stats.get(e)}}},76280:(e,t,n)=>{n.d(t,{i:()=>o});var r=n(88171),s=n(69258);const i={pointerdown:r.TL.Start,pointermove:r.TL.Move,pointerup:r.TL.End,pointercancel:r.TL.Cancel,pointerout:r.TL.Cancel};class o extends s.p{constructor(e){super(e),this.evEl="pointerdown",this.evWin="pointermove pointerup pointercancel",this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:t}=this;let n=!1;const s=i[e.type],o=e.pointerType,a="touch"===o;let c=t.findIndex(t=>t.pointerId===e.pointerId);s&r.TL.Start&&(e.buttons||a)?c<0&&(t.push(e),c=t.length-1):s&(r.TL.End|r.TL.Cancel)&&(n=!0),c<0||(t[c]=e,this.callback(s,{pointers:t,changedPointers:[e],eventType:s,pointerType:o,srcEvent:e}),n&&t.splice(c,1))}}},76282:(e,t,n)=>{function r(e){return function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)||function(e){return!!Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}(e)}n.d(t,{H9:()=>r})},76456:(e,t,n)=>{function r(e,t=[],n=0){const r=Math.fround(e),s=e-r;return t[n]=r,t[n+1]=s,t}function s(e){return e-Math.fround(e)}function i(e){const t=new Float32Array(32);for(let n=0;n<4;++n)for(let s=0;s<4;++s){const i=4*n+s;r(e[4*s+n],t,2*i)}return t}n.d(t,{qk:()=>s,v9:()=>r,yo:()=>i})},76522:(e,t,n)=>{n.d(t,{t2:()=>i});var r=n(71511),s=n(46555);async function i(e,t){if("string"==typeof e){const n=(0,r.o1)(e);return function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(n)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(n,t):await fetch(n,t)}return await(0,s.wv)(e)}},76726:(e,t,n)=>{n.d(t,{K:()=>i});var r=n(93871),s=n(20522);class i{constructor(e,t){this.actions="",this.manager=e,this.set(t)}set(e){e===r.ly&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const t of this.manager.recognizers)t.options.enable&&(e=e.concat(t.getTouchAction()));return(0,s.A)(e.join(" "))}}},77146:(e,t,n)=>{n.d(t,{q:()=>o});var r=n(5993),s=n(38503),i=n(55607);function o(e,t={}){const n=t[e.id]||{},o=s.Bd?`${e.id}-worker.js`:`${e.id}-worker-node.js`;let a=n.workerUrl;if(a||"compression"!==e.id||(a=t.workerUrl),"test"===t._workerType&&(a=s.Bd?`modules/${e.module}/dist/${o}`:`modules/${e.module}/src/workers/${e.id}-worker-node.ts`),!a){let t=e.version;"latest"===t&&(t=i.x);const n=t?`@${t}`:"";a=`https://unpkg.com/@loaders.gl/${e.module}${n}/dist/${o}`}return(0,r.v)(a),a}},77264:(e,t,n)=>{var r;n.d(t,{g:()=>r}),function(e){e[e.Possible=1]="Possible",e[e.Began=2]="Began",e[e.Changed=4]="Changed",e[e.Ended=8]="Ended",e[e.Recognized=8]="Recognized",e[e.Cancelled=16]="Cancelled",e[e.Failed=32]="Failed"}(r||(r={}))},77933:(e,t,n)=>{n.d(t,{Mz:()=>o,OB:()=>i,yx:()=>s});var r=n(72246);function s(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);const[n,s]=e.split("x"),i=n,o=s?parseInt(s):1,a=(0,r.vE)(i),c={type:i,components:o,byteLength:a.byteLength*o,integer:a.integer,signed:a.signed,normalized:a.normalized};return t&&(c.webglOnly=!0),c}function i(e,t,n){if(!t||t>4)throw new Error(`size ${t}`);const s=t;return function(e,t,n){const s=n?(0,r.K7)(e):e;switch(s){case"unorm8":return 1===t?"unorm8":3===t?"unorm8x3-webgl":`${s}x${t}`;case"snorm8":case"uint8":case"sint8":case"uint16":case"sint16":case"unorm16":case"snorm16":case"float16":if(1===t||3===t)throw new Error(`size: ${t}`);return`${s}x${t}`;default:return 1===t?s:`${s}x${t}`}}((0,r.h1)(e),s,n)}function o(e){let t;switch(e.primitiveType){case"f32":t="float32";break;case"i32":t="sint32";break;case"u32":t="uint32";break;case"f16":return e.components<=2?"float16x2":"float16x4"}return 1===e.components?t:`${t}x${e.components}`}},77989:(e,t,n)=>{function r(e){if("undefined"!=typeof window&&"renderer"===window.process?.type)return!0;if("undefined"!=typeof process&&Boolean(process.versions?.electron))return!0;const t="undefined"!=typeof navigator&&navigator.userAgent,n=e||t;return Boolean(n&&n.indexOf("Electron")>=0)}n.d(t,{b:()=>r})},78623:(e,t,n)=>{n.d(t,{v:()=>i});const r=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,s=/^\s*\#\s*endif\s*$/;function i(e,t){const n=e.split("\n"),i=[];let o=!0,a=null;for(const c of n){const e=c.match(r),n=c.match(s);e?(a=e[1],o=Boolean(t?.defines?.[a])):n?o=!0:o&&i.push(c)}return i.join("\n")}},78715:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(54901),s=n(24067);class i{constructor(e){const{compare:t,extract:n,required:r}=e;this._propsToCompare=t,this._propsToExtract=n||t,this._requiredProps=r}arePropsEqual(e,t){for(const n of this._propsToCompare)if(!(n in e)||!(n in t)||!(0,r.aI)(e[n],t[n]))return!1;return!0}initializeProps(e,t){const n={},r={};for(const s of this._propsToExtract)(s in e||s in t)&&(n[s]=e[s],r[s]=t[s]);return this._checkRequiredProps(n),this._checkRequiredProps(r),{start:n,end:r}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const n=e[t];(0,s.A)(Number.isFinite(n)||Array.isArray(n),`${t} is required for transition`)})}}},79431:(e,t,n)=>{function r({pickInfo:e,viewports:t,pixelRatio:n,x:r,y:s,z:i}){let o,a=t[0];if(t.length>1&&(a=function(e,t){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.containsPixel(t))return r}return e[0]}(e?.pickedViewports||t,{x:r,y:s})),a){const e=[r-a.x,s-a.y];void 0!==i&&(e[2]=i),o=a.unproject(e)}return{color:null,layer:null,viewport:a,index:-1,picked:!1,x:r,y:s,pixel:[r,s],coordinate:o,devicePixel:e&&"pickedX"in e?[e.pickedX,e.pickedY]:void 0,pixelRatio:n}}function s(e){const{pickInfo:t,lastPickedInfo:n,mode:s,layers:o}=e,{pickedColor:a,pickedLayer:c,pickedObjectIndex:l}=t,u=c?[c]:[];if("hover"===s){const e=n.index,t=n.layerId,r=c?c.props.id:null;if(r!==t||l!==e){if(r!==t){const e=o.find(e=>e.props.id===t);e&&u.unshift(e)}n.layerId=r,n.index=l,n.info=null}}const h=r(e),d=new Map;return d.set(null,h),u.forEach(e=>{let t={...h};e===c&&(t.color=a,t.index=l,t.picked=!0),t=i({layer:e,info:t,mode:s});const r=t.layer;e===c&&"hover"===s&&(n.info=t),d.set(r.id,t),"hover"===s&&r.updateAutoHighlight(t)}),d}function i({layer:e,info:t,mode:n}){for(;e&&t;){const r=t.layer||null;t.sourceLayer=r,t.layer=e,t=e.getPickingInfo({info:t,mode:n,sourceLayer:r}),e=e.parent}return t}n.d(t,{Rz:()=>i,nK:()=>r,r6:()=>s})},80698:(e,t,n)=>{n.d(t,{g:()=>a});var r=n(5153),s=n(89277),i=n(29651);const o={"1d":"1d","2d":"2d","2d-array":"2d",cube:"2d","cube-array":"2d","3d":"3d"};class a extends r.F{static SAMPLE=4;static STORAGE=8;static RENDER=16;static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static RENDER_ATTACHMENT=16;dimension;baseDimension;format;width;height;depth;mipLevels;updateTimestamp;get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}constructor(e,t){if(super(e,t=a.normalizeProps(e,t),a.defaultProps),this.dimension=this.props.dimension,this.baseDimension=o[this.dimension],this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.mipLevels=this.props.mipLevels,void 0===this.props.width||void 0===this.props.height)if(e.isExternalImage(t.data)){const n=e.getExternalImageSize(t.data);this.width=n?.width||1,this.height=n?.height||1}else this.width=1,this.height=1,void 0!==this.props.width&&void 0!==this.props.height||i.R.warn(`${this} created with undefined width or height. This is deprecated. Use AsyncTexture instead.`)();this.updateTimestamp=e.incrementTimestamp()}setSampler(e){this.sampler=e instanceof s.L?e:this.device.createSampler(e)}clone(e){return this.device.createTexture({...this.props,...e})}static normalizeProps(e,t){const n={...t},{width:r,height:s}=n;return"number"==typeof r&&(n.width=Math.max(1,Math.ceil(r))),"number"==typeof s&&(n.height=Math.max(1,Math.ceil(s))),n}_initializeData(e){this.device.isExternalImage(e)?this.copyExternalImage({image:e,width:this.width,height:this.height,depth:this.depth,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}):e&&this.copyImageData({data:e,mipLevel:0,x:0,y:0,z:0,aspect:"all"})}_normalizeCopyImageDataOptions(e){const{width:t,height:n,depth:r}=this,s={...a.defaultCopyDataOptions,width:t,height:n,depth:r,...e},i=this.device.getTextureFormatInfo(this.format);if(!e.bytesPerRow&&!i.bytesPerPixel)throw new Error(`bytesPerRow must be provided for texture format ${this.format}`);return s.bytesPerRow=e.bytesPerRow||t*(i.bytesPerPixel||4),s.rowsPerImage=e.rowsPerImage||n,s}_normalizeCopyExternalImageOptions(e){const t=this.device.getExternalImageSize(e.image),n={...a.defaultCopyExternalImageOptions,...t,...e};return n.width=Math.min(n.width,this.width-n.x),n.height=Math.min(n.height,this.height-n.y),n}static defaultProps={...r.F.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",usage:a.TEXTURE|a.RENDER_ATTACHMENT|a.COPY_DST,width:void 0,height:void 0,depth:1,mipLevels:1,samples:void 0,sampler:{},view:void 0};static defaultCopyDataOptions={data:void 0,byteOffset:0,bytesPerRow:void 0,rowsPerImage:void 0,mipLevel:0,x:0,y:0,z:0,aspect:"all"};static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}}},81312:(e,t,n)=>{n.d(t,{i:()=>i});var r=n(93640),s=n(74003);function i(){let e;if((0,s.B)()&&r.x.performance)e=r.x?.performance?.now?.();else if("hrtime"in r.eh){const t=r.eh?.hrtime?.();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}},81813:(e,t,n)=>{function r(e){return function(e,t,n=0){const r=(s=t,[...s].map(e=>e.charCodeAt(0)));var s;for(let i=0;i<r.length;++i)if(r[i]!==e[i+n])return!1;return!0}(e,"ftyp",4)&&96&e[8]?function(e){switch((t=e,n=8,r=12,String.fromCharCode(...t.slice(n,r))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var t,n,r}(e):null}n.d(t,{Z:()=>r})},82027:(e,t,n)=>{n.d(t,{g:()=>i});var r=n(13364),s=n(29651);class i{static defaultProps={...r.M.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new i(e),e._lumaData.defaultShaderFactory}device;cachingEnabled;destroyPolicy;debug;_cache={};get[Symbol.toStringTag](){return"ShaderFactory"}toString(){return`${this[Symbol.toStringTag]}(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cacheShaders,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=!0}createShader(e){if(!this.cachingEnabled)return this.device.createShader(e);const t=this._hashShader(e);let n=this._cache[t];if(n)n.useCount++,this.debug&&s.R.warn(`${this}: Reusing shader ${n.shader.id} count=${n.useCount}`)();else{const r=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[t]=n={shader:r,useCount:1},this.debug&&s.R.warn(`${this}: Created new shader ${r.id}`)()}return n.shader}release(e){if(!this.cachingEnabled)return void e.destroy();const t=this._hashShader(e),n=this._cache[t];if(n)if(n.useCount--,0===n.useCount)"unused"===this.destroyPolicy&&(delete this._cache[t],n.shader.destroy(),this.debug&&s.R.warn(`${this}: Releasing shader ${e.id}, destroyed`)());else{if(n.useCount<0)throw new Error(`ShaderFactory: Shader ${e.id} released too many times`);this.debug&&s.R.warn(`${this}: Releasing shader ${e.id} count=${n.useCount}`)()}}_hashShader(e){return`${e.stage}:${e.source}`}}},82041:(e,t,n)=>{n.d(t,{A:()=>c});var r=n(8199),s=n(58813),i=n(64756),o=n(3459);const a={interpolation:s.A,spring:i.A};class c{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,n,s){const{transitions:i}=this;if(i.has(e)){const n=i.get(e),{value:r=n.settings.fromValue}=n;t=r,this.remove(e)}if(!(s=(0,r.K)(s)))return;const c=a[s.type];if(!c)return void o.A.error(`unsupported transition type '${s.type}'`)();const l=new c(this.timeline);l.start({...s,fromValue:t,toValue:n}),i.set(e,l)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,n]of this.transitions)n.update(),e[t]=n.value,n.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}},82417:(e,t,n)=>{function r(e,t){if(e===t)return!0;if(Array.isArray(e)){const n=e.length;if(!t||t.length!==n)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}return!1}function s(e){let t,n={};return s=>{for(const i in s)if(!r(s[i],n[i])){t=e(s),n=s;break}return t}}n.d(t,{A:()=>s})},82859:(e,t,n)=>{n.d(t,{$A:()=>a,WQ:()=>s,Z0:()=>c,Z8:()=>d,eL:()=>h,ei:()=>l,g7:()=>p,gL:()=>u,jb:()=>g,lK:()=>_,x6:()=>f,ze:()=>i});var r=n(50741);function s(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function i(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function o(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function a(e,t,n){const r=t[0],s=t[1],i=t[2],o=n[0],a=n[1],c=n[2];return e[0]=s*c-i*a,e[1]=i*o-r*c,e[2]=r*a-s*o,e}function c(e,t,n){const r=t[0],s=t[1],i=t[2];let o=n[3]*r+n[7]*s+n[11]*i+n[15];return o=o||1,e[0]=(n[0]*r+n[4]*s+n[8]*i+n[12])/o,e[1]=(n[1]*r+n[5]*s+n[9]*i+n[13])/o,e[2]=(n[2]*r+n[6]*s+n[10]*i+n[14])/o,e}function l(e,t,n){const r=t[0],s=t[1],i=t[2];return e[0]=r*n[0]+s*n[3]+i*n[6],e[1]=r*n[1]+s*n[4]+i*n[7],e[2]=r*n[2]+s*n[5]+i*n[8],e}function u(e,t,n){const r=n[0],s=n[1],i=n[2],o=n[3],a=t[0],c=t[1],l=t[2];let u=s*l-i*c,h=i*a-r*l,d=r*c-s*a,f=s*d-i*h,p=i*u-r*d,g=r*h-s*u;const _=2*o;return u*=_,h*=_,d*=_,f*=2,p*=2,g*=2,e[0]=a+u+f,e[1]=c+h+p,e[2]=l+d+g,e}function h(e,t,n,r){const s=[],i=[];return s[0]=t[0]-n[0],s[1]=t[1]-n[1],s[2]=t[2]-n[2],i[0]=s[0],i[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),i[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function d(e,t,n,r){const s=[],i=[];return s[0]=t[0]-n[0],s[1]=t[1]-n[1],s[2]=t[2]-n[2],i[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),i[1]=s[1],i[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function f(e,t,n,r){const s=[],i=[];return s[0]=t[0]-n[0],s[1]=t[1]-n[1],s[2]=t[2]-n[2],i[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),i[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),i[2]=s[2],e[0]=i[0]+n[0],e[1]=i[1]+n[1],e[2]=i[2]+n[2],e}function p(e,t){const n=e[0],r=e[1],s=e[2],i=t[0],a=t[1],c=t[2],l=Math.sqrt((n*n+r*r+s*s)*(i*i+a*a+c*c)),u=l&&o(e,t)/l;return Math.acos(Math.min(Math.max(u,-1),1))}const g=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},_=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e};!function(){const e=function(){const e=new r.tb(3);return r.tb!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}()}()},82963:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(25285);class s extends r.A{constructor(e,t){super(e,t);const n=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),r=e.createTexture({format:"depth16unorm",width:1,height:1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[n],depthStencilAttachment:r})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const t=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),r=e.viewports[0],s=r.width*n,i=r.height*n;s===t.width&&i===t.height||t.resize({width:s,height:i}),super.render({...e,clearColor:[1,1,1,1],target:t,pass:"shadow"})}getLayerParameters(e,t,n){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getShaderModuleProps(e,t,n){return{shadow:{project:n.project,drawToShadowMap:!0}}}}},83588:(e,t,n)=>{n.d(t,{Cc:()=>o,WQ:()=>s,Z0:()=>u,ZF:()=>a,ei:()=>l,l0:()=>c,ze:()=>i});var r=n(50741);function s(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function i(e,t){return e[0]=-t[0],e[1]=-t[1],e}function o(e,t,n,r){const s=t[0],i=t[1];return e[0]=s+r*(n[0]-s),e[1]=i+r*(n[1]-i),e}function a(e,t,n){const r=t[0],s=t[1];return e[0]=n[0]*r+n[2]*s,e[1]=n[1]*r+n[3]*s,e}function c(e,t,n){const r=t[0],s=t[1];return e[0]=n[0]*r+n[2]*s+n[4],e[1]=n[1]*r+n[3]*s+n[5],e}function l(e,t,n){const r=t[0],s=t[1];return e[0]=n[0]*r+n[3]*s+n[6],e[1]=n[1]*r+n[4]*s+n[7],e}function u(e,t,n){const r=t[0],s=t[1];return e[0]=n[0]*r+n[4]*s+n[12],e[1]=n[1]*r+n[5]*s+n[13],e}!function(){const e=function(){const e=new r.tb(2);return r.tb!=Float32Array&&(e[0]=0,e[1]=0),e}()}()},83593:(e,t,n)=>{n.d(t,{Fh:()=>o,OO:()=>i,wb:()=>s});var r=n(31661);function s(e,t){if(function(e){for(const t in e)return!1;return!0}(t))return;const n={};for(const i in t){const s=Number(i),o=r.hE[i];o&&("string"==typeof o?n[o]=!0:o(e,t[i],s))}const s=e.state&&e.state.cache;if(s)for(const i in n){(0,r.xI[i])(e,t,s)}}function i(e,t=r.V_){if("number"==typeof t){const n=t,s=r.pK[n];return s?s(e,n):e.getParameter(n)}const n=Array.isArray(t)?t:Object.keys(t),s={};for(const i of n){const t=r.pK[i];s[i]=t?t(e,Number(i)):e.getParameter(Number(i))}return s}function o(e){s(e,r.V_)}},83701:(e,t,n)=>{n.d(t,{u:()=>s});const r=1048576;async function*s(e,t){const n=t?.chunkSize||r;let s=0;for(;s<e.size;){const t=s+n,r=await e.slice(s,t).arrayBuffer();s=t,yield r}}},83749:(e,t,n)=>{function r(e){return e}n.d(t,{X:()=>r})},83895:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(49042);const s={...r.q,defaultUniforms:{...r.q.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}}},83909:(e,t,n)=>{n.d(t,{I7:()=>h,PI:()=>u,pF:()=>d});var r=n(76028),s=n(29651),i=n(74683),o=n(26839),a=n(77933),c=n(25543),l=n(93520);class u{}class h{features;disabledFeatures;constructor(e=[],t){this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class d{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,webgl:{},onError:(e,t)=>{},onResize:(e,t)=>{const[n,r]=e.getDevicePixelSize();s.R.log(1,`${e} resized => ${n}x${r}px`)()},onPositionChange:(e,t)=>{const[n,r]=e.getPosition();s.R.log(1,`${e} repositioned => ${n},${r}`)()},onVisibilityChange:e=>s.R.log(1,`${e} Visibility changed ${e.isVisible}`)(),onDevicePixelRatioChange:(e,t)=>s.R.log(1,`${e} DPR changed ${t.oldRatio} => ${e.devicePixelRatio}`)(),debug:s.R.get("debug")||void 0,debugShaders:s.R.get("debug-shaders")||void 0,debugFramebuffers:Boolean(s.R.get("debug-framebuffers")),debugFactories:Boolean(s.R.get("debug-factories")),debugWebGL:Boolean(s.R.get("debug-webgl")),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_reuseDevices:!1,_requestMaxLimits:!0,_cacheShaders:!1,_cachePipelines:!1,_cacheDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_handle:void 0};get[Symbol.toStringTag](){return"Device"}toString(){return`Device(${this.id})`}id;props;userData={};statsManager=r.d;timestamp=0;_reused=!1;_lumaData={};_textureCaps={};constructor(e){this.props={...d.defaultProps,...e},this.id=this.props.id||(0,i.L)(this[Symbol.toStringTag].toLowerCase())}getVertexFormatInfo(e){return(0,a.yx)(e)}isVertexFormatSupported(e){return!0}getTextureFormatInfo(e){return c.v.getInfo(e)}getTextureFormatCapabilities(e){let t=this._textureCaps[e];if(!t){const n=this._getDeviceTextureFormatCapabilities(e);t=this._getDeviceSpecificTextureFormatCapabilities(n),this._textureCaps[e]=t}return t}getMipLevelCount(e,t,n=1){const r=Math.max(e,t,n);return 1+Math.floor(Math.log2(r))}isExternalImage(e){return(0,l.x)(e)}getExternalImageSize(e){return(0,l.c)(e)}isTextureFormatSupported(e){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return c.v.isCompressed(e)}pushDebugGroup(e){this.commandEncoder.pushDebugGroup(e)}popDebugGroup(){this.commandEncoder?.popDebugGroup()}insertDebugMarker(e){this.commandEncoder?.insertDebugMarker(e)}loseDevice(){return!1}incrementTimestamp(){return this.timestamp++}reportError(e,t,...n){return this.props.onError(e,t)?()=>{}:s.R.error(e.message,t,...n)}debug(){if(this.props.debug);else{const e="'Type luma.log.set({debug: true}) in console to enable debug breakpoints',\nor create a device with the 'debug: true' prop.";s.R.once(0,e)()}}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}beginRenderPass(e){return this.commandEncoder.beginRenderPass(e)}beginComputePass(e){return this.commandEncoder.beginComputePass(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return!0===e.createCanvasContext?{}:e.createCanvasContext}_getDeviceTextureFormatCapabilities(e){const t=c.v.getCapabilities(e),n=e=>("string"==typeof e?this.features.has(e):e)??!0,r=n(t.create);return{format:e,create:r,render:r&&n(t.render),filter:r&&n(t.filter),blend:r&&n(t.blend),store:r&&n(t.store)}}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t={...e};if((e.usage||0)&o.h.INDEX&&(e.indexType||(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array&&(t.indexType="uint16")),!t.indexType))throw new Error("indices buffer content must be of type uint16 or uint32");return t}}},84175:(e,t,n)=>{n.d(t,{A:()=>r});const r={name:"project32",dependencies:[n(31327).A],source:"// Define a structure to hold both the clip-space position and the common position.\nstruct ProjectResult {\n  clipPosition: vec4<f32>,\n  commonPosition: vec4<f32>,\n};\n\n// This function mimics the GLSL version with the 'out' parameter by returning both values.\nfn project_position_to_clipspace_and_commonspace(\n    position: vec3<f32>,\n    position64Low: vec3<f32>,\n    offset: vec3<f32>\n) -> ProjectResult {\n  // Compute the projected position.\n  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);\n\n  // Start with the provided offset.\n  var finalOffset: vec3<f32> = offset;\n\n  // Get whether a rotation is needed and the rotation matrix.\n  let rotationResult = project_needs_rotation(projectedPosition);\n\n  // If rotation is needed, update the offset.\n  if (rotationResult.needsRotation) {\n    finalOffset = rotationResult.transform * offset;\n  }\n\n  // Compute the common position.\n  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);\n\n  // Convert to clip-space.\n  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);\n\n  return ProjectResult(clipPosition, commonPosition);\n}\n\n// A convenience overload that returns only the clip-space position.\nfn project_position_to_clipspace(\n    position: vec3<f32>,\n    position64Low: vec3<f32>,\n    offset: vec3<f32>\n) -> vec4<f32> {\n  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;\n}\n",vs:"vec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"}},84565:(e,t,n)=>{function r(e,t=["constructor"]){const n=Object.getPrototypeOf(e),r=Object.getOwnPropertyNames(n),s=e;for(const i of r){const n=s[i];"function"==typeof n&&(t.find(e=>i===e)||(s[i]=n.bind(e)))}}n.d(t,{d:()=>r})},85007:(e,t,n)=>{n.d(t,{K:()=>a});var r=n(26839),s=n(29651),i=n(32367),o=n(34113);class a{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(const[t,n]of Object.entries(e)){const e=t,r=new o.j(n.uniformTypes??{},n.uniformSizes??{});this.uniformBufferLayouts.set(e,r);const s=new i.q({name:t});s.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(e,s)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[t,n]of Object.entries(e))this.uniformBlocks.get(t)?.setUniforms(n);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const t=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(t)}createUniformBuffer(e,t,n){n&&this.setUniforms(n);const s=this.getUniformBufferByteLength(t),i=e.createBuffer({usage:r.h.UNIFORM|r.h.COPY_DST,byteLength:s}),o=this.getUniformBufferData(t);return i.write(o),i}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const n=this.getUniformBufferByteLength(t),s=e.createBuffer({usage:r.h.UNIFORM|r.h.COPY_DST,byteLength:n});this.uniformBuffers.set(t,s)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(t);e||=n}return e&&s.R.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const t=this.uniformBlocks.get(e);let n=this.uniformBuffers.get(e),r=!1;if(n&&t?.needsRedraw){r||=t.needsRedraw;const i=this.getUniformBufferData(e);n=this.uniformBuffers.get(e),n?.write(i);const o=this.uniformBlocks.get(e)?.getAllUniforms();s.R.log(4,`Writing to uniform buffer ${String(e)}`,i,o)()}return r}}},85036:(e,t,n)=>{n.d(t,{dI:()=>o});var r=n(76456),s=n(93018),i=n(97681);const o={name:"fp64arithmetic",vs:s.E,defaultUniforms:{ONE:1},uniformTypes:{ONE:"f32"},fp64ify:r.v9,fp64LowPart:r.qk,fp64ifyMatrix4:r.yo};i.y,r.v9,r.qk,r.yo},85038:(e,t,n)=>{n.d(t,{e:()=>s});var r=n(40424);function s(e){const t={};return e.addressModeU&&(t[10242]=i(e.addressModeU)),e.addressModeV&&(t[10243]=i(e.addressModeV)),e.addressModeW&&(t[32882]=i(e.addressModeW)),e.magFilter&&(t[10240]=o(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[10241]=function(e,t="none"){if(!t)return o(e);switch(t){case"none":return o(e);case"nearest":switch(e){case"nearest":return 9984;case"linear":return 9985}break;case"linear":switch(e){case"nearest":return 9986;case"linear":return 9987}}}(e.minFilter||"linear",e.mipmapFilter)),void 0!==e.lodMinClamp&&(t[33082]=e.lodMinClamp),void 0!==e.lodMaxClamp&&(t[33083]=e.lodMaxClamp),"comparison-sampler"===e.type&&(t[34892]=34894),e.compare&&(t[34893]=(0,r.Te)("compare",e.compare)),e.maxAnisotropy&&(t[34046]=e.maxAnisotropy),t}function i(e){switch(e){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function o(e){switch(e){case"nearest":return 9728;case"linear":return 9729}}},85232:(e,t,n)=>{function r(e){const{source:t,target:n,start:r=0,size:s,getData:i}=e,o=e.end||n.length,a=t.length,c=o-r;if(a>c)return void n.set(t.subarray(0,c),r);if(n.set(t,r),!i)return;let l=a;for(;l<c;){const e=i(l,t);for(let t=0;t<s;t++)n[r+l]=e[t]||0,l++}}function s({source:e,target:t,size:n,getData:s,sourceStartIndices:i,targetStartIndices:o}){if(!i||!o)return r({source:e,target:t,size:n,getData:s}),t;let a=0,c=0;const l=s&&((e,t)=>s(e+c,t)),u=Math.min(i.length,o.length);for(let h=1;h<u;h++){const s=i[h]*n,u=o[h]*n;r({source:e.subarray(a,s),target:t,start:c,end:u,size:n,getData:l}),a=s,c=u}return c<t.length&&r({source:[],target:t,start:c,size:n,getData:l}),t}n.d(t,{N:()=>s})},85450:(e,t,n)=>{n.d(t,{d_:()=>l});var r=n(80698),s=n(29651),i=n(21719),o=n(85038),a=n(90539),c=n(92134);class l extends r.g{device;gl;handle;sampler=void 0;view;glTarget;glFormat;glType;glInternalFormat;compressed;_textureUnit=0;constructor(e,t){super(e,t),this.device=e,this.gl=this.device.gl;const n=(0,i.M8)(this.props.format);this.glTarget=function(e){switch(e){case"1d":case"cube-array":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(e)}(this.props.dimension),this.glInternalFormat=n.internalFormat,this.glFormat=n.format,this.glType=n.type,this.compressed=n.compressed,this.handle=this.props.handle||this.gl.createTexture(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.gl.bindTexture(this.glTarget,this.handle);const{dimension:r,width:s,height:o,depth:a,mipLevels:l,glTarget:u,glInternalFormat:h}=this;switch(r){case"2d":case"cube":this.gl.texStorage2D(u,l,h,s,o);break;case"2d-array":case"3d":this.gl.texStorage3D(u,l,h,s,o,a);break;default:throw new Error(r)}this.gl.bindTexture(this.glTarget,null),this._initializeData(t.data),this.setSampler(this.props.sampler),this.view=new c.C(this.device,{...this.props,texture:this}),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new c.C(this.device,{...e,texture:this})}setSampler(e={}){super.setSampler(e);const t=(0,o.e)(this.sampler.props);this._setSamplerParameters(t)}copyImageData(e){const t=this._normalizeCopyImageDataOptions(e),n=t.data,{width:r,height:s,depth:i}=this,{mipLevel:o=0,byteOffset:c=0,x:l=0,y:h=0,z:d=0}=t,{glFormat:f,glType:p,compressed:g}=this,_=u(this.glTarget,this.dimension,d);let m;if(!this.compressed){const{bytesPerPixel:e}=this.device.getTextureFormatInfo(this.format);if(e){if(t.bytesPerRow%e!==0)throw new Error(`bytesPerRow (${t.bytesPerRow}) must be a multiple of bytesPerPixel (${e}) for ${this.format}`);m=t.bytesPerRow/e}}const v=this.compressed?{}:{...void 0!==m?{3314:m}:{},32878:t.rowsPerImage};this.gl.bindTexture(_,this.handle),(0,a.O)(this.gl,v,()=>{switch(this.dimension){case"2d":case"cube":g?this.gl.compressedTexSubImage2D(_,o,l,h,r,s,f,n,c):this.gl.texSubImage2D(_,o,l,h,r,s,f,p,n,c);break;case"2d-array":case"3d":g?this.gl.compressedTexSubImage3D(_,o,l,h,d,r,s,i,f,n,c):this.gl.texSubImage3D(_,o,l,h,d,r,s,i,f,p,n,c)}}),this.gl.bindTexture(_,null)}copyExternalImage(e){const t=this._normalizeCopyExternalImageOptions(e);if(t.sourceX||t.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");const{glFormat:n,glType:r}=this,{image:s,depth:i,mipLevel:o,x:c,y:l,z:h,width:d,height:f}=t,p=u(this.glTarget,this.dimension,i),g=t.flipY?{37440:!0}:{};return this.gl.bindTexture(this.glTarget,this.handle),(0,a.O)(this.gl,g,()=>{switch(this.dimension){case"2d":case"cube":this.gl.texSubImage2D(p,o,c,l,d,f,n,r,s);break;case"2d-array":case"3d":this.gl.texSubImage3D(p,o,c,l,h,d,f,i,n,r,s)}}),this.gl.bindTexture(this.glTarget,null),{width:t.width,height:t.height}}generateMipmapsWebGL(e){if(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format)||(s.R.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),e?.force))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(t){s.R.warn(`Error generating mipmap for ${this}: ${t.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}_setSamplerParameters(e){s.R.log(2,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[t,n]of Object.entries(e)){const e=Number(t),r=n;switch(e){case 33082:case 33083:this.gl.texParameterf(this.glTarget,e,r);break;case 10240:case 10241:case 10242:case 10243:case 32882:case 34892:case 34893:this.gl.texParameteri(this.glTarget,e,r);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,e,r)}}this.gl.bindTexture(this.glTarget,null)}_getActiveUnit(){return this.gl.getParameter(34016)-33984}_bind(e){const{gl:t}=this;return void 0!==e&&(this._textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,this.handle),e}_unbind(e){const{gl:t}=this;return void 0!==e&&(this._textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,null),e}}function u(e,t,n){return"cube"===t?34069+n:e}},85753:(e,t,n)=>{function r(e){return e.trim().split(/\s+/g)}n.d(t,{M:()=>r})},85960:(e,t,n)=>{n.d(t,{P:()=>s});var r=n(56769);class s extends r.p{constructor(e,t,n){super(e,t,n),this.handleEvent=e=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){"contextmenu"===e&&(this.options.enable=t)}}},86143:(e,t,n)=>{n.d(t,{iR:()=>u});var r=n(80698),s=n(89277),i=n(29651),o=n(73156),a=n(4500);const c=["+X","-X","+Y","-Y","+Z","-Z"],l=["+X","-X","+Y","-Y","+Z","-Z"];class u{device;id;props;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,t){this.device=e;const n=(0,a.L)("async-texture");this.props={...u.defaultProps,id:n,...t},this.id=this.props.id,t={...t},"string"==typeof t?.data&&"2d"===t.dimension&&(t.data=(0,o.Dt)(t.data)),t.mipmaps&&(t.mipLevels="auto"),this.ready=new Promise((e,t)=>{this.resolveReady=()=>{this.isReady=!0,e()},this.rejectReady=t}),this.initAsync(t)}async initAsync(e){const t=e.data,n=await h(t).then(void 0,this.rejectReady);if(this.destroyed)return;const r=this.props.width&&this.props.height?{width:this.props.width,height:this.props.height}:this.getTextureDataSize(n);if(!r)throw new Error("Texture size could not be determined");const s={...r,...e,data:void 0,mipLevels:1},o=this.device.getMipLevelCount(s.width,s.height);if(s.mipLevels="auto"===this.props.mipLevels?o:Math.min(o,this.props.mipLevels),this.texture=this.device.createTexture(s),this.sampler=this.texture.sampler,this.view=this.texture.view,e.data)switch(this.props.dimension){case"1d":this._setTexture1DData(this.texture,n);break;case"2d":this._setTexture2DData(n);break;case"3d":this._setTexture3DData(this.texture,n);break;case"2d-array":this._setTextureArrayData(this.texture,n);break;case"cube":this._setTextureCubeData(this.texture,n);break;case"cube-array":this._setTextureCubeArrayData(this.texture,n)}this.props.mipmaps&&this.generateMipmaps(),i.R.info(1,`${this} loaded`),this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}generateMipmaps(){this.texture.generateMipmapsWebGL()}setSampler(e={}){this.texture.setSampler(e instanceof s.L?e:this.device.createSampler(e))}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const t=this.texture;this.texture=t.clone(e),t.destroy()}return!0}isTextureLevelData(e){const t=e?.data;return ArrayBuffer.isView(t)}getTextureDataSize(e){if(!e)return null;if(ArrayBuffer.isView(e))return null;if(Array.isArray(e))return this.getTextureDataSize(e[0]);if(this.device.isExternalImage(e))return this.device.getExternalImageSize(e);if(e&&"object"==typeof e&&e.constructor===Object){const t=Object.values(e)[0];return{width:t.width,height:t.height}}throw new Error("texture size deduction failed")}getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}setTextureData(e){}_setTexture1DData(e,t){throw new Error("setTexture1DData not supported in WebGL.")}_setTexture2DData(e,t=0){if(!this.texture)throw new Error("Texture not initialized");const n=this._normalizeTextureData(e);n.length>1&&!1!==this.props.mipmaps&&i.R.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let r=0;r<n.length;r++){const e=n[r];this.device.isExternalImage(e)?this.texture.copyExternalImage({image:e,depth:t,mipLevel:r,flipY:!0}):this.texture.copyImageData({data:e.data,mipLevel:r})}}_setTexture3DData(e,t){if("3d"!==this.texture?.props.dimension)throw new Error(this.id);for(let n=0;n<t.length;n++)this._setTexture2DData(t[n],n)}_setTextureCubeData(e,t){if("cube"!==this.texture?.props.dimension)throw new Error(this.id);for(const[n,r]of Object.entries(t)){const e=l.indexOf(n);this._setTexture2DData(r,e)}}_setTextureArrayData(e,t){if("2d-array"!==this.texture?.props.dimension)throw new Error(this.id);for(let n=0;n<t.length;n++)this._setTexture2DData(t[n],n)}_setTextureCubeArrayData(e,t){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}_setTextureCubeFaceData(e,t,n,r=0){Array.isArray(t)&&t.length>1&&!1!==this.props.mipmaps&&i.R.warn(`${this.id} has mipmap and multiple LODs.`)();const s=c.indexOf(n);this._setTexture2DData(t,s)}_normalizeTextureData(e){const t=this.texture;let n;return n=ArrayBuffer.isView(e)?[{data:e,width:t.width,height:t.height}]:Array.isArray(e)?e:[e],n}static defaultProps={...r.g.defaultProps,data:null,mipmaps:!1}}async function h(e){if(e=await e,Array.isArray(e))return await Promise.all(e.map(h));if(e&&"object"==typeof e&&e.constructor===Object){const t=e,n=await Promise.all(Object.values(t)),r=Object.keys(t),s={};for(let e=0;e<r.length;e++)s[r[e]]=n[e];return s}return e}},86231:(e,t,n)=>{function r(e){return a[e]}function s(e){const[t,n]=o[e],r="i32"===t||"u32"===t,s="u32"!==t;return{primitiveType:t,components:n,byteLength:i[t]*n,integer:r,signed:s}}n.d(t,{k0:()=>r,wH:()=>s});const i={f32:4,f16:2,i32:4,u32:4},o={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},a={f32:{type:"f32",components:1},f16:{type:"f16",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<f16>":{type:"f16",components:2},"vec3<f16>":{type:"f16",components:3},"vec4<f16>":{type:"f16",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16},"mat2x2<f16>":{type:"f16",components:4},"mat2x3<f16>":{type:"f16",components:6},"mat2x4<f16>":{type:"f16",components:8},"mat3x2<f16>":{type:"f16",components:6},"mat3x3<f16>":{type:"f16",components:9},"mat3x4<f16>":{type:"f16",components:12},"mat4x2<f16>":{type:"f16",components:8},"mat4x3<f16>":{type:"f16",components:12},"mat4x4<f16>":{type:"f16",components:16},"mat2x2<i32>":{type:"i32",components:4},"mat2x3<i32>":{type:"i32",components:6},"mat2x4<i32>":{type:"i32",components:8},"mat3x2<i32>":{type:"i32",components:6},"mat3x3<i32>":{type:"i32",components:9},"mat3x4<i32>":{type:"i32",components:12},"mat4x2<i32>":{type:"i32",components:8},"mat4x3<i32>":{type:"i32",components:12},"mat4x4<i32>":{type:"i32",components:16},"mat2x2<u32>":{type:"u32",components:4},"mat2x3<u32>":{type:"u32",components:6},"mat2x4<u32>":{type:"u32",components:8},"mat3x2<u32>":{type:"u32",components:6},"mat3x3<u32>":{type:"u32",components:9},"mat3x4<u32>":{type:"u32",components:12},"mat4x2<u32>":{type:"u32",components:8},"mat4x3<u32>":{type:"u32",components:12},"mat4x4<u32>":{type:"u32",components:16}},c={vec2i:"vec2<i32>",vec3i:"vec3<i32>",vec4i:"vec4<i32>",vec2u:"vec2<u32>",vec3u:"vec3<u32>",vec4u:"vec4<u32>",vec2f:"vec2<f32>",vec3f:"vec3<f32>",vec4f:"vec4<f32>",vec2h:"vec2<f16>",vec3h:"vec3<f16>",vec4h:"vec4<f16>"}},86482:(e,t,n)=>{n.d(t,{m:()=>l});var r=n(76726),s=n(76280),i=n(85753),o=n(92950),a=n(77264);const c={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class l{constructor(e,t){this.options={...c,...t,cssProps:{...c.cssProps,...t.cssProps},inputTarget:t.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new s.i(this),this.touchAction=new r.K(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?2:1}recognize(e){const{session:t}=this;if(t.stopped)return;let n;this.session.prevented&&e.srcEvent.preventDefault();const{recognizers:r}=this;let{curRecognizer:s}=t;(!s||s&&s.state&a.g.Recognized)&&(s=t.curRecognizer=null);let i=0;for(;i<r.length;)n=r[i],2===t.stopped||s&&n!==s&&!n.canRecognizeWith(s)?n.reset():n.recognize(e),!s&&n.state&(a.g.Began|a.g.Changed|a.g.Ended)&&(s=t.curRecognizer=n),i++}get(e){const{recognizers:t}=this;for(let n=0;n<t.length;n++)if(t[n].options.event===e)return t[n];return null}add(e){if(Array.isArray(e)){for(const t of e)this.add(t);return this}const t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const t of e)this.remove(t);return this}const t="string"==typeof e?this.get(e):e;if(t){const{recognizers:e}=this,n=e.indexOf(t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this}on(e,t){if(!e||!t)return;const{handlers:n}=this;for(const r of(0,i.M)(e))n[r]=n[r]||[],n[r].push(t)}off(e,t){if(!e)return;const{handlers:n}=this;for(const r of(0,i.M)(e))t?n[r]&&n[r].splice(n[r].indexOf(t),1):delete n[r]}emit(e,t){const n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;const r=t;r.type=e,r.preventDefault=function(){t.srcEvent.preventDefault()};let s=0;for(;s<n.length;)n[s](r),s++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:t}=this;if(t){for(const[n,r]of Object.entries(this.options.cssProps)){const s=(0,o.g)(t.style,n);e?(this.oldCssProps[s]=t.style[s],t.style[s]=r):t.style[s]=this.oldCssProps[s]||""}e||(this.oldCssProps={})}}}},86798:(e,t,n)=>{var r=n(44860);n(77264),n(93871),n(88171);r.f},87022:(e,t,n)=>{n.d(t,{A:()=>s});const r=262144;function*s(e,t={}){const{chunkSize:n=r}=t;let s=0;for(;s<e.byteLength;){const t=Math.min(e.byteLength-s,n),r=new ArrayBuffer(t),i=new Uint8Array(e,s,t);new Uint8Array(r).set(i),s+=t,yield r}}},87597:(e,t,n)=>{n.d(t,{P:()=>u});var r=n(54272),s=n(54901),i=n(73731),o=n(82859),a=n(68225);const c=[0,0,0];let l;class u extends r.M{static get ZERO(){return l||(l=new u(0,0,0),Object.freeze(l)),l}constructor(e=0,t=0,n=0){super(-0,-0,-0),1===arguments.length&&(0,s.cy)(e)?this.copy(e):(s.$W.debug&&((0,i.ws)(e),(0,i.ws)(t),(0,i.ws)(n)),this[0]=e,this[1]=t,this[2]=n)}set(e,t,n){return this[0]=e,this[1]=t,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return s.$W.debug&&((0,i.ws)(e.x),(0,i.ws)(e.y),(0,i.ws)(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=(0,i.ws)(e)}angle(e){return(0,o.g7)(this,e)}cross(e){return(0,o.$A)(this,this,e),this.check()}rotateX({radians:e,origin:t=c}){return(0,o.eL)(this,this,t,e),this.check()}rotateY({radians:e,origin:t=c}){return(0,o.Z8)(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=c}){return(0,o.x6)(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return(0,o.Z0)(this,this,e),this.check()}transformAsVector(e){return(0,a.cL)(this,this,e),this.check()}transformByMatrix3(e){return(0,o.ei)(this,this,e),this.check()}transformByMatrix2(e){return(0,a.J4)(this,this,e),this.check()}transformByQuaternion(e){return(0,o.gL)(this,this,e),this.check()}}},87835:(e,t,n)=>{function r(e,t){if(!e)throw new Error(t||"Assertion failed")}n.d(t,{A:()=>r})},88171:(e,t,n)=>{n.d(t,{Ay:()=>r,TL:()=>s,e8:()=>i});const r=25;var s,i;!function(e){e[e.Start=1]="Start",e[e.Move=2]="Move",e[e.End=4]="End",e[e.Cancel=8]="Cancel"}(s||(s={})),function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Up=4]="Up",e[e.Down=8]="Down",e[e.Horizontal=3]="Horizontal",e[e.Vertical=12]="Vertical",e[e.All=15]="All"}(i||(i={}))},88679:(e,t,n)=>{n.d(t,{A3:()=>o,Ol:()=>i,Pu:()=>l,Sg:()=>u,aI:()=>h,ro:()=>a,yY:()=>c});var r=n(85232),s=n(50708);function i(e){const{device:t,settings:n,value:r}=e,i=new s.A(t,n);return i.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),i}function o(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${e}"`)}}function a(e){switch(e){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function c(e){e.push(e.shift())}function l(e,t){const{doublePrecision:n,settings:r,value:s,size:i}=e,o=n&&s instanceof Float64Array?2:1;let a=0;const{shaderAttributes:c}=e.settings;if(c)for(const l of Object.values(c))a=Math.max(a,l.vertexOffset??0);return(r.noAlloc?s.length:(t+a)*i)*o}function u({device:e,source:t,target:n}){return(!n||n.byteLength<t.byteLength)&&(n?.destroy(),n=e.createBuffer({byteLength:t.byteLength,usage:t.usage})),n}function h({device:e,buffer:t,attribute:n,fromLength:s,toLength:i,fromStartIndices:o,getData:a=e=>e}){const c=n.doublePrecision&&n.value instanceof Float64Array?2:1,l=n.size*c,u=n.byteOffset,h=n.settings.bytesPerElement<4?u/n.settings.bytesPerElement*4:u,d=n.startIndices,f=o&&d,p=n.isConstant;if(!f&&t&&s>=i)return t;const g=n.value instanceof Float64Array?Float32Array:n.value.constructor,_=p?n.value:new g(n.getBuffer().readSyncWebGL(u,i*g.BYTES_PER_ELEMENT).buffer);if(n.settings.normalized&&!p){const e=a;a=(t,r)=>n.normalizeConstant(e(t,r))}const m=p?(e,t)=>a(_,t):(e,t)=>a(_.subarray(e+u,e+u+l),t),v=t?new Float32Array(t.readSyncWebGL(h,4*s).buffer):new Float32Array(0),b=new Float32Array(i);return(0,r.N)({source:v,target:b,sourceStartIndices:o,targetStartIndices:d,size:l,getData:m}),(!t||t.byteLength<b.byteLength+h)&&(t?.destroy(),t=e.createBuffer({byteLength:b.byteLength+h,usage:35050})),t.write(b,h),t}},88755:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(11548);class s{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(e=>this._getOrCreate(e))}_getOrCreate(e){const{name:t,type:n}=e;let s=this.stats[t];return s||(s=e instanceof r.A?e:new r.A(t,n),this.stats[t]=s),s}}},88967:(e,t,n)=>{n.d(t,{Gw:()=>m,Jh:()=>A,Os:()=>S,VJ:()=>I,XM:()=>_,aH:()=>p,dT:()=>w,fO:()=>b,h0:()=>g,iV:()=>v,mY:()=>y,nI:()=>E,om:()=>T,rY:()=>x,wZ:()=>R,xJ:()=>C});var r=n(70177),s=n(90218),i=n(83588),o=n(82859),a=n(26369);const c=Math.PI,l=c/4,u=c/180,h=180/c,d=512,f=4003e4,p=85.051129,g=1.5;function _(e){return Math.pow(2,e)}function m(e){const[t,n]=e;(0,a.v)(Number.isFinite(t)),(0,a.v)(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=n*u;return[d*(t*u+c)/(2*c),d*(c+Math.log(Math.tan(l+.5*r)))/(2*c)]}function v(e){const[t,n]=e,r=t/d*(2*c)-c,s=2*(Math.atan(Math.exp(n/d*(2*c)-c))-l);return[r*h,s*h]}function b(e){const{latitude:t}=e;(0,a.v)(Number.isFinite(t));const n=Math.cos(t*u);return s=f*n,(0,r.p6)(s)-9;var s}function y(e){const t=Math.cos(e*u);return d/f/t}function E(e){const{latitude:t,longitude:n,highPrecision:r=!1}=e;(0,a.v)(Number.isFinite(t)&&Number.isFinite(n));const s=d,i=Math.cos(t*u),o=s/360,c=o/i,l=s/f/i,h={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,c,l],degreesPerUnit:[1/o,1/c,1/l]};if(r){const e=u*Math.tan(t*u)/i,n=o*e/2,r=s/f*e,a=r/c*l;h.unitsPerDegree2=[0,n,r],h.unitsPerMeter2=[a,0,a]}return h}function w(e,t){const[n,r,s]=e,[i,o,a]=t,{unitsPerMeter:c,unitsPerMeter2:l}=E({longitude:n,latitude:r,highPrecision:!0}),u=m(e);u[0]+=i*(c[0]+l[0]*o),u[1]+=o*(c[1]+l[1]*o);const h=v(u),d=(s||0)+(a||0);return Number.isFinite(s)||Number.isFinite(a)?[h[0],h[1],d]:h}function x(e){const{height:t,pitch:n,bearing:i,altitude:a,scale:c,center:l}=e,h=(0,r.$M)();s.Tl(h,h,[0,0,-a]),s.eL(h,h,-n*u),s.Qr(h,h,i*u);const d=c/t;return s.hs(h,h,[d,d,d]),l&&s.Tl(h,h,o.ze([],l)),h}function T(e){const{width:t,height:n,altitude:s,pitch:i=0,offset:o,center:a,scale:c,nearZMultiplier:l=1,farZMultiplier:h=1}=e;let{fovy:d=S(g)}=e;void 0!==s&&(d=S(s));const f=d*u,p=i*u,_=R(d);let m=_;a&&(m+=a[2]*c/Math.cos(p)/n);const v=f*(.5+(o?o[1]:0)/n),b=Math.sin(v)*m/Math.sin((0,r.qE)(Math.PI/2-p-v,.01,Math.PI-.01)),y=Math.sin(p)*b+m,E=10*m;return{fov:f,aspect:t/n,focalDistance:_,near:l,far:Math.min(y*h,E)}}function A(e){const{fov:t,aspect:n,near:r,far:i}=T(e);return s.fN([],t,n,r,i)}function S(e){return 2*Math.atan(.5/e)*h}function R(e){return.5/Math.tan(.5*e*u)}function I(e,t){const[n,s,i=0]=e;return(0,a.v)(Number.isFinite(n)&&Number.isFinite(s)&&Number.isFinite(i)),(0,r._U)(t,[n,s,i,1])}function C(e,t,n=0){const[s,o,c]=e;if((0,a.v)(Number.isFinite(s)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(c)){return(0,r._U)(t,[s,o,c,1])}const l=(0,r._U)(t,[s,o,0,1]),u=(0,r._U)(t,[s,o,1,1]),h=l[2],d=u[2],f=h===d?0:((n||0)-h)/(d-h);return i.Cc([],l,u,f)}},88976:(e,t,n)=>{n.d(t,{cN:()=>a});var r=n(33952);const s=[n(3065).A],i=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],o=[];function a(e){const t=r._.getDefaultShaderAssembler();for(const r of s)t.addDefaultModule(r);t._hookFunctions.length=0;const n="glsl"===e?i:o;for(const r of n)t.addShaderHook(r);return t}},88981:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(53302),s=n(37906),i=n(87597),o=n(31886),a=n(82963),c=n(58373);const l={color:[255,255,255],intensity:1},u=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],h=[0,0,0,200/255];class d{constructor(e={}){this.id="lighting-effect",this.shadowColor=h,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:t,deck:n}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(t),n._addDefaultShaderModule(c.A),this.dummyShadowMap=t.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const t in e){const n=e[t];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(e=>e.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:t,viewports:n,onViewportActive:r,views:s}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let i=0;i<this.shadowPasses.length;i++){this.shadowPasses[i].render({layers:e,layerFilter:t,viewports:n,onViewportActive:r,views:s,shaderModuleProps:{shadow:{shadowLightId:i,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}}getShaderModuleProps(e,t){const n=this.shadow?{project:t.project,shadowMaps:this.shadowPasses.map(e=>e.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},r={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(t=>t.getProjectedLight({layer:e})),pointLights:this.pointLights.map(t=>t.getProjectedLight({layer:e}))},s=e.props.material;return{shadow:n,lighting:r,phongMaterial:s,gouraudMaterial:s}}cleanup(e){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(c.A))}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const n=(new o.k).lookAt({eye:new i.P(t.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const n=new a.A(e);this.shadowPasses[t]=n}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:n}=this;e||0!==t.length||0!==n.length||(this.ambientLight=new r.$(l),this.directionalLights.push(new s.Z(u[0]),new s.Z(u[1])))}}},89277:(e,t,n)=>{n.d(t,{L:()=>s});var r=n(5153);class s extends r.F{static defaultProps={...r.F.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){super(e,t=s.normalizeProps(e,t),s.defaultProps)}static normalizeProps(e,t){return t}}},89351:(e,t,n)=>{n.d(t,{j:()=>r});class r{terminate(){}}},89664:(e,t,n)=>{n.d(t,{q:()=>p});var r=n(94133),s=n(11346),i=n(5993),o=n(66829),a=n(90405),c=n(8521),l=n(3481),u=n(1035),h=n(32429),d=n(72548),f=n(1351);async function p(e,t,n,g){!t||Array.isArray(t)||(0,a.l)(t)||(g=void 0,n=t,t=void 0),e=await e,n=n||{};const _=(0,d.Al)(e),m=t,v=(0,h.i)(m,g),b=await(0,f.M)(e,v,n);return b?(n=(0,l.a5)(n,b,v,_),g=(0,h.l)({url:_,_parse:p,loaders:v},n,g||null),await async function(e,t,n,a){if((0,o.z)(e),n=(0,r.y)(e.options,n),(0,c.Sv)(t)){const e=t,{ok:n,redirected:r,status:s,statusText:i,type:o,url:c}=e,l=Object.fromEntries(e.headers.entries());a.response={headers:l,ok:n,redirected:r,status:s,statusText:i,type:o,url:c}}t=await(0,u.O1)(t,e,n);const l=e;if(l.parseTextSync&&"string"==typeof t)return l.parseTextSync(t,n,a);if((0,s.s)(e,n))return await(0,s.g)(e,t,n,a,p);if(l.parseText&&"string"==typeof t)return await l.parseText(t,n,a);if(l.parse)return await l.parse(t,n,a);throw(0,i.v)(!l.parseSync),new Error(`${e.id} loader - no parser found and worker is disabled`)}(b,e,n,g)):null}},90218:(e,t,n)=>{n.d(t,{$h:()=>g,B8:()=>i,I0:()=>p,Qr:()=>f,Tl:()=>c,Z8:()=>d,a4:()=>o,aI:()=>b,e$:()=>u,eL:()=>h,fN:()=>_,hs:()=>l,lw:()=>a,mg:()=>s,t5:()=>v,v3:()=>m});var r=n(50741);function s(e,t){if(e===t){const n=t[1],r=t[2],s=t[3],i=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=i,e[11]=t[14],e[12]=s,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function i(e,t){const n=t[0],r=t[1],s=t[2],i=t[3],o=t[4],a=t[5],c=t[6],l=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],g=t[13],_=t[14],m=t[15],v=n*a-r*o,b=n*c-s*o,y=n*l-i*o,E=r*c-s*a,w=r*l-i*a,x=s*l-i*c,T=u*g-h*p,A=u*_-d*p,S=u*m-f*p,R=h*_-d*g,I=h*m-f*g,C=d*m-f*_;let P=v*C-b*I+y*R+E*S-w*A+x*T;return P?(P=1/P,e[0]=(a*C-c*I+l*R)*P,e[1]=(s*I-r*C-i*R)*P,e[2]=(g*x-_*w+m*E)*P,e[3]=(d*w-h*x-f*E)*P,e[4]=(c*S-o*C-l*A)*P,e[5]=(n*C-s*S+i*A)*P,e[6]=(_*y-p*x-m*b)*P,e[7]=(u*x-d*y+f*b)*P,e[8]=(o*I-a*S+l*T)*P,e[9]=(r*S-n*I-i*T)*P,e[10]=(p*w-g*y+m*v)*P,e[11]=(h*y-u*w-f*v)*P,e[12]=(a*A-o*R-c*T)*P,e[13]=(n*R-r*A+s*T)*P,e[14]=(g*b-p*E-_*v)*P,e[15]=(u*E-h*b+d*v)*P,e):null}function o(e){const t=e[0],n=e[1],r=e[2],s=e[3],i=e[4],o=e[5],a=e[6],c=e[7],l=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],g=e[14],_=t*o-n*i,m=t*a-r*i,v=n*a-r*o,b=l*p-u*f,y=l*g-h*f,E=u*g-h*p;return c*(t*E-n*y+r*b)-s*(i*E-o*y+a*b)+e[15]*(l*v-u*m+h*_)-d*(f*v-p*m+g*_)}function a(e,t,n){const r=t[0],s=t[1],i=t[2],o=t[3],a=t[4],c=t[5],l=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],g=t[12],_=t[13],m=t[14],v=t[15];let b=n[0],y=n[1],E=n[2],w=n[3];return e[0]=b*r+y*a+E*h+w*g,e[1]=b*s+y*c+E*d+w*_,e[2]=b*i+y*l+E*f+w*m,e[3]=b*o+y*u+E*p+w*v,b=n[4],y=n[5],E=n[6],w=n[7],e[4]=b*r+y*a+E*h+w*g,e[5]=b*s+y*c+E*d+w*_,e[6]=b*i+y*l+E*f+w*m,e[7]=b*o+y*u+E*p+w*v,b=n[8],y=n[9],E=n[10],w=n[11],e[8]=b*r+y*a+E*h+w*g,e[9]=b*s+y*c+E*d+w*_,e[10]=b*i+y*l+E*f+w*m,e[11]=b*o+y*u+E*p+w*v,b=n[12],y=n[13],E=n[14],w=n[15],e[12]=b*r+y*a+E*h+w*g,e[13]=b*s+y*c+E*d+w*_,e[14]=b*i+y*l+E*f+w*m,e[15]=b*o+y*u+E*p+w*v,e}function c(e,t,n){const r=n[0],s=n[1],i=n[2];let o,a,c,l,u,h,d,f,p,g,_,m;return t===e?(e[12]=t[0]*r+t[4]*s+t[8]*i+t[12],e[13]=t[1]*r+t[5]*s+t[9]*i+t[13],e[14]=t[2]*r+t[6]*s+t[10]*i+t[14],e[15]=t[3]*r+t[7]*s+t[11]*i+t[15]):(o=t[0],a=t[1],c=t[2],l=t[3],u=t[4],h=t[5],d=t[6],f=t[7],p=t[8],g=t[9],_=t[10],m=t[11],e[0]=o,e[1]=a,e[2]=c,e[3]=l,e[4]=u,e[5]=h,e[6]=d,e[7]=f,e[8]=p,e[9]=g,e[10]=_,e[11]=m,e[12]=o*r+u*s+p*i+t[12],e[13]=a*r+h*s+g*i+t[13],e[14]=c*r+d*s+_*i+t[14],e[15]=l*r+f*s+m*i+t[15]),e}function l(e,t,n){const r=n[0],s=n[1],i=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function u(e,t,n,s){let i,o,a,c,l,u,h,d,f,p,g,_,m,v,b,y,E,w,x,T,A,S,R,I,C=s[0],P=s[1],L=s[2],M=Math.sqrt(C*C+P*P+L*L);return M<r.p8?null:(M=1/M,C*=M,P*=M,L*=M,o=Math.sin(n),i=Math.cos(n),a=1-i,c=t[0],l=t[1],u=t[2],h=t[3],d=t[4],f=t[5],p=t[6],g=t[7],_=t[8],m=t[9],v=t[10],b=t[11],y=C*C*a+i,E=P*C*a+L*o,w=L*C*a-P*o,x=C*P*a-L*o,T=P*P*a+i,A=L*P*a+C*o,S=C*L*a+P*o,R=P*L*a-C*o,I=L*L*a+i,e[0]=c*y+d*E+_*w,e[1]=l*y+f*E+m*w,e[2]=u*y+p*E+v*w,e[3]=h*y+g*E+b*w,e[4]=c*x+d*T+_*A,e[5]=l*x+f*T+m*A,e[6]=u*x+p*T+v*A,e[7]=h*x+g*T+b*A,e[8]=c*S+d*R+_*I,e[9]=l*S+f*R+m*I,e[10]=u*S+p*R+v*I,e[11]=h*S+g*R+b*I,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function h(e,t,n){const r=Math.sin(n),s=Math.cos(n),i=t[4],o=t[5],a=t[6],c=t[7],l=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*s+l*r,e[5]=o*s+u*r,e[6]=a*s+h*r,e[7]=c*s+d*r,e[8]=l*s-i*r,e[9]=u*s-o*r,e[10]=h*s-a*r,e[11]=d*s-c*r,e}function d(e,t,n){const r=Math.sin(n),s=Math.cos(n),i=t[0],o=t[1],a=t[2],c=t[3],l=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*s-l*r,e[1]=o*s-u*r,e[2]=a*s-h*r,e[3]=c*s-d*r,e[8]=i*r+l*s,e[9]=o*r+u*s,e[10]=a*r+h*s,e[11]=c*r+d*s,e}function f(e,t,n){const r=Math.sin(n),s=Math.cos(n),i=t[0],o=t[1],a=t[2],c=t[3],l=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*s+l*r,e[1]=o*s+u*r,e[2]=a*s+h*r,e[3]=c*s+d*r,e[4]=l*s-i*r,e[5]=u*s-o*r,e[6]=h*s-a*r,e[7]=d*s-c*r,e}function p(e,t){const n=t[0],r=t[1],s=t[2],i=t[3],o=n+n,a=r+r,c=s+s,l=n*o,u=r*o,h=r*a,d=s*o,f=s*a,p=s*c,g=i*o,_=i*a,m=i*c;return e[0]=1-h-p,e[1]=u+m,e[2]=d-_,e[3]=0,e[4]=u-m,e[5]=1-l-p,e[6]=f+g,e[7]=0,e[8]=d+_,e[9]=f-g,e[10]=1-l-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function g(e,t,n,r,s,i,o){const a=1/(n-t),c=1/(s-r),l=1/(i-o);return e[0]=2*i*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*i*c,e[6]=0,e[7]=0,e[8]=(n+t)*a,e[9]=(s+r)*c,e[10]=(o+i)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*i*2*l,e[15]=0,e}const _=function(e,t,n,r,s){const i=1/Math.tan(t/2);if(e[0]=i/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=s&&s!==1/0){const t=1/(r-s);e[10]=(s+r)*t,e[14]=2*s*r*t}else e[10]=-1,e[14]=-2*r;return e};const m=function(e,t,n,r,s,i,o){const a=1/(t-n),c=1/(r-s),l=1/(i-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*a,e[13]=(s+r)*c,e[14]=(o+i)*l,e[15]=1,e};function v(e,t,n,s){let i,o,a,c,l,u,h,d,f,p;const g=t[0],_=t[1],m=t[2],v=s[0],b=s[1],y=s[2],E=n[0],w=n[1],x=n[2];return Math.abs(g-E)<r.p8&&Math.abs(_-w)<r.p8&&Math.abs(m-x)<r.p8?function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}(e):(d=g-E,f=_-w,p=m-x,i=1/Math.sqrt(d*d+f*f+p*p),d*=i,f*=i,p*=i,o=b*p-y*f,a=y*d-v*p,c=v*f-b*d,i=Math.sqrt(o*o+a*a+c*c),i?(i=1/i,o*=i,a*=i,c*=i):(o=0,a=0,c=0),l=f*c-p*a,u=p*o-d*c,h=d*a-f*o,i=Math.sqrt(l*l+u*u+h*h),i?(i=1/i,l*=i,u*=i,h*=i):(l=0,u=0,h=0),e[0]=o,e[1]=l,e[2]=d,e[3]=0,e[4]=a,e[5]=u,e[6]=f,e[7]=0,e[8]=c,e[9]=h,e[10]=p,e[11]=0,e[12]=-(o*g+a*_+c*m),e[13]=-(l*g+u*_+h*m),e[14]=-(d*g+f*_+p*m),e[15]=1,e)}function b(e,t){const n=e[0],s=e[1],i=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],g=e[12],_=e[13],m=e[14],v=e[15],b=t[0],y=t[1],E=t[2],w=t[3],x=t[4],T=t[5],A=t[6],S=t[7],R=t[8],I=t[9],C=t[10],P=t[11],L=t[12],M=t[13],k=t[14],O=t[15];return Math.abs(n-b)<=r.p8*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(s-y)<=r.p8*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(i-E)<=r.p8*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(o-w)<=r.p8*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(a-x)<=r.p8*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(c-T)<=r.p8*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(l-A)<=r.p8*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(u-S)<=r.p8*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(h-R)<=r.p8*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(d-I)<=r.p8*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(f-C)<=r.p8*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(p-P)<=r.p8*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(g-L)<=r.p8*Math.max(1,Math.abs(g),Math.abs(L))&&Math.abs(_-M)<=r.p8*Math.max(1,Math.abs(_),Math.abs(M))&&Math.abs(m-k)<=r.p8*Math.max(1,Math.abs(m),Math.abs(k))&&Math.abs(v-O)<=r.p8*Math.max(1,Math.abs(v),Math.abs(O))}},90405:(e,t,n)=>{n.d(t,{D:()=>i,l:()=>s});var r=n(94976);function s(e){if(!e)return!1;Array.isArray(e)&&(e=e[0]);return Array.isArray(e?.extensions)}function i(e){let t;return(0,r.v)(e,"null loader"),(0,r.v)(s(e),"invalid loader"),Array.isArray(e)&&(t=e[1],e=e[0],e={...e,options:{...e.options,...t}}),(e?.parseTextSync||e?.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}},90539:(e,t,n)=>{n.d(t,{O:()=>i});var r=n(83593),s=n(62088);function i(e,t,n){if(function(e){for(const t in e)return!1;return!0}(t))return n(e);const{nocatch:i=!0}=t,o=s.J.get(e);let a;if(o.push(),(0,r.wb)(e,t),i)a=n(e),o.pop();else try{a=n(e)}finally{o.pop()}return a}},91097:(e,t,n)=>{function r(e){return Array.isArray(e)?0===e.length||"number"==typeof e[0]:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)}n.d(t,{p:()=>r})},91416:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(43411),s=n(36958),i=n(92189);class o{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new s.A(e),this.pickLayersPass=new i.A(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};n.effects&&this._preRender(n.effects,n);const s=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);const i=t.render({...n,target:s});n.effects&&(this.lastPostProcessEffect&&(n.clearCanvas=void 0===e.clearCanvas||e.clearCanvas),this._postRender(n.effects,n)),this.renderCount++,(0,r.A)("deckRenderer.renderLayers",this,i,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const n of e)t.preRenderStats[n.id]=n.preRender(t),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,t=this.device.canvasContext.getDrawingBufferSize(),[n,r]=t;0===e.length&&[0,1].map(t=>{const s=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"},width:n,height:r});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${t}`,colorAttachments:[s]}))});for(const s of e)s.resize(t)}_postRender(e,t){const{renderBuffers:n}=this,r={...t,inputBuffer:n[0],swapBuffer:n[1]};for(const s of e)if(s.postRender){r.target=s.id===this.lastPostProcessEffect?t.target:void 0;const e=s.postRender(r);r.inputBuffer=e,r.swapBuffer=e===n[0]?n[1]:n[0]}}}},91858:(e,t,n)=>{var r;n.d(t,{GL:()=>r}),function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.R16_EXT=33322]="R16_EXT",e[e.RG16_EXT=33324]="RG16_EXT",e[e.RGB16_EXT=32852]="RGB16_EXT",e[e.RGBA16_EXT=32859]="RGBA16_EXT",e[e.R16_SNORM_EXT=36760]="R16_SNORM_EXT",e[e.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",e[e.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",e[e.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e[e.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",e[e.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",e[e.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",e[e.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",e[e.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",e[e.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",e[e.LINE_WEBGL=6913]="LINE_WEBGL",e[e.FILL_WEBGL=6914]="FILL_WEBGL",e[e.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",e[e.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",e[e.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",e[e.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",e[e.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",e[e.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",e[e.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",e[e.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",e[e.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",e[e.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",e[e.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",e[e.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",e[e.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",e[e.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",e[e.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",e[e.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",e[e.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",e[e.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",e[e.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",e[e.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",e[e.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",e[e.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",e[e.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",e[e.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"}(r||(r={}))},92134:(e,t,n)=>{n.d(t,{C:()=>i});var r=n(80698),s=n(75638);class i extends s.X{device;gl;handle;texture;constructor(e,t){super(e,{...r.g.defaultProps,...t}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=t.texture}}},92189:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(25285),s=n(3459);const i={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant",blendAlphaDstFactor:"zero"};class o extends r.A{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:t,views:n,viewports:r,onViewportActive:s,pickingFBO:i,deviceRect:{x:o,y:c,width:l,height:u},cullRect:h,effects:d,pass:f="picking",pickZ:p,shaderModuleProps:g}){this.pickZ=p;const _=this._resetColorEncoder(p),m=[o,c,l,u],v=super.render({target:i,layers:e,layerFilter:t,views:n,viewports:r,onViewportActive:s,cullRect:h,effects:d?.filter(e=>e.useInPicking),pass:f,isPicking:!0,shaderModuleProps:g,clearColor:[0,0,0,0],colorMask:15,scissorRect:m});this._colorEncoderState=null;return{decodePickingColor:_&&a.bind(null,_),stats:v}}shouldDrawLayer(e){const{pickable:t,operation:n}=e.props;return t&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getShaderModuleProps(e,t,n){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,t,n){const r={...e.props.parameters},{pickable:o,operation:a}=e.props;return!this._colorEncoderState||a.includes("terrain")?r.blend=!1:o&&a.includes("draw")&&(Object.assign(r,i),r.blend=!0,r.blendColor=function(e,t,n){const{byLayer:r,byAlpha:i}=e;let o,a=r.get(t);a?(a.viewports.push(n),o=a.a):(o=r.size+1,o<=255?(a={a:o,layer:t,viewports:[n]},r.set(t,a),i[o]=a):(s.A.warn("Too many pickable layers, only picking the first 255")(),o=0));return[0,0,0,o/255]}(this._colorEncoderState,e,n)),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function a(e,t){const n=e.byAlpha[t[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(t)}}},92285:(e,t,n)=>{n.d(t,{d:()=>o});var r=n(88171),s=n(18160),i=n(60682);function o(e,t){const n=e.lastInterval||t,o=t.timeStamp-n.timeStamp;let a,c,l,u;if(t.eventType!==r.TL.Cancel&&(o>r.Ay||void 0===n.velocity)){const r=t.deltaX-n.deltaX,h=t.deltaY-n.deltaY,d=(0,s.O)(o,r,h);c=d.x,l=d.y,a=Math.abs(d.x)>Math.abs(d.y)?d.x:d.y,u=(0,i.u)(r,h),e.lastInterval=t}else a=n.velocity,c=n.velocityX,l=n.velocityY,u=n.direction;t.velocity=a,t.velocityX=c,t.velocityY=l,t.direction=u}},92950:(e,t,n)=>{n.d(t,{g:()=>s});const r=["","webkit","Moz","MS","ms","o"];function s(e,t){const n=t[0].toUpperCase()+t.slice(1);for(const s of r){const r=s?s+n:t;if(r in e)return r}}},93018:(e,t,n)=>{n.d(t,{E:()=>r});const r="\nuniform fp64arithmeticUniforms {\n  uniform float ONE;\n} fp64;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some 'equivalent' form.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * fp64.ONE - (t - a);\n  float a_lo = a * fp64.ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * fp64.ONE;\n  float err = b - (sum - a) * fp64.ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *\n    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n"},93520:(e,t,n)=>{function r(e){return"undefined"!=typeof ImageData&&e instanceof ImageData||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas}function s(e){if("undefined"!=typeof ImageData&&e instanceof ImageData||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height};if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)return{width:e.naturalWidth,height:e.naturalHeight};if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};if("undefined"!=typeof VideoFrame&&e instanceof VideoFrame)return{width:e.displayWidth,height:e.displayHeight};throw new Error("Unknown image type")}n.d(t,{c:()=>s,x:()=>r})},93640:(e,t,n)=>{n.d(t,{eh:()=>s,gM:()=>i,x:()=>r});const r=globalThis,s=(globalThis.document,globalThis.process||{}),i=(globalThis.console,globalThis.navigator||{})},93697:(e,t,n)=>{n.d(t,{c:()=>i});var r=n(66347);const s={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class i extends r.x{constructor(e={}){super(e),this.id="default-tooltip",this.placement="fill",this.className="deck-tooltip",this.isVisible=!1,this.setProps(e)}onCreateRootElement(){const e=document.createElement("div");return e.className=this.className,Object.assign(e.style,s),e}onRenderHTML(e){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:t}=this,n=t&&t.props.getTooltip;if(!n)return;const r=n(e);this.lastViewport=e.viewport,this.setTooltip(r,e.x,e.y)}setTooltip(e,t,n){const r=this.rootElement;if(r){if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className)}this.isVisible=!0,r.style.display="block",r.style.transform=`translate(${t}px, ${n}px)`,e&&"object"==typeof e&&"style"in e&&Object.assign(r.style,e.style)}}}i.defaultProps={...r.x.defaultProps}},93871:(e,t,n)=>{n.d(t,{LU:()=>c,Sw:()=>a,ZO:()=>i,fO:()=>s,ly:()=>r,uR:()=>o});const r="compute",s="auto",i="manipulation",o="none",a="pan-x",c="pan-y"},93948:(e,t,n)=>{n.d(t,{l:()=>a});var r=n(83909),s=n(68643),i=n(21719);const o={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class a extends r.I7{gl;extensions;testedFeatures=new Set;constructor(e,t,n){super([],n),this.gl=e,this.extensions=t,(0,s.T)(e,"EXT_color_buffer_float",t)}*[Symbol.iterator](){const e=this.getFeatures();for(const t of e)this.has(t)&&(yield t);return[]}has(e){return!this.disabledFeatures?.[e]&&(this.testedFeatures.has(e)||(this.testedFeatures.add(e),(0,i.My)(e)&&(0,i.aK)(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter(e=>"polygon-mode-webgl"!==e);for(const t of e)this.has(t)}getFeatures(){return[...Object.keys(o),...Object.keys(i.cu)]}getWebGLFeature(e){const t=o[e];return"string"==typeof t?Boolean((0,s.T)(this.gl,t,this.extensions)):Boolean(t)}}},94034:(e,t,n)=>{n.d(t,{A:()=>S});var r=n(56980),s=n(43424),i=n(45800),o=n(40352),a=n(91416),c=n(25593),l=n(97669),u=n(93697),h=n(3459),d=n(7914),f=n(23459),p=n(66037),g=n(95850),_=n(30416),m=n(3726),v=n(19871),b=n(88755),y=n(18511),E=n(24067),w=n(9350);function x(){}const T={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:x,onWebGLInitialized:x,onResize:x,onViewStateChange:x,onInteractionStateChange:x,onBeforeRender:x,onAfterRender:x,onLoad:x,onError:e=>h.A.error(e.message,e.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:e})=>e?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class A{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new b.A({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=e=>{const{_pickRequest:t}=this;if("pointerleave"===e.type)t.x=-1,t.y=-1,t.radius=0;else{if(e.leftButton||e.rightButton)return;{const n=e.offsetCenter;if(!n)return;t.x=n.x,t.y=n.y,t.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:t.x,y:t.y}),t.event=e},this._onEvent=e=>{const t=w.tg[e.type],n=e.offsetCenter;if(!t||!n||!this.layerManager)return;const r=this.layerManager.getLayers(),s=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:i}=s,o=i&&(i[t]||i.props[t]),a=this.props[t];let c=!1;o&&(c=o.call(i,s,e)),c||(a?.(s,e),this.widgetManager.onEvent(s,e))},this._onPointerDown=e=>{if("webgpu"===this.device?.type)return;const t=e.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:t.x,y:t.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo},this.props={...T,...e},(e=this.props).viewState&&e.initialViewState&&h.A.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let t=this.device;!t&&e.gl&&(e.gl instanceof WebGLRenderingContext&&h.A.error("WebGL1 context not supported.")(),t=_.l.attach(e.gl,this.props.deviceProps)),t||(t=this._createDevice(e)),this.animationLoop=this._createAnimationLoop(t,e),this.setProps(e),e._typedArrayManagerProps&&f.A.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,this.props.canvas||this.props.device||this.props.gl||!this.canvas||(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&h.A.removed("onLayerHover","onHover")(),"onLayerClick"in e&&h.A.removed("onLayerClick","onClick")(),e.initialViewState&&!(0,d.b)(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);if(Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),e.device&&e.device.id!==this.device?.id&&(this.animationLoop?.stop(),this.canvas!==e.device.canvasContext?.canvas&&(this.canvas?.remove(),this.eventManager?.destroy(),this.canvas=null),h.A.log(`recreating animation loop for new device! id=${e.device.id}`)(),this.animationLoop=this._createAnimationLoop(e.device,e),this.animationLoop.start()),this.animationLoop?.setProps(t),void 0!==e.useDevicePixels&&this.device?.canvasContext?.canvas instanceof HTMLCanvasElement){this.device.canvasContext.props.useDevicePixels=e.useDevicePixels;const t=this.device.canvasContext.canvas,n={target:t,contentBoxSize:[{inlineSize:t.clientWidth,blockSize:t.clientHeight}],devicePixelContentBoxSize:[{inlineSize:t.clientWidth,blockSize:t.clientHeight}],borderBoxSize:[{inlineSize:t.clientWidth,blockSize:t.clientHeight}]};this.device.canvasContext._handleResize([n])}this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t),this.widgetManager.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),i=this.deckRenderer.needsRedraw(e);return t=t||n||r||s||i,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return null!==this.viewManager}getViews(){return(0,E.A)(this.viewManager),this.viewManager.views}getViewports(e){return(0,E.A)(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,t,n){(0,E.A)(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;if("string"==typeof t&&(t=document.getElementById(t),(0,E.A)(t)),!t){t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",e.width&&"number"==typeof e.width&&(t.width=e.width),e.height&&"number"==typeof e.height&&(t.height=e.height);(e.parent||document.body).appendChild(t)}return Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:n}=e;if(t||0===t){const e=Number.isFinite(t)?`${t}px`:t;this.canvas.style.width=e}if(n||0===n){const t=Number.isFinite(n)?`${n}px`:n;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=t}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const t=e.clientWidth??e.width,n=e.clientHeight??e.height;t===this.width&&n===this.height||(this.width=t,this.height=n,this.viewManager?.setProps({width:t,height:n}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:t,height:n}))}_createAnimationLoop(e,t){const{gl:n,onError:r}=t;return new v.F({device:e,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:e=>this._setDevice(e.device),onRender:this._onRenderFrame.bind(this),onError:r})}_createDevice(e){const t=this.props.deviceProps?.createCanvasContext,n="object"==typeof t?t:void 0,r={adapters:[],...e.deviceProps};r.adapters.includes(_.l)||r.adapters.push(_.l);const s={alphaMode:"webgpu"===this.props.deviceProps?.type?"premultiplied":void 0};return g.a.createDevice({_reuseDevices:!0,type:"webgl",...r,createCanvasContext:{...s,...n,canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!0}})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,t=Array.isArray(e)?e:e?[e]:[new i.A({id:"default-view"})];return t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){if("webgpu"===this.device?.type)return;const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:n}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=t.length>0;let r=n,s=!1;for(const i of t)r=i,s=i.layer?.onHover(i,e.event)||s;s||(this.props.onHover?.(r,e.event),this.widgetManager.onHover(r,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas,!this.canvas.isConnected&&this.props.parent&&this.props.parent.insertBefore(this.canvas,this.props.parent.firstChild)),"webgl"===this.device.type&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),"webgl"===this.device.type&&this.props.onWebGLInitialized(this.device.gl);const t=new m.K;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new y.EU(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(w.We).map(e=>{const[t,n,r,s]=w.We[e],i=this.props.eventRecognizerOptions?.[e];return{recognizer:new t({...n,...i,event:e}),recognizeWith:r,requestFailure:s}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in w.tg)this.eventManager.on(r,this._onEvent);this.viewManager=new s.A({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new r.A(this.device,{deck:this,stats:this.stats,viewport:n,timeline:t}),this.effectManager=new o.A({deck:this,device:this.device}),this.deckRenderer=new a.A(this.device),this.deckPicker=new c.A(this.device),this.widgetManager=new l.S({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new u.c),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{device:n,gl:r}=this.layerManager.context;this.props.onBeforeRender({device:n,gl:r});const s={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...t};this.deckRenderer?.renderLayers(s),"screen"===s.pass&&this.widgetManager.onRedraw({viewports:s.viewports,layers:s.layers}),this.props.onAfterRender({device:n,gl:r})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),h.A.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),"webgpu"!==this.device?.type&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const n=g.a.stats.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}A.defaultProps=T,A.VERSION=p.x;const S=A},94133:(e,t,n)=>{function r(e,t){return s(e||{},t)}function s(e,t,n=0){if(n>3)return t;const r={...e};for(const[i,o]of Object.entries(t))o&&"object"==typeof o&&!Array.isArray(o)?r[i]=s(r[i]||{},t[i],n+1):r[i]=t[i];return r}n.d(t,{y:()=>r})},94541:(e,t,n)=>{n.d(t,{x:()=>c});var r=n(3459),s=n(53439),i=n(10511),o=n(12897),a=n(47787);function c(e,t){let n;for(let i=t.length-1;i>=0;i--){const e=t[i];"extensions"in e&&(n=e.extensions)}const r=u(e.constructor,n),s=Object.create(r);s[o.r3]=e,s[o.YN]={},s[o.vf]={};for(let i=0;i<t.length;++i){const e=t[i];for(const t in e)s[t]=e[t]}return Object.freeze(s),s}const l="_mergedDefaultProps";function u(e,t){if(!(e instanceof a.A.constructor))return{};let n=l;if(t)for(const r of t){const e=r.constructor;e&&(n+=`:${e.extensionName||e.name}`)}const s=f(e,n);return s||(e[n]=function(e,t){const n=e.prototype;if(!n)return null;const s=Object.getPrototypeOf(e),a=u(s),c=f(e,"defaultProps")||{},l=(0,i.E)(c),p=Object.assign(Object.create(null),a,l.defaultProps),g=Object.assign(Object.create(null),a?.[o.fW],l.propTypes),_=Object.assign(Object.create(null),a?.[o.uH],l.deprecatedProps);for(const r of t){const e=u(r.constructor);e&&(Object.assign(p,e),Object.assign(g,e[o.fW]),Object.assign(_,e[o.uH]))}(function(e,t){const n=function(e){const t=e.componentName;t||r.A.warn(`${e.name}.componentName not specified`)();return t||e.name}(t);Object.defineProperties(e,{id:{writable:!0,value:n}})})(p,e),function(e,t){const n={},r={};for(const s in t){const e=t[s],{name:i,value:o}=e;e.async&&(n[i]=o,r[i]=h(i))}e[o.jA]=n,e[o.YN]={},Object.defineProperties(e,r)}(p,g),function(e,t){for(const n in t)Object.defineProperty(e,n,{enumerable:!1,set(e){const s=`${this.id}: ${n}`;for(const r of t[n])d(this,r)||(this[r]=e);r.A.deprecated(s,t[n].join("/"))()}})}(p,_),p[o.fW]=g,p[o.uH]=_,0!==t.length||d(e,"_propTypes")||(e._propTypes=g);return p}(e,t||[]))}function h(e){return{enumerable:!0,set(t){"string"==typeof t||t instanceof Promise||(0,s.Td)(t)?this[o.YN][e]=t:this[o.vf][e]=t},get(){if(this[o.vf]){if(e in this[o.vf]){return this[o.vf][e]||this[o.jA][e]}if(e in this[o.YN]){const t=this[o.r3]&&this[o.r3].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[o.jA][e]}}return this[o.jA][e]}}}function d(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function f(e,t){return d(e,t)&&e[t]}},94717:(e,t,n)=>{n.d(t,{A:()=>p});var r=n(35560),s=n(70053);const i={transitionDuration:0},o=e=>1-(1-e)*(1-e),a=["wheel"],c=["panstart","panmove","panend"],l=["pinchstart","pinchmove","pinchend"],u=["multipanstart","multipanmove","multipanend"],h=["dblclick"],d=["keydown"],f={};class p{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new r.A({...e,getControllerState:e=>new this.ControllerState(e),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return!t&&this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:n}=this.props,{offsetCenter:r}=e;return[r.x-t,r.y-n]}isPointInBounds(e,t){const{width:n,height:r}=this.props;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:!0===t?300:0;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:i=!0,touchZoom:o=!0,touchRotate:f=!1,keyboard:p=!0}=e,g=Boolean(this.onViewStateChange);this.toggleEvents(a,g&&n),this.toggleEvents(c,g),this.toggleEvents(l,g&&(o||f)),this.toggleEvents(u,g&&f),this.toggleEvents(h,g&&i),this.toggleEvents(d,g&&p),this.scrollZoom=n,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=i,this.touchZoom=o,this.touchRotate=f,this.keyboard=p}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(e=>{this._events[e]!==t&&(this._events[e]=t,t?this.eventManager.on(e,this.handleEvent):this.eventManager.off(e,this.handleEvent))})}updateViewport(e,t=null,n={}){const r={...e.getViewportProps(),...t},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),s){const e=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:e,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:t});return this._panMove=n,this.updateViewport(r,i,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),n=this.controllerState.pan({pos:t});return this.updateViewport(n,i,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],s=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:o},{isDragging:!1,isPanning:!0})}else{const e=this.controllerState.panEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),n=this.controllerState.rotate({pos:t});return this.updateViewport(n,i,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const n=this.getCenter(e),r=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],s=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:o},{isDragging:!1,isRotating:!0})}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:r=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*n)));s<0&&0!==o&&(o=1/o);const a=r?{...this._getTransitionProps({around:t}),transitionDuration:250}:i,c=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(c,a,{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.rotateStart({pos:t});return this.updateViewport(n,i,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const n=this.controllerState.rotate({pos:t});return this.updateViewport(n,i,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const n=this.getCenter(e),r=[n[0],n[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:o},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const e=this.controllerState.rotateEnd();this.updateViewport(e,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return f._startPinchRotation=e.rotation,f._lastPinchEvent=e,this.updateViewport(n,i,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:n}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=e;t=t.rotate({deltaAngleX:f._startPinchRotation-n})}return this.updateViewport(t,i,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),f._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:n}=f;if(this.touchZoom&&t&&n&&e.scale!==n.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const i=Math.log2(e.scale),a=(i-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),c=Math.pow(2,i+a*t/2);s=s.zoom({pos:r,scale:c}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:r}),transitionDuration:t,transitionEasing:o},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const e=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return f._startPinchRotation=null,f._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:i}=!0===this.keyboard?{}:this.keyboard,{controllerState:o}=this;let a;const c={};switch(e.srcEvent.code){case"Minus":a=t?o.zoomOut(n).zoomOut(n):o.zoomOut(n),c.isZooming=!0;break;case"Equal":a=t?o.zoomIn(n).zoomIn(n):o.zoomIn(n),c.isZooming=!0;break;case"ArrowLeft":t?(a=o.rotateLeft(s),c.isRotating=!0):(a=o.moveLeft(r),c.isPanning=!0);break;case"ArrowRight":t?(a=o.rotateRight(s),c.isRotating=!0):(a=o.moveRight(r),c.isPanning=!0);break;case"ArrowUp":t?(a=o.rotateUp(i),c.isRotating=!0):(a=o.moveUp(r),c.isPanning=!0);break;case"ArrowDown":t?(a=o.rotateDown(i),c.isRotating=!0):(a=o.moveDown(r),c.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{transition:t}=this;return t&&t.transitionInterpolator?e?{...t,transitionInterpolator:new s.A({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t:i}}},94937:(e,t,n)=>{function r(e){return s[e]}n.d(t,{q:()=>r});const s={5124:"sint32",5125:"uint32",5122:"sint16",5123:"uint16",5120:"sint8",5121:"uint8",5126:"float32",5131:"float16",33635:"uint16",32819:"uint16",32820:"uint16",33640:"uint32",35899:"uint32",35902:"uint32",34042:"uint32",36269:"uint32"}},94976:(e,t,n)=>{function r(e,t){if(!e)throw new Error(t||"loader assertion failed.")}n.d(t,{v:()=>r})},95561:(e,t,n)=>{n.d(t,{R:()=>a});var r=n(53081),s=n(29651),i=n(2919),o=n(24744);class a extends r.w{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,t){super(e,t),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,t.buffers&&this.setBuffers(t.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback((0,o.PD)(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])})}setBuffer(e,t){const n=this._getVaryingIndex(e),{buffer:r,byteLength:i,byteOffset:o}=this._getBufferRange(t);if(n<0)return this.unusedBuffers[e]=r,void s.R.warn(`${this.id} unusedBuffers varying buffer ${e}`)();this.buffers[n]={buffer:r,byteLength:i,byteOffset:o},this.bindOnUse||this._bindBuffer(n,r,o,i)}getBuffer(e){if(c(e))return this.buffers[e]||null;const t=this._getVaryingIndex(e);return t>=0?this.buffers[t]:null}bind(e=this.handle){if("function"!=typeof e)return this.gl.bindTransformFeedback(36386,e),this;let t;return this._bound?t=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,t=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),t}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof i.K)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:t,byteOffset:n=0,byteLength:r=e.buffer.byteLength}=e;return{buffer:t,byteOffset:n,byteLength:r}}_getVaryingIndex(e){if(c(e))return Number(e);for(const t of this.layout.varyings||[])if(e===t.name)return t.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:t,byteLength:n,byteOffset:r}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),t,r,n)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,t,n=0,r){const s=t&&t.handle;s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,n,r):this.gl.bindBufferBase(35982,e,s)}}function c(e){return"number"==typeof e?Number.isInteger(e):/^\d+$/.test(e)}},95631:(e,t,n)=>{n.d(t,{X:()=>a});var r=n(42719),s=n(90539),i=n(83593);const o=[1,2,4,8];class a extends r.A{device;handle=null;glParameters={};constructor(e,t){let n;if(super(e,t),this.device=e,!t?.parameters?.viewport)if(t?.framebuffer){const{width:e,height:r}=t.framebuffer;n=[0,0,e,r]}else{const[t,r]=e.getDefaultCanvasContext().getDrawingBufferSize();n=[0,0,t,r]}this.device.pushState(),this.setParameters({viewport:n,...this.props.parameters});const r=this.props.framebuffer;if(this.props.framebuffer&&r?.handle){const e=this.props.framebuffer.colorAttachments.map((e,t)=>36064+t);this.device.gl.drawBuffers(e)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){const t={...this.glParameters};t.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(t.depthMask=!this.props.depthReadOnly),t.stencilMask=this.props.stencilReadOnly?0:1,t[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(t.viewport=e.viewport.slice(0,4),t.depthRange=[e.viewport[4],e.viewport[5]]):t.viewport=e.viewport),e.scissorRect&&(t.scissorTest=!0,t.scissor=e.scissorRect),e.blendConstant&&(t.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),t[2967]=e.stencilReference),"colorMask"in e&&(t.colorMask=o.map(t=>Boolean(t&e.colorMask))),this.glParameters=t,(0,i.wb)(this.device.gl,t)}beginOcclusionQuery(e){const t=this.props.occlusionQuerySet;t?.beginOcclusionQuery()}endOcclusionQuery(){const e=this.props.occlusionQuerySet;e?.endOcclusionQuery()}clear(){const e={...this.glParameters};let t=0;this.props.clearColors&&this.props.clearColors.forEach((e,t)=>{e&&this.clearColorBuffer(t,e)}),!1!==this.props.clearColor&&void 0===this.props.clearColors&&(t|=16384,e.clearColor=this.props.clearColor),!1!==this.props.clearDepth&&(t|=256,e.clearDepth=this.props.clearDepth),!1!==this.props.clearStencil&&(t|=1024,e.clearStencil=this.props.clearStencil),0!==t&&(0,s.O)(this.device.gl,e,()=>{this.device.gl.clear(t)})}clearColorBuffer(e=0,t=[0,0,0,0]){(0,s.O)(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,t);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,t);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,t);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}},95850:(e,t,n)=>{n.d(t,{a:()=>c});var r=n(83909),s=n(76028),i=n(29651);const o="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class a{static defaultProps={...r.pF.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};stats=s.d;log=i.R;VERSION="9.2.4";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw i.R.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),i.R.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");i.R.error("This version of luma.gl has already been initialized")()}i.R.log(1,`${this.VERSION} - set luma.log.level=1 (or higher) to trace rendering`)(),globalThis.luma=this}async createDevice(e={}){const t={...a.defaultProps,...e},n=this.selectAdapter(t.type,t.adapters);if(!n)throw new Error(o);return t.waitForPageLoad&&await n.pageLoaded,await n.create(t)}async attachDevice(e,t){const n=this._getTypeFromHandle(e,t.adapters),r=n&&this.selectAdapter(n,t.adapters);if(!r)throw new Error(o);return await(r?.attach?.(e,t))}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(e=[]){const t=this._getAdapterMap(e);return Array.from(t).map(([,e])=>e).filter(e=>e.isSupported?.()).map(e=>e.type)}getBestAvailableAdapterType(e=[]){const t=["webgpu","webgl","null"],n=this._getAdapterMap(e);for(const r of t)if(n.get(r)?.isSupported?.())return r;return null}selectAdapter(e,t=[]){let n=e;"best-available"===e&&(n=this.getBestAvailableAdapterType(t));const r=this._getAdapterMap(t);return n&&r.get(n)||null}enforceWebGL2(e=!0,t=[]){const n=this._getAdapterMap(t).get("webgl");n||i.R.warn("enforceWebGL2: webgl adapter not found")(),n?.enforceWebGL2?.(e)}setDefaultDeviceProps(e){Object.assign(a.defaultProps,e)}_getAdapterMap(e=[]){const t=new Map(this.preregisteredAdapters);for(const n of e)t.set(n.type,n);return t}_getTypeFromHandle(e,t=[]){return e instanceof WebGL2RenderingContext?"webgl":"undefined"!=typeof GPUDevice&&e instanceof GPUDevice||e?.queue?"webgpu":null===e?"null":(e instanceof WebGLRenderingContext?i.R.warn("WebGL1 is not supported",e)():i.R.warn("Unknown handle type",e)(),null)}}const c=new a},95862:(e,t,n)=>{n.d(t,{q:()=>i});var r=n(94976),s=n(23793);async function i(e,t){const{mimeType:n}=(0,s.m)(e)||{},i=globalThis.loaders?.parseImageNode;return(0,r.v)(i),await i(e,n)}},96100:(e,t,n)=>{n.d(t,{d3:()=>a});var r=n(26839),s=n(77933),i=n(4500);class o{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||(0,i.L)("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&r.h.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function a(e,t){if(t instanceof o)return t;const n=function(e,t){if(!t.indices)return;const n=t.indices.value;return e.createBuffer({usage:r.h.INDEX,data:n})}(e,t),{attributes:i,bufferLayout:a}=function(e,t){const n=[],r={};for(const[o,a]of Object.entries(t.attributes)){let t=o;switch(o){case"POSITION":t="positions";break;case"NORMAL":t="normals";break;case"TEXCOORD_0":t="texCoords";break;case"COLOR_0":t="colors"}if(a){r[t]=e.createBuffer({data:a.value,id:`${o}-buffer`});const{value:i,size:c,normalized:l}=a;n.push({name:t,format:(0,s.OB)(i,c,l)})}}const i=t._calculateVertexCount(t.attributes,t.indices);return{attributes:r,bufferLayout:n,vertexCount:i}}(e,t);return new o({topology:t.topology||"triangle-list",bufferLayout:a,vertexCount:t.vertexCount,indices:n,attributes:i})}},96573:(e,t,n)=>{n.d(t,{X:()=>s});var r=n(20736);function s(e,t){return(0,r.m)(t[0],t[1])/(0,r.m)(e[0],e[1])}},97564:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(54901),s=n(94717),i=n(60676),o=n(73279),a=n(24067),c=n(70053);class l extends i.A{constructor(e){const{width:t,height:n,latitude:r,longitude:s,zoom:i,bearing:o=0,pitch:c=0,altitude:l=1.5,position:u=[0,0,0],maxZoom:h=20,minZoom:d=0,maxPitch:f=60,minPitch:p=0,startPanLngLat:g,startZoomLngLat:_,startRotatePos:m,startBearing:v,startPitch:b,startZoom:y,normalize:E=!0}=e;(0,a.A)(Number.isFinite(s)),(0,a.A)(Number.isFinite(r)),(0,a.A)(Number.isFinite(i)),super({width:t,height:n,latitude:r,longitude:s,zoom:i,bearing:o,pitch:c,altitude:l,maxZoom:h,minZoom:d,maxPitch:f,minPitch:p,normalize:E,position:u},{startPanLngLat:g,startZoomLngLat:_,startRotatePos:m,startBearing:v,startPitch:b,startZoom:y}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const n=this.getState().startPanLngLat||this._unproject(t);if(!n)return this;const r=this.makeViewport(this.getViewportProps()).panByPosition(n,e);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:s,startPitch:i}=this.getState();if(!r||void 0===s||void 0===i)return this;let o;return o=e?this._getNewRotation(e,r,i,s):{bearing:s+t,pitch:i+n},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:n}){let{startZoom:s,startZoomLngLat:i}=this.getState();if(i||(s=this.getViewportProps().zoom,i=this._unproject(t)||this._unproject(e)),!i)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let c=s+Math.log2(n);c=(0,r.qE)(c,a,o);const l=this.makeViewport({...this.getViewportProps(),zoom:c});return this._getUpdatedState({zoom:c,...l.panByPosition(i,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),n={...this.getViewportProps()},{bearing:r,longitude:s}=n;return Math.abs(r-t.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(n.longitude=s<0?s+360:s-360),n}applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:s}=e;e.zoom=(0,r.qE)(s,n,t);const{maxPitch:i,minPitch:a,pitch:c}=e;e.pitch=(0,r.qE)(c,a,i);const{normalize:l=!0}=e;return l&&Object.assign(e,(0,o.CK)(e)),e}_zoomFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.zoom({pos:[t/2,n/2],scale:e})}_panFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.pan({startPos:[t/2,n/2],pos:[t/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,n,s){const i=e[0]-t[0],o=e[1]-t[1],a=e[1],c=t[1],{width:l,height:u}=this.getViewportProps(),h=i/l;let d=0;o>0?Math.abs(u-c)>5&&(d=o/(c-u)*1.2):o<0&&c>5&&(d=1-a/c),d=(0,r.qE)(d,-1,1);const{minPitch:f,maxPitch:p}=this.getViewportProps();let g=n;return d>0?g=n+d*(p-n):d<0&&(g=n-d*(f-n)),{pitch:g,bearing:s+180*h}}}class u extends s.A{constructor(){super(...arguments),this.ControllerState=l,this.transition={transitionDuration:300,transitionInterpolator:new c.A({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e);(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}},97669:(e,t,n)=>{n.d(t,{S:()=>c});var r=n(9350),s=n(7914);const i={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},o="top-left",a="__root";class c{constructor({deck:e,parentElement:t}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,t?.classList.add("deck-widget-container"),this.parentElement=t}getWidgets(){return this.resolvedWidgets}setProps(e){if(e.widgets&&!(0,s.b)(e.widgets,this.widgets,1)){const t=e.widgets.filter(Boolean);this._setWidgets(t)}}finalize(){for(const e of this.getWidgets())this._removeWidget(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(t=>t.id===e.id)||(this._addWidget(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}onRedraw({viewports:e,layers:t}){const n=e.reduce((e,t)=>(e[t.id]=t,e),{});for(const r of this.getWidgets()){const{viewId:s}=r;if(s){const e=n[s];e&&(r.onViewportChange&&r.onViewportChange(e),r.onRedraw?.({viewports:[e],layers:t}))}else{if(r.onViewportChange)for(const t of e)r.onViewportChange(t);r.onRedraw?.({viewports:e,layers:t})}}this.lastViewports=n,this._updateContainers()}onHover(e,t){for(const n of this.getWidgets()){const{viewId:r}=n;r&&r!==e.viewport?.id||n.onHover?.(e,t)}}onEvent(e,t){const n=r.tg[t.type];if(n)for(const r of this.getWidgets()){const{viewId:s}=r;s&&s!==e.viewport?.id||r[n]?.(e,t)}}_setWidgets(e){const t={};for(const n of this.resolvedWidgets)t[n.id]=n;this.resolvedWidgets.length=0;for(const n of this.defaultWidgets)t[n.id]=null,this.resolvedWidgets.push(n);for(let n of e){const e=t[n.id];e?e.viewId!==n.viewId||e.placement!==n.placement?(this._removeWidget(e),this._addWidget(n)):n!==e&&(e.setProps(n.props),n=e):this._addWidget(n),t[n.id]=null,this.resolvedWidgets.push(n)}for(const n in t){const e=t[n];e&&this._removeWidget(e)}this.widgets=e}_addWidget(e){const{viewId:t=null,placement:n=o}=e;e.widgetManager=this,e.deck=this.deck,e.rootElement=e._onAdd({deck:this.deck,viewId:t}),e.rootElement&&this._getContainer(t,n).append(e.rootElement),e.updateHTML()}_removeWidget(e){e.onRemove?.(),e.rootElement&&e.rootElement.remove(),e.rootElement=void 0,e.deck=void 0,e.widgetManager=void 0}_getContainer(e,t){const n=e||a;let r=this.containers[n];r||(r=document.createElement("div"),r.style.pointerEvents="none",r.style.position="absolute",r.style.overflow="hidden",this.parentElement?.append(r),this.containers[n]=r);let s=r.querySelector(`.${t}`);return s||(s=globalThis.document.createElement("div"),s.className=t,s.style.position="absolute",s.style.zIndex="2",Object.assign(s.style,i[t]),r.append(s)),s}_updateContainers(){const e=this.deck.width,t=this.deck.height;for(const n in this.containers){const r=this.lastViewports[n]||null,s=n===a||r,i=this.containers[n];s?(i.style.display="block",i.style.left=`${r?r.x:0}px`,i.style.top=`${r?r.y:0}px`,i.style.width=`${r?r.width:e}px`,i.style.height=`${r?r.height:t}px`):i.style.display="none"}}}},97681:(e,t,n)=>{n.d(t,{y:()=>r});const r="const vec2 E_FP64 = vec2(2.7182817459106445e+00, 8.254840366817007e-08);\nconst vec2 LOG2_FP64 = vec2(0.6931471824645996e+00, -1.9046542121259336e-09);\nconst vec2 PI_FP64 = vec2(3.1415927410125732, -8.742278012618954e-8);\nconst vec2 TWO_PI_FP64 = vec2(6.2831854820251465, -1.7484556025237907e-7);\nconst vec2 PI_2_FP64 = vec2(1.5707963705062866, -4.371139006309477e-8);\nconst vec2 PI_4_FP64 = vec2(0.7853981852531433, -2.1855695031547384e-8);\nconst vec2 PI_16_FP64 = vec2(0.19634954631328583, -5.463923757886846e-9);\nconst vec2 PI_16_2_FP64 = vec2(0.39269909262657166, -1.0927847515773692e-8);\nconst vec2 PI_16_3_FP64 = vec2(0.5890486240386963, -1.4906100798128818e-9);\nconst vec2 PI_180_FP64 = vec2(0.01745329238474369, 1.3519960498364902e-10);\n\nconst vec2 SIN_TABLE_0_FP64 = vec2(0.19509032368659973, -1.6704714833615242e-9);\nconst vec2 SIN_TABLE_1_FP64 = vec2(0.3826834261417389, 6.22335089017767e-9);\nconst vec2 SIN_TABLE_2_FP64 = vec2(0.5555702447891235, -1.1769521357507529e-8);\nconst vec2 SIN_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617041793133e-8);\n\nconst vec2 COS_TABLE_0_FP64 = vec2(0.9807852506637573, 2.9739473106360492e-8);\nconst vec2 COS_TABLE_1_FP64 = vec2(0.9238795042037964, 2.8307490351764386e-8);\nconst vec2 COS_TABLE_2_FP64 = vec2(0.8314695954322815, 1.6870263741530778e-8);\nconst vec2 COS_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617152815436e-8);\n\nconst vec2 INVERSE_FACTORIAL_3_FP64 = vec2(1.666666716337204e-01, -4.967053879312289e-09); // 1/3!\nconst vec2 INVERSE_FACTORIAL_4_FP64 = vec2(4.16666679084301e-02, -1.2417634698280722e-09); // 1/4!\nconst vec2 INVERSE_FACTORIAL_5_FP64 = vec2(8.333333767950535e-03, -4.34617203337595e-10); // 1/5!\nconst vec2 INVERSE_FACTORIAL_6_FP64 = vec2(1.3888889225199819e-03, -3.3631094437103215e-11); // 1/6!\nconst vec2 INVERSE_FACTORIAL_7_FP64 = vec2(1.9841270113829523e-04,  -2.725596874933456e-12); // 1/7!\nconst vec2 INVERSE_FACTORIAL_8_FP64 = vec2(2.4801587642286904e-05, -3.406996025904184e-13); // 1/8!\nconst vec2 INVERSE_FACTORIAL_9_FP64 = vec2(2.75573188446287533e-06, 3.7935713937038186e-14); // 1/9!\nconst vec2 INVERSE_FACTORIAL_10_FP64 = vec2(2.755731998149713e-07, -7.575112367869873e-15); // 1/10!\n\nfloat nint(float d) {\n    if (d == floor(d)) return d;\n    return floor(d + 0.5);\n}\n\nvec2 nint_fp64(vec2 a) {\n    float hi = nint(a.x);\n    float lo;\n    vec2 tmp;\n    if (hi == a.x) {\n        lo = nint(a.y);\n        tmp = quickTwoSum(hi, lo);\n    } else {\n        lo = 0.0;\n        if (abs(hi - a.x) == 0.5 && a.y < 0.0) {\n            hi -= 1.0;\n        }\n        tmp = vec2(hi, lo);\n    }\n    return tmp;\n}\n\n/* k_power controls how much range reduction we would like to have\nRange reduction uses the following method:\nassume a = k_power * r + m * log(2), k and m being integers.\nSet k_power = 4 (we can choose other k to trade accuracy with performance.\nwe only need to calculate exp(r) and using exp(a) = 2^m * exp(r)^k_power;\n*/\n\nvec2 exp_fp64(vec2 a) {\n  // We need to make sure these two numbers match\n  // as bit-wise shift is not available in GLSL 1.0\n  const int k_power = 4;\n  const float k = 16.0;\n\n  const float inv_k = 1.0 / k;\n\n  if (a.x <= -88.0) return vec2(0.0, 0.0);\n  if (a.x >= 88.0) return vec2(1.0 / 0.0, 1.0 / 0.0);\n  if (a.x == 0.0 && a.y == 0.0) return vec2(1.0, 0.0);\n  if (a.x == 1.0 && a.y == 0.0) return E_FP64;\n\n  float m = floor(a.x / LOG2_FP64.x + 0.5);\n  vec2 r = sub_fp64(a, mul_fp64(LOG2_FP64, vec2(m, 0.0))) * inv_k;\n  vec2 s, t, p;\n\n  p = mul_fp64(r, r);\n  s = sum_fp64(r, p * 0.5);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_3_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_4_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_5_FP64);\n\n  // s = sum_fp64(s, t);\n  // p = mul_fp64(p, r);\n  // t = mul_fp64(p, INVERSE_FACTORIAL_6_FP64);\n\n  // s = sum_fp64(s, t);\n  // p = mul_fp64(p, r);\n  // t = mul_fp64(p, INVERSE_FACTORIAL_7_FP64);\n\n  s = sum_fp64(s, t);\n\n\n  // At this point, s = exp(r) - 1; but after following 4 recursions, we will get exp(r) ^ 512 - 1.\n  for (int i = 0; i < k_power; i++) {\n    s = sum_fp64(s * 2.0, mul_fp64(s, s));\n  }\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = sum_fp64(s, vec2(fp64.ONE, 0.0));\n#else\n  s = sum_fp64(s, vec2(1.0, 0.0));\n#endif\n\n  return s * pow(2.0, m);\n//   return r;\n}\n\nvec2 log_fp64(vec2 a)\n{\n  if (a.x == 1.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x <= 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n  vec2 x = vec2(log(a.x), 0.0);\n  vec2 s;\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = vec2(fp64.ONE, 0.0);\n#else\n  s = vec2(1.0, 0.0);\n#endif\n\n  x = sub_fp64(sum_fp64(x, mul_fp64(a, exp_fp64(-x))), s);\n  return x;\n}\n\nvec2 sin_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(0.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  s = a;\n  r = a;\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_3_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_5_FP64);\n  s = sum_fp64(s, t);\n\n  /* keep the following commented code in case we need them\n  for extra accuracy from the Taylor expansion*/\n\n  // r = mul_fp64(r, x);\n  // t = mul_fp64(r, INVERSE_FACTORIAL_7_FP64);\n  // s = sum_fp64(s, t);\n\n  // r = mul_fp64(r, x);\n  // t = mul_fp64(r, INVERSE_FACTORIAL_9_FP64);\n  // s = sum_fp64(s, t);\n\n  return s;\n}\n\nvec2 cos_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(1.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  r = x;\n  s = sum_fp64(vec2(1.0, 0.0), r * 0.5);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_4_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_6_FP64);\n  s = sum_fp64(s, t);\n\n  /* keep the following commented code in case we need them\n  for extra accuracy from the Taylor expansion*/\n\n  // r = mul_fp64(r, x);\n  // t = mul_fp64(r, INVERSE_FACTORIAL_8_FP64);\n  // s = sum_fp64(s, t);\n\n  // r = mul_fp64(r, x);\n  // t = mul_fp64(r, INVERSE_FACTORIAL_10_FP64);\n  // s = sum_fp64(s, t);\n\n  return s;\n}\n\nvoid sincos_taylor_fp64(vec2 a, out vec2 sin_t, out vec2 cos_t) {\n  if (a.x == 0.0 && a.y == 0.0) {\n    sin_t = vec2(0.0, 0.0);\n    cos_t = vec2(1.0, 0.0);\n  }\n\n  sin_t = sin_taylor_fp64(a);\n  cos_t = sqrt_fp64(sub_fp64(vec2(1.0, 0.0), mul_fp64(sin_t, sin_t)));\n}\n\nvec2 sin_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n\n    // 2pi range reduction\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return sin_taylor_fp64(t);\n        } else if (j == 1) {\n            return cos_taylor_fp64(t);\n        } else if (j == -1) {\n            return -cos_taylor_fp64(t);\n        } else {\n            return -sin_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 cos_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(1.0, 0.0);\n    }\n\n    // 2pi range reduction\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return cos_taylor_fp64(t);\n        } else if (j == 1) {\n            return -sin_taylor_fp64(t);\n        } else if (j == -1) {\n            return sin_taylor_fp64(t);\n        } else {\n            return -cos_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 tan_fp64(vec2 a) {\n    vec2 sin_a;\n    vec2 cos_a;\n\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n\n    // 2pi range reduction\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    // We just can't get PI/16 * 3.0 very accurately.\n    // so let's just store it\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n    vec2 sin_t, cos_t;\n    vec2 s, c;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#else\n        if (abs_k == 1) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs_k == 2) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs_k == 3) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs_k == 4) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#endif\n        if (k > 0) {\n            s = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            s = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return div_fp64(sin_a, cos_a);\n}\n\nvec2 radians_fp64(vec2 degree) {\n  return mul_fp64(degree, PI_180_FP64);\n}\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\n// Vector functions\n// vec2 functions\nvoid vec2_sum_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sum_fp64(a[0], b[0]);\n    out_val[1] = sum_fp64(a[1], b[1]);\n}\n\nvoid vec2_sub_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sub_fp64(a[0], b[0]);\n    out_val[1] = sub_fp64(a[1], b[1]);\n}\n\nvoid vec2_mul_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = mul_fp64(a[0], b[0]);\n    out_val[1] = mul_fp64(a[1], b[1]);\n}\n\nvoid vec2_div_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = div_fp64(a[0], b[0]);\n    out_val[1] = div_fp64(a[1], b[1]);\n}\n\nvoid vec2_mix_fp64(vec2 x[2], vec2 y[2], float a, out vec2 out_val[2]) {\n  vec2 range[2];\n  vec2_sub_fp64(y, x, range);\n  vec2 portion[2];\n  portion[0] = range[0] * a;\n  portion[1] = range[1] * a;\n  vec2_sum_fp64(x, portion, out_val);\n}\n\nvec2 vec2_length_fp64(vec2 x[2]) {\n  return sqrt_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])));\n}\n\nvoid vec2_normalize_fp64(vec2 x[2], out vec2 out_val[2]) {\n  vec2 length = vec2_length_fp64(x);\n  vec2 length_vec2[2];\n  length_vec2[0] = length;\n  length_vec2[1] = length;\n\n  vec2_div_fp64(x, length_vec2, out_val);\n}\n\nvec2 vec2_distance_fp64(vec2 x[2], vec2 y[2]) {\n  vec2 diff[2];\n  vec2_sub_fp64(x, y, diff);\n  return vec2_length_fp64(diff);\n}\n\nvec2 vec2_dot_fp64(vec2 a[2], vec2 b[2]) {\n  vec2 v[2];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n\n  return sum_fp64(v[0], v[1]);\n}\n\n// vec3 functions\nvoid vec3_sub_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec3_sum_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvec2 vec3_length_fp64(vec2 x[3]) {\n  return sqrt_fp64(sum_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])),\n    mul_fp64(x[2], x[2])));\n}\n\nvec2 vec3_distance_fp64(vec2 x[3], vec2 y[3]) {\n  vec2 diff[3];\n  vec3_sub_fp64(x, y, diff);\n  return vec3_length_fp64(diff);\n}\n\n// vec4 functions\nvoid vec4_fp64(vec4 a, out vec2 out_val[4]) {\n  out_val[0].x = a[0];\n  out_val[0].y = 0.0;\n\n  out_val[1].x = a[1];\n  out_val[1].y = 0.0;\n\n  out_val[2].x = a[2];\n  out_val[2].y = 0.0;\n\n  out_val[3].x = a[3];\n  out_val[3].y = 0.0;\n}\n\nvoid vec4_scalar_mul_fp64(vec2 a[4], vec2 b, out vec2 out_val[4]) {\n  out_val[0] = mul_fp64(a[0], b);\n  out_val[1] = mul_fp64(a[1], b);\n  out_val[2] = mul_fp64(a[2], b);\n  out_val[3] = mul_fp64(a[3], b);\n}\n\nvoid vec4_sum_fp64(vec2 a[4], vec2 b[4], out vec2 out_val[4]) {\n  for (int i = 0; i < 4; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec4_dot_fp64(vec2 a[4], vec2 b[4], out vec2 out_val) {\n  vec2 v[4];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n  v[2] = mul_fp64(a[2], b[2]);\n  v[3] = mul_fp64(a[3], b[3]);\n\n  out_val = sum_fp64(sum_fp64(v[0], v[1]), sum_fp64(v[2], v[3]));\n}\n\nvoid mat4_vec4_mul_fp64(vec2 b[16], vec2 a[4], out vec2 out_val[4]) {\n  vec2 tmp[4];\n\n  for (int i = 0; i < 4; i++)\n  {\n    for (int j = 0; j < 4; j++)\n    {\n      tmp[j] = b[j + i * 4];\n    }\n    vec4_dot_fp64(a, tmp, out_val[i]);\n  }\n}\n"},98763:(e,t,n)=>{var r=n(36157);n(88171),n(57662);r.o},99209:(e,t,n)=>{n.d(t,{r:()=>a});var r=n(33814),s=n(67637);const i={};let o=!0;async function a(e,t,n){let a;if((0,r.XJ)(n)){a=await(0,s.a)(e,t,n)}else a=(0,r.qW)(e,n);const c=t&&t.imagebitmap;return await async function(e,t=null){!function(e){for(const t in e||i)return!1;return!0}(t)&&o||(t=null);if(t)try{return await createImageBitmap(e,t)}catch(n){console.warn(n),o=!1}return await createImageBitmap(e)}(a,c)}},99254:(e,t,n)=>{function r(e){switch(e){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function s(e){switch(e){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}n.d(t,{E:()=>s,c:()=>r})},99273:(e,t,n)=>{n.d(t,{X:()=>i});var r=n(60517),s=n(7638);class i extends r.Q{device;handle=null;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,t){super(t),this.device=e,this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this._updateDevice()}getCurrentFramebuffer(){return this._framebuffer=this._framebuffer||new s.h(this.device,{handle:null}),this._framebuffer}_updateDevice(){}}},99551:(e,t,n)=>{n.d(t,{F:()=>i,q:()=>o});var r=n(3459);const s={pickedColor:null,pickedObjectIndex:-1};function i({pickedColors:e,decodePickingColor:t,deviceX:n,deviceY:i,deviceRadius:o,deviceRect:a}){const{x:c,y:l,width:u,height:h}=a;let d=o*o,f=-1,p=0;for(let r=0;r<h;r++){const t=r+l-i,s=t*t;if(s>d)p+=4*u;else for(let r=0;r<u;r++){if(e[p+3]-1>=0){const e=r+c-n,t=e*e+s;t<=d&&(d=t,f=p)}p+=4}}if(f>=0){const n=e.slice(f,f+4),s=t(n);if(s){const e=Math.floor(f/4/u),t=f/4-e*u;return{...s,pickedColor:n,pickedX:c+t,pickedY:l+e}}r.A.error("Picked non-existent layer. Is picking buffer corrupt?")()}return s}function o({pickedColors:e,decodePickingColor:t}){const n=new Map;if(e)for(let s=0;s<e.length;s+=4){if(e[s+3]-1>=0){const i=e.slice(s,s+4),o=i.join(",");if(!n.has(o)){const e=t(i);e?n.set(o,{...e,color:i}):r.A.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}},99616:(e,t,n)=>{n.d(t,{G:()=>f});var r=n(22512),s=n(29651),i=n(54128),o=n(40424),a=n(73756),c=n(2919),l=n(7638),u=n(85450),h=n(92134),d=n(24744);class f extends r.r{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};get[Symbol.toStringTag](){return"WEBGLRenderPipeline"}constructor(e,t){super(e,t),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:{id:this.props.id}}),this.vs=t.vs,this.fs=t.fs;const{varyings:n,bufferMode:r=35981}=t;n&&n.length>0&&(this.varyings=n,this.device.gl.transformFeedbackVaryings(this.handle,n,r)),this._linkShaders(),s.R.time(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=(0,i.K)(this.device.gl,this.handle),s.R.timeEnd(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=t.shaderLayout?function(e,t){const n={...e,attributes:e.attributes.map(e=>({...e}))};for(const r of t?.attributes||[]){const e=n.attributes.find(e=>e.name===r.name);e?(e.type=r.type||e.type,e.stepMode=r.stepMode||e.stepMode):s.R.warn(`shader layout attribute ${r.name} not present in shader`)}return n}(this.introspectedLayout,t.shaderLayout):this.introspectedLayout}destroy(){this.handle&&(this.device.gl.useProgram(null),this.device.gl.deleteProgram(this.handle),this.destroyed=!0,this.handle.destroyed=!0,this.handle=null)}setBindings(e,t){for(const[n,r]of Object.entries(e)){const e=this.shaderLayout.bindings.find(e=>e.name===n)||this.shaderLayout.bindings.find(e=>e.name===`${n}Uniforms`);if(!e){const e=this.shaderLayout.bindings.map(e=>`"${e.name}"`).join(", ");t?.disableWarnings||s.R.warn(`No binding "${n}" in render pipeline "${this.id}", expected one of ${e}`,r)();continue}switch(r||s.R.warn(`Unsetting binding "${n}" in render pipeline "${this.id}"`)(),e.type){case"uniform":if(!(r instanceof c.K||r.buffer instanceof c.K))throw new Error("buffer value");break;case"texture":if(!(r instanceof h.C||r instanceof u.d_||r instanceof l.h))throw new Error(`${this} Bad texture binding for ${n}`);break;case"sampler":s.R.warn(`Ignoring sampler ${n}`)();break;default:throw new Error(e.type)}this.bindings[n]=r}}draw(e){const{renderPass:t,parameters:n=this.props.parameters,topology:r=this.props.topology,vertexArray:i,vertexCount:a,instanceCount:c,isInstanced:l=!1,firstVertex:u=0,transformFeedback:h}=e,f=(0,d.nV)(r),p=Boolean(i.indexBuffer),g=i.indexBuffer?.glIndexType;if("success"!==this.linkStatus)return s.R.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return s.R.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),i.bindBeforeRender(t),h&&h.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const _=t;return(0,o.nk)(this.device,n,_.glParameters,()=>{p&&l?this.device.gl.drawElementsInstanced(f,a||0,g,u,c||0):p?this.device.gl.drawElements(f,a||0,g,u):l?this.device.gl.drawArraysInstanced(f,u,a||0,c||0):this.device.gl.drawArrays(f,u,a||0),h&&h.end()}),i.unbindAfterRender(t),!0}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),s.R.time(4,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),s.R.timeEnd(4,`linkProgram for ${this.id}`)(),s.R.level,!this.device.features.has("compilation-status-async-webgl")){const e=this._getLinkStatus();return void this._reportLinkStatus(e)}s.R.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),s.R.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const t=this._getLinkStatus();this._reportLinkStatus(t)}async _reportLinkStatus(e){if("success"!==e){const t="link-error"===e?"Link error":"Validation error";switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`${this} ${t} during compilation of ${this.vs}`);case"pending":await this.vs.asyncCompilationStatus,this.vs.debugShader()}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`${this} ${t} during compilation of ${this.fs}`);case"pending":await this.fs.asyncCompilationStatus,this.fs.debugShader()}const n=this.device.gl.getProgramInfoLog(this.handle);this.device.reportError(new Error(`${t} during ${e}: ${n}`),this)(),this.device.debug()}}_getLinkStatus(){const{gl:e}=this.device;if(!e.getProgramParameter(this.handle,35714))return this.linkStatus="error","link-error";e.validateProgram(this.handle);return e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation-error")}async _waitForLinkComplete(){const e=async e=>await new Promise(t=>setTimeout(t,e));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const t of this.shaderLayout.bindings)this.bindings[t.name]||this.bindings[t.name.replace(/Uniforms$/,"")]||(s.R.warn(`Binding ${t.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if("success"!==this.linkStatus)return;const{gl:e}=this.device;e.useProgram(this.handle);let t=0,n=0;for(const r of this.shaderLayout.bindings){const i=this.bindings[r.name]||this.bindings[r.name.replace(/Uniforms$/,"")];if(!i)throw new Error(`No value for binding ${r.name} in ${this.id}`);switch(r.type){case"uniform":const{name:o}=r,a=e.getUniformBlockIndex(this.handle,o);if(4294967295===a)throw new Error(`Invalid uniform block name ${o}`);e.uniformBlockBinding(this.handle,n,a),i instanceof c.K?e.bindBufferBase(35345,n,i.handle):e.bindBufferRange(35345,n,i.buffer.handle,i.offset||0,i.size||i.buffer.byteLength-i.offset),n+=1;break;case"texture":if(!(i instanceof h.C||i instanceof u.d_||i instanceof l.h))throw new Error("texture");let d;if(i instanceof h.C)d=i.texture;else if(i instanceof u.d_)d=i;else{if(!(i instanceof l.h&&i.colorAttachments[0]instanceof h.C))throw new Error("No texture");s.R.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),d=i.colorAttachments[0].texture}e.activeTexture(33984+t),e.bindTexture(d.glTarget,d.handle),t+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${r.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:t,location:n,type:r,textureUnit:s}=e,i=this.uniforms[t]??s;void 0!==i&&(0,a.B)(this.device.gl,n,r,i)}}}}}]);